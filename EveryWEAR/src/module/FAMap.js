var FA = (function(FA, FAConfig) {
    if (typeof (FA) !== "undefined") {
        return FA;
    }
    FA = {};
    FA.Modules = {};
    FA.faConfig = FAConfig ? FAConfig : {};
    if (typeof (FA.faConfig.fa_config) === "undefined") {
        FA.faConfig.fa_config = function(key, fallbackValue) {
            if (typeof (FA.faConfig[key]) !== 'undefined') {
                return FA.faConfig[key];
            } else {
                console.warn('FA.faConfig.' + key + ' was not initialized');
                return fallbackValue;
            }
        }
    }
    ;return FA;
}
)(FA, typeof (FAConfig) === "object" ? FAConfig : null);
var console = console || {};
['log', 'error', 'warn'].forEach(function(fn) {
    if (typeof console[fn] == 'undefined') {
        console[fn] = function() {}
        ;
    }
});
(function(FA) {
    if (typeof (FA.Lib) !== "undefined") {
        return;
    }
    FA.Lib = {};
}
)(FA);
if (typeof (module) !== "undefined" && typeof (module.exports) !== "undefined") {
    module.exports = FA.Lib;
}
var Ajax = (function(FA, console) {
    if (FA && typeof (FA.Lib) === "object" && typeof (FA.Lib.Common) === "object" && typeof (FA.Lib.Common.Ajax) === "object") {
        return FA.Lib.Common.Ajax;
    }
    var Post = function(url, opt) {
        var options = opt || {};
        options.success = options.success || (function(ajax) {
            return function() {
                console.warn("success: status=" + ajax.xhttp.status + ":" + ajax.xhttp.statusText)
            }
            ;
        }
        )(this);
        options.error = options.error || (function(ajax) {
            return function() {
                console.warn("error: status=" + ajax.xhttp.status + ":" + ajax.xhttp.statusText)
            }
            ;
        }
        )(this);
        options.statusCode = options.statusCode || {};
        options.params = options.params || {};
        var params = null;
        for (key in options.params) {
            var value = key + "=" + encodeURIComponent(options.params[key]);
            if (params) {
                params = params + "&" + value;
            } else {
                params = value;
            }
        }
        this.xhttp = new XMLHttpRequest();
        this.xhttp.open('POST', encodeURI(url));
        this.xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        this.xhttp.onload = (function(xhttp, options) {
            return function() {
                if ((xhttp.status >= 200 && xhttp.status < 300) || xhttp.status === 304) {
                    options.success();
                } else {
                    options.error();
                }
                if (typeof (options.statusCode[xhttp.status]) === "function") {
                    options.statusCode[xhttp.status]();
                }
            }
            ;
        }
        )(this.xhttp, options);
        this.xhttp.send(params);
    };
    return {
        "Post": Post
    };
}
)(typeof (FA) === "object" ? FA : null, console);
if (typeof (module) !== "undefined" && typeof (module.exports) !== "undefined") {
    module.exports = Ajax;
}
(function(FA, Ajax) {
    if (typeof (FA.Lib.Common) !== "undefined") {
        return;
    }
    FA.Lib.Common = {
        "version": "0.1"
    };
    FA.Lib.Common.debounce = function(func, wait) {
        var immediate = typeof (wait) === "undefined" || wait === null || wait === 0 ? true : false;
        var timeoutSet = null;
        return function() {
            var _func = function() {
                timeoutSet = null;
                func();
            };
            if (immediate && !timeoutSet) {
                func();
            } else {
                clearTimeout(timeoutSet);
                timeoutSet = setTimeout(_func, wait);
            }
        }
        ;
    }
    ;
    FA.Lib.Common.isCoordinate = function(value) {
        return new RegExp('^L ([0-9\-\.]+) ([0-9\-\.]+)$').test(value);
    }
    ;
    FA.Lib.Common.hasLocalStorage = (function() {
        try {
            window.localStorage.setItem('test', 'test');
            window.localStorage.removeItem('test');
            return true;
        } catch (e) {
            return false;
        }
    }
    )();
    FA.Lib.Common.Ajax = Ajax;
}
)(FA, Ajax);
if (typeof (module) !== "undefined" && typeof (module.exports) !== "undefined") {
    module.exports = FA.Lib.Common;
}
(function(FA) {
    if ((typeof FA.Modules.Error) !== "undefined") {
        return;
    }
    FA.Modules.Error = function(message) {
        Error.prototype.constructor.apply(this, arguments);
        if (typeof (console) != undefined) {
            console.error(message);
        }
    }
    FA.Modules.Error.prototype = Object.create(Error.prototype);
    FA.Modules.Error.prototype.constructor = FA.Modules.Error;
}(FA));
(function(global) {
    if (global.performance) {
        return;
    }
    var startTime = Date.now();
    if (!global.performance) {
        global.performance = {};
    }
    global.performance.now = function() {
        return Date.now() - startTime;
    }
    ;
}(this));
(function(global, window) {
    var rafPrefix;
    if ('requestAnimationFrame'in global) {
        return;
    }
    if ('mozRequestAnimationFrame'in global) {
        rafPrefix = 'moz';
    } else if ('webkitRequestAnimationFrame'in global) {
        rafPrefix = 'webkit';
    }
    if (rafPrefix) {
        global.requestAnimationFrame = function(callback) {
            return global[rafPrefix + 'RequestAnimationFrame'](function() {
                callback(global.performance.now());
            });
        }
        ;
        global.cancelAnimationFrame = global[rafPrefix + 'CancelAnimationFrame'];
    } else {
        var lastTime = Date.now();
        global.requestAnimationFrame = function(callback) {
            if (typeof callback !== 'function') {
                throw new TypeError(callback + ' is not a function');
            }
            var currentTime = Date.now()
              , delay = 16 + lastTime - currentTime;
            if (delay < 0) {
                delay = 0;
            }
            lastTime = currentTime;
            return setTimeout(function() {
                lastTime = Date.now();
                callback(global.performance.now());
            }, delay);
        }
        ;
        global.cancelAnimationFrame = function(id) {
            clearTimeout(id);
        }
        ;
    }
}(this));
;(function(root, factory) {
    if (typeof exports === "object") {
        module.exports = factory();
    } else if (typeof define === "function" && define.amd) {
        define([], factory);
    } else {
        root.ol = factory();
    }
}(this, function() {
    var OPENLAYERS = {};
    var h, aa = "function" == typeof Object.defineProperties ? Object.defineProperty : function(a, b, c) {
        a != Array.prototype && a != Object.prototype && (a[b] = c.value)
    }
    , ba = "undefined" != typeof window && window === this ? this : "undefined" != typeof global && null != global ? global : this;
    function da(a, b) {
        if (b) {
            var c = ba;
            a = a.split(".");
            for (var d = 0; d < a.length - 1; d++) {
                var e = a[d];
                e in c || (c[e] = {});
                c = c[e]
            }
            a = a[a.length - 1];
            d = c[a];
            b = b(d);
            b != d && null != b && aa(c, a, {
                configurable: !0,
                writable: !0,
                value: b
            })
        }
    }
    da("Math.cosh", function(a) {
        if (a)
            return a;
        var b = Math.exp;
        return function(a) {
            a = Number(a);
            return (b(a) + b(-a)) / 2
        }
    });
    function fa() {
        fa = function() {}
        ;
        ba.Symbol || (ba.Symbol = ha)
    }
    var ia = 0;
    function ha(a) {
        return "jscomp_symbol_" + (a || "") + ia++
    }
    function ja() {
        fa();
        var a = ba.Symbol.iterator;
        a || (a = ba.Symbol.iterator = ba.Symbol("iterator"));
        "function" != typeof Array.prototype[a] && aa(Array.prototype, a, {
            configurable: !0,
            writable: !0,
            value: function() {
                return ka(this)
            }
        });
        ja = function() {}
    }
    function ka(a) {
        var b = 0;
        return la(function() {
            return b < a.length ? {
                done: !1,
                value: a[b++]
            } : {
                done: !0
            }
        })
    }
    function la(a) {
        ja();
        a = {
            next: a
        };
        a[ba.Symbol.iterator] = function() {
            return this
        }
        ;
        return a
    }
    function ma(a, b) {
        ja();
        a instanceof String && (a += "");
        var c = 0
          , d = {
            next: function() {
                if (c < a.length) {
                    var e = c++;
                    return {
                        value: b(e, a[e]),
                        done: !1
                    }
                }
                d.next = function() {
                    return {
                        done: !0,
                        value: void 0
                    }
                }
                ;
                return d.next()
            }
        };
        d[Symbol.iterator] = function() {
            return d
        }
        ;
        return d
    }
    da("Array.prototype.keys", function(a) {
        return a ? a : function() {
            return ma(this, function(a) {
                return a
            })
        }
    });
    da("Array.prototype.fill", function(a) {
        return a ? a : function(a, c, d) {
            var b = this.length || 0;
            0 > c && (c = Math.max(0, b + c));
            if (null == d || d > b)
                d = b;
            d = Number(d);
            0 > d && (d = Math.max(0, b + d));
            for (c = Number(c || 0); c < d; c++)
                this[c] = a;
            return this
        }
    });
    da("Number.EPSILON", function() {
        return Math.pow(2, -52)
    });
    da("Object.is", function(a) {
        return a ? a : function(a, c) {
            return a === c ? 0 !== a || 1 / a === 1 / c : a !== a && c !== c
        }
    });
    da("Array.prototype.values", function(a) {
        return a ? a : function() {
            return ma(this, function(a, c) {
                return c
            })
        }
    });
    var na = this;
    function r(a, b) {
        a = a.split(".");
        var c = OPENLAYERS || na;
        a[0]in c || !c.execScript || c.execScript("var " + a[0]);
        for (var d; a.length && (d = a.shift()); )
            a.length || void 0 === b ? c = c[d] && c[d] !== Object.prototype[d] ? c[d] : c[d] = {} : c[d] = b
    }
    ;var oa, pa;
    function qa(a, b) {
        return a > b ? 1 : a < b ? -1 : 0
    }
    function ra(a, b) {
        return 0 <= a.indexOf(b)
    }
    function sa(a, b, c) {
        var d = a.length;
        if (a[0] <= b)
            return 0;
        if (!(b <= a[d - 1]))
            if (0 < c)
                for (c = 1; c < d; ++c) {
                    if (a[c] < b)
                        return c - 1
                }
            else if (0 > c)
                for (c = 1; c < d; ++c) {
                    if (a[c] <= b)
                        return c
                }
            else
                for (c = 1; c < d; ++c) {
                    if (a[c] == b)
                        return c;
                    if (a[c] < b)
                        return a[c - 1] - b < b - a[c] ? c - 1 : c
                }
        return d - 1
    }
    function ta(a, b) {
        var c = Array.isArray(b) ? b : [b]
          , d = c.length;
        for (b = 0; b < d; b++)
            a[a.length] = c[b]
    }
    function ua(a, b) {
        for (var c = a.length >>> 0, d, e = 0; e < c; e++)
            if (d = a[e],
            b(d, e, a))
                return d;
        return null
    }
    function wa(a, b) {
        var c = a.length;
        if (c !== b.length)
            return !1;
        for (var d = 0; d < c; d++)
            if (a[d] !== b[d])
                return !1;
        return !0
    }
    function xa(a) {
        var b = ya, c = a.length, d = Array(a.length), e;
        for (e = 0; e < c; e++)
            d[e] = {
                index: e,
                value: a[e]
            };
        d.sort(function(a, c) {
            return b(a.value, c.value) || a.index - c.index
        });
        for (e = 0; e < a.length; e++)
            a[e] = d[e].value
    }
    function za(a, b) {
        var c;
        return a.every(function(d, e) {
            c = e;
            return !b(d, e, a)
        }) ? -1 : c
    }
    function Aa(a, b) {
        var c = b || qa;
        return a.every(function(b, e) {
            if (0 === e)
                return !0;
            b = c(a[e - 1], b);
            return !(0 < b || 0 === b)
        })
    }
    ;function v(a, b) {
        a.prototype = Object.create(b.prototype);
        a.prototype.constructor = a
    }
    function Ba() {}
    function w(a) {
        return a.uz || (a.uz = ++Da)
    }
    var Da = 0;
    function Ea(a) {
        this.message = "Assertion failed. See https://openlayers.org/en/v4.3.4fa/doc/errors/#" + a + " for details.";
        this.code = a;
        this.name = "AssertionError"
    }
    v(Ea, Error);
    function Fa(a, b) {
        if (!a)
            throw new Ea(b);
    }
    ;function Ga(a, b, c, d) {
        this.ba = a;
        this.ea = b;
        this.ca = c;
        this.fa = d
    }
    h = Ga.prototype;
    h.contains = function(a) {
        return this.de(a[1], a[2])
    }
    ;
    h.de = function(a, b) {
        return this.ba <= a && a <= this.ea && this.ca <= b && b <= this.fa
    }
    ;
    h.hs = function(a) {
        return this.ba == a.ba && this.ca == a.ca && this.ea == a.ea && this.fa == a.fa
    }
    ;
    h.extend = function(a) {
        a.ba < this.ba && (this.ba = a.ba);
        a.ea > this.ea && (this.ea = a.ea);
        a.ca < this.ca && (this.ca = a.ca);
        a.fa > this.fa && (this.fa = a.fa)
    }
    ;
    h.Ga = function() {
        return [this.Sb(), this.fa - this.ca + 1]
    }
    ;
    h.Sb = function() {
        return this.ea - this.ba + 1
    }
    ;
    function Ha(a, b) {
        return a.ba <= b.ea && a.ea >= b.ba && a.ca <= b.fa && a.fa >= b.ca
    }
    h.Rs = function() {
        return [this.ca, this.ba, this.fa, this.ea]
    }
    ;
    function Ia(a, b, c) {
        return Math.min(Math.max(a, b), c)
    }
    var Ja = "cosh"in Math ? Math.cosh : function(a) {
        a = Math.exp(a);
        return (a + 1 / a) / 2
    }
    ;
    function Ka(a) {
        Fa(0 < a, 29);
        return Math.pow(2, Math.ceil(Math.log(a) / Math.LN2))
    }
    function La(a, b, c, d, e, f) {
        var g = e - c
          , k = f - d;
        if (0 !== g || 0 !== k) {
            var l = ((a - c) * g + (b - d) * k) / (g * g + k * k);
            1 < l ? (c = e,
            d = f) : 0 < l && (c += g * l,
            d += k * l)
        }
        return Ma(a, b, c, d)
    }
    function Ma(a, b, c, d) {
        a = c - a;
        b = d - b;
        return a * a + b * b
    }
    function Na(a) {
        return a * Math.PI / 180
    }
    function Oa(a, b) {
        a %= b;
        return 0 > a * b ? a + b : a
    }
    function Pa(a, b, c) {
        return a + c * (b - a)
    }
    ;function Qa(a, b, c) {
        void 0 === c && (c = [0, 0]);
        c[0] = a[0] + 2 * b;
        c[1] = a[1] + 2 * b;
        return c
    }
    function Ra(a, b, c) {
        void 0 === c && (c = [0, 0]);
        c[0] = a[0] * b + .5 | 0;
        c[1] = a[1] * b + .5 | 0;
        return c
    }
    function Sa(a, b) {
        if (Array.isArray(a))
            return a;
        void 0 === b ? b = [a, a] : b[0] = b[1] = a;
        return b
    }
    ;function Ta(a) {
        for (var b = Ua(), c = 0, d = a.length; c < d; ++c)
            Va(b, a[c]);
        return b
    }
    function Wa(a, b, c) {
        return c ? (c[0] = a[0] - b,
        c[1] = a[1] - b,
        c[2] = a[2] + b,
        c[3] = a[3] + b,
        c) : [a[0] - b, a[1] - b, a[2] + b, a[3] + b]
    }
    function Xa(a, b) {
        return b ? (b[0] = a[0],
        b[1] = a[1],
        b[2] = a[2],
        b[3] = a[3],
        b) : a.slice()
    }
    function Ya(a, b, c) {
        b = b < a[0] ? a[0] - b : a[2] < b ? b - a[2] : 0;
        a = c < a[1] ? a[1] - c : a[3] < c ? c - a[3] : 0;
        return b * b + a * a
    }
    function Za(a, b) {
        return $a(a, b[0], b[1])
    }
    function ab(a, b) {
        return a[0] <= b[0] && b[2] <= a[2] && a[1] <= b[1] && b[3] <= a[3]
    }
    function $a(a, b, c) {
        return a[0] <= b && b <= a[2] && a[1] <= c && c <= a[3]
    }
    function bb(a, b) {
        var c = a[1]
          , d = a[2]
          , e = a[3]
          , f = b[0];
        b = b[1];
        var g = 0;
        f < a[0] ? g |= 16 : f > d && (g |= 4);
        b < c ? g |= 8 : b > e && (g |= 2);
        0 === g && (g = 1);
        return g
    }
    function Ua() {
        return [Infinity, Infinity, -Infinity, -Infinity]
    }
    function cb(a, b, c, d, e) {
        return e ? (e[0] = a,
        e[1] = b,
        e[2] = c,
        e[3] = d,
        e) : [a, b, c, d]
    }
    function db(a) {
        return cb(Infinity, Infinity, -Infinity, -Infinity, a)
    }
    function eb(a, b) {
        var c = a[0];
        a = a[1];
        return cb(c, a, c, a, b)
    }
    function fb(a, b, c, d, e) {
        e = db(e);
        return gb(e, a, b, c, d)
    }
    function hb(a, b) {
        return a[0] == b[0] && a[2] == b[2] && a[1] == b[1] && a[3] == b[3]
    }
    function ib(a, b) {
        b[0] < a[0] && (a[0] = b[0]);
        b[2] > a[2] && (a[2] = b[2]);
        b[1] < a[1] && (a[1] = b[1]);
        b[3] > a[3] && (a[3] = b[3]);
        return a
    }
    function Va(a, b) {
        b[0] < a[0] && (a[0] = b[0]);
        b[0] > a[2] && (a[2] = b[0]);
        b[1] < a[1] && (a[1] = b[1]);
        b[1] > a[3] && (a[3] = b[1])
    }
    function gb(a, b, c, d, e) {
        for (; c < d; c += e) {
            var f = a
              , g = b[c]
              , k = b[c + 1];
            f[0] = Math.min(f[0], g);
            f[1] = Math.min(f[1], k);
            f[2] = Math.max(f[2], g);
            f[3] = Math.max(f[3], k)
        }
        return a
    }
    function jb(a, b, c) {
        var d;
        return (d = b.call(c, kb(a))) || (d = b.call(c, lb(a))) || (d = b.call(c, mb(a))) ? d : (d = b.call(c, nb(a))) ? d : !1
    }
    function ob(a) {
        var b = 0;
        pb(a) || (b = qb(a) * rb(a));
        return b
    }
    function kb(a) {
        return [a[0], a[1]]
    }
    function lb(a) {
        return [a[2], a[1]]
    }
    function sb(a) {
        return [(a[0] + a[2]) / 2, (a[1] + a[3]) / 2]
    }
    function tb(a, b, c, d, e) {
        var f = b * d[0] / 2;
        d = b * d[1] / 2;
        b = Math.cos(c);
        var g = Math.sin(c);
        c = f * b;
        f *= g;
        b *= d;
        var k = d * g
          , l = a[0]
          , m = a[1];
        a = l - c + k;
        d = l - c - k;
        g = l + c - k;
        c = l + c + k;
        k = m - f - b;
        l = m - f + b;
        var n = m + f + b;
        f = m + f - b;
        return cb(Math.min(a, d, g, c), Math.min(k, l, n, f), Math.max(a, d, g, c), Math.max(k, l, n, f), e)
    }
    function rb(a) {
        return a[3] - a[1]
    }
    function ub(a, b, c) {
        c = c ? c : Ua();
        vb(a, b) && (c[0] = a[0] > b[0] ? a[0] : b[0],
        c[1] = a[1] > b[1] ? a[1] : b[1],
        c[2] = a[2] < b[2] ? a[2] : b[2],
        c[3] = a[3] < b[3] ? a[3] : b[3]);
        return c
    }
    function nb(a) {
        return [a[0], a[3]]
    }
    function mb(a) {
        return [a[2], a[3]]
    }
    function qb(a) {
        return a[2] - a[0]
    }
    function vb(a, b) {
        return a[0] <= b[2] && a[2] >= b[0] && a[1] <= b[3] && a[3] >= b[1]
    }
    function pb(a) {
        return a[2] < a[0] || a[3] < a[1]
    }
    function wb(a, b) {
        var c = (a[2] - a[0]) / 2 * (b - 1);
        b = (a[3] - a[1]) / 2 * (b - 1);
        a[0] -= c;
        a[2] += c;
        a[1] -= b;
        a[3] += b
    }
    function xb(a, b, c) {
        a = [a[0], a[1], a[0], a[3], a[2], a[1], a[2], a[3]];
        b(a, a, 2);
        var d = [a[0], a[2], a[4], a[6]]
          , e = [a[1], a[3], a[5], a[7]];
        b = Math.min.apply(null, d);
        a = Math.min.apply(null, e);
        d = Math.max.apply(null, d);
        e = Math.max.apply(null, e);
        return cb(b, a, d, e, c)
    }
    ;var yb = "function" === typeof Object.assign ? Object.assign : function(a, b) {
        if (void 0 === a || null === a)
            throw new TypeError("Cannot convert undefined or null to object");
        for (var c = Object(a), d = 1, e = arguments.length; d < e; ++d) {
            var f = arguments[d];
            if (void 0 !== f && null !== f)
                for (var g in f)
                    f.hasOwnProperty(g) && (c[g] = f[g])
        }
        return c
    }
    ;
    function zb(a) {
        for (var b in a)
            delete a[b]
    }
    function Ab(a) {
        var b = [], c;
        for (c in a)
            b.push(a[c]);
        return b
    }
    function Bb(a) {
        for (var b in a)
            return !1;
        return !b
    }
    ;function Cb(a) {
        this.radius = a
    }
    Cb.prototype.Rw = function(a) {
        return Db(a, this.radius)
    }
    ;
    Cb.prototype.pp = function(a, b) {
        return Eb(a, b, this.radius)
    }
    ;
    Cb.prototype.offset = function(a, b, c) {
        var d = Na(a[1]);
        b /= this.radius;
        var e = Math.asin(Math.sin(d) * Math.cos(b) + Math.cos(d) * Math.sin(b) * Math.cos(c));
        return [180 * (Na(a[0]) + Math.atan2(Math.sin(c) * Math.sin(b) * Math.cos(d), Math.cos(b) - Math.sin(d) * Math.sin(e))) / Math.PI, 180 * e / Math.PI]
    }
    ;
    function Fb(a, b) {
        var c = b || {}
          , d = c.radius || 6371008.8;
        c = c.projection || "EPSG:3857";
        a = a.clone().transform(c, "EPSG:4326");
        var e = a.D();
        c = 0;
        var f;
        switch (e) {
        case "Point":
        case "MultiPoint":
            break;
        case "LineString":
        case "LinearRing":
            b = a.H();
            c = Gb(b, d);
            break;
        case "MultiLineString":
        case "Polygon":
            b = a.H();
            a = 0;
            for (e = b.length; a < e; ++a)
                c += Gb(b[a], d);
            break;
        case "MultiPolygon":
            b = a.H();
            a = 0;
            for (e = b.length; a < e; ++a) {
                var g = b[a];
                var k = 0;
                for (f = g.length; k < f; ++k)
                    c += Gb(g[k], d)
            }
            break;
        case "GeometryCollection":
            d = a.Rh();
            a = 0;
            for (e = d.length; a < e; ++a)
                c += Fb(d[a], b);
            break;
        default:
            throw Error("Unsupported geometry type: " + e);
        }
        return c
    }
    function Gb(a, b) {
        for (var c = 0, d = 0, e = a.length; d < e - 1; ++d)
            c += Eb(a[d], a[d + 1], b);
        return c
    }
    function Eb(a, b, c) {
        var d = Na(a[1])
          , e = Na(b[1])
          , f = (e - d) / 2;
        a = Na(b[0] - a[0]) / 2;
        d = Math.sin(f) * Math.sin(f) + Math.sin(a) * Math.sin(a) * Math.cos(d) * Math.cos(e);
        return 2 * c * Math.atan2(Math.sqrt(d), Math.sqrt(1 - d))
    }
    function Hb(a, b) {
        var c = b || {}
          , d = c.radius || 6371008.8;
        c = c.projection || "EPSG:3857";
        a = a.clone().transform(c, "EPSG:4326");
        var e = a.D();
        c = 0;
        var f;
        switch (e) {
        case "Point":
        case "MultiPoint":
        case "LineString":
        case "MultiLineString":
        case "LinearRing":
            break;
        case "Polygon":
            b = a.H();
            c = Math.abs(Db(b[0], d));
            a = 1;
            for (e = b.length; a < e; ++a)
                c -= Math.abs(Db(b[a], d));
            break;
        case "MultiPolygon":
            b = a.H();
            a = 0;
            for (e = b.length; a < e; ++a) {
                var g = b[a];
                c += Math.abs(Db(g[0], d));
                var k = 1;
                for (f = g.length; k < f; ++k)
                    c -= Math.abs(Db(g[k], d))
            }
            break;
        case "GeometryCollection":
            d = a.Rh();
            a = 0;
            for (e = d.length; a < e; ++a)
                c += Hb(d[a], b);
            break;
        default:
            throw Error("Unsupported geometry type: " + e);
        }
        return c
    }
    function Db(a, b) {
        for (var c = 0, d = a.length, e = a[d - 1][0], f = a[d - 1][1], g = 0; g < d; g++) {
            var k = a[g][0]
              , l = a[g][1];
            c += Na(k - e) * (2 + Math.sin(Na(f)) + Math.sin(Na(l)));
            e = k;
            f = l
        }
        return c * b * b / 2
    }
    ;var Ib = {};
    Ib.degrees = 12741994 * Math.PI / 360;
    Ib.ft = .3048;
    Ib.m = 1;
    Ib["us-ft"] = 1200 / 3937;
    var Kb = null;
    function Lb(a) {
        this.qc = a.code;
        this.Vq = a.units;
        this.V = void 0 !== a.extent ? a.extent : null;
        this.Yq = void 0 !== a.worldExtent ? a.worldExtent : null;
        this.be = void 0 !== a.axisOrientation ? a.axisOrientation : "enu";
        this.Pg = void 0 !== a.global ? a.global : !1;
        this.Bf = !(!this.Pg || !this.V);
        this.Ls = a.getPointResolution;
        this.bs = null;
        this.Om = a.metersPerUnit;
        var b = a.code
          , c = Kb || window.proj4;
        "function" == typeof c && (b = c.Bo(b),
        void 0 !== b && (void 0 !== b.axis && void 0 === a.axisOrientation && (this.be = b.axis),
        void 0 === a.metersPerUnit && (this.Om = b.tC),
        void 0 === a.units && (this.Vq = b.units)))
    }
    h = Lb.prototype;
    h.Zw = function() {
        return this.qc
    }
    ;
    h.c = function() {
        return this.V
    }
    ;
    h.pd = function() {
        return this.Vq
    }
    ;
    h.Mg = function() {
        return this.Om || Ib[this.Vq]
    }
    ;
    h.Ox = function() {
        return this.Yq
    }
    ;
    h.Oy = function() {
        return this.Pg
    }
    ;
    h.MA = function(a) {
        this.Pg = a;
        this.Bf = !(!a || !this.V)
    }
    ;
    h.Eb = function(a) {
        this.V = a;
        this.Bf = !(!this.Pg || !a)
    }
    ;
    h.YA = function(a) {
        this.Yq = a
    }
    ;
    h.LA = function(a) {
        this.Ls = a
    }
    ;
    function Mb(a) {
        Lb.call(this, {
            code: a,
            units: "m",
            extent: Nb,
            global: !0,
            worldExtent: Ob,
            getPointResolution: function(a, c) {
                return a / Ja(c[1] / 6378137)
            }
        })
    }
    v(Mb, Lb);
    var Qb = 6378137 * Math.PI
      , Nb = [-Qb, -Qb, Qb, Qb]
      , Ob = [-180, -85, 180, 85]
      , Rb = [new Mb("EPSG:3857"), new Mb("EPSG:102100"), new Mb("EPSG:102113"), new Mb("EPSG:900913"), new Mb("urn:ogc:def:crs:EPSG:6.18:3:3857"), new Mb("urn:ogc:def:crs:EPSG::3857"), new Mb("http://www.opengis.net/gml/srs/epsg.xml#3857")];
    function Sb(a, b, c) {
        var d = a.length;
        c = 1 < c ? c : 2;
        void 0 === b && (b = 2 < c ? a.slice() : Array(d));
        for (var e = 0; e < d; e += c) {
            b[e] = Qb * a[e] / 180;
            var f = 6378137 * Math.log(Math.tan(Math.PI * (a[e + 1] + 90) / 360));
            f > Qb ? f = Qb : f < -Qb && (f = -Qb);
            b[e + 1] = f
        }
        return b
    }
    function Tb(a, b, c) {
        var d = a.length;
        c = 1 < c ? c : 2;
        void 0 === b && (b = 2 < c ? a.slice() : Array(d));
        for (var e = 0; e < d; e += c)
            b[e] = 180 * a[e] / Qb,
            b[e + 1] = 360 * Math.atan(Math.exp(a[e + 1] / 6378137)) / Math.PI - 90;
        return b
    }
    ;function Ub(a, b) {
        Lb.call(this, {
            code: a,
            units: "degrees",
            extent: Vb,
            axisOrientation: b,
            global: !0,
            metersPerUnit: Wb,
            worldExtent: Vb
        })
    }
    v(Ub, Lb);
    var Vb = [-180, -90, 180, 90]
      , Wb = 6378137 * Math.PI / 180
      , Xb = [new Ub("CRS:84"), new Ub("EPSG:4326","neu"), new Ub("urn:ogc:def:crs:EPSG::4326","neu"), new Ub("urn:ogc:def:crs:EPSG:6.6:4326","neu"), new Ub("urn:ogc:def:crs:OGC:1.3:CRS84"), new Ub("urn:ogc:def:crs:OGC:2:84"), new Ub("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"), new Ub("urn:x-ogc:def:crs:EPSG:4326","neu")];
    var Yb = {};
    var $b = {};
    function ac(a, b, c) {
        a = a.qc;
        b = b.qc;
        a in $b || ($b[a] = {});
        $b[a][b] = c
    }
    function bc(a, b) {
        var c;
        a in $b && b in $b[a] && (c = $b[a][b]);
        return c
    }
    ;var cc = new Cb(6371008.8);
    function dc(a, b, c, d) {
        a = ec(a);
        var e = a.Ls;
        e ? b = e(b, c) : "degrees" == a.pd() && !d || "degrees" == d || (e = fc(a, ec("EPSG:4326")),
        b = [c[0] - b / 2, c[1], c[0] + b / 2, c[1], c[0], c[1] - b / 2, c[0], c[1] + b / 2],
        b = e(b, b, 2),
        b = (cc.pp(b.slice(0, 2), b.slice(2, 4)) + cc.pp(b.slice(4, 6), b.slice(6, 8))) / 2,
        a = d ? Ib[d] : a.Mg(),
        void 0 !== a && (b /= a));
        return b
    }
    function gc(a) {
        a.forEach(hc);
        a.forEach(function(b) {
            a.forEach(function(a) {
                b !== a && ac(b, a, ic)
            })
        })
    }
    function jc() {
        Xb.forEach(function(a) {
            Rb.forEach(function(b) {
                ac(a, b, Sb);
                ac(b, a, Tb)
            })
        })
    }
    function hc(a) {
        Yb[a.qc] = a;
        ac(a, a, ic)
    }
    function kc(a) {
        return a ? "string" === typeof a ? ec(a) : a : ec("EPSG:3857")
    }
    function lc(a, b, c, d) {
        a = ec(a);
        b = ec(b);
        ac(a, b, mc(c));
        ac(b, a, mc(d))
    }
    function mc(a) {
        return function(b, c, d) {
            var e = b.length;
            d = void 0 !== d ? d : 2;
            c = void 0 !== c ? c : Array(e);
            var f;
            for (f = 0; f < e; f += d) {
                var g = a([b[f], b[f + 1]]);
                c[f] = g[0];
                c[f + 1] = g[1];
                for (g = d - 1; 2 <= g; --g)
                    c[f + g] = b[f + g]
            }
            return c
        }
    }
    function ec(a) {
        var b = null;
        if (a instanceof Lb)
            b = a;
        else if ("string" === typeof a && (b = Yb[a] || null,
        !b)) {
            var c = Kb || window.proj4;
            "function" == typeof c && void 0 !== c.Bo(a) && (b = new Lb({
                code: a
            }),
            hc(b))
        }
        return b
    }
    function nc(a, b) {
        if (a === b)
            return !0;
        var c = a.pd() === b.pd();
        return a.qc === b.qc ? c : fc(a, b) === ic && c
    }
    function oc(a, b) {
        a = ec(a);
        b = ec(b);
        return fc(a, b)
    }
    function fc(a, b) {
        var c = a.qc
          , d = b.qc
          , e = bc(c, d);
        if (!e) {
            var f = Kb || window.proj4;
            if ("function" == typeof f) {
                var g = f.Bo(c)
                  , k = f.Bo(d);
                void 0 !== g && void 0 !== k && (g === k ? gc([b, a]) : (e = f(d, c),
                lc(b, a, e.forward, e.inverse)),
                e = bc(c, d))
            }
        }
        e || (e = pc);
        return e
    }
    function pc(a, b) {
        if (void 0 !== b && a !== b) {
            for (var c = 0, d = a.length; c < d; ++c)
                b[c] = a[c];
            a = b
        }
        return a
    }
    function ic(a, b) {
        if (void 0 !== b) {
            for (var c = 0, d = a.length; c < d; ++c)
                b[c] = a[c];
            a = b
        } else
            a = a.slice();
        return a
    }
    function qc(a, b, c) {
        return oc(b, c)(a, void 0, a.length)
    }
    function rc(a, b, c) {
        b = oc(b, c);
        return xb(a, b)
    }
    function sc() {
        gc(Rb);
        gc(Xb);
        jc()
    }
    sc();
    function tc(a, b, c, d) {
        return void 0 !== d ? (d[0] = a,
        d[1] = b,
        d[2] = c,
        d) : [a, b, c]
    }
    function uc(a) {
        var b = a[0], c = Array(b), d = 1 << b - 1, e;
        for (e = 0; e < b; ++e) {
            var f = 48;
            a[1] & d && (f += 1);
            a[2] & d && (f += 2);
            c[e] = String.fromCharCode(f);
            d >>= 1
        }
        return c.join("")
    }
    ;function vc(a) {
        this.minZoom = void 0 !== a.minZoom ? a.minZoom : 0;
        this.zb = a.resolutions;
        Fa(Aa(this.zb, function(a, b) {
            return b - a
        }), 17);
        this.maxZoom = this.zb.length - 1;
        this.Fc = void 0 !== a.origin ? a.origin : null;
        this.pi = null;
        void 0 !== a.origins && (this.pi = a.origins,
        Fa(this.pi.length == this.zb.length, 20));
        var b = a.extent;
        void 0 === b || this.Fc || this.pi || (this.Fc = nb(b));
        Fa(!this.Fc && this.pi || this.Fc && !this.pi, 18);
        this.Ji = null;
        void 0 !== a.tileSizes && (this.Ji = a.tileSizes,
        Fa(this.Ji.length == this.zb.length, 19));
        this.Ii = void 0 !== a.tileSize ? a.tileSize : this.Ji ? null : 256;
        Fa(!this.Ii && this.Ji || this.Ii && !this.Ji, 22);
        this.V = void 0 !== b ? b : null;
        this.Oh = null;
        this.Li = [0, 0];
        void 0 !== a.sizes ? this.Oh = a.sizes.map(function(a) {
            return new Ga(Math.min(0, a[0]),Math.max(a[0] - 1, -1),Math.min(0, a[1]),Math.max(a[1] - 1, -1))
        }, this) : b && wc(this, b)
    }
    var xc = [0, 0, 0];
    h = vc.prototype;
    h.Lo = function(a, b, c) {
        a = this.xc(a, b);
        for (var d = a.ba, e = a.ea; d <= e; ++d)
            for (var f = a.ca, g = a.fa; f <= g; ++f)
                c([b, d, f])
    }
    ;
    function Ac(a, b, c, d, e) {
        e = a.Oa(b, e);
        for (b = b[0] - 1; b >= a.minZoom; ) {
            if (c.call(null, b, a.xc(e, b, d)))
                return !0;
            --b
        }
        return !1
    }
    h.c = function() {
        return this.V
    }
    ;
    h.Ij = function() {
        return this.maxZoom
    }
    ;
    h.Ng = function() {
        return this.minZoom
    }
    ;
    h.ic = function(a) {
        return this.Fc ? this.Fc : this.pi[a]
    }
    ;
    h.O = function(a) {
        return this.zb[a]
    }
    ;
    h.Jd = function() {
        return this.zb
    }
    ;
    function Bc(a, b, c, d) {
        return b[0] < a.maxZoom ? (d = a.Oa(b, d),
        a.xc(d, b[0] + 1, c)) : null
    }
    h.Qj = function(a, b, c) {
        Cc(this, a[0], a[1], b, !1, xc);
        var d = xc[1]
          , e = xc[2];
        Cc(this, a[2], a[3], b, !0, xc);
        a = xc[1];
        b = xc[2];
        void 0 !== c ? (c.ba = d,
        c.ea = a,
        c.ca = e,
        c.fa = b) : c = new Ga(d,a,e,b);
        return c
    }
    ;
    h.xc = function(a, b, c) {
        b = this.O(b);
        return this.Qj(a, b, c)
    }
    ;
    h.Oj = function(a) {
        var b = this.ic(a[0])
          , c = this.O(a[0])
          , d = Sa(this.Zb(a[0]), this.Li);
        return [b[0] + (a[1] + .5) * d[0] * c, b[1] + (a[2] + .5) * d[1] * c]
    }
    ;
    h.Oa = function(a, b) {
        var c = this.ic(a[0])
          , d = this.O(a[0])
          , e = Sa(this.Zb(a[0]), this.Li)
          , f = c[0] + a[1] * e[0] * d;
        a = c[1] + a[2] * e[1] * d;
        return cb(f, a, f + e[0] * d, a + e[1] * d, b)
    }
    ;
    h.Xl = function(a, b, c) {
        return Cc(this, a[0], a[1], b, !1, c)
    }
    ;
    function Cc(a, b, c, d, e, f) {
        var g = a.Pf(d)
          , k = d / a.O(g)
          , l = a.ic(g);
        a = Sa(a.Zb(g), a.Li);
        b = k * Math.floor((b - l[0]) / d + (e ? .5 : 0)) / a[0];
        c = k * Math.floor((c - l[1]) / d + (e ? 0 : .5)) / a[1];
        e ? (b = Math.ceil(b) - 1,
        c = Math.ceil(c) - 1) : (b = Math.floor(b),
        c = Math.floor(c));
        return tc(g, b, c, f)
    }
    h.ip = function(a, b, c) {
        b = this.O(b);
        return Cc(this, a[0], a[1], b, !1, c)
    }
    ;
    h.Zb = function(a) {
        return this.Ii ? this.Ii : this.Ji[a]
    }
    ;
    h.Pf = function(a, b) {
        return Ia(sa(this.zb, a, b || 0), this.minZoom, this.maxZoom)
    }
    ;
    function wc(a, b) {
        for (var c = a.zb.length, d = Array(c), e = a.minZoom; e < c; ++e)
            d[e] = a.xc(b, e);
        a.Oh = d
    }
    ;function Dc(a) {
        var b = a.bs;
        b || (b = Ec(a),
        a.bs = b);
        return b
    }
    function Fc(a) {
        var b = {};
        yb(b, void 0 !== a ? a : {});
        void 0 === b.extent && (b.extent = ec("EPSG:3857").c());
        b.resolutions = Gc(b.extent, b.maxZoom, b.tileSize);
        delete b.maxZoom;
        return new vc(b)
    }
    function Gc(a, b, c) {
        b = void 0 !== b ? b : 42;
        var d = rb(a);
        a = qb(a);
        c = Sa(void 0 !== c ? c : 256);
        c = Math.max(a / c[0], d / c[1]);
        b += 1;
        d = Array(b);
        for (a = 0; a < b; ++a)
            d[a] = c / Math.pow(2, a);
        return d
    }
    function Ec(a, b, c) {
        a = Hc(a);
        b = Gc(a, b, c);
        return new vc({
            extent: a,
            origin: nb(a),
            resolutions: b,
            tileSize: c
        })
    }
    function Hc(a) {
        a = ec(a);
        var b = a.c();
        b || (a = 180 * Ib.degrees / a.Mg(),
        b = cb(-a, -a, a, a));
        return b
    }
    ;function Ic(a) {
        this.lm = a.html;
        this.Bn = a.An ? a.An : null
    }
    Ic.prototype.ix = function() {
        return this.lm
    }
    ;
    function Jc(a) {
        return function(b) {
            if (b)
                return [Ia(b[0], a[0], a[2]), Ia(b[1], a[1], a[3])]
        }
    }
    function Kc(a) {
        return a
    }
    ;function Lc(a) {
        function b(b) {
            var c = a.listener
              , e = a.Jr || a.target;
            a.Lr && Mc(a);
            return c.call(e, b)
        }
        return a.Kr = b
    }
    function Nc(a, b, c, d) {
        for (var e, f = 0, g = a.length; f < g; ++f)
            if (e = a[f],
            e.listener === b && e.Jr === c)
                return d && (e.deleteIndex = f),
                e
    }
    function Oc(a, b) {
        return (a = a.Qm) ? a[b] : void 0
    }
    function Pc(a) {
        var b = a.Qm;
        b || (b = a.Qm = {});
        return b
    }
    function Qc(a, b) {
        var c = Oc(a, b);
        if (c) {
            for (var d = 0, e = c.length; d < e; ++d)
                a.removeEventListener(b, c[d].Kr),
                zb(c[d]);
            c.length = 0;
            if (c = a.Qm)
                delete c[b],
                0 === Object.keys(c).length && delete a.Qm
        }
    }
    function y(a, b, c, d, e) {
        var f = Pc(a)
          , g = f[b];
        g || (g = f[b] = []);
        (f = Nc(g, c, d, !1)) ? e || (f.Lr = !1) : (f = {
            Jr: d,
            Lr: !!e,
            listener: c,
            target: a,
            type: b
        },
        a.addEventListener(b, Lc(f)),
        g.push(f));
        return f
    }
    function Rc(a, b, c, d) {
        return y(a, b, c, d, !0)
    }
    function Sc(a, b, c, d) {
        (a = Oc(a, b)) && (c = Nc(a, c, d, !0)) && Mc(c)
    }
    function Mc(a) {
        if (a && a.target) {
            a.target.removeEventListener(a.type, a.Kr);
            var b = Oc(a.target, a.type);
            if (b) {
                var c = "deleteIndex"in a ? a.deleteIndex : b.indexOf(a);
                -1 !== c && b.splice(c, 1);
                0 === b.length && Qc(a.target, a.type)
            }
            zb(a)
        }
    }
    function Tc(a) {
        var b = Pc(a), c;
        for (c in b)
            Qc(a, c)
    }
    ;function Uc() {}
    Uc.prototype.ds = !1;
    function Vc(a) {
        a.ds || (a.ds = !0,
        a.la())
    }
    Uc.prototype.la = Ba;
    function Wc(a) {
        this.type = a;
        this.target = null
    }
    Wc.prototype.preventDefault = Wc.prototype.stopPropagation = function() {
        this.Vz = !0
    }
    ;
    function Xc(a) {
        a.stopPropagation()
    }
    ;function Yc() {
        this.tk = {};
        this.Gh = {};
        this.$g = {}
    }
    v(Yc, Uc);
    h = Yc.prototype;
    h.addEventListener = function(a, b) {
        var c = this.$g[a];
        c || (c = this.$g[a] = []);
        -1 === c.indexOf(b) && c.push(b)
    }
    ;
    h.dispatchEvent = function(a) {
        var b = "string" === typeof a ? new Wc(a) : a;
        a = b.type;
        b.target = this;
        var c = this.$g[a];
        if (c) {
            a in this.Gh || (this.Gh[a] = 0,
            this.tk[a] = 0);
            ++this.Gh[a];
            for (var d = 0, e = c.length; d < e; ++d)
                if (!1 === c[d].call(this, b) || b.Vz) {
                    var f = !1;
                    break
                }
            --this.Gh[a];
            if (0 === this.Gh[a]) {
                b = this.tk[a];
                for (delete this.tk[a]; b--; )
                    this.removeEventListener(a, Ba);
                delete this.Gh[a]
            }
            return f
        }
    }
    ;
    h.la = function() {
        Tc(this)
    }
    ;
    h.hasListener = function(a) {
        return a ? a in this.$g : 0 < Object.keys(this.$g).length
    }
    ;
    h.removeEventListener = function(a, b) {
        var c = this.$g[a];
        c && (b = c.indexOf(b),
        a in this.tk ? (c[b] = Ba,
        ++this.tk[a]) : (c.splice(b, 1),
        0 === c.length && delete this.$g[a]))
    }
    ;
    function Zc() {
        Yc.call(this);
        this.Z = 0
    }
    v(Zc, Yc);
    h = Zc.prototype;
    h.a = function() {
        ++this.Z;
        this.dispatchEvent("change")
    }
    ;
    h.o = function() {
        return this.Z
    }
    ;
    h.g = function(a, b, c) {
        if (Array.isArray(a)) {
            for (var d = a.length, e = Array(d), f = 0; f < d; ++f)
                e[f] = y(this, a[f], b, c);
            return e
        }
        return y(this, a, b, c)
    }
    ;
    h.once = function(a, b, c) {
        if (Array.isArray(a)) {
            for (var d = a.length, e = Array(d), f = 0; f < d; ++f)
                e[f] = Rc(this, a[f], b, c);
            return e
        }
        return Rc(this, a, b, c)
    }
    ;
    h.j = function(a, b, c) {
        if (Array.isArray(a))
            for (var d = 0, e = a.length; d < e; ++d)
                Sc(this, a[d], b, c);
        else
            Sc(this, a, b, c)
    }
    ;
    function $c(a) {
        Zc.call(this);
        w(this);
        this.He = {};
        void 0 !== a && this.f(a)
    }
    v($c, Zc);
    var ad = {};
    function bd(a) {
        return ad.hasOwnProperty(a) ? ad[a] : ad[a] = "change:" + a
    }
    h = $c.prototype;
    h.get = function(a) {
        var b;
        this.He.hasOwnProperty(a) && (b = this.He[a]);
        return b
    }
    ;
    h.v = function() {
        return Object.keys(this.He)
    }
    ;
    h.l = function() {
        return yb({}, this.He)
    }
    ;
    function cd(a, b, c) {
        var d = bd(b);
        a.dispatchEvent(new dd(d,b,c));
        a.dispatchEvent(new dd("propertychange",b,c))
    }
    h.set = function(a, b, c) {
        c ? this.He[a] = b : (c = this.He[a],
        this.He[a] = b,
        c !== b && cd(this, a, c))
    }
    ;
    h.f = function(a, b) {
        for (var c in a)
            this.set(c, a[c], b)
    }
    ;
    h.A = function(a, b) {
        if (a in this.He) {
            var c = this.He[a];
            delete this.He[a];
            b || cd(this, a, c)
        }
    }
    ;
    function dd(a, b, c) {
        Wc.call(this, a);
        this.key = b;
        this.oldValue = c
    }
    v(dd, Wc);
    function C(a, b) {
        $c.call(this);
        this.Ln = !!(b || {}).unique;
        this.pc = a ? a : [];
        if (this.Ln)
            for (a = 0,
            b = this.pc.length; a < b; ++a)
                ed(this, this.pc[a], a);
        fd(this)
    }
    v(C, $c);
    h = C.prototype;
    h.clear = function() {
        for (; 0 < this.Wb(); )
            this.pop()
    }
    ;
    h.extend = function(a) {
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c)
            this.push(a[c]);
        return this
    }
    ;
    h.forEach = function(a, b) {
        a = b ? a.bind(b) : a;
        b = this.pc;
        for (var c = 0, d = b.length; c < d; ++c)
            a(b[c], c, b)
    }
    ;
    h.ie = function() {
        return this.pc
    }
    ;
    h.item = function(a) {
        return this.pc[a]
    }
    ;
    h.Wb = function() {
        return this.get(gd)
    }
    ;
    h.sm = function(a, b) {
        this.Ln && ed(this, b);
        this.pc.splice(a, 0, b);
        fd(this);
        this.dispatchEvent(new hd("add",b))
    }
    ;
    h.pop = function() {
        return this.gq(this.Wb() - 1)
    }
    ;
    h.push = function(a) {
        this.Ln && ed(this, a);
        var b = this.Wb();
        this.sm(b, a);
        return this.Wb()
    }
    ;
    h.remove = function(a) {
        var b = this.pc, c;
        var d = 0;
        for (c = b.length; d < c; ++d)
            if (b[d] === a)
                return this.gq(d)
    }
    ;
    h.gq = function(a) {
        var b = this.pc[a];
        this.pc.splice(a, 1);
        fd(this);
        this.dispatchEvent(new hd("remove",b));
        return b
    }
    ;
    h.IA = function(a, b) {
        var c = this.Wb();
        if (a < c)
            this.Ln && ed(this, b, a),
            c = this.pc[a],
            this.pc[a] = b,
            this.dispatchEvent(new hd("remove",c)),
            this.dispatchEvent(new hd("add",b));
        else {
            for (; c < a; ++c)
                this.sm(c, void 0);
            this.sm(a, b)
        }
    }
    ;
    function fd(a) {
        a.set(gd, a.pc.length)
    }
    function ed(a, b, c) {
        for (var d = 0, e = a.pc.length; d < e; ++d)
            if (a.pc[d] === b && d !== c)
                throw new Ea(58);
    }
    var gd = "length";
    function hd(a, b) {
        Wc.call(this, a);
        this.element = b
    }
    v(hd, Wc);
    var id = /^#(?:[0-9a-f]{3}){1,2}$/i
      , jd = /^([a-z]*)$/i;
    function kd(a) {
        return Array.isArray(a) ? a : ld(a)
    }
    function md(a) {
        if ("string" !== typeof a) {
            var b = a[0];
            b != (b | 0) && (b = b + .5 | 0);
            var c = a[1];
            c != (c | 0) && (c = c + .5 | 0);
            var d = a[2];
            d != (d | 0) && (d = d + .5 | 0);
            a = "rgba(" + b + "," + c + "," + d + "," + (void 0 === a[3] ? 1 : a[3]) + ")"
        }
        return a
    }
    var ld = function() {
        var a = {}
          , b = 0;
        return function(c) {
            if (a.hasOwnProperty(c))
                var d = a[c];
            else {
                if (1024 <= b) {
                    d = 0;
                    for (var e in a)
                        0 === (d++ & 3) && (delete a[e],
                        --b)
                }
                d = c;
                jd.exec(d) && (e = document.createElement("div"),
                e.style.color = d,
                document.body.appendChild(e),
                d = getComputedStyle(e).color,
                document.body.removeChild(e));
                if (id.exec(d)) {
                    var f = d.length - 1;
                    Fa(3 == f || 6 == f, 54);
                    var g = 3 == f ? 1 : 2;
                    f = parseInt(d.substr(1 + 0 * g, g), 16);
                    e = parseInt(d.substr(1 + 1 * g, g), 16);
                    d = parseInt(d.substr(1 + 2 * g, g), 16);
                    1 == g && (f = (f << 4) + f,
                    e = (e << 4) + e,
                    d = (d << 4) + d);
                    f = [f, e, d, 1]
                } else
                    0 == d.indexOf("rgba(") ? (d = d.slice(5, -1).split(",").map(Number),
                    f = nd(d)) : 0 == d.indexOf("rgb(") ? (d = d.slice(4, -1).split(",").map(Number),
                    d.push(1),
                    f = nd(d)) : Fa(!1, 14);
                d = f;
                a[c] = d;
                ++b
            }
            return d
        }
    }();
    function nd(a) {
        var b = [];
        b[0] = Ia(a[0] + .5 | 0, 0, 255);
        b[1] = Ia(a[1] + .5 | 0, 0, 255);
        b[2] = Ia(a[2] + .5 | 0, 0, 255);
        b[3] = Ia(a[3], 0, 1);
        return b
    }
    ;function od(a) {
        return "string" === typeof a || a instanceof CanvasPattern || a instanceof CanvasGradient ? a : md(a)
    }
    ;function pd(a, b) {
        var c = document.createElement("CANVAS");
        a && (c.width = a);
        b && (c.height = b);
        return c.getContext("2d")
    }
    function qd(a, b) {
        var c = b.parentNode;
        c && c.replaceChild(a, b)
    }
    function rd(a) {
        a && a.parentNode && a.parentNode.removeChild(a)
    }
    ;function sd(a) {
        $c.call(this);
        this.element = a.element ? a.element : null;
        this.ra = this.Hq = null;
        this.Yg = [];
        this.render = a.render ? a.render : Ba;
        a.target && this.ac(a.target)
    }
    v(sd, $c);
    sd.prototype.la = function() {
        rd(this.element);
        $c.prototype.la.call(this)
    }
    ;
    sd.prototype.B = function() {
        return this.ra
    }
    ;
    sd.prototype.setMap = function(a) {
        this.ra && rd(this.element);
        for (var b = 0, c = this.Yg.length; b < c; ++b)
            Mc(this.Yg[b]);
        this.Yg.length = 0;
        if (this.ra = a)
            (this.Hq ? this.Hq : a.qk).appendChild(this.element),
            this.render !== Ba && this.Yg.push(y(a, "postrender", this.render, this)),
            a.render()
    }
    ;
    sd.prototype.ac = function(a) {
        this.Hq = "string" === typeof a ? document.getElementById(a) : a
    }
    ;
    function td(a) {
        a = a ? a : {};
        this.Kn = document.createElement("UL");
        this.ck = document.createElement("LI");
        this.Kn.appendChild(this.ck);
        this.ck.style.display = "none";
        this.sb = void 0 !== a.collapsed ? a.collapsed : !0;
        this.Ob = void 0 !== a.collapsible ? a.collapsible : !0;
        this.Ob || (this.sb = !1);
        var b = void 0 !== a.className ? a.className : "ol-attribution"
          , c = void 0 !== a.tipLabel ? a.tipLabel : "Attributions"
          , d = void 0 !== a.collapseLabel ? a.collapseLabel : "\u00bb";
        "string" === typeof d ? (this.Fd = document.createElement("span"),
        this.Fd.textContent = d) : this.Fd = d;
        d = void 0 !== a.label ? a.label : "i";
        "string" === typeof d ? (this.nb = document.createElement("span"),
        this.nb.textContent = d) : this.nb = d;
        var e = this.Ob && !this.sb ? this.Fd : this.nb;
        d = document.createElement("button");
        d.setAttribute("type", "button");
        d.title = c;
        d.appendChild(e);
        y(d, "click", this.qd, this);
        c = document.createElement("div");
        c.className = b + " ol-unselectable ol-control" + (this.sb && this.Ob ? " ol-collapsed" : "") + (this.Ob ? "" : " ol-uncollapsible");
        c.appendChild(this.Kn);
        c.appendChild(d);
        sd.call(this, {
            element: c,
            render: a.render ? a.render : ud,
            target: a.target
        });
        this.xb = !0;
        this.zg = {};
        this.zf = {};
        this.Vy = {}
    }
    v(td, sd);
    h = td.prototype;
    h.getSourceAttributions = function(a) {
        var b, c, d, e, f, g = a.Od, k = yb({}, a.attributions), l = {}, m = {}, n = a.viewState.projection;
        var p = 0;
        for (b = g.length; p < b; p++)
            if (e = g[p].layer.Y()) {
                var q = w(e).toString();
                if (f = e.Nb) {
                    var t = 0;
                    for (c = f.length; t < c; t++) {
                        var u = f[t];
                        var x = w(u).toString();
                        if (!(x in k)) {
                            if (d = a.Qi[q]) {
                                var B = e.Cb(n);
                                a: {
                                    var z = void 0;
                                    var E, G = u, ea = B, V = n;
                                    if (G.Bn) {
                                        for (z in d)
                                            if (z in G.Bn) {
                                                B = d[z];
                                                var O = 0;
                                                for (E = G.Bn[z].length; O < E; ++O) {
                                                    var ca = G.Bn[z][O];
                                                    if (Ha(ca, B)) {
                                                        z = !0;
                                                        break a
                                                    }
                                                    var va = ea.xc(Hc(V), parseInt(z, 10))
                                                      , A = va.Sb();
                                                    if (B.ba < va.ba || B.ea > va.ea)
                                                        if (Ha(ca, new Ga(Oa(B.ba, A),Oa(B.ea, A),B.ca,B.fa)) || B.Sb() > A && Ha(ca, va)) {
                                                            z = !0;
                                                            break a
                                                        }
                                                }
                                            }
                                        z = !1
                                    } else
                                        z = !0
                                }
                            } else
                                z = !1;
                            z ? (x in l && delete l[x],
                            z = u.lm,
                            z in m || (m[z] = !0,
                            k[x] = u)) : l[x] = u
                        }
                    }
                }
            }
        return [k, l]
    }
    ;
    function ud(a) {
        this.On(a.frameState)
    }
    h.On = function(a) {
        if (a) {
            var b = this.getSourceAttributions(a)
              , c = b[0];
            b = b[1];
            for (g in this.zg)
                g in c ? (this.zf[g] || (this.zg[g].style.display = "",
                this.zf[g] = !0),
                delete c[g]) : g in b ? (this.zf[g] && (this.zg[g].style.display = "none",
                delete this.zf[g]),
                delete b[g]) : (rd(this.zg[g]),
                delete this.zg[g],
                delete this.zf[g]);
            for (g in c) {
                var d = document.createElement("LI");
                d.innerHTML = c[g].lm;
                this.Kn.appendChild(d);
                this.zg[g] = d;
                this.zf[g] = !0
            }
            for (g in b)
                d = document.createElement("LI"),
                d.innerHTML = b[g].lm,
                d.style.display = "none",
                this.Kn.appendChild(d),
                this.zg[g] = d;
            c = !Bb(this.zf) || !Bb(a.ah);
            this.xb != c && (this.element.style.display = c ? "" : "none",
            this.xb = c);
            c && Bb(this.zf) ? this.element.classList.add("ol-logo-only") : this.element.classList.remove("ol-logo-only");
            a = a.ah;
            c = this.Vy;
            for (f in c)
                f in a || (rd(c[f]),
                delete c[f]);
            for (var e in a)
                if (b = a[e],
                b instanceof HTMLElement && (this.ck.appendChild(b),
                c[e] = b),
                !(e in c)) {
                    var f = new Image;
                    f.src = e;
                    if ("" === b)
                        var g = f;
                    else
                        g = document.createElement("a"),
                        g.href = b,
                        g.appendChild(f);
                    this.ck.appendChild(g);
                    c[e] = g
                }
            this.ck.style.display = Bb(a) ? "none" : ""
        } else
            this.xb && (this.element.style.display = "none",
            this.xb = !1)
    }
    ;
    h.qd = function(a) {
        a.preventDefault();
        this.Sg()
    }
    ;
    h.Sg = function() {
        this.element.classList.toggle("ol-collapsed");
        this.sb ? qd(this.Fd, this.nb) : qd(this.nb, this.Fd);
        this.sb = !this.sb
    }
    ;
    h.Qo = function() {
        return this.Ob
    }
    ;
    h.uq = function(a) {
        this.Ob !== a && (this.Ob = a,
        this.element.classList.toggle("ol-uncollapsible"),
        !a && this.sb && this.Sg())
    }
    ;
    h.tq = function(a) {
        this.Ob && this.sb !== a && this.Sg()
    }
    ;
    h.Po = function() {
        return this.sb
    }
    ;
    function vd(a) {
        return Math.pow(a, 3)
    }
    function wd(a) {
        return 1 - vd(1 - a)
    }
    function xd(a) {
        return 3 * a * a - 2 * a * a * a
    }
    function yd(a) {
        return a
    }
    ;function zd(a) {
        a = a ? a : {};
        var b = void 0 !== a.className ? a.className : "ol-rotate"
          , c = void 0 !== a.label ? a.label : "\u21e7";
        this.nb = null;
        "string" === typeof c ? (this.nb = document.createElement("span"),
        this.nb.className = "ol-compass",
        this.nb.textContent = c) : (this.nb = c,
        this.nb.classList.add("ol-compass"));
        var d = a.tipLabel ? a.tipLabel : "Reset rotation";
        c = document.createElement("button");
        c.className = b + "-reset";
        c.setAttribute("type", "button");
        c.title = d;
        c.appendChild(this.nb);
        y(c, "click", zd.prototype.qd, this);
        d = document.createElement("div");
        d.className = b + " ol-unselectable ol-control";
        d.appendChild(c);
        b = a.render ? a.render : Ad;
        this.Mr = a.resetNorth ? a.resetNorth : void 0;
        sd.call(this, {
            element: d,
            render: b,
            target: a.target
        });
        this.Ha = void 0 !== a.duration ? a.duration : 250;
        this.Hr = void 0 !== a.autoHide ? a.autoHide : !0;
        this.Za = void 0;
        this.Hr && this.element.classList.add("ol-hidden")
    }
    v(zd, sd);
    zd.prototype.qd = function(a) {
        a.preventDefault();
        void 0 !== this.Mr ? this.Mr() : (a = this.B().R()) && void 0 !== a.ma() && (0 < this.Ha ? a.rb({
            rotation: 0,
            duration: this.Ha,
            easing: wd
        }) : a.Wd(0))
    }
    ;
    function Ad(a) {
        if (a = a.frameState) {
            a = a.viewState.rotation;
            if (a != this.Za) {
                var b = "rotate(" + a + "rad)";
                if (this.Hr) {
                    var c = this.element.classList.contains("ol-hidden");
                    c || 0 !== a ? c && 0 !== a && this.element.classList.remove("ol-hidden") : this.element.classList.add("ol-hidden")
                }
                this.nb.style.msTransform = b;
                this.nb.style.webkitTransform = b;
                this.nb.style.transform = b
            }
            this.Za = a
        }
    }
    ;function Bd(a) {
        a = a ? a : {};
        var b = void 0 !== a.className ? a.className : "ol-zoom"
          , c = void 0 !== a.delta ? a.delta : 1
          , d = void 0 !== a.zoomInLabel ? a.zoomInLabel : "+"
          , e = void 0 !== a.zoomOutLabel ? a.zoomOutLabel : "\u2212"
          , f = void 0 !== a.zoomInTipLabel ? a.zoomInTipLabel : "Zoom in"
          , g = void 0 !== a.zoomOutTipLabel ? a.zoomOutTipLabel : "Zoom out"
          , k = document.createElement("button");
        k.className = b + "-in";
        k.setAttribute("type", "button");
        k.title = f;
        k.appendChild("string" === typeof d ? document.createTextNode(d) : d);
        y(k, "click", Bd.prototype.qd.bind(this, c));
        d = document.createElement("button");
        d.className = b + "-out";
        d.setAttribute("type", "button");
        d.title = g;
        d.appendChild("string" === typeof e ? document.createTextNode(e) : e);
        y(d, "click", Bd.prototype.qd.bind(this, -c));
        c = document.createElement("div");
        c.className = b + " ol-unselectable ol-control";
        c.appendChild(k);
        c.appendChild(d);
        sd.call(this, {
            element: c,
            target: a.target
        });
        this.Ha = void 0 !== a.duration ? a.duration : 250
    }
    v(Bd, sd);
    Bd.prototype.qd = function(a, b) {
        b.preventDefault();
        if (b = this.B().R()) {
            var c = b.O();
            c && (a = b.constrainResolution(c, a),
            0 < this.Ha ? (b.Ig() && b.Bh(),
            b.rb({
                resolution: a,
                duration: this.Ha,
                easing: wd
            })) : b.nh(a))
        }
    }
    ;
    function Cd(a) {
        a = a ? a : {};
        var b = new C;
        (void 0 !== a.zoom ? a.zoom : 1) && b.push(new Bd(a.zoomOptions));
        (void 0 !== a.rotate ? a.rotate : 1) && b.push(new zd(a.rotateOptions));
        (void 0 !== a.attribution ? a.attribution : 1) && b.push(new td(a.attributionOptions));
        return b
    }
    ;function Dd(a) {
        a = a ? a : {};
        this.Dl = void 0 !== a.className ? a.className : "ol-full-screen";
        var b = void 0 !== a.label ? a.label : "\u2922";
        this.Ap = "string" === typeof b ? document.createTextNode(b) : b;
        b = void 0 !== a.labelActive ? a.labelActive : "\u00d7";
        this.ht = "string" === typeof b ? document.createTextNode(b) : b;
        var c = a.tipLabel ? a.tipLabel : "Toggle full-screen";
        b = document.createElement("button");
        b.className = this.Dl + "-" + Ed();
        b.setAttribute("type", "button");
        b.title = c;
        b.appendChild(this.Ap);
        y(b, "click", this.qd, this);
        c = document.createElement("div");
        c.className = this.Dl + " ol-unselectable ol-control " + (Fd() ? "" : "ol-unsupported");
        c.appendChild(b);
        sd.call(this, {
            element: c,
            target: a.target
        });
        this.gi = void 0 !== a.keys ? a.keys : !1;
        this.da = a.source
    }
    v(Dd, sd);
    Dd.prototype.qd = function(a) {
        a.preventDefault();
        Fd() && (a = this.B()) && (Ed() ? document.exitFullscreen ? document.exitFullscreen() : document.msExitFullscreen ? document.msExitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.webkitExitFullscreen && document.webkitExitFullscreen() : (a = this.da ? "string" === typeof this.da ? document.getElementById(this.da) : this.da : a.Yh(),
        this.gi ? a.mozRequestFullScreenWithKeys ? a.mozRequestFullScreenWithKeys() : a.webkitRequestFullscreen ? a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT) : Gd(a) : Gd(a)))
    }
    ;
    Dd.prototype.Yx = function() {
        var a = this.element.firstElementChild
          , b = this.B();
        Ed() ? (a.className = this.Dl + "-true",
        qd(this.ht, this.Ap)) : (a.className = this.Dl + "-false",
        qd(this.Ap, this.ht));
        b && b.Pi()
    }
    ;
    Dd.prototype.setMap = function(a) {
        sd.prototype.setMap.call(this, a);
        a && this.Yg.push(y(document, Hd(), this.Yx, this))
    }
    ;
    function Fd() {
        var a = document.body;
        return !!(a.webkitRequestFullscreen || a.mozRequestFullScreen && document.mozFullScreenEnabled || a.msRequestFullscreen && document.msFullscreenEnabled || a.requestFullscreen && document.fullscreenEnabled)
    }
    function Ed() {
        return !!(document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement)
    }
    function Gd(a) {
        a.requestFullscreen ? a.requestFullscreen() : a.msRequestFullscreen ? a.msRequestFullscreen() : a.mozRequestFullScreen ? a.mozRequestFullScreen() : a.webkitRequestFullscreen && a.webkitRequestFullscreen()
    }
    var Hd = function() {
        var a;
        return function() {
            if (!a) {
                var b = document.body;
                b.webkitRequestFullscreen ? a = "webkitfullscreenchange" : b.mozRequestFullScreen ? a = "mozfullscreenchange" : b.msRequestFullscreen ? a = "MSFullscreenChange" : b.requestFullscreen && (a = "fullscreenchange")
            }
            return a
        }
    }();
    function Id(a) {
        a = a ? a : {};
        var b = document.createElement("DIV");
        b.className = void 0 !== a.className ? a.className : "ol-mouse-position";
        sd.call(this, {
            element: b,
            render: a.render ? a.render : Jd,
            target: a.target
        });
        y(this, bd(Kd), this.kp, this);
        a.coordinateFormat && this.ru(a.coordinateFormat);
        a.projection && this.lf(a.projection);
        this.AB = void 0 !== a.undefinedHTML ? a.undefinedHTML : "";
        this.zi = b.innerHTML;
        this.wm = this.qb = this.ek = null
    }
    v(Id, sd);
    function Jd(a) {
        a = a.frameState;
        a ? this.ek != a.viewState.projection && (this.ek = a.viewState.projection,
        this.qb = null) : this.ek = null;
        Ld(this, this.wm)
    }
    h = Id.prototype;
    h.kp = function() {
        this.qb = null
    }
    ;
    h.Ds = function() {
        return this.get(Md)
    }
    ;
    h.M = function() {
        return this.get(Kd)
    }
    ;
    h.ky = function(a) {
        this.wm = this.B().Sl(a);
        Ld(this, this.wm)
    }
    ;
    h.ly = function() {
        Ld(this, null);
        this.wm = null
    }
    ;
    h.setMap = function(a) {
        sd.prototype.setMap.call(this, a);
        a && (a = a.Sa,
        this.Yg.push(y(a, "mousemove", this.ky, this), y(a, "mouseout", this.ly, this)))
    }
    ;
    h.ru = function(a) {
        this.set(Md, a)
    }
    ;
    h.lf = function(a) {
        this.set(Kd, ec(a))
    }
    ;
    function Ld(a, b) {
        var c = a.AB;
        if (b && a.ek) {
            if (!a.qb) {
                var d = a.M();
                a.qb = d ? fc(a.ek, d) : pc
            }
            if (b = a.B().Jb(b))
                a.qb(b, b),
                c = (c = a.Ds()) ? c(b) : b.toString()
        }
        a.zi && c == a.zi || (a.element.innerHTML = c,
        a.zi = c)
    }
    var Kd = "projection"
      , Md = "coordinateFormat";
    function Nd(a, b, c) {
        Wc.call(this, a);
        this.map = b;
        this.frameState = void 0 !== c ? c : null
    }
    v(Nd, Wc);
    function Od(a, b, c, d, e) {
        Nd.call(this, a, b, e);
        this.originalEvent = c;
        this.pixel = b.Sl(c);
        this.coordinate = b.Jb(this.pixel);
        this.dragging = void 0 !== d ? d : !1
    }
    v(Od, Nd);
    Od.prototype.preventDefault = function() {
        Nd.prototype.preventDefault.call(this);
        this.originalEvent.preventDefault()
    }
    ;
    Od.prototype.stopPropagation = function() {
        Nd.prototype.stopPropagation.call(this);
        this.originalEvent.stopPropagation()
    }
    ;
    var Pd = ["experimental-webgl", "webgl", "webkit-3d", "moz-webgl"];
    function Qd(a, b) {
        var c, d, e = Pd.length;
        for (d = 0; d < e; ++d)
            try {
                if (c = a.getContext(Pd[d], b))
                    return c
            } catch (f) {}
        return null
    }
    ;var Rd, Sd = "undefined" !== typeof navigator ? navigator.userAgent.toLowerCase() : "", Td = -1 !== Sd.indexOf("firefox"), Ud = -1 !== Sd.indexOf("safari") && -1 == Sd.indexOf("chrom"), Vd = -1 !== Sd.indexOf("webkit") && -1 == Sd.indexOf("edge"), Wd = -1 !== Sd.indexOf("macintosh"), Xd = window.devicePixelRatio || 1, Yd = !1, Zd = function() {
        if (!("HTMLCanvasElement"in window))
            return !1;
        try {
            var a = document.createElement("CANVAS").getContext("2d");
            return a ? (void 0 !== a.setLineDash && (Yd = !0),
            !0) : !1
        } catch (b) {
            return !1
        }
    }(), $d = "DeviceOrientationEvent"in window, ae = "geolocation"in navigator, be = "ontouchstart"in window, ee = "PointerEvent"in window, fe = !!navigator.msPointerEnabled, ge = !1, he, ie = [];
    if ("WebGLRenderingContext"in window)
        try {
            var je = Qd(document.createElement("CANVAS"), {
                failIfMajorPerformanceCaveat: !0
            });
            je && (ge = !0,
            he = je.getParameter(je.MAX_TEXTURE_SIZE),
            ie = je.getSupportedExtensions())
        } catch (a) {}
    Rd = ge;
    pa = ie;
    oa = he;
    var ke = {
        bC: "singleclick",
        RB: "click",
        SB: "dblclick",
        VB: "pointerdrag",
        YB: "pointermove",
        UB: "pointerdown",
        aC: "pointerup",
        $B: "pointerover",
        ZB: "pointerout",
        WB: "pointerenter",
        XB: "pointerleave",
        TB: "pointercancel"
    };
    function le(a, b, c, d, e) {
        Od.call(this, a, b, c.originalEvent, d, e);
        this.Vm = c
    }
    v(le, Od);
    function me(a, b) {
        this.qa = a;
        this.Jm = b
    }
    ;function ne(a) {
        me.call(this, a, {
            mousedown: this.ez,
            mousemove: this.fz,
            mouseup: this.iz,
            mouseover: this.hz,
            mouseout: this.gz
        });
        this.hb = a.hb;
        this.jt = []
    }
    v(ne, me);
    function oe(a, b) {
        a = a.jt;
        var c = b.clientX;
        b = b.clientY;
        for (var d = 0, e = a.length, f; d < e && (f = a[d]); d++) {
            var g = Math.abs(b - f[1]);
            if (25 >= Math.abs(c - f[0]) && 25 >= g)
                return !0
        }
        return !1
    }
    function pe(a) {
        var b = qe(a, a)
          , c = b.preventDefault;
        b.preventDefault = function() {
            a.preventDefault();
            c()
        }
        ;
        b.pointerId = 1;
        b.isPrimary = !0;
        b.pointerType = "mouse";
        return b
    }
    h = ne.prototype;
    h.ez = function(a) {
        if (!oe(this, a)) {
            (1).toString()in this.hb && this.cancel(a);
            var b = pe(a);
            this.hb[(1).toString()] = a;
            this.qa.fireEvent("pointerdown", b, a)
        }
    }
    ;
    h.fz = function(a) {
        if (!oe(this, a)) {
            var b = pe(a);
            this.qa.move(b, a)
        }
    }
    ;
    h.iz = function(a) {
        if (!oe(this, a)) {
            var b = this.hb[(1).toString()];
            b && b.button === a.button && (b = pe(a),
            this.qa.fireEvent("pointerup", b, a),
            delete this.hb[(1).toString()])
        }
    }
    ;
    h.hz = function(a) {
        if (!oe(this, a)) {
            var b = pe(a);
            re(this.qa, b, a)
        }
    }
    ;
    h.gz = function(a) {
        if (!oe(this, a)) {
            var b = pe(a);
            se(this.qa, b, a)
        }
    }
    ;
    h.cancel = function(a) {
        var b = pe(a);
        this.qa.cancel(b, a);
        delete this.hb[(1).toString()]
    }
    ;
    function te(a) {
        me.call(this, a, {
            MSPointerDown: this.nz,
            MSPointerMove: this.oz,
            MSPointerUp: this.rz,
            MSPointerOut: this.pz,
            MSPointerOver: this.qz,
            MSPointerCancel: this.mz,
            MSGotPointerCapture: this.kz,
            MSLostPointerCapture: this.lz
        });
        this.hb = a.hb;
        this.Dv = ["", "unavailable", "touch", "pen", "mouse"]
    }
    v(te, me);
    function ue(a, b) {
        var c = b;
        "number" === typeof b.pointerType && (c = qe(b, b),
        c.pointerType = a.Dv[b.pointerType]);
        return c
    }
    h = te.prototype;
    h.nz = function(a) {
        this.hb[a.pointerId.toString()] = a;
        var b = ue(this, a);
        this.qa.fireEvent("pointerdown", b, a)
    }
    ;
    h.oz = function(a) {
        var b = ue(this, a);
        this.qa.move(b, a)
    }
    ;
    h.rz = function(a) {
        var b = ue(this, a);
        this.qa.fireEvent("pointerup", b, a);
        delete this.hb[a.pointerId.toString()]
    }
    ;
    h.pz = function(a) {
        var b = ue(this, a);
        se(this.qa, b, a)
    }
    ;
    h.qz = function(a) {
        var b = ue(this, a);
        re(this.qa, b, a)
    }
    ;
    h.mz = function(a) {
        var b = ue(this, a);
        this.qa.cancel(b, a);
        delete this.hb[a.pointerId.toString()]
    }
    ;
    h.lz = function(a) {
        this.qa.dispatchEvent(new ve("lostpointercapture",a,a))
    }
    ;
    h.kz = function(a) {
        this.qa.dispatchEvent(new ve("gotpointercapture",a,a))
    }
    ;
    function we(a) {
        me.call(this, a, {
            pointerdown: this.Mz,
            pointermove: this.Nz,
            pointerup: this.Qz,
            pointerout: this.Oz,
            pointerover: this.Pz,
            pointercancel: this.Lz,
            gotpointercapture: this.Px,
            lostpointercapture: this.Zy
        })
    }
    v(we, me);
    h = we.prototype;
    h.Mz = function(a) {
        xe(this.qa, a)
    }
    ;
    h.Nz = function(a) {
        xe(this.qa, a)
    }
    ;
    h.Qz = function(a) {
        xe(this.qa, a)
    }
    ;
    h.Oz = function(a) {
        xe(this.qa, a)
    }
    ;
    h.Pz = function(a) {
        xe(this.qa, a)
    }
    ;
    h.Lz = function(a) {
        xe(this.qa, a)
    }
    ;
    h.Zy = function(a) {
        xe(this.qa, a)
    }
    ;
    h.Px = function(a) {
        xe(this.qa, a)
    }
    ;
    function ve(a, b, c) {
        Wc.call(this, a);
        this.originalEvent = b;
        a = c ? c : {};
        this.buttons = ye(a);
        this.pressure = a.pressure ? a.pressure : this.buttons ? .5 : 0;
        this.bubbles = "bubbles"in a ? a.bubbles : !1;
        this.cancelable = "cancelable"in a ? a.cancelable : !1;
        this.view = "view"in a ? a.view : null;
        this.detail = "detail"in a ? a.detail : null;
        this.screenX = "screenX"in a ? a.screenX : 0;
        this.screenY = "screenY"in a ? a.screenY : 0;
        this.clientX = "clientX"in a ? a.clientX : 0;
        this.clientY = "clientY"in a ? a.clientY : 0;
        this.ctrlKey = "ctrlKey"in a ? a.ctrlKey : !1;
        this.altKey = "altKey"in a ? a.altKey : !1;
        this.shiftKey = "shiftKey"in a ? a.shiftKey : !1;
        this.metaKey = "metaKey"in a ? a.metaKey : !1;
        this.button = "button"in a ? a.button : 0;
        this.relatedTarget = "relatedTarget"in a ? a.relatedTarget : null;
        this.pointerId = "pointerId"in a ? a.pointerId : 0;
        this.width = "width"in a ? a.width : 0;
        this.height = "height"in a ? a.height : 0;
        this.tiltX = "tiltX"in a ? a.tiltX : 0;
        this.tiltY = "tiltY"in a ? a.tiltY : 0;
        this.pointerType = "pointerType"in a ? a.pointerType : "";
        this.hwTimestamp = "hwTimestamp"in a ? a.hwTimestamp : 0;
        this.isPrimary = "isPrimary"in a ? a.isPrimary : !1;
        b.preventDefault && (this.preventDefault = function() {
            b.preventDefault()
        }
        )
    }
    v(ve, Wc);
    function ye(a) {
        if (a.buttons || ze)
            a = a.buttons;
        else
            switch (a.which) {
            case 1:
                a = 1;
                break;
            case 2:
                a = 4;
                break;
            case 3:
                a = 2;
                break;
            default:
                a = 0
            }
        return a
    }
    var ze = !1;
    try {
        ze = 1 === (new MouseEvent("click",{
            buttons: 1
        })).buttons
    } catch (a) {}
    ;function Ae(a, b) {
        me.call(this, a, {
            touchstart: this.tB,
            touchmove: this.sB,
            touchend: this.rB,
            touchcancel: this.qB
        });
        this.hb = a.hb;
        this.dz = b;
        this.vj = void 0;
        this.ro = 0;
        this.Dk = void 0
    }
    v(Ae, me);
    h = Ae.prototype;
    h.nu = function() {
        this.ro = 0;
        this.Dk = void 0
    }
    ;
    function Be(a, b, c) {
        b = qe(b, c);
        b.pointerId = c.identifier + 2;
        b.bubbles = !0;
        b.cancelable = !0;
        b.detail = a.ro;
        b.button = 0;
        b.buttons = 1;
        b.width = c.webkitRadiusX || c.radiusX || 0;
        b.height = c.webkitRadiusY || c.radiusY || 0;
        b.pressure = c.webkitForce || c.force || .5;
        b.isPrimary = a.vj === c.identifier;
        b.pointerType = "touch";
        b.clientX = c.clientX;
        b.clientY = c.clientY;
        b.screenX = c.screenX;
        b.screenY = c.screenY;
        return b
    }
    function Ce(a, b, c) {
        function d() {
            b.preventDefault()
        }
        var e = Array.prototype.slice.call(b.changedTouches), f = e.length, g;
        for (g = 0; g < f; ++g) {
            var k = Be(a, b, e[g]);
            k.preventDefault = d;
            c.call(a, b, k)
        }
    }
    h.tB = function(a) {
        var b = a.touches
          , c = Object.keys(this.hb)
          , d = c.length;
        if (d >= b.length) {
            var e = [], f;
            for (f = 0; f < d; ++f) {
                var g = c[f];
                var k = this.hb[g];
                var l;
                if (!(l = 1 == g))
                    a: {
                        for (var m = b.length, n = 0; n < m; n++)
                            if (l = b[n],
                            l.identifier === g - 2) {
                                l = !0;
                                break a
                            }
                        l = !1
                    }
                l || e.push(k.out)
            }
            for (f = 0; f < e.length; ++f)
                this.qo(a, e[f])
        }
        b = a.changedTouches[0];
        c = Object.keys(this.hb).length;
        if (0 === c || 1 === c && (1).toString()in this.hb)
            this.vj = b.identifier,
            void 0 !== this.Dk && clearTimeout(this.Dk);
        De(this, a);
        this.ro++;
        Ce(this, a, this.Ez)
    }
    ;
    h.Ez = function(a, b) {
        this.hb[b.pointerId] = {
            target: b.target,
            out: b,
            Pt: b.target
        };
        var c = this.qa;
        b.bubbles = !0;
        c.fireEvent("pointerover", b, a);
        c = this.qa;
        b.bubbles = !1;
        c.fireEvent("pointerenter", b, a);
        this.qa.fireEvent("pointerdown", b, a)
    }
    ;
    h.sB = function(a) {
        a.preventDefault();
        Ce(this, a, this.jz)
    }
    ;
    h.jz = function(a, b) {
        var c = this.hb[b.pointerId];
        if (c) {
            var d = c.out
              , e = c.Pt;
            this.qa.move(b, a);
            d && e !== b.target && (d.relatedTarget = b.target,
            b.relatedTarget = e,
            d.target = e,
            b.target ? (se(this.qa, d, a),
            re(this.qa, b, a)) : (b.target = e,
            b.relatedTarget = null,
            this.qo(a, b)));
            c.out = b;
            c.Pt = b.target
        }
    }
    ;
    h.rB = function(a) {
        De(this, a);
        Ce(this, a, this.BB)
    }
    ;
    h.BB = function(a, b) {
        this.qa.fireEvent("pointerup", b, a);
        this.qa.out(b, a);
        Ee(this.qa, b, a);
        delete this.hb[b.pointerId];
        b.isPrimary && (this.vj = void 0,
        this.Dk = setTimeout(this.nu.bind(this), 200))
    }
    ;
    h.qB = function(a) {
        Ce(this, a, this.qo)
    }
    ;
    h.qo = function(a, b) {
        this.qa.cancel(b, a);
        this.qa.out(b, a);
        Ee(this.qa, b, a);
        delete this.hb[b.pointerId];
        b.isPrimary && (this.vj = void 0,
        this.Dk = setTimeout(this.nu.bind(this), 200))
    }
    ;
    function De(a, b) {
        var c = a.dz.jt;
        b = b.changedTouches[0];
        if (a.vj === b.identifier) {
            var d = [b.clientX, b.clientY];
            c.push(d);
            setTimeout(function() {
                var a = c.indexOf(d);
                -1 < a && c.splice(a, 1)
            }, 2500)
        }
    }
    ;function Fe(a) {
        Yc.call(this);
        this.Ba = a;
        this.hb = {};
        this.ls = {};
        this.rj = [];
        ee ? Ge(this, new we(this)) : fe ? Ge(this, new te(this)) : (a = new ne(this),
        Ge(this, a),
        be && Ge(this, new Ae(this,a)));
        a = this.rj.length;
        for (var b, c = 0; c < a; c++)
            b = this.rj[c],
            He(this, Object.keys(b.Jm))
    }
    v(Fe, Yc);
    function Ge(a, b) {
        var c = Object.keys(b.Jm);
        c && (c.forEach(function(a) {
            var c = b.Jm[a];
            c && (this.ls[a] = c.bind(b))
        }, a),
        a.rj.push(b))
    }
    h = Fe.prototype;
    h.ks = function(a) {
        var b = this.ls[a.type];
        b && b(a)
    }
    ;
    function He(a, b) {
        b.forEach(function(a) {
            y(this.Ba, a, this.ks, this)
        }, a)
    }
    function Ie(a, b) {
        b.forEach(function(a) {
            Sc(this.Ba, a, this.ks, this)
        }, a)
    }
    function qe(a, b) {
        for (var c = {}, d, e = 0, f = Je.length; e < f; e++)
            d = Je[e][0],
            c[d] = a[d] || b[d] || Je[e][1];
        return c
    }
    h.move = function(a, b) {
        this.fireEvent("pointermove", a, b)
    }
    ;
    function Ee(a, b, c) {
        b.bubbles = !1;
        a.fireEvent("pointerleave", b, c)
    }
    h.out = function(a, b) {
        a.bubbles = !0;
        this.fireEvent("pointerout", a, b)
    }
    ;
    h.cancel = function(a, b) {
        this.fireEvent("pointercancel", a, b)
    }
    ;
    function se(a, b, c) {
        a.out(b, c);
        var d = b.target
          , e = b.relatedTarget;
        d && e && d.contains(e) || Ee(a, b, c)
    }
    function re(a, b, c) {
        b.bubbles = !0;
        a.fireEvent("pointerover", b, c);
        var d = b.target
          , e = b.relatedTarget;
        d && e && d.contains(e) || (b.bubbles = !1,
        a.fireEvent("pointerenter", b, c))
    }
    h.fireEvent = function(a, b, c) {
        this.dispatchEvent(new ve(a,c,b))
    }
    ;
    function xe(a, b) {
        a.dispatchEvent(new ve(b.type,b,b))
    }
    h.la = function() {
        for (var a = this.rj.length, b, c = 0; c < a; c++)
            b = this.rj[c],
            Ie(this, Object.keys(b.Jm));
        Yc.prototype.la.call(this)
    }
    ;
    var Je = [["bubbles", !1], ["cancelable", !1], ["view", null], ["detail", null], ["screenX", 0], ["screenY", 0], ["clientX", 0], ["clientY", 0], ["ctrlKey", !1], ["altKey", !1], ["shiftKey", !1], ["metaKey", !1], ["button", 0], ["relatedTarget", null], ["buttons", 0], ["pointerId", 0], ["width", 0], ["height", 0], ["pressure", 0], ["tiltX", 0], ["tiltY", 0], ["pointerType", ""], ["hwTimestamp", 0], ["isPrimary", !1], ["type", ""], ["target", null], ["currentTarget", null], ["which", 0]];
    function Ke(a, b) {
        Yc.call(this);
        this.ra = a;
        this.bj = 0;
        this.Pe = !1;
        this.Ih = [];
        this.Ht = b ? b * Xd : Xd;
        this.Hh = null;
        a = this.ra.Sa;
        this.Ar = 0;
        this.Pq = {};
        this.ui = new Fe(a);
        this.Ef = null;
        this.Np = y(this.ui, "pointerdown", this.oy, this);
        this.fq = y(this.ui, "pointermove", this.rA, this)
    }
    v(Ke, Yc);
    function Le(a, b) {
        var c = new le("click",a.ra,b);
        a.dispatchEvent(c);
        0 !== a.bj ? (clearTimeout(a.bj),
        a.bj = 0,
        c = new le("dblclick",a.ra,b),
        a.dispatchEvent(c)) : a.bj = setTimeout(function() {
            this.bj = 0;
            var a = new le("singleclick",this.ra,b);
            this.dispatchEvent(a)
        }
        .bind(a), 250)
    }
    function Me(a, b) {
        "pointerup" == b.type || "pointercancel" == b.type ? delete a.Pq[b.pointerId] : "pointerdown" == b.type && (a.Pq[b.pointerId] = !0);
        a.Ar = Object.keys(a.Pq).length
    }
    h = Ke.prototype;
    h.Us = function(a) {
        Me(this, a);
        var b = new le("pointerup",this.ra,a);
        this.dispatchEvent(b);
        !this.Pe && 0 === a.button && Le(this, this.Hh);
        0 === this.Ar && (this.Ih.forEach(Mc),
        this.Ih.length = 0,
        this.Pe = !1,
        this.Hh = null,
        Vc(this.Ef),
        this.Ef = null)
    }
    ;
    h.oy = function(a) {
        Me(this, a);
        var b = new le("pointerdown",this.ra,a);
        this.dispatchEvent(b);
        this.Hh = a;
        0 === this.Ih.length && (this.Ef = new Fe(document),
        this.Ih.push(y(this.Ef, "pointermove", this.Qf, this), y(this.Ef, "pointerup", this.Us, this), y(this.ui, "pointercancel", this.Us, this)))
    }
    ;
    h.Qf = function(a) {
        if (Ne(this, a)) {
            this.Pe = !0;
            var b = new le("pointerdrag",this.ra,a,this.Pe);
            this.dispatchEvent(b)
        }
        a.preventDefault()
    }
    ;
    h.rA = function(a) {
        this.dispatchEvent(new le(a.type,this.ra,a,!(!this.Hh || !Ne(this, a))))
    }
    ;
    function Ne(a, b) {
        return Math.abs(b.clientX - a.Hh.clientX) > a.Ht || Math.abs(b.clientY - a.Hh.clientY) > a.Ht
    }
    h.la = function() {
        this.fq && (Mc(this.fq),
        this.fq = null);
        this.Np && (Mc(this.Np),
        this.Np = null);
        this.Ih.forEach(Mc);
        this.Ih.length = 0;
        this.Ef && (Vc(this.Ef),
        this.Ef = null);
        this.ui && (Vc(this.ui),
        this.ui = null);
        Yc.prototype.la.call(this)
    }
    ;
    function Oe(a, b) {
        this.Ut = a;
        this.um = b;
        this.ge = [];
        this.vi = [];
        this.xi = {}
    }
    h = Oe.prototype;
    h.clear = function() {
        this.ge.length = 0;
        this.vi.length = 0;
        zb(this.xi)
    }
    ;
    function Pe(a) {
        var b = a.ge
          , c = a.vi
          , d = b[0];
        1 == b.length ? (b.length = 0,
        c.length = 0) : (b[0] = b.pop(),
        c[0] = c.pop(),
        Qe(a, 0));
        b = a.um(d);
        delete a.xi[b];
        return d
    }
    h.enqueue = function(a) {
        Fa(!(this.um(a)in this.xi), 31);
        var b = this.Ut(a);
        return Infinity != b ? (this.ge.push(a),
        this.vi.push(b),
        this.xi[this.um(a)] = !0,
        Re(this, 0, this.ge.length - 1),
        !0) : !1
    }
    ;
    h.Bj = function() {
        return this.ge.length
    }
    ;
    h.Nd = function() {
        return 0 === this.ge.length
    }
    ;
    h.zp = function(a) {
        return a in this.xi
    }
    ;
    function Qe(a, b) {
        for (var c = a.ge, d = a.vi, e = c.length, f = c[b], g = d[b], k = b; b < e >> 1; ) {
            var l = 2 * b + 1
              , m = 2 * b + 2;
            l = m < e && d[m] < d[l] ? m : l;
            c[b] = c[l];
            d[b] = d[l];
            b = l
        }
        c[b] = f;
        d[b] = g;
        Re(a, k, b)
    }
    function Re(a, b, c) {
        var d = a.ge;
        a = a.vi;
        for (var e = d[c], f = a[c]; c > b; ) {
            var g = c - 1 >> 1;
            if (a[g] > f)
                d[c] = d[g],
                a[c] = a[g],
                c = g;
            else
                break
        }
        d[c] = e;
        a[c] = f
    }
    function Se(a) {
        var b = a.Ut, c = a.ge, d = a.vi, e = 0, f = c.length, g;
        for (g = 0; g < f; ++g) {
            var k = c[g];
            var l = b(k);
            Infinity == l ? delete a.xi[a.um(k)] : (d[e] = l,
            c[e++] = k)
        }
        c.length = e;
        d.length = e;
        for (b = (a.ge.length >> 1) - 1; 0 <= b; b--)
            Qe(a, b)
    }
    ;function Te(a, b) {
        Oe.call(this, function(b) {
            return a.apply(null, b)
        }, function(a) {
            return a[0].getKey()
        });
        this.Su = b;
        this.Dn = 0;
        this.Cn = {}
    }
    v(Te, Oe);
    Te.prototype.enqueue = function(a) {
        var b = Oe.prototype.enqueue.call(this, a);
        b && y(a[0], "change", this.Uj, this);
        return b
    }
    ;
    Te.prototype.Uj = function(a) {
        a = a.target;
        var b = a.getState();
        if (2 === b || 3 === b || 4 === b || 5 === b)
            Sc(a, "change", this.Uj, this),
            a = a.getKey(),
            a in this.Cn && (delete this.Cn[a],
            --this.Dn),
            this.Su()
    }
    ;
    Te.prototype.Ep = function(a, b) {
        for (var c = 0, d = !1, e, f, g; this.Dn < a && c < b && 0 < this.Bj(); )
            f = Pe(this)[0],
            g = f.getKey(),
            e = f.getState(),
            5 === e ? d = !0 : 0 !== e || g in this.Cn || (this.Cn[g] = !0,
            ++this.Dn,
            ++c,
            f.load());
        0 === c && d && this.Su()
    }
    ;
    function Ue(a) {
        return function(b, c, d) {
            if (void 0 !== b)
                return b = sa(a, b, d),
                b = Ia(b + c, 0, a.length - 1),
                c = Math.floor(b),
                b != c && c < a.length - 1 ? a[c] / Math.pow(a[c] / a[c + 1], b - c) : a[c]
        }
    }
    function Ve(a, b, c) {
        return function(d, e, f) {
            if (void 0 !== d)
                return d = Math.max(Math.floor(Math.log(b / d) / Math.log(a) + (-f / 2 + .5)) + e, 0),
                void 0 !== c && (d = Math.min(d, c)),
                b / Math.pow(a, d)
        }
    }
    ;function We(a) {
        if (void 0 !== a)
            return 0
    }
    function Xe(a, b) {
        if (void 0 !== a)
            return a + b
    }
    function Ye(a) {
        var b = 2 * Math.PI / a;
        return function(a, d) {
            if (void 0 !== a)
                return a = Math.floor((a + d) / b + .5) * b
        }
    }
    function Ze() {
        var a = Na(5);
        return function(b, c) {
            if (void 0 !== b)
                return Math.abs(b + c) <= a ? 0 : b + c
        }
    }
    ;function $e(a, b) {
        a = void 0 !== b ? a.toFixed(b) : "" + a;
        b = a.indexOf(".");
        b = -1 === b ? a.length : b;
        return 2 < b ? a : Array(3 - b).join("0") + a
    }
    ;function af(a, b) {
        a[0] += b[0];
        a[1] += b[1];
        return a
    }
    function bf(a, b) {
        var c = b.wc()
          , d = b.Fa();
        b = d[0];
        d = d[1];
        var e = a[0] - b;
        a = a[1] - d;
        0 === e && 0 === a && (e = 1);
        var f = Math.sqrt(e * e + a * a);
        return [b + c * e / f, d + c * a / f]
    }
    function cf(a, b) {
        var c = a[0];
        a = a[1];
        var d = b[0]
          , e = b[1];
        b = d[0];
        d = d[1];
        var f = e[0];
        e = e[1];
        var g = f - b
          , k = e - d;
        c = 0 === g && 0 === k ? 0 : (g * (c - b) + k * (a - d)) / (g * g + k * k || 0);
        0 >= c ? (a = b,
        c = d) : 1 <= c ? (a = f,
        c = e) : (a = b + c * g,
        c = d + c * k);
        return [a, c]
    }
    function df(a, b, c) {
        b = Oa(b + 180, 360) - 180;
        var d = Math.abs(3600 * b);
        c = c || 0;
        var e = Math.pow(10, c)
          , f = Math.floor(d / 3600)
          , g = Math.floor((d - 3600 * f) / 60);
        d = Math.ceil((d - 3600 * f - 60 * g) * e) / e;
        60 <= d && (d = 0,
        g += 1);
        60 <= g && (g = 0,
        f += 1);
        return f + "\u00b0 " + $e(g) + "\u2032 " + $e(d, c) + "\u2033" + (0 == b ? "" : " " + a.charAt(0 > b ? 1 : 0))
    }
    function ef(a, b, c) {
        return a ? b.replace("{x}", a[0].toFixed(c)).replace("{y}", a[1].toFixed(c)) : ""
    }
    function ff(a, b) {
        for (var c = !0, d = a.length - 1; 0 <= d; --d)
            if (a[d] != b[d]) {
                c = !1;
                break
            }
        return c
    }
    function gf(a, b) {
        var c = Math.cos(b);
        b = Math.sin(b);
        var d = a[1] * c + a[0] * b;
        a[0] = a[0] * c - a[1] * b;
        a[1] = d;
        return a
    }
    function hf(a, b) {
        a[0] *= b;
        a[1] *= b
    }
    function kf(a, b) {
        var c = a[0] - b[0];
        a = a[1] - b[1];
        return c * c + a * a
    }
    function lf(a, b) {
        return Math.sqrt(kf(a, b))
    }
    function mf(a, b) {
        return kf(a, cf(a, b))
    }
    function nf(a, b) {
        return ef(a, "{x}, {y}", b)
    }
    ;function of() {
        return !0
    }
    function pf() {
        return !1
    }
    ;function qf() {
        $c.call(this);
        this.V = Ua();
        this.os = -1;
        this.ig = {};
        this.rn = this.jg = 0
    }
    v(qf, $c);
    h = qf.prototype;
    h.od = function(a, b) {
        b = b ? b : [NaN, NaN];
        this.Ed(a[0], a[1], b, Infinity);
        return b
    }
    ;
    h.Xc = function(a) {
        return this.de(a[0], a[1])
    }
    ;
    h.de = pf;
    h.c = function(a) {
        this.os != this.Z && (this.V = this.Bl(this.V),
        this.os = this.Z);
        var b = this.V;
        a ? (a[0] = b[0],
        a[1] = b[1],
        a[2] = b[2],
        a[3] = b[3]) : a = b;
        return a
    }
    ;
    h.Zd = function(a) {
        return this.Kj(a * a)
    }
    ;
    h.transform = function(a, b) {
        this.xg(oc(a, b));
        return this
    }
    ;
    function rf(a, b, c, d, e, f) {
        for (var g = f ? f : [], k = 0; b < c; b += d) {
            var l = a[b]
              , m = a[b + 1];
            g[k++] = e[0] * l + e[2] * m + e[4];
            g[k++] = e[1] * l + e[3] * m + e[5]
        }
        f && g.length != k && (g.length = k);
        return g
    }
    function sf(a, b, c, d, e, f, g) {
        for (var k = g ? g : [], l = 0, m; b < c; b += d)
            for (k[l++] = a[b] + e,
            k[l++] = a[b + 1] + f,
            m = b + 2; m < b + d; ++m)
                k[l++] = a[m];
        g && k.length != l && (k.length = l);
        return k
    }
    ;function tf() {
        qf.call(this);
        this.ha = "XY";
        this.C = 2;
        this.b = null
    }
    v(tf, qf);
    function uf(a) {
        var b;
        "XY" == a ? b = 2 : "XYZ" == a || "XYM" == a ? b = 3 : "XYZM" == a && (b = 4);
        return b
    }
    h = tf.prototype;
    h.de = pf;
    h.Bl = function(a) {
        return fb(this.b, 0, this.b.length, this.C, a)
    }
    ;
    h.Re = function() {
        return this.b.slice(0, this.C)
    }
    ;
    h.X = function() {
        return this.b
    }
    ;
    h.Se = function() {
        return this.b.slice(this.b.length - this.C)
    }
    ;
    h.Ue = function() {
        return this.ha
    }
    ;
    h.Kj = function(a) {
        this.rn != this.Z && (zb(this.ig),
        this.jg = 0,
        this.rn = this.Z);
        if (0 > a || 0 !== this.jg && a <= this.jg)
            return this;
        var b = a.toString();
        if (this.ig.hasOwnProperty(b))
            return this.ig[b];
        var c = this.Wh(a);
        if (c.X().length < this.b.length)
            return this.ig[b] = c;
        this.jg = a;
        return this
    }
    ;
    h.Wh = function() {
        return this
    }
    ;
    h.oa = function() {
        return this.C
    }
    ;
    function vf(a, b, c) {
        a.C = uf(b);
        a.ha = b;
        a.b = c
    }
    function wf(a, b, c, d) {
        if (b)
            c = uf(b);
        else {
            for (b = 0; b < d; ++b) {
                if (0 === c.length) {
                    a.ha = "XY";
                    a.C = 2;
                    return
                }
                c = c[0]
            }
            c = c.length;
            var e;
            2 == c ? e = "XY" : 3 == c ? e = "XYZ" : 4 == c && (e = "XYZM");
            b = e
        }
        a.ha = b;
        a.C = c
    }
    h.xg = function(a) {
        this.b && (a(this.b, this.b, this.C),
        this.a())
    }
    ;
    h.rotate = function(a, b) {
        var c = this.X();
        if (c) {
            var d = c.length
              , e = this.oa()
              , f = c ? c : []
              , g = Math.cos(a);
            a = Math.sin(a);
            var k = b[0];
            b = b[1];
            for (var l = 0, m = 0; m < d; m += e) {
                var n = c[m] - k
                  , p = c[m + 1] - b;
                f[l++] = k + n * g - p * a;
                f[l++] = b + n * a + p * g;
                for (n = m + 2; n < m + e; ++n)
                    f[l++] = c[n]
            }
            c && f.length != l && (f.length = l);
            this.a()
        }
    }
    ;
    h.scale = function(a, b, c) {
        var d = b;
        void 0 === d && (d = a);
        var e = c;
        e || (e = sb(this.c()));
        if (c = this.X()) {
            b = c.length;
            var f = this.oa()
              , g = c ? c : []
              , k = e[0];
            e = e[1];
            for (var l = 0, m = 0; m < b; m += f) {
                var n = c[m] - k
                  , p = c[m + 1] - e;
                g[l++] = k + a * n;
                g[l++] = e + d * p;
                for (n = m + 2; n < m + f; ++n)
                    g[l++] = c[n]
            }
            c && g.length != l && (g.length = l);
            this.a()
        }
    }
    ;
    h.translate = function(a, b) {
        var c = this.X();
        c && (sf(c, 0, c.length, this.oa(), a, b, c),
        this.a())
    }
    ;
    function xf(a, b, c, d) {
        for (var e = 0, f = a[c - d], g = a[c - d + 1]; b < c; b += d) {
            var k = a[b]
              , l = a[b + 1];
            e += g * k - f * l;
            f = k;
            g = l
        }
        return e / 2
    }
    function yf(a, b, c, d) {
        var e = 0, f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var k = c[g];
            e += xf(a, b, k, d);
            b = k
        }
        return e
    }
    ;function zf(a, b, c, d, e, f, g) {
        var k = a[b]
          , l = a[b + 1]
          , m = a[c] - k
          , n = a[c + 1] - l;
        if (0 !== m || 0 !== n)
            if (f = ((e - k) * m + (f - l) * n) / (m * m + n * n),
            1 < f)
                b = c;
            else if (0 < f) {
                for (e = 0; e < d; ++e)
                    g[e] = Pa(a[b + e], a[c + e], f);
                g.length = d;
                return
            }
        for (e = 0; e < d; ++e)
            g[e] = a[b + e];
        g.length = d
    }
    function Af(a, b, c, d, e) {
        var f = a[b]
          , g = a[b + 1];
        for (b += d; b < c; b += d) {
            var k = a[b]
              , l = a[b + 1];
            f = Ma(f, g, k, l);
            f > e && (e = f);
            f = k;
            g = l
        }
        return e
    }
    function Bf(a, b, c, d, e) {
        var f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var k = c[g];
            e = Af(a, b, k, d, e);
            b = k
        }
        return e
    }
    function Cf(a, b, c, d, e, f, g, k, l, m, n) {
        if (b == c)
            return m;
        if (0 === e) {
            var p = Ma(g, k, a[b], a[b + 1]);
            if (p < m) {
                for (n = 0; n < d; ++n)
                    l[n] = a[b + n];
                l.length = d;
                return p
            }
            return m
        }
        for (var q = n ? n : [NaN, NaN], t = b + d; t < c; )
            if (zf(a, t - d, t, d, g, k, q),
            p = Ma(g, k, q[0], q[1]),
            p < m) {
                m = p;
                for (n = 0; n < d; ++n)
                    l[n] = q[n];
                l.length = d;
                t += d
            } else
                t += d * Math.max((Math.sqrt(p) - Math.sqrt(m)) / e | 0, 1);
        if (f && (zf(a, c - d, b, d, g, k, q),
        p = Ma(g, k, q[0], q[1]),
        p < m)) {
            m = p;
            for (n = 0; n < d; ++n)
                l[n] = q[n];
            l.length = d
        }
        return m
    }
    function Df(a, b, c, d, e, f, g, k, l, m, n) {
        n = n ? n : [NaN, NaN];
        var p;
        var q = 0;
        for (p = c.length; q < p; ++q) {
            var t = c[q];
            m = Cf(a, b, t, d, e, f, g, k, l, m, n);
            b = t
        }
        return m
    }
    ;function Ef(a, b) {
        var c = 0, d;
        var e = 0;
        for (d = b.length; e < d; ++e)
            a[c++] = b[e];
        return c
    }
    function Ff(a, b, c, d) {
        var e;
        var f = 0;
        for (e = c.length; f < e; ++f) {
            var g = c[f], k;
            for (k = 0; k < d; ++k)
                a[b++] = g[k]
        }
        return b
    }
    function Gf(a, b, c, d, e) {
        e = e ? e : [];
        var f = 0, g;
        var k = 0;
        for (g = c.length; k < g; ++k)
            b = Ff(a, b, c[k], d),
            e[f++] = b;
        e.length = f;
        return e
    }
    ;function Hf(a, b, c, d, e) {
        e = void 0 !== e ? e : [];
        for (var f = 0; b < c; b += d)
            e[f++] = a.slice(b, b + d);
        e.length = f;
        return e
    }
    function If(a, b, c, d, e) {
        e = void 0 !== e ? e : [];
        var f = 0, g;
        var k = 0;
        for (g = c.length; k < g; ++k) {
            var l = c[k];
            e[f++] = Hf(a, b, l, d, e[f]);
            b = l
        }
        e.length = f;
        return e
    }
    function Kf(a, b, c, d, e) {
        e = void 0 !== e ? e : [];
        var f = 0, g;
        var k = 0;
        for (g = c.length; k < g; ++k) {
            var l = c[k];
            e[f++] = If(a, b, l, d, e[f]);
            b = l[l.length - 1]
        }
        e.length = f;
        return e
    }
    ;function Lf(a, b, c, d, e, f, g) {
        var k = (c - b) / d;
        if (3 > k) {
            for (; b < c; b += d)
                f[g++] = a[b],
                f[g++] = a[b + 1];
            return g
        }
        var l = Array(k);
        l[0] = 1;
        l[k - 1] = 1;
        c = [b, c - d];
        for (var m = 0, n; 0 < c.length; ) {
            var p = c.pop()
              , q = c.pop()
              , t = 0
              , u = a[q]
              , x = a[q + 1]
              , B = a[p]
              , z = a[p + 1];
            for (n = q + d; n < p; n += d) {
                var E = La(a[n], a[n + 1], u, x, B, z);
                E > t && (m = n,
                t = E)
            }
            t > e && (l[(m - b) / d] = 1,
            q + d < m && c.push(q, m),
            m + d < p && c.push(m, p))
        }
        for (n = 0; n < k; ++n)
            l[n] && (f[g++] = a[b + n * d],
            f[g++] = a[b + n * d + 1]);
        return g
    }
    function Mf(a, b, c, d, e, f, g, k) {
        var l;
        var m = 0;
        for (l = c.length; m < l; ++m) {
            var n = c[m];
            a: {
                var p = a
                  , q = n
                  , t = d
                  , u = e
                  , x = f
                  , B = g;
                if (b != q) {
                    var z = u * Math.round(p[b] / u)
                      , E = u * Math.round(p[b + 1] / u);
                    b += t;
                    x[B++] = z;
                    x[B++] = E;
                    do {
                        var G = u * Math.round(p[b] / u);
                        g = u * Math.round(p[b + 1] / u);
                        b += t;
                        if (b == q) {
                            x[B++] = G;
                            x[B++] = g;
                            g = B;
                            break a
                        }
                    } while (G == z && g == E);for (; b < q; ) {
                        var ea = u * Math.round(p[b] / u);
                        var V = u * Math.round(p[b + 1] / u);
                        b += t;
                        if (ea != G || V != g) {
                            var O = G - z
                              , ca = g - E
                              , va = ea - z
                              , A = V - E;
                            O * A == ca * va && (0 > O && va < O || O == va || 0 < O && va > O) && (0 > ca && A < ca || ca == A || 0 < ca && A > ca) || (x[B++] = G,
                            x[B++] = g,
                            z = G,
                            E = g);
                            G = ea;
                            g = V
                        }
                    }
                    x[B++] = G;
                    x[B++] = g
                }
                g = B
            }
            k.push(g);
            b = n
        }
        return g
    }
    ;function Nf(a, b) {
        tf.call(this);
        this.Cc = this.Dc = -1;
        this.pa(a, b)
    }
    v(Nf, tf);
    h = Nf.prototype;
    h.clone = function() {
        var a = new Nf(null);
        a.K(this.ha, this.b.slice());
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        if (d < Ya(this.c(), a, b))
            return d;
        this.Cc != this.Z && (this.Dc = Math.sqrt(Af(this.b, 0, this.b.length, this.C, 0)),
        this.Cc = this.Z);
        return Cf(this.b, 0, this.b.length, this.C, this.Dc, !0, a, b, c, d)
    }
    ;
    h.yj = function() {
        return xf(this.b, 0, this.b.length, this.C)
    }
    ;
    h.H = function() {
        return Hf(this.b, 0, this.b.length, this.C)
    }
    ;
    h.Wh = function(a) {
        var b = [];
        b.length = Lf(this.b, 0, this.b.length, this.C, a, b, 0);
        a = new Nf(null);
        a.K("XY", b);
        return a
    }
    ;
    h.D = function() {
        return "LinearRing"
    }
    ;
    h.Kb = function() {}
    ;
    h.pa = function(a, b) {
        a ? (wf(this, b, a, 1),
        this.b || (this.b = []),
        this.b.length = Ff(this.b, 0, a, this.C),
        this.a()) : this.K("XY", null)
    }
    ;
    h.K = function(a, b) {
        vf(this, a, b);
        this.a()
    }
    ;
    function D(a, b) {
        tf.call(this);
        this.pa(a, b)
    }
    v(D, tf);
    h = D.prototype;
    h.clone = function() {
        var a = new D(null);
        a.K(this.ha, this.b.slice());
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        var e = this.b;
        a = Ma(a, b, e[0], e[1]);
        if (a < d) {
            d = this.C;
            for (b = 0; b < d; ++b)
                c[b] = e[b];
            c.length = d;
            return a
        }
        return d
    }
    ;
    h.H = function() {
        return this.b ? this.b.slice() : []
    }
    ;
    h.Bl = function(a) {
        return eb(this.b, a)
    }
    ;
    h.D = function() {
        return "Point"
    }
    ;
    h.Kb = function(a) {
        return $a(a, this.b[0], this.b[1])
    }
    ;
    h.pa = function(a, b) {
        a ? (wf(this, b, a, 0),
        this.b || (this.b = []),
        this.b.length = Ef(this.b, a),
        this.a()) : this.K("XY", null)
    }
    ;
    h.K = function(a, b) {
        vf(this, a, b);
        this.a()
    }
    ;
    function Of(a, b, c, d, e) {
        return !jb(e, function(e) {
            return !Pf(a, b, c, d, e[0], e[1])
        })
    }
    function Pf(a, b, c, d, e, f) {
        for (var g = 0, k = a[c - d], l = a[c - d + 1]; b < c; b += d) {
            var m = a[b]
              , n = a[b + 1];
            l <= f ? n > f && 0 < (m - k) * (f - l) - (e - k) * (n - l) && g++ : n <= f && 0 > (m - k) * (f - l) - (e - k) * (n - l) && g--;
            k = m;
            l = n
        }
        return 0 !== g
    }
    function Qf(a, b, c, d, e, f) {
        if (0 === c.length || !Pf(a, b, c[0], d, e, f))
            return !1;
        var g;
        b = 1;
        for (g = c.length; b < g; ++b)
            if (Pf(a, c[b - 1], c[b], d, e, f))
                return !1;
        return !0
    }
    ;function Rf(a, b, c, d, e, f, g) {
        var k, l = e[f + 1], m = [], n = c[0];
        var p = a[n - d];
        var q = a[n - d + 1];
        for (k = b; k < n; k += d) {
            var t = a[k];
            var u = a[k + 1];
            if (l <= q && u <= l || q <= l && l <= u)
                p = (l - q) / (u - q) * (t - p) + p,
                m.push(p);
            p = t;
            q = u
        }
        n = NaN;
        q = -Infinity;
        m.sort(qa);
        p = m[0];
        k = 1;
        for (u = m.length; k < u; ++k) {
            t = m[k];
            var x = Math.abs(t - p);
            x > q && (p = (p + t) / 2,
            Qf(a, b, c, d, p, l) && (n = p,
            q = x));
            p = t
        }
        isNaN(n) && (n = e[f]);
        return g ? (g.push(n, l),
        g) : [n, l]
    }
    ;function Sf(a, b, c, d, e, f) {
        for (var g = [a[b], a[b + 1]], k = [], l; b + d < c; b += d) {
            k[0] = a[b + d];
            k[1] = a[b + d + 1];
            if (l = e.call(f, g, k))
                return l;
            g[0] = k[0];
            g[1] = k[1]
        }
        return !1
    }
    ;function Tf(a, b, c, d, e) {
        var f = gb(Ua(), a, b, c, d);
        return vb(e, f) ? ab(e, f) || f[0] >= e[0] && f[2] <= e[2] || f[1] >= e[1] && f[3] <= e[3] ? !0 : Sf(a, b, c, d, function(a, b) {
            var c = !1
              , d = bb(e, a)
              , f = bb(e, b);
            if (1 === d || 1 === f)
                c = !0;
            else {
                var g = e[0]
                  , k = e[1]
                  , t = e[2]
                  , u = e[3]
                  , x = b[0];
                b = b[1];
                a = (b - a[1]) / (x - a[0]);
                f & 2 && !(d & 2) && (c = x - (b - u) / a,
                c = c >= g && c <= t);
                c || !(f & 4) || d & 4 || (c = b - (x - t) * a,
                c = c >= k && c <= u);
                c || !(f & 8) || d & 8 || (c = x - (b - k) / a,
                c = c >= g && c <= t);
                c || !(f & 16) || d & 16 || (c = b - (x - g) * a,
                c = c >= k && c <= u)
            }
            return c
        }) : !1
    }
    function Uf(a, b, c, d, e) {
        var f = c[0];
        if (!(Tf(a, b, f, d, e) || Pf(a, b, f, d, e[0], e[1]) || Pf(a, b, f, d, e[0], e[3]) || Pf(a, b, f, d, e[2], e[1]) || Pf(a, b, f, d, e[2], e[3])))
            return !1;
        if (1 === c.length)
            return !0;
        b = 1;
        for (f = c.length; b < f; ++b)
            if (Of(a, c[b - 1], c[b], d, e))
                return !1;
        return !0
    }
    ;function Vf(a, b, c, d) {
        for (var e = 0, f = a[c - d], g = a[c - d + 1]; b < c; b += d) {
            var k = a[b]
              , l = a[b + 1];
            e += (k - f) * (l + g);
            f = k;
            g = l
        }
        return 0 < e
    }
    function Wf(a, b, c, d) {
        var e = 0;
        d = void 0 !== d ? d : !1;
        var f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var k = b[g];
            e = Vf(a, e, k, c);
            if (0 === g) {
                if (d && e || !d && !e)
                    return !1
            } else if (d && !e || !d && e)
                return !1;
            e = k
        }
        return !0
    }
    function Xf(a, b, c, d, e) {
        e = void 0 !== e ? e : !1;
        var f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var k = c[g]
              , l = Vf(a, b, k, d);
            if (0 === g ? e && l || !e && !l : e && !l || !e && l) {
                l = a;
                for (var m = k, n = d; b < m - n; ) {
                    var p;
                    for (p = 0; p < n; ++p) {
                        var q = l[b + p];
                        l[b + p] = l[m - n + p];
                        l[m - n + p] = q
                    }
                    b += n;
                    m -= n
                }
            }
            b = k
        }
        return b
    }
    function Yf(a, b, c, d) {
        var e = 0, f;
        var g = 0;
        for (f = b.length; g < f; ++g)
            e = Xf(a, e, b[g], c, d);
        return e
    }
    ;function F(a, b) {
        tf.call(this);
        this.U = [];
        this.ss = -1;
        this.ts = null;
        this.pk = this.Cc = this.Dc = -1;
        this.Qd = null;
        this.pa(a, b)
    }
    v(F, tf);
    h = F.prototype;
    h.fw = function(a) {
        this.b ? ta(this.b, a.X()) : this.b = a.X().slice();
        this.U.push(this.b.length);
        this.a()
    }
    ;
    h.clone = function() {
        var a = new F(null);
        a.K(this.ha, this.b.slice(), this.U.slice());
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        if (d < Ya(this.c(), a, b))
            return d;
        this.Cc != this.Z && (this.Dc = Math.sqrt(Bf(this.b, 0, this.U, this.C, 0)),
        this.Cc = this.Z);
        return Df(this.b, 0, this.U, this.C, this.Dc, !0, a, b, c, d)
    }
    ;
    h.de = function(a, b) {
        return Qf(this.ub(), 0, this.U, this.C, a, b)
    }
    ;
    h.yj = function() {
        return yf(this.ub(), 0, this.U, this.C)
    }
    ;
    h.H = function(a) {
        if (void 0 !== a) {
            var b = this.ub().slice();
            Xf(b, 0, this.U, this.C, a)
        } else
            b = this.b;
        return If(b, 0, this.U, this.C)
    }
    ;
    function Zf(a) {
        if (a.ss != a.Z) {
            var b = sb(a.c());
            a.ts = Rf(a.ub(), 0, a.U, a.C, b, 0);
            a.ss = a.Z
        }
        return a.ts
    }
    h.mx = function() {
        return new D(Zf(this))
    }
    ;
    h.sx = function() {
        return this.U.length
    }
    ;
    h.Js = function(a) {
        if (0 > a || this.U.length <= a)
            return null;
        var b = new Nf(null);
        b.K(this.ha, this.b.slice(0 === a ? 0 : this.U[a - 1], this.U[a]));
        return b
    }
    ;
    h.Hj = function() {
        var a = this.ha, b = this.b, c = this.U, d = [], e = 0, f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var k = c[g]
              , l = new Nf(null);
            l.K(a, b.slice(e, k));
            d.push(l);
            e = k
        }
        return d
    }
    ;
    h.ub = function() {
        if (this.pk != this.Z) {
            var a = this.b;
            Wf(a, this.U, this.C) ? this.Qd = a : (this.Qd = a.slice(),
            this.Qd.length = Xf(this.Qd, 0, this.U, this.C));
            this.pk = this.Z
        }
        return this.Qd
    }
    ;
    h.Wh = function(a) {
        var b = []
          , c = [];
        b.length = Mf(this.b, 0, this.U, this.C, Math.sqrt(a), b, 0, c);
        a = new F(null);
        a.K("XY", b, c);
        return a
    }
    ;
    h.D = function() {
        return "Polygon"
    }
    ;
    h.Kb = function(a) {
        return Uf(this.ub(), 0, this.U, this.C, a)
    }
    ;
    h.pa = function(a, b) {
        a ? (wf(this, b, a, 2),
        this.b || (this.b = []),
        a = Gf(this.b, 0, a, this.C, this.U),
        this.b.length = 0 === a.length ? 0 : a[a.length - 1],
        this.a()) : this.K("XY", null, this.U)
    }
    ;
    h.K = function(a, b, c) {
        vf(this, a, b);
        this.U = c;
        this.a()
    }
    ;
    function $f(a, b, c, d) {
        var e = d ? d : 32;
        d = [];
        var f;
        for (f = 0; f < e; ++f)
            ta(d, a.offset(b, c, 2 * Math.PI * f / e));
        d.push(d[0], d[1]);
        a = new F(null);
        a.K("XY", d, [d.length]);
        return a
    }
    function ag(a) {
        var b = a[0]
          , c = a[1]
          , d = a[2];
        a = a[3];
        b = [b, c, b, a, d, a, d, c, b, c];
        c = new F(null);
        c.K("XY", b, [b.length]);
        return c
    }
    function bg(a, b, c) {
        var d = b ? b : 32
          , e = a.oa();
        b = a.ha;
        var f = new F(null,b);
        d = e * (d + 1);
        e = Array(d);
        for (var g = 0; g < d; g++)
            e[g] = 0;
        f.K(b, e, [e.length]);
        cg(f, a.Fa(), a.wc(), c);
        return f
    }
    function cg(a, b, c, d) {
        var e = a.X()
          , f = a.ha
          , g = a.oa()
          , k = a.U
          , l = e.length / g - 1;
        d = d ? d : 0;
        for (var m, n, p = 0; p <= l; ++p)
            n = p * g,
            m = d + 2 * Oa(p, l) * Math.PI / l,
            e[n] = b[0] + c * Math.cos(m),
            e[n + 1] = b[1] + c * Math.sin(m);
        a.K(f, e, k)
    }
    ;function H(a) {
        $c.call(this);
        a = yb({}, a);
        this.Vj = [0, 0];
        this.Me = [];
        this.Nn = this.Nn.bind(this);
        this.Ic = kc(a.projection);
        dg(this, a)
    }
    v(H, $c);
    function dg(a, b) {
        var c = {};
        c.center = void 0 !== b.center ? b.center : null;
        var d = void 0 !== b.minZoom ? b.minZoom : 0;
        var e = void 0 !== b.maxZoom ? b.maxZoom : 28;
        var f = void 0 !== b.zoomFactor ? b.zoomFactor : 2;
        if (void 0 !== b.resolutions) {
            e = b.resolutions;
            var g = e[0];
            var k = e[e.length - 1];
            e = Ue(e)
        } else {
            g = kc(b.projection);
            k = g.c();
            var l = (k ? Math.max(qb(k), rb(k)) : 360 * Ib.degrees / g.Mg()) / 256 / Math.pow(2, 0)
              , m = l / Math.pow(2, 28);
            g = b.maxResolution;
            void 0 !== g ? d = 0 : g = l / Math.pow(f, d);
            k = b.minResolution;
            void 0 === k && (k = void 0 !== b.maxZoom ? void 0 !== b.maxResolution ? g / Math.pow(f, e) : l / Math.pow(f, e) : m);
            e = d + Math.floor(Math.log(g / k) / Math.log(f));
            k = g / Math.pow(f, e - d);
            e = Ve(f, g, e - d)
        }
        a.pe = g;
        a.kk = k;
        a.OB = f;
        a.zb = b.resolutions;
        a.lk = d;
        (void 0 !== b.enableRotation ? b.enableRotation : 1) ? (d = b.constrainRotation,
        d = void 0 === d || !0 === d ? Ze() : !1 === d ? Xe : "number" === typeof d ? Ye(d) : Xe) : d = We;
        a.Cl = {
            center: void 0 !== b.extent ? Jc(b.extent) : Kc,
            resolution: e,
            rotation: d
        };
        void 0 !== b.resolution ? c.resolution = b.resolution : void 0 !== b.zoom && (c.resolution = a.constrainResolution(a.pe, b.zoom - a.lk));
        c.rotation = void 0 !== b.rotation ? b.rotation : 0;
        a.f(c);
        a.Az = b
    }
    function eg(a, b) {
        var c = yb({}, a.Az);
        void 0 !== c.resolution ? c.resolution = a.O() : c.zoom = a.Ss();
        c.center = a.Fa();
        c.rotation = a.ma();
        return yb({}, c, b)
    }
    h = H.prototype;
    h.rb = function(a) {
        var b = Date.now()
          , c = this.Fa().slice()
          , d = this.O()
          , e = this.ma()
          , f = arguments.length;
        if (1 < f && "function" === typeof arguments[f - 1]) {
            var g = arguments[f - 1];
            --f
        }
        for (var k = [], l = 0; l < f; ++l) {
            var m = arguments[l]
              , n = {
                start: b,
                complete: !1,
                anchor: m.anchor,
                duration: void 0 !== m.duration ? m.duration : 1E3,
                easing: m.easing || xd
            };
            m.center && (n.Jk = c,
            n.Nk = m.center,
            c = n.Nk);
            void 0 !== m.zoom ? (n.Lk = d,
            n.rh = this.constrainResolution(this.pe, m.zoom - this.lk, 0),
            d = n.rh) : m.resolution && (n.Lk = d,
            n.rh = m.resolution,
            d = n.rh);
            void 0 !== m.rotation && (n.tn = e,
            n.Ok = e + (Oa(m.rotation - e + Math.PI, 2 * Math.PI) - Math.PI),
            e = n.Ok);
            n.callback = g;
            n.Jk && n.Nk && !ff(n.Jk, n.Nk) || n.Lk !== n.rh || n.tn !== n.Ok ? b += n.duration : n.complete = !0;
            k.push(n)
        }
        this.Me.push(k);
        fg(this, 0, 1);
        this.Nn()
    }
    ;
    h.Ig = function() {
        return 0 < gg(this)[0]
    }
    ;
    h.kx = function() {
        return 0 < gg(this)[1]
    }
    ;
    h.Bh = function() {
        fg(this, 0, -gg(this)[0]);
        for (var a = 0, b = this.Me.length; a < b; ++a) {
            var c = this.Me[a];
            c[0].callback && c[0].callback(!1)
        }
        this.Me.length = 0
    }
    ;
    h.Nn = function() {
        void 0 !== this.Mn && (cancelAnimationFrame(this.Mn),
        this.Mn = void 0);
        if (this.Ig()) {
            for (var a = Date.now(), b = !1, c = this.Me.length - 1; 0 <= c; --c) {
                for (var d = this.Me[c], e = !0, f = 0, g = d.length; f < g; ++f) {
                    var k = d[f];
                    if (!k.complete) {
                        b = a - k.start;
                        b = 0 < k.duration ? b / k.duration : 1;
                        1 <= b ? (k.complete = !0,
                        b = 1) : e = !1;
                        b = k.easing(b);
                        if (k.Jk) {
                            var l = k.Jk[0]
                              , m = k.Jk[1];
                            this.set("center", [l + b * (k.Nk[0] - l), m + b * (k.Nk[1] - m)])
                        }
                        k.Lk && k.rh && (l = 1 === b ? k.rh : k.Lk + b * (k.rh - k.Lk),
                        k.anchor && this.set("center", hg(this, l, k.anchor)),
                        this.set("resolution", l));
                        void 0 !== k.tn && void 0 !== k.Ok && (b = 1 === b ? Oa(k.Ok + Math.PI, 2 * Math.PI) - Math.PI : k.tn + b * (k.Ok - k.tn),
                        k.anchor && this.set("center", ig(this, b, k.anchor)),
                        this.set("rotation", b));
                        b = !0;
                        if (!k.complete)
                            break
                    }
                }
                e && (this.Me[c] = null,
                fg(this, 0, -1),
                (d = d[0].callback) && d(!0))
            }
            this.Me = this.Me.filter(Boolean);
            b && void 0 === this.Mn && (this.Mn = requestAnimationFrame(this.Nn))
        }
    }
    ;
    function ig(a, b, c) {
        var d = a.Fa();
        if (void 0 !== d) {
            var e = [d[0] - c[0], d[1] - c[1]];
            gf(e, b - a.ma());
            af(e, c)
        }
        return e
    }
    function hg(a, b, c) {
        var d, e = a.Fa();
        a = a.O();
        void 0 !== e && void 0 !== a && (d = [c[0] - b * (c[0] - e[0]) / a, c[1] - b * (c[1] - e[1]) / a]);
        return d
    }
    function jg(a) {
        var b = [100, 100];
        a = '.ol-viewport[data-view="' + w(a) + '"]';
        if (a = document.querySelector(a))
            a = getComputedStyle(a),
            b[0] = parseInt(a.width, 10),
            b[1] = parseInt(a.height, 10);
        return b
    }
    h.Cg = function(a) {
        return this.Cl.center(a)
    }
    ;
    h.constrainResolution = function(a, b, c) {
        return this.Cl.resolution(a, b || 0, c || 0)
    }
    ;
    h.constrainRotation = function(a, b) {
        return this.Cl.rotation(a, b || 0)
    }
    ;
    h.Fa = function() {
        return this.get("center")
    }
    ;
    h.getConstraints = function() {
        return this.Cl
    }
    ;
    function gg(a, b) {
        return void 0 !== b ? (b[0] = a.Vj[0],
        b[1] = a.Vj[1],
        b) : a.Vj.slice()
    }
    h.Ah = function(a) {
        a = a || jg(this);
        var b = this.Fa();
        Fa(b, 1);
        var c = this.O();
        Fa(void 0 !== c, 2);
        var d = this.ma();
        Fa(void 0 !== d, 3);
        return tb(b, c, d, a)
    }
    ;
    h.uc = function() {
        return this.pe
    }
    ;
    h.vc = function() {
        return this.kk
    }
    ;
    h.Ij = function() {
        return this.Yl(this.kk)
    }
    ;
    h.QA = function(a) {
        dg(this, eg(this, {
            maxZoom: a
        }))
    }
    ;
    h.Ng = function() {
        return this.Yl(this.pe)
    }
    ;
    h.RA = function(a) {
        dg(this, eg(this, {
            minZoom: a
        }))
    }
    ;
    h.M = function() {
        return this.Ic
    }
    ;
    h.O = function() {
        return this.get("resolution")
    }
    ;
    h.Jd = function() {
        return this.zb
    }
    ;
    h.Vl = function(a, b) {
        b = b || jg(this);
        return Math.max(qb(a) / b[0], rb(a) / b[1])
    }
    ;
    function kg(a) {
        var b = a.pe
          , c = Math.log(b / a.kk) / Math.log(2);
        return function(a) {
            return b / Math.pow(2, a * c)
        }
    }
    h.ma = function() {
        return this.get("rotation")
    }
    ;
    function lg(a) {
        var b = a.pe
          , c = Math.log(b / a.kk) / Math.log(2);
        return function(a) {
            return Math.log(b / a) / Math.log(2) / c
        }
    }
    h.getState = function() {
        var a = this.Fa()
          , b = this.M()
          , c = this.O()
          , d = this.ma();
        return {
            center: a.slice(),
            projection: void 0 !== b ? b : null,
            resolution: c,
            rotation: d
        }
    }
    ;
    h.Ss = function() {
        var a, b = this.O();
        void 0 !== b && (a = this.Yl(b));
        return a
    }
    ;
    h.Yl = function(a) {
        if (a >= this.kk && a <= this.pe) {
            var b = this.lk || 0;
            if (this.zb) {
                var c = sa(this.zb, a, 1);
                b += c;
                if (c == this.zb.length - 1)
                    return b;
                var d = this.zb[c];
                c = d / this.zb[c + 1]
            } else
                d = this.pe,
                c = this.OB;
            b += Math.log(d / a) / Math.log(c)
        }
        return b
    }
    ;
    h.Ps = function(a) {
        return this.constrainResolution(this.pe, a - this.lk, 0)
    }
    ;
    h.Io = function(a, b) {
        b = b || {};
        var c = b.size;
        c || (c = jg(this));
        if (a instanceof tf)
            if ("Circle" === a.D()) {
                a = a.c();
                var d = ag(a);
                d.rotate(this.ma(), sb(a))
            } else
                d = a;
        else
            Fa(Array.isArray(a), 24),
            Fa(!pb(a), 25),
            d = ag(a);
        var e = void 0 !== b.padding ? b.padding : [0, 0, 0, 0]
          , f = void 0 !== b.constrainResolution ? b.constrainResolution : !0
          , g = void 0 !== b.nearest ? b.nearest : !1;
        var k = void 0 !== b.minResolution ? b.minResolution : void 0 !== b.maxZoom ? this.constrainResolution(this.pe, b.maxZoom - this.lk, 0) : 0;
        var l = d.X()
          , m = this.ma();
        a = Math.cos(-m);
        m = Math.sin(-m);
        var n = Infinity
          , p = Infinity
          , q = -Infinity
          , t = -Infinity;
        d = d.oa();
        for (var u = 0, x = l.length; u < x; u += d) {
            var B = l[u] * a - l[u + 1] * m
              , z = l[u] * m + l[u + 1] * a;
            n = Math.min(n, B);
            p = Math.min(p, z);
            q = Math.max(q, B);
            t = Math.max(t, z)
        }
        c = this.Vl([n, p, q, t], [c[0] - e[1] - e[3], c[1] - e[0] - e[2]]);
        c = isNaN(c) ? k : Math.max(c, k);
        f && (f = this.constrainResolution(c, 0, 0),
        !g && f < c && (f = this.constrainResolution(f, -1, 0)),
        c = f);
        m = -m;
        g = (n + q) / 2 + (e[1] - e[3]) / 2 * c;
        e = (p + t) / 2 + (e[0] - e[2]) / 2 * c;
        a = [g * a - e * m, e * a + g * m];
        e = b.callback ? b.callback : Ba;
        void 0 !== b.duration ? this.rb({
            resolution: c,
            center: a,
            duration: b.duration,
            easing: b.easing
        }, e) : (this.nh(c),
        this.Jc(a),
        setTimeout(e.bind(void 0, !0), 0))
    }
    ;
    h.pw = function(a, b, c) {
        var d = this.ma()
          , e = Math.cos(-d);
        d = Math.sin(-d);
        var f = a[0] * e - a[1] * d;
        a = a[1] * e + a[0] * d;
        var g = this.O();
        f += (b[0] / 2 - c[0]) * g;
        a += (c[1] - b[1] / 2) * g;
        d = -d;
        this.Jc([f * e - a * d, a * e + f * d])
    }
    ;
    function mg(a) {
        return !!a.Fa() && void 0 !== a.O()
    }
    h.rotate = function(a, b) {
        void 0 !== b && (b = ig(this, a, b),
        this.Jc(b));
        this.Wd(a)
    }
    ;
    h.Jc = function(a) {
        this.set("center", a);
        this.Ig() && this.Bh()
    }
    ;
    function fg(a, b, c) {
        a.Vj[b] += c;
        a.a()
    }
    h.nh = function(a) {
        this.set("resolution", a);
        this.Ig() && this.Bh()
    }
    ;
    h.Wd = function(a) {
        this.set("rotation", a);
        this.Ig() && this.Bh()
    }
    ;
    h.ZA = function(a) {
        this.nh(this.Ps(a))
    }
    ;
    function ng(a, b, c) {
        this.tw = a;
        this.Gt = b;
        this.yw = c;
        this.wb = [];
        this.qm = this.Pc = 0
    }
    h = ng.prototype;
    h.Yi = function() {
        this.qm = this.Pc = this.wb.length = 0
    }
    ;
    h.update = function(a, b) {
        this.wb.push(a, b, Date.now())
    }
    ;
    h.end = function() {
        if (6 > this.wb.length)
            return !1;
        var a = Date.now() - this.yw
          , b = this.wb.length - 3;
        if (this.wb[b + 2] < a)
            return !1;
        for (var c = b - 3; 0 < c && this.wb[c + 2] > a; )
            c -= 3;
        a = this.wb[b + 2] - this.wb[c + 2];
        if (a < 1E3 / 60)
            return !1;
        var d = this.wb[b] - this.wb[c];
        b = this.wb[b + 1] - this.wb[c + 1];
        this.Pc = Math.atan2(b, d);
        this.qm = Math.sqrt(d * d + b * b) / a;
        return this.qm > this.Gt
    }
    ;
    h.So = function() {
        return (this.Gt - this.qm) / this.tw
    }
    ;
    h.No = function() {
        return this.Pc
    }
    ;
    function og(a) {
        $c.call(this);
        this.ra = null;
        this.setActive(!0);
        this.handleEvent = a.handleEvent
    }
    v(og, $c);
    og.prototype.Va = function() {
        return this.get("active")
    }
    ;
    og.prototype.B = function() {
        return this.ra
    }
    ;
    og.prototype.setActive = function(a) {
        this.set("active", a)
    }
    ;
    og.prototype.setMap = function(a) {
        this.ra = a
    }
    ;
    og.pan = function(a, b, c) {
        var d = a.Fa();
        d && (b = a.Cg([d[0] + b[0], d[1] + b[1]]),
        c ? a.rb({
            duration: c,
            easing: yd,
            center: b
        }) : a.Jc(b))
    }
    ;
    function pg(a, b, c, d) {
        b = a.constrainRotation(b, 0);
        og.rotateWithoutConstraints(a, b, c, d)
    }
    og.rotateWithoutConstraints = function(a, b, c, d) {
        if (void 0 !== b) {
            var e = a.ma()
              , f = a.Fa();
            void 0 !== e && f && 0 < d ? a.rb({
                rotation: b,
                anchor: c,
                duration: d,
                easing: wd
            }) : a.rotate(b, c)
        }
    }
    ;
    og.zoomByDelta = function(a, b, c, d) {
        var e = a.O();
        b = a.constrainResolution(e, b, 0);
        if (c && void 0 !== b && b !== e) {
            var f = a.Fa();
            c = hg(a, b, c);
            c = a.Cg(c);
            c = [(b * f[0] - e * c[0]) / (b - e), (b * f[1] - e * c[1]) / (b - e)]
        }
        og.zoomWithoutConstraints(a, b, c, d)
    }
    ;
    og.zoomWithoutConstraints = function(a, b, c, d) {
        if (b) {
            var e = a.O()
              , f = a.Fa();
            void 0 !== e && f && b !== e && d ? a.rb({
                resolution: b,
                anchor: c,
                duration: d,
                easing: wd
            }) : (c && (c = hg(a, b, c),
            a.Jc(c)),
            a.nh(b))
        }
    }
    ;
    function qg(a) {
        a = a ? a : {};
        this.ee = a.delta ? a.delta : 1;
        og.call(this, {
            handleEvent: rg
        });
        this.Ha = void 0 !== a.duration ? a.duration : 250
    }
    v(qg, og);
    function rg(a) {
        var b = !1
          , c = a.originalEvent;
        if ("dblclick" == a.type) {
            b = a.coordinate;
            c = c.shiftKey ? -this.ee : this.ee;
            var d = a.map.R();
            og.zoomByDelta(d, c, b, this.Ha);
            a.preventDefault();
            b = !0
        }
        return !b
    }
    ;function sg(a) {
        a = a.originalEvent;
        return a.altKey && !(a.metaKey || a.ctrlKey) && !a.shiftKey
    }
    function tg(a) {
        a = a.originalEvent;
        return a.altKey && !(a.metaKey || a.ctrlKey) && a.shiftKey
    }
    function ug(a) {
        a = a.originalEvent;
        return 0 == a.button && !(Vd && Wd && a.ctrlKey)
    }
    function vg(a) {
        return "pointermove" == a.type
    }
    function wg(a) {
        return "singleclick" == a.type
    }
    function xg(a) {
        a = a.originalEvent;
        return !a.altKey && !(a.metaKey || a.ctrlKey) && !a.shiftKey
    }
    function yg(a) {
        a = a.originalEvent;
        return !a.altKey && !(a.metaKey || a.ctrlKey) && a.shiftKey
    }
    function Ag(a) {
        a = a.originalEvent.target.tagName;
        return "INPUT" !== a && "SELECT" !== a && "TEXTAREA" !== a
    }
    function Bg(a) {
        Fa(a.Vm, 56);
        return "mouse" == a.Vm.pointerType
    }
    function Cg(a) {
        a = a.Vm;
        return a.isPrimary && 0 === a.button
    }
    ;function Dg(a) {
        a = a ? a : {};
        og.call(this, {
            handleEvent: a.handleEvent ? a.handleEvent : Eg
        });
        this.Sx = a.handleDownEvent ? a.handleDownEvent : pf;
        this.Tx = a.handleDragEvent ? a.handleDragEvent : Ba;
        this.my = a.handleMoveEvent ? a.handleMoveEvent : Ba;
        this.handleUpEvent_ = a.handleUpEvent ? a.handleUpEvent : pf;
        this.$e = !1;
        this.Xk = {};
        this.fc = []
    }
    v(Dg, og);
    function Fg(a) {
        for (var b = a.length, c = 0, d = 0, e = 0; e < b; e++)
            c += a[e].clientX,
            d += a[e].clientY;
        return [c / b, d / b]
    }
    function Eg(a) {
        if (!(a instanceof le))
            return !0;
        var b = !1
          , c = a.type;
        if ("pointerdown" === c || "pointerdrag" === c || "pointerup" === c) {
            c = a.Vm;
            var d = c.pointerId.toString();
            "pointerup" == a.type ? delete this.Xk[d] : "pointerdown" == a.type ? this.Xk[d] = c : d in this.Xk && (this.Xk[d] = c);
            this.fc = Ab(this.Xk)
        }
        this.$e ? "pointerdrag" == a.type ? this.Tx(a) : "pointerup" == a.type && (this.$e = this.handleUpEvent_(a) && 0 < this.fc.length) : "pointerdown" == a.type ? (this.$e = a = this.Sx(a),
        b = this.ph(a)) : "pointermove" == a.type && this.my(a);
        return !b
    }
    Dg.prototype.ph = function(a) {
        return a
    }
    ;
    function Gg(a) {
        Dg.call(this, {
            handleDownEvent: Hg,
            handleDragEvent: Ig,
            handleUpEvent: Gg.handleUpEvent_
        });
        a = a ? a : {};
        this.td = a.kinetic;
        this.hi = null;
        this.Pb = a.condition ? a.condition : xg;
        this.Lt = !1
    }
    v(Gg, Dg);
    function Ig(a) {
        var b = this.fc
          , c = Fg(b);
        if (b.length == this.Py) {
            if (this.td && this.td.update(c[0], c[1]),
            this.hi) {
                var d = this.hi[0] - c[0]
                  , e = c[1] - this.hi[1];
                a = a.map.R();
                var f = a.getState();
                d = [d, e];
                hf(d, f.resolution);
                gf(d, f.rotation);
                af(d, f.center);
                d = a.Cg(d);
                a.Jc(d)
            }
        } else
            this.td && this.td.Yi();
        this.hi = c;
        this.Py = b.length
    }
    Gg.handleUpEvent_ = function(a) {
        var b = a.map;
        a = b.R();
        if (0 === this.fc.length) {
            if (!this.Lt && this.td && this.td.end()) {
                var c = this.td.So()
                  , d = this.td.Pc
                  , e = a.Fa();
                e = b.gb(e);
                b = b.Jb([e[0] - c * Math.cos(d), e[1] - c * Math.sin(d)]);
                a.rb({
                    center: a.Cg(b),
                    duration: 500,
                    easing: wd
                })
            }
            fg(a, 1, -1);
            return !1
        }
        this.td && this.td.Yi();
        this.hi = null;
        return !0
    }
    ;
    function Hg(a) {
        if (0 < this.fc.length && this.Pb(a)) {
            var b = a.map.R();
            this.hi = null;
            this.$e || fg(b, 1, 1);
            gg(b)[0] && b.Jc(a.frameState.viewState.center);
            this.td && this.td.Yi();
            this.Lt = 1 < this.fc.length;
            return !0
        }
        return !1
    }
    Gg.prototype.ph = pf;
    function Jg(a) {
        a = a ? a : {};
        Dg.call(this, {
            handleDownEvent: Kg,
            handleDragEvent: Lg,
            handleUpEvent: Mg
        });
        this.Pb = a.condition ? a.condition : tg;
        this.zc = void 0;
        this.Ha = void 0 !== a.duration ? a.duration : 250
    }
    v(Jg, Dg);
    function Lg(a) {
        if (Bg(a)) {
            var b = a.map
              , c = b.R();
            if (c.getConstraints().rotation !== We) {
                b = b.Ga();
                a = a.pixel;
                a = Math.atan2(b[1] / 2 - a[1], a[0] - b[0] / 2);
                if (void 0 !== this.zc) {
                    b = a - this.zc;
                    var d = c.ma();
                    og.rotateWithoutConstraints(c, d - b)
                }
                this.zc = a
            }
        }
    }
    function Mg(a) {
        if (!Bg(a))
            return !0;
        a = a.map.R();
        fg(a, 1, -1);
        var b = a.ma();
        pg(a, b, void 0, this.Ha);
        return !1
    }
    function Kg(a) {
        return Bg(a) && ug(a) && this.Pb(a) ? (fg(a.map.R(), 1, 1),
        this.zc = void 0,
        !0) : !1
    }
    Jg.prototype.ph = pf;
    function Ng(a) {
        this.Gg = null;
        this.Ba = document.createElement("div");
        this.Ba.style.position = "absolute";
        this.Ba.className = "ol-box " + a;
        this.Nl = this.Be = this.ra = null
    }
    v(Ng, Uc);
    Ng.prototype.la = function() {
        this.setMap(null)
    }
    ;
    Ng.prototype.zk = function() {
        var a = this.Be
          , b = this.Nl
          , c = this.Ba.style;
        c.left = Math.min(a[0], b[0]) + "px";
        c.top = Math.min(a[1], b[1]) + "px";
        c.width = Math.abs(b[0] - a[0]) + "px";
        c.height = Math.abs(b[1] - a[1]) + "px"
    }
    ;
    Ng.prototype.setMap = function(a) {
        if (this.ra) {
            this.ra.rk.removeChild(this.Ba);
            var b = this.Ba.style;
            b.left = b.top = b.width = b.height = "inherit"
        }
        (this.ra = a) && this.ra.rk.appendChild(this.Ba)
    }
    ;
    function Og(a) {
        var b = a.Be
          , c = a.Nl;
        b = [b, [b[0], c[1]], c, [c[0], b[1]]].map(a.ra.Jb, a.ra);
        b[4] = b[0].slice();
        a.Gg ? a.Gg.pa([b]) : a.Gg = new F([b])
    }
    Ng.prototype.I = function() {
        return this.Gg
    }
    ;
    function Pg(a) {
        Dg.call(this, {
            handleDownEvent: Qg,
            handleDragEvent: Rg,
            handleUpEvent: Sg
        });
        a = a ? a : {};
        this.$i = new Ng(a.className || "ol-dragbox");
        this.cz = void 0 !== a.minArea ? a.minArea : 64;
        this.Be = null;
        this.Pb = a.condition ? a.condition : of;
        this.lw = a.boxEndCondition ? a.boxEndCondition : Tg
    }
    v(Pg, Dg);
    function Tg(a, b, c) {
        a = c[0] - b[0];
        b = c[1] - b[1];
        return a * a + b * b >= this.cz
    }
    function Rg(a) {
        if (Bg(a)) {
            var b = this.$i
              , c = a.pixel;
            b.Be = this.Be;
            b.Nl = c;
            Og(b);
            b.zk();
            this.dispatchEvent(new Ug(Vg,a.coordinate,a))
        }
    }
    Pg.prototype.I = function() {
        return this.$i.I()
    }
    ;
    Pg.prototype.Ot = Ba;
    function Sg(a) {
        if (!Bg(a))
            return !0;
        this.$i.setMap(null);
        this.lw(a, this.Be, a.pixel) && (this.Ot(a),
        this.dispatchEvent(new Ug(Wg,a.coordinate,a)));
        return !1
    }
    function Qg(a) {
        if (Bg(a) && ug(a) && this.Pb(a)) {
            this.Be = a.pixel;
            this.$i.setMap(a.map);
            var b = this.$i
              , c = this.Be;
            b.Be = this.Be;
            b.Nl = c;
            Og(b);
            b.zk();
            this.dispatchEvent(new Ug(Xg,a.coordinate,a));
            return !0
        }
        return !1
    }
    var Xg = "boxstart"
      , Vg = "boxdrag"
      , Wg = "boxend";
    function Ug(a, b, c) {
        Wc.call(this, a);
        this.coordinate = b;
        this.mapBrowserEvent = c
    }
    v(Ug, Wc);
    function Yg(a) {
        a = a ? a : {};
        var b = a.condition ? a.condition : yg;
        this.Ha = void 0 !== a.duration ? a.duration : 200;
        this.Cz = void 0 !== a.out ? a.out : !1;
        Pg.call(this, {
            condition: b,
            className: a.className || "ol-dragzoom"
        })
    }
    v(Yg, Pg);
    Yg.prototype.Ot = function() {
        var a = this.B()
          , b = a.R()
          , c = a.Ga()
          , d = this.I().c();
        if (this.Cz) {
            var e = b.Ah(c);
            d = [a.gb(kb(d)), a.gb(mb(d))];
            a = db(void 0);
            var f;
            var g = 0;
            for (f = d.length; g < f; ++g)
                Va(a, d[g]);
            d = b.Vl(a, c);
            wb(e, 1 / d);
            d = e
        }
        c = b.constrainResolution(b.Vl(d, c));
        e = sb(d);
        e = b.Cg(e);
        b.rb({
            resolution: c,
            center: e,
            duration: this.Ha,
            easing: wd
        })
    }
    ;
    function Zg(a) {
        og.call(this, {
            handleEvent: $g
        });
        a = a || {};
        this.vw = function(a) {
            return xg(a) && Ag(a)
        }
        ;
        this.Pb = void 0 !== a.condition ? a.condition : this.vw;
        this.Ha = void 0 !== a.duration ? a.duration : 100;
        this.Jz = void 0 !== a.pixelDelta ? a.pixelDelta : 128
    }
    v(Zg, og);
    function $g(a) {
        var b = !1;
        if ("keydown" == a.type) {
            var c = a.originalEvent.keyCode;
            if (this.Pb(a) && (40 == c || 37 == c || 39 == c || 38 == c)) {
                b = a.map.R();
                var d = b.O() * this.Jz
                  , e = 0
                  , f = 0;
                40 == c ? f = -d : 37 == c ? e = -d : 39 == c ? e = d : f = d;
                c = [e, f];
                gf(c, b.ma());
                og.pan(b, c, this.Ha);
                a.preventDefault();
                b = !0
            }
        }
        return !b
    }
    ;function ah(a) {
        og.call(this, {
            handleEvent: bh
        });
        a = a ? a : {};
        this.Pb = a.condition ? a.condition : Ag;
        this.ee = a.delta ? a.delta : 1;
        this.Ha = void 0 !== a.duration ? a.duration : 100
    }
    v(ah, og);
    function bh(a) {
        var b = !1;
        if ("keydown" == a.type || "keypress" == a.type) {
            var c = a.originalEvent.charCode;
            !this.Pb(a) || 43 != c && 45 != c || (b = 43 == c ? this.ee : -this.ee,
            c = a.map.R(),
            og.zoomByDelta(c, b, void 0, this.Ha),
            a.preventDefault(),
            b = !0)
        }
        return !b
    }
    ;function ch(a) {
        og.call(this, {
            handleEvent: dh
        });
        a = a || {};
        this.ee = 0;
        this.Ha = void 0 !== a.duration ? a.duration : 250;
        this.nB = void 0 !== a.timeout ? a.timeout : 80;
        this.dv = void 0 !== a.useAnchor ? a.useAnchor : !0;
        this.uo = a.constrainResolution || !1;
        this.cf = null;
        this.Ya = this.Lq = this.Gi = void 0;
        this.Xu = 400;
        this.Hn = void 0;
        this.uB = 300;
        this.Yu = 1.5
    }
    v(ch, og);
    function dh(a) {
        var b = a.type;
        if ("wheel" !== b && "mousewheel" !== b)
            return !0;
        a.preventDefault();
        b = a.map;
        var c = a.originalEvent;
        this.dv && (this.cf = a.coordinate);
        if ("wheel" == a.type) {
            var d = c.deltaY;
            Td && c.deltaMode === WheelEvent.DOM_DELTA_PIXEL && (d /= Xd);
            c.deltaMode === WheelEvent.DOM_DELTA_LINE && (d *= 40)
        } else
            "mousewheel" == a.type && (d = -c.wheelDeltaY,
            Ud && (d /= 3));
        if (0 === d)
            return !1;
        a = Date.now();
        void 0 === this.Gi && (this.Gi = a);
        if (!this.Ya || a - this.Gi > this.Xu)
            this.Ya = 4 > Math.abs(d) ? eh : fh;
        if (this.Ya === eh) {
            b = b.R();
            this.Hn ? clearTimeout(this.Hn) : fg(b, 1, 1);
            this.Hn = setTimeout(this.uw.bind(this), this.Xu);
            c = b.O() * Math.pow(2, d / this.uB);
            var e = b.vc()
              , f = b.uc()
              , g = 0;
            c < e ? (c = Math.max(c, e / this.Yu),
            g = 1) : c > f && (c = Math.min(c, f * this.Yu),
            g = -1);
            if (this.cf) {
                var k = hg(b, c, this.cf);
                b.Jc(b.Cg(k))
            }
            b.nh(c);
            0 === g && this.uo && b.rb({
                resolution: b.constrainResolution(c, 0 < d ? -1 : 1),
                easing: wd,
                anchor: this.cf,
                duration: this.Ha
            });
            0 < g ? b.rb({
                resolution: e,
                easing: wd,
                anchor: this.cf,
                duration: 500
            }) : 0 > g && b.rb({
                resolution: f,
                easing: wd,
                anchor: this.cf,
                duration: 500
            });
            this.Gi = a;
            return !1
        }
        this.ee += d;
        d = Math.max(this.nB - (a - this.Gi), 0);
        clearTimeout(this.Lq);
        this.Lq = setTimeout(this.Cy.bind(this, b), d);
        return !1
    }
    ch.prototype.uw = function() {
        this.Hn = void 0;
        fg(this.B().R(), 1, -1)
    }
    ;
    ch.prototype.Cy = function(a) {
        a = a.R();
        a.Ig() && a.Bh();
        og.zoomByDelta(a, -Ia(this.ee, -1, 1), this.cf, this.Ha);
        this.Ya = void 0;
        this.ee = 0;
        this.cf = null;
        this.Lq = this.Gi = void 0
    }
    ;
    ch.prototype.TA = function(a) {
        this.dv = a;
        a || (this.cf = null)
    }
    ;
    var eh = "trackpad"
      , fh = "wheel";
    function gh(a) {
        Dg.call(this, {
            handleDownEvent: hh,
            handleDragEvent: ih,
            handleUpEvent: jh
        });
        a = a || {};
        this.Ib = null;
        this.zc = void 0;
        this.Ek = !1;
        this.kn = 0;
        this.lB = void 0 !== a.threshold ? a.threshold : .3;
        this.Ha = void 0 !== a.duration ? a.duration : 250
    }
    v(gh, Dg);
    function ih(a) {
        var b = 0
          , c = this.fc[0]
          , d = this.fc[1];
        c = Math.atan2(d.clientY - c.clientY, d.clientX - c.clientX);
        void 0 !== this.zc && (b = c - this.zc,
        this.kn += b,
        !this.Ek && Math.abs(this.kn) > this.lB && (this.Ek = !0));
        this.zc = c;
        a = a.map;
        c = a.R();
        if (c.getConstraints().rotation !== We) {
            d = a.Sa.getBoundingClientRect();
            var e = Fg(this.fc);
            e[0] -= d.left;
            e[1] -= d.top;
            this.Ib = a.Jb(e);
            this.Ek && (d = c.ma(),
            a.render(),
            og.rotateWithoutConstraints(c, d + b, this.Ib))
        }
    }
    function jh(a) {
        if (2 > this.fc.length) {
            a = a.map.R();
            fg(a, 1, -1);
            if (this.Ek) {
                var b = a.ma();
                pg(a, b, this.Ib, this.Ha)
            }
            return !1
        }
        return !0
    }
    function hh(a) {
        return 2 <= this.fc.length ? (a = a.map,
        this.Ib = null,
        this.zc = void 0,
        this.Ek = !1,
        this.kn = 0,
        this.$e || fg(a.R(), 1, 1),
        !0) : !1
    }
    gh.prototype.ph = pf;
    function mh(a) {
        Dg.call(this, {
            handleDownEvent: nh,
            handleDragEvent: oh,
            handleUpEvent: ph
        });
        a = a ? a : {};
        this.uo = a.constrainResolution || !1;
        this.Ib = null;
        this.Ha = void 0 !== a.duration ? a.duration : 400;
        this.vm = void 0;
        this.Xg = 1
    }
    v(mh, Dg);
    function oh(a) {
        var b = 1
          , c = this.fc[0]
          , d = this.fc[1]
          , e = c.clientX - d.clientX;
        c = c.clientY - d.clientY;
        e = Math.sqrt(e * e + c * c);
        void 0 !== this.vm && (b = this.vm / e);
        this.vm = e;
        a = a.map;
        e = a.R();
        d = e.O();
        var f = e.uc()
          , g = e.vc();
        c = d * b;
        c > f ? (b = f / d,
        c = f) : c < g && (b = g / d,
        c = g);
        1 != b && (this.Xg = b);
        b = a.Sa.getBoundingClientRect();
        d = Fg(this.fc);
        d[0] -= b.left;
        d[1] -= b.top;
        this.Ib = a.Jb(d);
        a.render();
        og.zoomWithoutConstraints(e, c, this.Ib)
    }
    function ph(a) {
        if (2 > this.fc.length) {
            a = a.map.R();
            fg(a, 1, -1);
            var b = a.O();
            if (this.uo || b < a.vc() || b > a.uc()) {
                var c = this.Ib
                  , d = this.Ha;
                b = a.constrainResolution(b, 0, this.Xg - 1);
                og.zoomWithoutConstraints(a, b, c, d)
            }
            return !1
        }
        return !0
    }
    function nh(a) {
        return 2 <= this.fc.length ? (a = a.map,
        this.Ib = null,
        this.vm = void 0,
        this.Xg = 1,
        this.$e || fg(a.R(), 1, 1),
        !0) : !1
    }
    mh.prototype.ph = pf;
    function qh(a) {
        a = a ? a : {};
        var b = new C
          , c = new ng(-.005,.05,100);
        (void 0 !== a.altShiftDragRotate ? a.altShiftDragRotate : 1) && b.push(new Jg);
        (void 0 !== a.doubleClickZoom ? a.doubleClickZoom : 1) && b.push(new qg({
            delta: a.zoomDelta,
            duration: a.zoomDuration
        }));
        (void 0 !== a.dragPan ? a.dragPan : 1) && b.push(new Gg({
            kinetic: c
        }));
        (void 0 !== a.pinchRotate ? a.pinchRotate : 1) && b.push(new gh);
        (void 0 !== a.pinchZoom ? a.pinchZoom : 1) && b.push(new mh({
            constrainResolution: a.constrainResolution,
            duration: a.zoomDuration
        }));
        if (void 0 !== a.keyboard ? a.keyboard : 1)
            b.push(new Zg),
            b.push(new ah({
                delta: a.zoomDelta,
                duration: a.zoomDuration
            }));
        (void 0 !== a.mouseWheelZoom ? a.mouseWheelZoom : 1) && b.push(new ch({
            constrainResolution: a.constrainResolution,
            duration: a.zoomDuration
        }));
        (void 0 !== a.shiftDragZoom ? a.shiftDragZoom : 1) && b.push(new Yg({
            duration: a.zoomDuration
        }));
        return b
    }
    ;function rh(a) {
        $c.call(this);
        var b = yb({}, a);
        b.opacity = void 0 !== a.opacity ? a.opacity : 1;
        b.visible = void 0 !== a.visible ? a.visible : !0;
        b.zIndex = void 0 !== a.zIndex ? a.zIndex : 0;
        b.maxResolution = void 0 !== a.maxResolution ? a.maxResolution : Infinity;
        b.minResolution = void 0 !== a.minResolution ? a.minResolution : 0;
        this.f(b);
        this.u = {
            layer: this,
            Fm: !0
        }
    }
    v(rh, $c);
    function sh(a) {
        a.u.opacity = Ia(a.tb(), 0, 1);
        a.u.Ku = a.ep();
        a.u.visible = a.ke();
        a.u.extent = a.c();
        a.u.zIndex = a.La();
        a.u.maxResolution = a.uc();
        a.u.minResolution = Math.max(a.vc(), 0);
        return a.u
    }
    h = rh.prototype;
    h.c = function() {
        return this.get("extent")
    }
    ;
    h.uc = function() {
        return this.get("maxResolution")
    }
    ;
    h.vc = function() {
        return this.get("minResolution")
    }
    ;
    h.tb = function() {
        return this.get("opacity")
    }
    ;
    h.ke = function() {
        return this.get("visible")
    }
    ;
    h.La = function() {
        return this.get("zIndex")
    }
    ;
    h.Eb = function(a) {
        this.set("extent", a)
    }
    ;
    h.fg = function(a) {
        this.set("maxResolution", a)
    }
    ;
    h.gg = function(a) {
        this.set("minResolution", a)
    }
    ;
    h.oc = function(a) {
        this.set("opacity", a)
    }
    ;
    h.Yd = function(a) {
        this.set("visible", a)
    }
    ;
    h.Ae = function(a) {
        this.set("zIndex", a)
    }
    ;
    function th(a) {
        var b = a || {};
        a = yb({}, b);
        delete a.layers;
        b = b.layers;
        rh.call(this, a);
        this.Cp = [];
        this.Zg = {};
        y(this, bd(uh), this.gy, this);
        b ? Array.isArray(b) ? b = new C(b.slice(),{
            unique: !0
        }) : Fa(b instanceof C, 43) : b = new C(void 0,{
            unique: !0
        });
        this.mn(b)
    }
    v(th, rh);
    h = th.prototype;
    h.dj = function() {}
    ;
    h.em = function() {
        this.a()
    }
    ;
    h.gy = function() {
        this.Cp.forEach(Mc);
        this.Cp.length = 0;
        var a = this.Te();
        this.Cp.push(y(a, "add", this.fy, this), y(a, "remove", this.hy, this));
        for (var b in this.Zg)
            this.Zg[b].forEach(Mc);
        zb(this.Zg);
        a = a.ie();
        var c;
        b = 0;
        for (c = a.length; b < c; b++) {
            var d = a[b];
            this.Zg[w(d).toString()] = [y(d, "propertychange", this.em, this), y(d, "change", this.em, this)]
        }
        this.a()
    }
    ;
    h.fy = function(a) {
        a = a.element;
        var b = w(a).toString();
        this.Zg[b] = [y(a, "propertychange", this.em, this), y(a, "change", this.em, this)];
        this.a()
    }
    ;
    h.hy = function(a) {
        a = w(a.element).toString();
        this.Zg[a].forEach(Mc);
        delete this.Zg[a];
        this.a()
    }
    ;
    h.Te = function() {
        return this.get(uh)
    }
    ;
    h.mn = function(a) {
        this.set(uh, a)
    }
    ;
    h.bp = function(a) {
        var b = void 0 !== a ? a : []
          , c = b.length;
        this.Te().forEach(function(a) {
            a.bp(b)
        });
        a = sh(this);
        var d;
        for (d = b.length; c < d; c++) {
            var e = b[c];
            e.opacity *= a.opacity;
            e.visible = e.visible && a.visible;
            e.maxResolution = Math.min(e.maxResolution, a.maxResolution);
            e.minResolution = Math.max(e.minResolution, a.minResolution);
            void 0 !== a.extent && (e.extent = void 0 !== e.extent ? ub(e.extent, a.extent) : a.extent)
        }
        return b
    }
    ;
    h.ep = function() {
        return "ready"
    }
    ;
    var uh = "layers";
    function vh(a) {
        var b = yb({}, a);
        delete b.source;
        rh.call(this, b);
        this.sn = this.Im = this.Hm = null;
        a.map && this.setMap(a.map);
        y(this, bd("source"), this.wy, this);
        this.oh(a.source ? a.source : null)
    }
    v(vh, rh);
    function wh(a, b) {
        return a.visible && b >= a.minResolution && b < a.maxResolution
    }
    h = vh.prototype;
    h.bp = function(a) {
        a = a ? a : [];
        a.push(sh(this));
        return a
    }
    ;
    h.Y = function() {
        return this.get("source") || null
    }
    ;
    h.ep = function() {
        var a = this.Y();
        return a ? a.getState() : "undefined"
    }
    ;
    h.lp = function() {
        this.a()
    }
    ;
    h.wy = function() {
        this.sn && (Mc(this.sn),
        this.sn = null);
        var a = this.Y();
        a && (this.sn = y(a, "change", this.lp, this));
        this.a()
    }
    ;
    h.setMap = function(a) {
        this.Hm && (Mc(this.Hm),
        this.Hm = null);
        a || this.a();
        this.Im && (Mc(this.Im),
        this.Im = null);
        a && (this.Hm = y(a, "precompose", function(a) {
            var b = sh(this);
            b.Fm = !1;
            b.zIndex = Infinity;
            a.frameState.Od.push(b);
            a.frameState.ak[w(this)] = b
        }, this),
        this.Im = y(this, "change", a.render, a),
        this.a())
    }
    ;
    h.oh = function(a) {
        this.set("source", a)
    }
    ;
    function xh() {
        this.Ag = {};
        this.zl = 0;
        this.az = 32
    }
    xh.prototype.clear = function() {
        this.Ag = {};
        this.zl = 0
    }
    ;
    xh.prototype.get = function(a, b, c) {
        a = b + ":" + a + ":" + (c ? md(c) : "null");
        return a in this.Ag ? this.Ag[a] : null
    }
    ;
    xh.prototype.set = function(a, b, c, d) {
        this.Ag[b + ":" + a + ":" + (c ? md(c) : "null")] = d;
        ++this.zl
    }
    ;
    var yh = new xh;
    var zh = Array(6);
    function Ah() {
        return [1, 0, 0, 1, 0, 0]
    }
    function Bh(a) {
        return Ch(a, 1, 0, 0, 1, 0, 0)
    }
    function Dh(a, b) {
        var c = a[0]
          , d = a[1]
          , e = a[2]
          , f = a[3]
          , g = a[4]
          , k = a[5]
          , l = b[0]
          , m = b[1]
          , n = b[2]
          , p = b[3]
          , q = b[4];
        b = b[5];
        a[0] = c * l + e * m;
        a[1] = d * l + f * m;
        a[2] = c * n + e * p;
        a[3] = d * n + f * p;
        a[4] = c * q + e * b + g;
        a[5] = d * q + f * b + k;
        return a
    }
    function Ch(a, b, c, d, e, f, g) {
        a[0] = b;
        a[1] = c;
        a[2] = d;
        a[3] = e;
        a[4] = f;
        a[5] = g;
        return a
    }
    function Eh(a, b) {
        a[0] = b[0];
        a[1] = b[1];
        a[2] = b[2];
        a[3] = b[3];
        a[4] = b[4];
        a[5] = b[5];
        return a
    }
    function Fh(a, b) {
        var c = b[0]
          , d = b[1];
        b[0] = a[0] * c + a[2] * d + a[4];
        b[1] = a[1] * c + a[3] * d + a[5];
        return b
    }
    function Gh(a, b) {
        var c = Math.cos(b);
        b = Math.sin(b);
        Dh(a, Ch(zh, c, b, -b, c, 0, 0))
    }
    function Hh(a, b, c) {
        return Dh(a, Ch(zh, b, 0, 0, c, 0, 0))
    }
    function Ih(a, b, c) {
        Dh(a, Ch(zh, 1, 0, 0, 1, b, c))
    }
    function Jh(a, b, c, d, e, f, g, k) {
        var l = Math.sin(f);
        f = Math.cos(f);
        a[0] = d * f;
        a[1] = e * l;
        a[2] = -d * l;
        a[3] = e * f;
        a[4] = g * d * f - k * d * l + b;
        a[5] = g * e * l + k * e * f + c;
        return a
    }
    function Kh(a) {
        var b = a[0] * a[3] - a[1] * a[2];
        Fa(0 !== b, 32);
        var c = a[0]
          , d = a[1]
          , e = a[2]
          , f = a[3]
          , g = a[4]
          , k = a[5];
        a[0] = f / b;
        a[1] = -d / b;
        a[2] = -e / b;
        a[3] = c / b;
        a[4] = (e * k - f * g) / b;
        a[5] = -(c * k - d * g) / b;
        return a
    }
    ;function Lh(a, b) {
        this.ra = b;
        this.oe = {};
        this.Bp = {}
    }
    v(Lh, Uc);
    function Mh(a) {
        var b = a.viewState
          , c = a.Dg
          , d = a.ti;
        Jh(c, a.size[0] / 2, a.size[1] / 2, 1 / b.resolution, -1 / b.resolution, -b.rotation, -b.center[0], -b.center[1]);
        Kh(Eh(d, c))
    }
    h = Lh.prototype;
    h.la = function() {
        for (var a in this.oe)
            Vc(this.oe[a])
    }
    ;
    function Nh() {
        if (yh.zl > yh.az) {
            var a = 0, b;
            for (b in yh.Ag) {
                var c = yh.Ag[b];
                0 !== (a++ & 3) || c.hasListener() || (delete yh.Ag[b],
                --yh.zl)
            }
        }
    }
    h.Ta = function(a, b, c, d, e, f, g) {
        function k(a, c) {
            var f = w(a).toString()
              , g = b.ak[w(c)].Fm;
            if (!(f in b.qh) || g)
                return d.call(e, a, g ? c : null)
        }
        var l, m = b.viewState, n = m.resolution, p = m.projection;
        m = a;
        if (p.Bf) {
            p = p.c();
            var q = qb(p)
              , t = a[0];
            if (t < p[0] || t > p[2])
                m = [t + q * Math.ceil((p[0] - t) / q), a[1]]
        }
        p = b.Od;
        for (q = p.length - 1; 0 <= q; --q) {
            var u = p[q];
            t = u.layer;
            if (wh(u, n) && f.call(g, t) && (u = Oh(this, t),
            t.Y() && (l = u.Ta(t.Y().Tn ? m : a, b, c, k, e)),
            l))
                return l
        }
    }
    ;
    h.af = function(a, b, c, d, e) {
        return void 0 !== this.Ta(a, b, c, of, this, d, e)
    }
    ;
    function Oh(a, b) {
        var c = w(b).toString();
        if (c in a.oe)
            return a.oe[c];
        b = b.dj(a);
        a.oe[c] = b;
        a.Bp[c] = y(b, "change", a.ey, a);
        return b
    }
    h.B = function() {
        return this.ra
    }
    ;
    h.ey = function() {
        this.ra.render()
    }
    ;
    h.iq = Ba;
    h.yA = function(a, b) {
        for (var c in this.oe)
            if (!(b && c in b.ak)) {
                a = c;
                var d = this.oe[a];
                delete this.oe[a];
                Mc(this.Bp[a]);
                delete this.Bp[a];
                Vc(d)
            }
    }
    ;
    function Ph(a, b) {
        for (var c in a.oe)
            if (!(c in b.ak)) {
                b.Rd.push(a.yA.bind(a));
                break
            }
    }
    function ya(a, b) {
        return a.zIndex - b.zIndex
    }
    ;function Qh(a, b, c, d, e) {
        Wc.call(this, a);
        this.vectorContext = b;
        this.frameState = c;
        this.context = d;
        this.glContext = e
    }
    v(Qh, Wc);
    var Rh = [0, 0, 0, 1]
      , Sh = []
      , Th = [0, 0, 0, 1];
    function Uh(a, b, c, d) {
        0 !== b && (a.translate(c, d),
        a.rotate(b),
        a.translate(-c, -d))
    }
    ;function Vh() {}
    h = Vh.prototype;
    h.es = function() {}
    ;
    h.ld = function() {}
    ;
    h.Gb = function() {}
    ;
    h.Qe = function() {}
    ;
    h.Il = function() {}
    ;
    h.Jl = function() {}
    ;
    h.Ff = function() {}
    ;
    h.Gf = function() {}
    ;
    h.Hf = function() {}
    ;
    h.If = function() {}
    ;
    h.Jf = function() {}
    ;
    h.Kf = function() {}
    ;
    h.fe = function() {}
    ;
    h.kb = function() {}
    ;
    h.ye = function() {}
    ;
    h.bc = function() {}
    ;
    function Wh(a, b, c, d, e) {
        this.$ = a;
        this.Wa = b;
        this.V = c;
        this.qb = d;
        this.hv = e;
        this.s = this.Mb = this.sc = this.Wr = this.Vr = this.Ur = null;
        this.$s = this.Zs = this.om = this.wp = this.vp = this.up = 0;
        this.at = !1;
        this.Xj = this.bt = 0;
        this.ct = !1;
        this.yp = 0;
        this.S = "";
        this.Qk = this.Pk = 0;
        this.Rk = !1;
        this.ng = this.Sk = 0;
        this.qf = this.Nc = this.Mc = null;
        this.te = [];
        this.Fn = Ah()
    }
    v(Wh, Vh);
    function Xh(a, b, c) {
        if (a.s) {
            b = rf(b, 0, c, 2, a.qb, a.te);
            c = a.$;
            var d = a.Fn
              , e = c.globalAlpha;
            1 != a.om && (c.globalAlpha = e * a.om);
            var f = a.bt;
            a.at && (f += a.hv);
            var g;
            var k = 0;
            for (g = b.length; k < g; k += 2) {
                var l = b[k] - a.up
                  , m = b[k + 1] - a.vp;
                a.ct && (l = Math.round(l),
                m = Math.round(m));
                if (0 !== f || 1 != a.Xj) {
                    var n = l + a.up
                      , p = m + a.vp;
                    Jh(d, n, p, a.Xj, a.Xj, f, -n, -p);
                    c.setTransform.apply(c, d)
                }
                c.drawImage(a.s, a.Zs, a.$s, a.yp, a.wp, l, m, a.yp, a.wp)
            }
            0 === f && 1 == a.Xj || c.setTransform(1, 0, 0, 1, 0, 0);
            1 != a.om && (c.globalAlpha = e)
        }
    }
    h = Wh.prototype;
    h.Qb = function(a, b, c, d) {
        if (this.qf && "" !== this.S) {
            this.Mc && Yh(this, this.Mc);
            this.Nc && Zh(this, this.Nc);
            var e = this.qf
              , f = this.$
              , g = this.Wr;
            g ? (g.font != e.font && (g.font = f.font = e.font),
            g.textAlign != e.textAlign && (g.textAlign = f.textAlign = e.textAlign),
            g.textBaseline != e.textBaseline && (g.textBaseline = f.textBaseline = e.textBaseline)) : (f.font = e.font,
            f.textAlign = e.textAlign,
            f.textBaseline = e.textBaseline,
            this.Wr = {
                font: e.font,
                textAlign: e.textAlign,
                textBaseline: e.textBaseline
            });
            a = rf(a, b, c, d, this.qb, this.te);
            e = this.$;
            f = this.Sk;
            for (this.Rk && (f += this.hv); b < c; b += d) {
                g = a[b] + this.Pk;
                var k = a[b + 1] + this.Qk;
                if (0 !== f || 1 != this.ng) {
                    var l = Jh(this.Fn, g, k, this.ng, this.ng, f, -g, -k);
                    e.setTransform.apply(e, l)
                }
                this.Nc && e.strokeText(this.S, g, k);
                this.Mc && e.fillText(this.S, g, k)
            }
            0 === f && 1 == this.ng || e.setTransform(1, 0, 0, 1, 0, 0)
        }
    }
    ;
    function $h(a, b, c, d, e, f) {
        var g = a.$;
        a = rf(b, c, d, e, a.qb, a.te);
        g.moveTo(a[0], a[1]);
        b = a.length;
        f && (b -= 2);
        for (c = 2; c < b; c += 2)
            g.lineTo(a[c], a[c + 1]);
        f && g.closePath();
        return d
    }
    function ai(a, b, c, d, e) {
        var f;
        var g = 0;
        for (f = d.length; g < f; ++g)
            c = $h(a, b, c, d[g], e, !0);
        return c
    }
    h.Qe = function(a) {
        if (vb(this.V, a.c())) {
            if (this.sc || this.Mb) {
                this.sc && Yh(this, this.sc);
                this.Mb && Zh(this, this.Mb);
                var b = this.qb;
                var c = this.te
                  , d = a.X();
                b = d ? rf(d, 0, d.length, a.oa(), b, c) : null;
                c = b[2] - b[0];
                d = b[3] - b[1];
                c = Math.sqrt(c * c + d * d);
                d = this.$;
                d.beginPath();
                d.arc(b[0], b[1], c, 0, 2 * Math.PI);
                this.sc && d.fill();
                this.Mb && d.stroke()
            }
            "" !== this.S && this.Qb(a.Fa(), 0, 2, 2)
        }
    }
    ;
    h.Gb = function(a) {
        this.kb(a.ja, a.ia);
        this.ye(a.N());
        this.bc(a.S)
    }
    ;
    h.ld = function(a) {
        switch (a.D()) {
        case "Point":
            this.Jf(a);
            break;
        case "LineString":
            this.Ff(a);
            break;
        case "Polygon":
            this.Kf(a);
            break;
        case "MultiPoint":
            this.Hf(a);
            break;
        case "MultiLineString":
            this.Gf(a);
            break;
        case "MultiPolygon":
            this.If(a);
            break;
        case "GeometryCollection":
            this.Jl(a);
            break;
        case "Circle":
            this.Qe(a)
        }
    }
    ;
    h.Il = function(a, b) {
        (a = (0,
        b.Rb)(a)) && vb(this.V, a.c()) && (this.Gb(b),
        this.ld(a))
    }
    ;
    h.Jl = function(a) {
        a = a.Ja;
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c)
            this.ld(a[c])
    }
    ;
    h.Jf = function(a) {
        var b = a.X();
        a = a.oa();
        this.s && Xh(this, b, b.length);
        "" !== this.S && this.Qb(b, 0, b.length, a)
    }
    ;
    h.Hf = function(a) {
        var b = a.X();
        a = a.oa();
        this.s && Xh(this, b, b.length);
        "" !== this.S && this.Qb(b, 0, b.length, a)
    }
    ;
    h.Ff = function(a) {
        if (vb(this.V, a.c())) {
            if (this.Mb) {
                Zh(this, this.Mb);
                var b = this.$
                  , c = a.X();
                b.beginPath();
                $h(this, c, 0, c.length, a.oa(), !1);
                b.stroke()
            }
            "" !== this.S && (a = bi(a),
            this.Qb(a, 0, 2, 2))
        }
    }
    ;
    h.Gf = function(a) {
        var b = a.c();
        if (vb(this.V, b)) {
            if (this.Mb) {
                Zh(this, this.Mb);
                b = this.$;
                var c = a.X()
                  , d = 0
                  , e = a.U
                  , f = a.oa();
                b.beginPath();
                var g;
                var k = 0;
                for (g = e.length; k < g; ++k)
                    d = $h(this, c, d, e[k], f, !1);
                b.stroke()
            }
            "" !== this.S && (a = ci(a),
            this.Qb(a, 0, a.length, 2))
        }
    }
    ;
    h.Kf = function(a) {
        if (vb(this.V, a.c())) {
            if (this.Mb || this.sc) {
                this.sc && Yh(this, this.sc);
                this.Mb && Zh(this, this.Mb);
                var b = this.$;
                b.beginPath();
                ai(this, a.ub(), 0, a.U, a.oa());
                this.sc && b.fill();
                this.Mb && b.stroke()
            }
            "" !== this.S && (a = Zf(a),
            this.Qb(a, 0, 2, 2))
        }
    }
    ;
    h.If = function(a) {
        if (vb(this.V, a.c())) {
            if (this.Mb || this.sc) {
                this.sc && Yh(this, this.sc);
                this.Mb && Zh(this, this.Mb);
                var b = this.$, c = a.ub(), d = 0, e = a.Ia, f = a.oa(), g;
                b.beginPath();
                var k = 0;
                for (g = e.length; k < g; ++k)
                    d = ai(this, c, d, e[k], f);
                this.sc && b.fill();
                this.Mb && b.stroke()
            }
            "" !== this.S && (a = di(a),
            this.Qb(a, 0, a.length, 2))
        }
    }
    ;
    function Yh(a, b) {
        var c = a.$
          , d = a.Ur;
        d ? d.fillStyle != b.fillStyle && (d.fillStyle = c.fillStyle = b.fillStyle) : (c.fillStyle = b.fillStyle,
        a.Ur = {
            fillStyle: b.fillStyle
        })
    }
    function Zh(a, b) {
        var c = a.$
          , d = a.Vr;
        d ? (d.lineCap != b.lineCap && (d.lineCap = c.lineCap = b.lineCap),
        Yd && (wa(d.lineDash, b.lineDash) || c.setLineDash(d.lineDash = b.lineDash),
        d.lineDashOffset != b.lineDashOffset && (d.lineDashOffset = c.lineDashOffset = b.lineDashOffset)),
        d.lineJoin != b.lineJoin && (d.lineJoin = c.lineJoin = b.lineJoin),
        d.lineWidth != b.lineWidth && (d.lineWidth = c.lineWidth = b.lineWidth),
        d.miterLimit != b.miterLimit && (d.miterLimit = c.miterLimit = b.miterLimit),
        d.strokeStyle != b.strokeStyle && (d.strokeStyle = c.strokeStyle = b.strokeStyle)) : (c.lineCap = b.lineCap,
        Yd && (c.setLineDash(b.lineDash),
        c.lineDashOffset = b.lineDashOffset),
        c.lineJoin = b.lineJoin,
        c.lineWidth = b.lineWidth,
        c.miterLimit = b.miterLimit,
        c.strokeStyle = b.strokeStyle,
        a.Vr = {
            lineCap: b.lineCap,
            lineDash: b.lineDash,
            lineDashOffset: b.lineDashOffset,
            lineJoin: b.lineJoin,
            lineWidth: b.lineWidth,
            miterLimit: b.miterLimit,
            strokeStyle: b.strokeStyle
        })
    }
    h.kb = function(a, b) {
        a ? (a = a.W,
        this.sc = {
            fillStyle: od(a ? a : Rh)
        }) : this.sc = null;
        if (b) {
            a = b.W;
            var c = b.Zc
              , d = b.getLineDash()
              , e = b.Ac
              , f = b.$c
              , g = b.Sb();
            b = b.ad;
            this.Mb = {
                lineCap: void 0 !== c ? c : "round",
                lineDash: d ? d : Sh,
                lineDashOffset: e ? e : 0,
                lineJoin: void 0 !== f ? f : "round",
                lineWidth: this.Wa * (void 0 !== g ? g : 1),
                miterLimit: void 0 !== b ? b : 10,
                strokeStyle: od(a ? a : Th)
            }
        } else
            this.Mb = null
    }
    ;
    h.ye = function(a) {
        if (a) {
            var b = a.Hg()
              , c = a.N(1)
              , d = a.ic()
              , e = a.Ga();
            this.up = b[0];
            this.vp = b[1];
            this.wp = e[1];
            this.s = c;
            this.om = a.tb();
            this.Zs = d[0];
            this.$s = d[1];
            this.at = a.Db;
            this.bt = a.ma();
            this.Xj = a.Ma * this.Wa;
            this.ct = a.fd;
            this.yp = e[0]
        } else
            this.s = null
    }
    ;
    h.bc = function(a) {
        if (a) {
            var b = a.ja;
            b ? (b = b.W,
            this.Mc = {
                fillStyle: od(b ? b : Rh)
            }) : this.Mc = null;
            var c = a.ia;
            if (c) {
                b = c.W;
                var d = c.Zc
                  , e = c.getLineDash()
                  , f = c.Ac
                  , g = c.$c
                  , k = c.Sb();
                c = c.ad;
                this.Nc = {
                    lineCap: void 0 !== d ? d : "round",
                    lineDash: e ? e : Sh,
                    lineDashOffset: f ? f : 0,
                    lineJoin: void 0 !== g ? g : "round",
                    lineWidth: void 0 !== k ? k : 1,
                    miterLimit: void 0 !== c ? c : 10,
                    strokeStyle: od(b ? b : Th)
                }
            } else
                this.Nc = null;
            b = a.Lf;
            d = a.qe;
            e = a.re;
            f = a.Db;
            g = a.ma();
            k = a.Ma;
            c = a.S;
            var l = a.De;
            a = a.Ee;
            this.qf = {
                font: void 0 !== b ? b : "10px sans-serif",
                textAlign: void 0 !== l ? l : "center",
                textBaseline: void 0 !== a ? a : "middle"
            };
            this.S = void 0 !== c ? c : "";
            this.Pk = void 0 !== d ? this.Wa * d : 0;
            this.Qk = void 0 !== e ? this.Wa * e : 0;
            this.Rk = void 0 !== f ? f : !1;
            this.Sk = void 0 !== g ? g : 0;
            this.ng = this.Wa * (void 0 !== k ? k : 1)
        } else
            this.S = ""
    }
    ;
    function ei(a, b) {
        Lh.call(this, 0, b);
        this.$ = pd();
        this.J = this.$.canvas;
        this.J.style.width = "100%";
        this.J.style.height = "100%";
        this.J.style.display = "block";
        this.J.className = "ol-unselectable";
        a.insertBefore(this.J, a.childNodes[0] || null);
        this.xb = !0;
        this.qb = Ah()
    }
    v(ei, Lh);
    h = ei.prototype;
    h.Rc = function(a, b) {
        var c = this.B()
          , d = this.$;
        if (c.hasListener(a)) {
            var e = b.extent
              , f = b.pixelRatio
              , g = b.viewState.rotation
              , k = this.Nf(b);
            c.dispatchEvent(new Qh(a,new Wh(d,f,e,k,g),b,d,null))
        }
    }
    ;
    h.Nf = function(a) {
        var b = a.viewState;
        a = a.pixelRatio / b.resolution;
        return Jh(this.qb, this.J.width / 2, this.J.height / 2, a, -a, -b.rotation, -b.center[0], -b.center[1])
    }
    ;
    h.D = function() {
        return "canvas"
    }
    ;
    h.iq = function(a) {
        if (a) {
            var b = this.$
              , c = a.pixelRatio
              , d = Math.round(a.size[0] * c)
              , e = Math.round(a.size[1] * c);
            this.J.width != d || this.J.height != e ? (this.J.width = d,
            this.J.height = e) : b.clearRect(0, 0, d, e);
            c = a.viewState.rotation;
            Mh(a);
            this.Rc("precompose", a);
            var f = a.Od;
            xa(f);
            c && (b.save(),
            Uh(b, c, d / 2, e / 2));
            d = a.viewState.resolution;
            var g;
            e = 0;
            for (g = f.length; e < g; ++e) {
                var k = f[e];
                var l = k.layer;
                l = Oh(this, l);
                wh(k, d) && "ready" == k.Ku && l.ue(a, k) && l.Ch(a, k, b)
            }
            c && b.restore();
            this.Rc("postcompose", a);
            this.xb || (this.J.style.display = "",
            this.xb = !0);
            Ph(this, a);
            a.Rd.push(Nh)
        } else
            this.xb && (this.J.style.display = "none",
            this.xb = !1)
    }
    ;
    h.Mf = function(a, b, c, d, e, f) {
        var g = b.viewState.resolution
          , k = b.Od
          , l = k.length;
        a = Fh(b.ti, a.slice());
        for (--l; 0 <= l; --l) {
            var m = k[l];
            var n = m.layer;
            if (wh(m, g) && e.call(f, n) && (m = Oh(this, n).Ko(a, b, c, d)))
                return m
        }
    }
    ;
    var fi = "Polygon Circle LineString Image Text Default".split(" ");
    function gi() {}
    ;function hi(a) {
        this.da = a
    }
    hi.prototype.Y = function() {
        return this.da
    }
    ;
    function ii(a) {
        this.da = a
    }
    v(ii, hi);
    ii.prototype.D = function() {
        return 35632
    }
    ;
    function ji(a) {
        this.da = a
    }
    v(ji, hi);
    ji.prototype.D = function() {
        return 35633
    }
    ;
    function ki() {
        this.da = "precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n"
    }
    v(ki, ii);
    var li = new ki;
    function mi() {
        this.da = "varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n"
    }
    v(mi, ji);
    var ni = new mi;
    function oi(a, b) {
        this.vB = a.getUniformLocation(b, "u_fillColor");
        this.Rq = a.getUniformLocation(b, "u_lineWidth");
        this.In = a.getUniformLocation(b, "u_offsetRotateMatrix");
        this.Jn = a.getUniformLocation(b, "u_offsetScaleMatrix");
        this.Ni = a.getUniformLocation(b, "u_opacity");
        this.Sq = a.getUniformLocation(b, "u_pixelRatio");
        this.Oi = a.getUniformLocation(b, "u_projectionMatrix");
        this.Tq = a.getUniformLocation(b, "u_size");
        this.xB = a.getUniformLocation(b, "u_strokeColor");
        this.ho = a.getAttribLocation(b, "a_instruction");
        this.lb = a.getAttribLocation(b, "a_position");
        this.mo = a.getAttribLocation(b, "a_radius")
    }
    ;function pi() {
        return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]
    }
    function qi(a, b) {
        a[0] = b[0];
        a[1] = b[1];
        a[4] = b[2];
        a[5] = b[3];
        a[12] = b[4];
        a[13] = b[5];
        return a
    }
    ;function ri(a, b) {
        this.Wu = a;
        this.Km = b;
        this.origin = sb(b);
        this.Uz = Ah();
        this.sz = Ah();
        this.tz = Ah();
        this.Ki = pi();
        this.i = [];
        this.le = null;
        this.T = [];
        this.Ub = [];
        this.G = [];
        this.Ie = null;
        this.Bc = void 0
    }
    v(ri, Vh);
    ri.prototype.jb = function(a, b, c, d, e, f, g, k, l, m, n) {
        var p = a.sa;
        if (this.Bc) {
            var q = p.isEnabled(p.STENCIL_TEST);
            var t = p.getParameter(p.STENCIL_FUNC);
            var u = p.getParameter(p.STENCIL_VALUE_MASK);
            var x = p.getParameter(p.STENCIL_REF);
            var B = p.getParameter(p.STENCIL_WRITEMASK);
            var z = p.getParameter(p.STENCIL_FAIL);
            var E = p.getParameter(p.STENCIL_PASS_DEPTH_PASS);
            var G = p.getParameter(p.STENCIL_PASS_DEPTH_FAIL);
            p.enable(p.STENCIL_TEST);
            p.clear(p.STENCIL_BUFFER_BIT);
            p.stencilMask(255);
            p.stencilFunc(p.ALWAYS, 1, 255);
            p.stencilOp(p.KEEP, p.KEEP, p.REPLACE);
            this.Bc.jb(a, b, c, d, e, f, g, k, l, m, n);
            p.stencilMask(0);
            p.stencilFunc(p.NOTEQUAL, 1, 255)
        }
        a.bindBuffer(34962, this.Ie);
        a.bindBuffer(34963, this.le);
        f = this.pn(p, a, e, f);
        var ea = Bh(this.Uz);
        Hh(ea, 2 / (c * e[0]), 2 / (c * e[1]));
        Gh(ea, -d);
        Ih(ea, -(b[0] - this.origin[0]), -(b[1] - this.origin[1]));
        b = Bh(this.tz);
        Hh(b, 2 / e[0], 2 / e[1]);
        e = Bh(this.sz);
        0 !== d && Gh(e, -d);
        p.uniformMatrix4fv(f.Oi, !1, qi(this.Ki, ea));
        p.uniformMatrix4fv(f.Jn, !1, qi(this.Ki, b));
        p.uniformMatrix4fv(f.In, !1, qi(this.Ki, e));
        p.uniform1f(f.Ni, g);
        if (void 0 === l)
            this.pj(p, a, k, !1);
        else {
            m ? a = this.Kl(p, a, k, l, n) : (p.clear(p.COLOR_BUFFER_BIT | p.DEPTH_BUFFER_BIT),
            this.pj(p, a, k, !0),
            a = (a = l(null)) ? a : void 0);
            var V = a
        }
        this.qn(p, f);
        this.Bc && (q || p.disable(p.STENCIL_TEST),
        p.clear(p.STENCIL_BUFFER_BIT),
        p.stencilFunc(t, x, u),
        p.stencilMask(B),
        p.stencilOp(z, G, E));
        return V
    }
    ;
    ri.prototype.drawElements = function(a, b, c, d) {
        a.drawElements(4, d - c, b.hm ? 5125 : 5123, c * (b.hm ? 4 : 2))
    }
    ;
    var si = [0, 0, 0, 1]
      , ti = []
      , ui = [0, 0, 0, 1];
    function vi(a, b, c, d, e, f) {
        a = (c - a) * (f - b) - (e - a) * (d - b);
        return a <= wi && a >= -wi ? void 0 : 0 < a
    }
    var wi = Number.EPSILON || 2.220446049250313E-16;
    function xi(a, b) {
        this.iw = void 0 !== a ? a : [];
        this.FB = void 0 !== b ? b : yi
    }
    xi.prototype.ie = function() {
        return this.iw
    }
    ;
    var yi = 35044;
    function zi(a, b) {
        ri.call(this, a, b);
        this.fb = null;
        this.ab = [];
        this.Aa = [];
        this.ob = 0;
        this.u = {
            fillColor: null,
            strokeColor: null,
            lineDash: null,
            lineDashOffset: void 0,
            lineWidth: void 0,
            a: !1
        }
    }
    v(zi, ri);
    h = zi.prototype;
    h.kd = function(a, b, c, d) {
        for (var e = this.G.length, f = this.i.length, g = e / 4; b < c; b += d)
            this.G[e++] = a[b],
            this.G[e++] = a[b + 1],
            this.G[e++] = 0,
            this.G[e++] = this.ob,
            this.G[e++] = a[b],
            this.G[e++] = a[b + 1],
            this.G[e++] = 1,
            this.G[e++] = this.ob,
            this.G[e++] = a[b],
            this.G[e++] = a[b + 1],
            this.G[e++] = 2,
            this.G[e++] = this.ob,
            this.G[e++] = a[b],
            this.G[e++] = a[b + 1],
            this.G[e++] = 3,
            this.G[e++] = this.ob,
            this.i[f++] = g,
            this.i[f++] = g + 1,
            this.i[f++] = g + 2,
            this.i[f++] = g + 2,
            this.i[f++] = g + 3,
            this.i[f++] = g,
            g += 4
    }
    ;
    h.Qe = function(a, b) {
        var c = a.wc()
          , d = a.oa();
        c ? (this.T.push(this.i.length),
        this.Ub.push(b),
        this.u.a && (this.Aa.push(this.i.length),
        this.u.a = !1),
        this.ob = c,
        a = a.X(),
        a = sf(a, 0, 2, d, -this.origin[0], -this.origin[1]),
        this.kd(a, 0, 2, d)) : this.u.a && (this.ab.pop(),
        this.ab.length && (d = this.ab[this.ab.length - 1],
        this.u.fillColor = d[0],
        this.u.strokeColor = d[1],
        this.u.lineWidth = d[2],
        this.u.a = !1))
    }
    ;
    h.finish = function() {
        this.Ie = new xi(this.G);
        this.le = new xi(this.i);
        this.T.push(this.i.length);
        0 === this.Aa.length && 0 < this.ab.length && (this.ab = []);
        this.i = this.G = null
    }
    ;
    h.Vb = function(a) {
        var b = this.Ie
          , c = this.le;
        return function() {
            a.deleteBuffer(b);
            a.deleteBuffer(c)
        }
    }
    ;
    h.pn = function(a, b, c, d) {
        var e = Ai(b, li, ni);
        if (this.fb)
            var f = this.fb;
        else
            this.fb = f = new oi(a,e);
        b.useProgram(e);
        a.enableVertexAttribArray(f.lb);
        a.vertexAttribPointer(f.lb, 2, 5126, !1, 16, 0);
        a.enableVertexAttribArray(f.ho);
        a.vertexAttribPointer(f.ho, 1, 5126, !1, 16, 8);
        a.enableVertexAttribArray(f.mo);
        a.vertexAttribPointer(f.mo, 1, 5126, !1, 16, 12);
        a.uniform2fv(f.Tq, c);
        a.uniform1f(f.Sq, d);
        return f
    }
    ;
    h.qn = function(a, b) {
        a.disableVertexAttribArray(b.lb);
        a.disableVertexAttribArray(b.ho);
        a.disableVertexAttribArray(b.mo)
    }
    ;
    h.pj = function(a, b, c) {
        if (Bb(c)) {
            var d = this.T[this.T.length - 1];
            for (c = this.Aa.length - 1; 0 <= c; --c) {
                var e = this.Aa[c];
                var f = this.ab[c];
                this.kh(a, f[0]);
                this.ze(a, f[1], f[2]);
                this.drawElements(a, b, e, d);
                d = e
            }
        } else
            this.qj(a, b, c)
    }
    ;
    h.Kl = function(a, b, c, d, e) {
        var f, g;
        var k = this.T.length - 2;
        var l = this.T[k + 1];
        for (f = this.Aa.length - 1; 0 <= f; --f) {
            var m = this.ab[f];
            this.kh(a, m[0]);
            this.ze(a, m[1], m[2]);
            for (g = this.Aa[f]; 0 <= k && this.T[k] >= g; ) {
                m = this.T[k];
                var n = this.Ub[k];
                var p = w(n).toString();
                if (void 0 === c[p] && n.I() && (void 0 === e || vb(e, n.I().c())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT),
                this.drawElements(a, b, m, l),
                l = d(n)))
                    return l;
                k--;
                l = m
            }
        }
    }
    ;
    h.qj = function(a, b, c) {
        var d, e;
        var f = this.T.length - 2;
        var g = e = this.T[f + 1];
        for (d = this.Aa.length - 1; 0 <= d; --d) {
            var k = this.ab[d];
            this.kh(a, k[0]);
            this.ze(a, k[1], k[2]);
            for (k = this.Aa[d]; 0 <= f && this.T[f] >= k; ) {
                var l = this.T[f];
                var m = this.Ub[f];
                m = w(m).toString();
                c[m] && (e !== g && this.drawElements(a, b, e, g),
                g = l);
                f--;
                e = l
            }
            e !== g && this.drawElements(a, b, e, g);
            e = g = k
        }
    }
    ;
    h.kh = function(a, b) {
        a.uniform4fv(this.fb.vB, b)
    }
    ;
    h.ze = function(a, b, c) {
        a.uniform4fv(this.fb.xB, b);
        a.uniform1f(this.fb.Rq, c)
    }
    ;
    h.kb = function(a, b) {
        if (b) {
            var c = b.getLineDash();
            this.u.lineDash = c ? c : ti;
            c = b.Ac;
            this.u.lineDashOffset = c ? c : 0;
            c = b.W;
            c = c instanceof CanvasGradient || c instanceof CanvasPattern ? ui : kd(c).map(function(a, b) {
                return 3 != b ? a / 255 : a
            }) || ui;
            b = b.Sb();
            b = void 0 !== b ? b : 1
        } else
            c = [0, 0, 0, 0],
            b = 0;
        a = a ? a.W : [0, 0, 0, 0];
        a = a instanceof CanvasGradient || a instanceof CanvasPattern ? si : kd(a).map(function(a, b) {
            return 3 != b ? a / 255 : a
        }) || si;
        this.u.strokeColor && wa(this.u.strokeColor, c) && this.u.fillColor && wa(this.u.fillColor, a) && this.u.lineWidth === b || (this.u.a = !0,
        this.u.fillColor = a,
        this.u.strokeColor = c,
        this.u.lineWidth = b,
        this.ab.push([a, c, b]))
    }
    ;
    function Bi() {
        this.da = "precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n"
    }
    v(Bi, ii);
    var Ci = new Bi;
    function Di() {
        this.da = "varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n"
    }
    v(Di, ji);
    var Ei = new Di;
    function Fi(a, b) {
        this.In = a.getUniformLocation(b, "u_offsetRotateMatrix");
        this.Jn = a.getUniformLocation(b, "u_offsetScaleMatrix");
        this.Ni = a.getUniformLocation(b, "u_opacity");
        this.Oi = a.getUniformLocation(b, "u_projectionMatrix");
        this.ko = a.getAttribLocation(b, "a_offsets");
        this.lo = a.getAttribLocation(b, "a_opacity");
        this.lb = a.getAttribLocation(b, "a_position");
        this.no = a.getAttribLocation(b, "a_rotateWithView");
        this.Le = a.getAttribLocation(b, "a_texCoord")
    }
    ;function Gi(a, b) {
        this.J = a;
        this.sa = b;
        this.Af = {};
        this.Ci = {};
        this.wi = {};
        this.qp = this.rp = this.Wj = this.zo = null;
        (this.hm = ra(pa, "OES_element_index_uint")) && b.getExtension("OES_element_index_uint");
        y(this.J, "webglcontextlost", this.Tg, this);
        y(this.J, "webglcontextrestored", this.op, this)
    }
    v(Gi, Uc);
    h = Gi.prototype;
    h.bindBuffer = function(a, b) {
        var c = this.sa
          , d = b.ie()
          , e = String(w(b));
        if (e in this.Af)
            c.bindBuffer(a, this.Af[e].buffer);
        else {
            var f = c.createBuffer();
            c.bindBuffer(a, f);
            var g;
            34962 == a ? g = new Float32Array(d) : 34963 == a && (g = this.hm ? new Uint32Array(d) : new Uint16Array(d));
            c.bufferData(a, g, b.FB);
            this.Af[e] = {
                Ne: b,
                buffer: f
            }
        }
    }
    ;
    h.deleteBuffer = function(a) {
        var b = this.sa;
        a = String(w(a));
        var c = this.Af[a];
        b.isContextLost() || b.deleteBuffer(c.buffer);
        delete this.Af[a]
    }
    ;
    h.la = function() {
        Tc(this.J);
        var a = this.sa;
        if (!a.isContextLost()) {
            for (var b in this.Af)
                a.deleteBuffer(this.Af[b].buffer);
            for (b in this.wi)
                a.deleteProgram(this.wi[b]);
            for (b in this.Ci)
                a.deleteShader(this.Ci[b]);
            a.deleteFramebuffer(this.Wj);
            a.deleteRenderbuffer(this.qp);
            a.deleteTexture(this.rp)
        }
    }
    ;
    h.Hs = function() {
        return this.sa
    }
    ;
    function Hi(a) {
        if (!a.Wj) {
            var b = a.sa
              , c = b.createFramebuffer();
            b.bindFramebuffer(b.FRAMEBUFFER, c);
            var d = Ii(b, 1, 1)
              , e = b.createRenderbuffer();
            b.bindRenderbuffer(b.RENDERBUFFER, e);
            b.renderbufferStorage(b.RENDERBUFFER, b.DEPTH_COMPONENT16, 1, 1);
            b.framebufferTexture2D(b.FRAMEBUFFER, b.COLOR_ATTACHMENT0, b.TEXTURE_2D, d, 0);
            b.framebufferRenderbuffer(b.FRAMEBUFFER, b.DEPTH_ATTACHMENT, b.RENDERBUFFER, e);
            b.bindTexture(b.TEXTURE_2D, null);
            b.bindRenderbuffer(b.RENDERBUFFER, null);
            b.bindFramebuffer(b.FRAMEBUFFER, null);
            a.Wj = c;
            a.rp = d;
            a.qp = e
        }
        return a.Wj
    }
    function Ji(a, b) {
        var c = String(w(b));
        if (c in a.Ci)
            return a.Ci[c];
        var d = a.sa
          , e = d.createShader(b.D());
        d.shaderSource(e, b.Y());
        d.compileShader(e);
        return a.Ci[c] = e
    }
    function Ai(a, b, c) {
        var d = w(b) + "/" + w(c);
        if (d in a.wi)
            return a.wi[d];
        var e = a.sa
          , f = e.createProgram();
        e.attachShader(f, Ji(a, b));
        e.attachShader(f, Ji(a, c));
        e.linkProgram(f);
        return a.wi[d] = f
    }
    h.Tg = function() {
        zb(this.Af);
        zb(this.Ci);
        zb(this.wi);
        this.qp = this.rp = this.Wj = this.zo = null
    }
    ;
    h.op = function() {}
    ;
    h.useProgram = function(a) {
        if (a == this.zo)
            return !1;
        this.sa.useProgram(a);
        this.zo = a;
        return !0
    }
    ;
    function Ki(a, b, c) {
        var d = a.createTexture();
        a.bindTexture(a.TEXTURE_2D, d);
        a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, a.LINEAR);
        a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, a.LINEAR);
        void 0 !== b && a.texParameteri(3553, 10242, b);
        void 0 !== c && a.texParameteri(3553, 10243, c);
        return d
    }
    function Ii(a, b, c) {
        var d = Ki(a, void 0, void 0);
        a.texImage2D(a.TEXTURE_2D, 0, a.RGBA, b, c, 0, a.RGBA, a.UNSIGNED_BYTE, null);
        return d
    }
    function Li(a, b) {
        var c = Ki(a, 33071, 33071);
        a.texImage2D(a.TEXTURE_2D, 0, a.RGBA, a.RGBA, a.UNSIGNED_BYTE, b);
        return c
    }
    ;function Mi(a, b) {
        ri.call(this, a, b);
        this.ul = this.tl = void 0;
        this.$h = [];
        this.ei = [];
        this.imageWidth = this.imageHeight = this.height = void 0;
        this.Ao = null;
        this.width = this.scale = this.rotation = this.rotateWithView = this.Sm = this.Rm = this.opacity = void 0
    }
    v(Mi, ri);
    h = Mi.prototype;
    h.Vb = function(a) {
        var b = this.Ie
          , c = this.le
          , d = this.hp(!0)
          , e = a.sa;
        return function() {
            if (!e.isContextLost()) {
                var f;
                var g = 0;
                for (f = d.length; g < f; ++g)
                    e.deleteTexture(d[g])
            }
            a.deleteBuffer(b);
            a.deleteBuffer(c)
        }
    }
    ;
    function Ni(a, b, c, d, e) {
        var f = a.tl
          , g = a.ul
          , k = a.height
          , l = a.imageHeight
          , m = a.imageWidth
          , n = a.opacity
          , p = a.Rm
          , q = a.Sm
          , t = a.rotateWithView ? 1 : 0
          , u = -a.rotation
          , x = a.scale
          , B = a.width
          , z = Math.cos(u);
        u = Math.sin(u);
        for (var E = a.i.length, G = a.G.length, ea, V, O, ca, va; c < d; c += e)
            ca = b[c] - a.origin[0],
            va = b[c + 1] - a.origin[1],
            ea = G / 8,
            V = -x * f,
            O = -x * (k - g),
            a.G[G++] = ca,
            a.G[G++] = va,
            a.G[G++] = V * z - O * u,
            a.G[G++] = V * u + O * z,
            a.G[G++] = p / m,
            a.G[G++] = (q + k) / l,
            a.G[G++] = n,
            a.G[G++] = t,
            V = x * (B - f),
            O = -x * (k - g),
            a.G[G++] = ca,
            a.G[G++] = va,
            a.G[G++] = V * z - O * u,
            a.G[G++] = V * u + O * z,
            a.G[G++] = (p + B) / m,
            a.G[G++] = (q + k) / l,
            a.G[G++] = n,
            a.G[G++] = t,
            V = x * (B - f),
            O = x * g,
            a.G[G++] = ca,
            a.G[G++] = va,
            a.G[G++] = V * z - O * u,
            a.G[G++] = V * u + O * z,
            a.G[G++] = (p + B) / m,
            a.G[G++] = q / l,
            a.G[G++] = n,
            a.G[G++] = t,
            V = -x * f,
            O = x * g,
            a.G[G++] = ca,
            a.G[G++] = va,
            a.G[G++] = V * z - O * u,
            a.G[G++] = V * u + O * z,
            a.G[G++] = p / m,
            a.G[G++] = q / l,
            a.G[G++] = n,
            a.G[G++] = t,
            a.i[E++] = ea,
            a.i[E++] = ea + 1,
            a.i[E++] = ea + 2,
            a.i[E++] = ea,
            a.i[E++] = ea + 2,
            a.i[E++] = ea + 3
    }
    function Oi(a, b, c, d) {
        var e, f = b.length;
        for (e = 0; e < f; ++e) {
            var g = b[e];
            var k = w(g).toString();
            k in c ? g = c[k] : (g = Li(d, g),
            c[k] = g);
            a[e] = g
        }
    }
    h.pn = function(a, b) {
        var c = Ai(b, Ci, Ei);
        if (this.Ao)
            var d = this.Ao;
        else
            this.Ao = d = new Fi(a,c);
        b.useProgram(c);
        a.enableVertexAttribArray(d.lb);
        a.vertexAttribPointer(d.lb, 2, 5126, !1, 32, 0);
        a.enableVertexAttribArray(d.ko);
        a.vertexAttribPointer(d.ko, 2, 5126, !1, 32, 8);
        a.enableVertexAttribArray(d.Le);
        a.vertexAttribPointer(d.Le, 2, 5126, !1, 32, 16);
        a.enableVertexAttribArray(d.lo);
        a.vertexAttribPointer(d.lo, 1, 5126, !1, 32, 24);
        a.enableVertexAttribArray(d.no);
        a.vertexAttribPointer(d.no, 1, 5126, !1, 32, 28);
        return d
    }
    ;
    h.qn = function(a, b) {
        a.disableVertexAttribArray(b.lb);
        a.disableVertexAttribArray(b.ko);
        a.disableVertexAttribArray(b.Le);
        a.disableVertexAttribArray(b.lo);
        a.disableVertexAttribArray(b.no)
    }
    ;
    h.pj = function(a, b, c, d) {
        var e = d ? this.Zo() : this.hp();
        d = d ? this.ei : this.$h;
        if (Bb(c)) {
            var f;
            c = 0;
            var g = e.length;
            for (f = 0; c < g; ++c) {
                a.bindTexture(3553, e[c]);
                var k = d[c];
                this.drawElements(a, b, f, k);
                f = k
            }
        } else
            for (f = g = 0,
            k = e.length; f < k; ++f) {
                a.bindTexture(3553, e[f]);
                for (var l = 0 < f ? d[f - 1] : 0, m = d[f], n = l; g < this.T.length && this.T[g] <= m; ) {
                    var p = w(this.Ub[g]).toString();
                    void 0 !== c[p] ? (n !== l && this.drawElements(a, b, n, l),
                    l = n = g === this.T.length - 1 ? m : this.T[g + 1]) : l = g === this.T.length - 1 ? m : this.T[g + 1];
                    g++
                }
                n !== l && this.drawElements(a, b, n, l)
            }
    }
    ;
    h.Kl = function(a, b, c, d, e) {
        var f, g, k = this.T.length - 1, l = this.Zo();
        for (f = l.length - 1; 0 <= f; --f) {
            a.bindTexture(3553, l[f]);
            var m = 0 < f ? this.ei[f - 1] : 0;
            for (g = this.ei[f]; 0 <= k && this.T[k] >= m; ) {
                var n = this.T[k];
                var p = this.Ub[k];
                var q = w(p).toString();
                if (void 0 === c[q] && p.I() && (void 0 === e || vb(e, p.I().c())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT),
                this.drawElements(a, b, n, g),
                g = d(p)))
                    return g;
                g = n;
                k--
            }
        }
    }
    ;
    h.finish = function() {
        this.imageWidth = this.imageHeight = this.height = this.ul = this.tl = void 0;
        this.i = null;
        this.scale = this.rotation = this.rotateWithView = this.Sm = this.Rm = this.opacity = void 0;
        this.G = null;
        this.width = void 0
    }
    ;
    function Pi(a, b) {
        Mi.call(this, a, b);
        this.kc = [];
        this.Ug = [];
        this.sh = [];
        this.sp = []
    }
    v(Pi, Mi);
    h = Pi.prototype;
    h.Hf = function(a, b) {
        this.T.push(this.i.length);
        this.Ub.push(b);
        b = a.X();
        Ni(this, b, 0, b.length, a.oa())
    }
    ;
    h.Jf = function(a, b) {
        this.T.push(this.i.length);
        this.Ub.push(b);
        b = a.X();
        Ni(this, b, 0, b.length, a.oa())
    }
    ;
    h.finish = function(a) {
        var b = a.sa;
        this.$h.push(this.i.length);
        this.ei.push(this.i.length);
        this.Ie = new xi(this.G);
        this.le = new xi(this.i);
        var c = {};
        Oi(this.sh, this.kc, c, b);
        Oi(this.sp, this.Ug, c, b);
        this.Ug = this.kc = null;
        Mi.prototype.finish.call(this, a)
    }
    ;
    h.ye = function(a) {
        var b = a.Hg()
          , c = a.N(1)
          , d = a.Tl()
          , e = a.Dj(1)
          , f = a.tb()
          , g = a.ic()
          , k = a.Db
          , l = a.ma()
          , m = a.Ga();
        a = a.Ma;
        if (0 === this.kc.length)
            this.kc.push(c);
        else {
            var n = this.kc[this.kc.length - 1];
            w(n) != w(c) && (this.$h.push(this.i.length),
            this.kc.push(c))
        }
        0 === this.Ug.length ? this.Ug.push(e) : (n = this.Ug[this.Ug.length - 1],
        w(n) != w(e) && (this.ei.push(this.i.length),
        this.Ug.push(e)));
        this.tl = b[0];
        this.ul = b[1];
        this.height = m[1];
        this.imageHeight = d[1];
        this.imageWidth = d[0];
        this.opacity = f;
        this.Rm = g[0];
        this.Sm = g[1];
        this.rotation = l;
        this.rotateWithView = k;
        this.scale = a;
        this.width = m[0]
    }
    ;
    h.hp = function(a) {
        return a ? this.sh.concat(this.sp) : this.sh
    }
    ;
    h.Zo = function() {
        return this.sp
    }
    ;
    function Qi(a, b, c, d) {
        var e = c - d;
        return a[b] === a[e] && a[b + 1] === a[e + 1] && 3 < (c - b) / d ? !!xf(a, b, c, d) : !1
    }
    ;function Ri() {
        this.da = "precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n"
    }
    v(Ri, ii);
    var Si = new Ri;
    function Ti() {
        this.da = "varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n"
    }
    v(Ti, ji);
    var Ui = new Ti;
    function Vi(a, b) {
        this.Qq = a.getUniformLocation(b, "u_color");
        this.Rq = a.getUniformLocation(b, "u_lineWidth");
        this.wB = a.getUniformLocation(b, "u_miterLimit");
        this.In = a.getUniformLocation(b, "u_offsetRotateMatrix");
        this.Jn = a.getUniformLocation(b, "u_offsetScaleMatrix");
        this.Ni = a.getUniformLocation(b, "u_opacity");
        this.Sq = a.getUniformLocation(b, "u_pixelRatio");
        this.Oi = a.getUniformLocation(b, "u_projectionMatrix");
        this.Tq = a.getUniformLocation(b, "u_size");
        this.fo = a.getAttribLocation(b, "a_direction");
        this.io = a.getAttribLocation(b, "a_lastPos");
        this.jo = a.getAttribLocation(b, "a_nextPos");
        this.lb = a.getAttribLocation(b, "a_position")
    }
    ;function Wi(a, b) {
        ri.call(this, a, b);
        this.fb = null;
        this.ab = [];
        this.Aa = [];
        this.u = {
            strokeColor: null,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: void 0,
            miterLimit: void 0,
            a: !1
        }
    }
    v(Wi, ri);
    h = Wi.prototype;
    h.kd = function(a, b, c, d) {
        var e, f = this.G.length, g = this.i.length, k = "bevel" === this.u.lineJoin ? 0 : "miter" === this.u.lineJoin ? 1 : 2, l = "butt" === this.u.lineCap ? 0 : "square" === this.u.lineCap ? 1 : 2, m = Qi(a, b, c, d), n = g, p = 1;
        for (e = b; e < c; e += d) {
            var q = f / 7;
            var t = u;
            var u = x || [a[e], a[e + 1]];
            if (e === b) {
                var x = [a[e + d], a[e + d + 1]];
                if (c - b === 2 * d && wa(u, x))
                    break;
                if (m) {
                    t = [a[c - 2 * d], a[c - 2 * d + 1]];
                    var B = x
                } else {
                    l && (f = Xi(this, [0, 0], u, x, p * Yi * l, f),
                    f = Xi(this, [0, 0], u, x, -p * Yi * l, f),
                    this.i[g++] = q + 2,
                    this.i[g++] = q,
                    this.i[g++] = q + 1,
                    this.i[g++] = q + 1,
                    this.i[g++] = q + 3,
                    this.i[g++] = q + 2);
                    f = Xi(this, [0, 0], u, x, p * Zi * (l || 1), f);
                    f = Xi(this, [0, 0], u, x, -p * Zi * (l || 1), f);
                    n = f / 7 - 1;
                    continue
                }
            } else if (e === c - d) {
                m ? x = B : (t = t || [0, 0],
                f = Xi(this, t, u, [0, 0], p * $i * (l || 1), f),
                f = Xi(this, t, u, [0, 0], -p * $i * (l || 1), f),
                this.i[g++] = q,
                this.i[g++] = n - 1,
                this.i[g++] = n,
                this.i[g++] = n,
                this.i[g++] = q + 1,
                this.i[g++] = q,
                l && (f = Xi(this, t, u, [0, 0], p * aj * l, f),
                f = Xi(this, t, u, [0, 0], -p * aj * l, f),
                this.i[g++] = q + 2,
                this.i[g++] = q,
                this.i[g++] = q + 1,
                this.i[g++] = q + 1,
                this.i[g++] = q + 3,
                this.i[g++] = q + 2));
                break
            } else
                x = [a[e + d], a[e + d + 1]];
            var z = vi(t[0], t[1], u[0], u[1], x[0], x[1]) ? -1 : 1;
            f = Xi(this, t, u, x, z * bj * (k || 1), f);
            f = Xi(this, t, u, x, z * cj * (k || 1), f);
            f = Xi(this, t, u, x, -z * dj * (k || 1), f);
            e > b && (this.i[g++] = q,
            this.i[g++] = n - 1,
            this.i[g++] = n,
            this.i[g++] = q + 2,
            this.i[g++] = q,
            this.i[g++] = 0 < p * z ? n : n - 1);
            this.i[g++] = q;
            this.i[g++] = q + 2;
            this.i[g++] = q + 1;
            n = q + 2;
            p = z;
            k && (f = Xi(this, t, u, x, z * ej * k, f),
            this.i[g++] = q + 1,
            this.i[g++] = q + 3,
            this.i[g++] = q)
        }
        m && (q = q || f / 7,
        z = Vf([t[0], t[1], u[0], u[1], x[0], x[1]], 0, 6, 2) ? 1 : -1,
        f = Xi(this, t, u, x, z * bj * (k || 1), f),
        Xi(this, t, u, x, -z * dj * (k || 1), f),
        this.i[g++] = q,
        this.i[g++] = n - 1,
        this.i[g++] = n,
        this.i[g++] = q + 1,
        this.i[g++] = q,
        this.i[g++] = 0 < p * z ? n : n - 1)
    }
    ;
    function Xi(a, b, c, d, e, f) {
        a.G[f++] = b[0];
        a.G[f++] = b[1];
        a.G[f++] = c[0];
        a.G[f++] = c[1];
        a.G[f++] = d[0];
        a.G[f++] = d[1];
        a.G[f++] = e;
        return f
    }
    function fj(a, b, c, d) {
        c -= b;
        return c < 2 * d ? !1 : c === 2 * d ? !wa([a[b], a[b + 1]], [a[b + d], a[b + d + 1]]) : !0
    }
    h.Ff = function(a, b) {
        var c = a.X();
        a = a.oa();
        fj(c, 0, c.length, a) && (c = sf(c, 0, c.length, a, -this.origin[0], -this.origin[1]),
        this.u.a && (this.Aa.push(this.i.length),
        this.u.a = !1),
        this.T.push(this.i.length),
        this.Ub.push(b),
        this.kd(c, 0, c.length, a))
    }
    ;
    h.Gf = function(a, b) {
        var c = this.i.length
          , d = a.U;
        d.unshift(0);
        var e = a.X();
        a = a.oa();
        var f;
        if (1 < d.length) {
            var g = 1;
            for (f = d.length; g < f; ++g)
                if (fj(e, d[g - 1], d[g], a)) {
                    var k = sf(e, d[g - 1], d[g], a, -this.origin[0], -this.origin[1]);
                    this.kd(k, 0, k.length, a)
                }
        }
        this.i.length > c && (this.T.push(c),
        this.Ub.push(b),
        this.u.a && (this.Aa.push(c),
        this.u.a = !1))
    }
    ;
    function gj(a, b, c, d) {
        Qi(b, 0, b.length, d) || (b.push(b[0]),
        b.push(b[1]));
        a.kd(b, 0, b.length, d);
        if (c.length) {
            var e;
            b = 0;
            for (e = c.length; b < e; ++b)
                Qi(c[b], 0, c[b].length, d) || (c[b].push(c[b][0]),
                c[b].push(c[b][1])),
                a.kd(c[b], 0, c[b].length, d)
        }
    }
    function hj(a, b, c) {
        c = void 0 === c ? a.i.length : c;
        a.T.push(c);
        a.Ub.push(b);
        a.u.a && (a.Aa.push(c),
        a.u.a = !1)
    }
    h.finish = function() {
        this.Ie = new xi(this.G);
        this.le = new xi(this.i);
        this.T.push(this.i.length);
        0 === this.Aa.length && 0 < this.ab.length && (this.ab = []);
        this.i = this.G = null
    }
    ;
    h.Vb = function(a) {
        var b = this.Ie
          , c = this.le;
        return function() {
            a.deleteBuffer(b);
            a.deleteBuffer(c)
        }
    }
    ;
    h.pn = function(a, b, c, d) {
        var e = Ai(b, Si, Ui);
        if (this.fb)
            var f = this.fb;
        else
            this.fb = f = new Vi(a,e);
        b.useProgram(e);
        a.enableVertexAttribArray(f.io);
        a.vertexAttribPointer(f.io, 2, 5126, !1, 28, 0);
        a.enableVertexAttribArray(f.lb);
        a.vertexAttribPointer(f.lb, 2, 5126, !1, 28, 8);
        a.enableVertexAttribArray(f.jo);
        a.vertexAttribPointer(f.jo, 2, 5126, !1, 28, 16);
        a.enableVertexAttribArray(f.fo);
        a.vertexAttribPointer(f.fo, 1, 5126, !1, 28, 24);
        a.uniform2fv(f.Tq, c);
        a.uniform1f(f.Sq, d);
        return f
    }
    ;
    h.qn = function(a, b) {
        a.disableVertexAttribArray(b.io);
        a.disableVertexAttribArray(b.lb);
        a.disableVertexAttribArray(b.jo);
        a.disableVertexAttribArray(b.fo)
    }
    ;
    h.pj = function(a, b, c, d) {
        var e = a.getParameter(a.DEPTH_FUNC)
          , f = a.getParameter(a.DEPTH_WRITEMASK);
        d || (a.enable(a.DEPTH_TEST),
        a.depthMask(!0),
        a.depthFunc(a.NOTEQUAL));
        if (Bb(c)) {
            var g = this.T[this.T.length - 1];
            for (c = this.Aa.length - 1; 0 <= c; --c) {
                var k = this.Aa[c];
                var l = this.ab[c];
                this.ze(a, l[0], l[1], l[2]);
                this.drawElements(a, b, k, g);
                a.clear(a.DEPTH_BUFFER_BIT);
                g = k
            }
        } else
            this.qj(a, b, c);
        d || (a.disable(a.DEPTH_TEST),
        a.clear(a.DEPTH_BUFFER_BIT),
        a.depthMask(f),
        a.depthFunc(e))
    }
    ;
    h.qj = function(a, b, c) {
        var d, e;
        var f = this.T.length - 2;
        var g = e = this.T[f + 1];
        for (d = this.Aa.length - 1; 0 <= d; --d) {
            var k = this.ab[d];
            this.ze(a, k[0], k[1], k[2]);
            for (k = this.Aa[d]; 0 <= f && this.T[f] >= k; ) {
                var l = this.T[f];
                var m = this.Ub[f];
                m = w(m).toString();
                c[m] && (e !== g && (this.drawElements(a, b, e, g),
                a.clear(a.DEPTH_BUFFER_BIT)),
                g = l);
                f--;
                e = l
            }
            e !== g && (this.drawElements(a, b, e, g),
            a.clear(a.DEPTH_BUFFER_BIT));
            e = g = k
        }
    }
    ;
    h.Kl = function(a, b, c, d, e) {
        var f, g;
        var k = this.T.length - 2;
        var l = this.T[k + 1];
        for (f = this.Aa.length - 1; 0 <= f; --f) {
            var m = this.ab[f];
            this.ze(a, m[0], m[1], m[2]);
            for (g = this.Aa[f]; 0 <= k && this.T[k] >= g; ) {
                m = this.T[k];
                var n = this.Ub[k];
                var p = w(n).toString();
                if (void 0 === c[p] && n.I() && (void 0 === e || vb(e, n.I().c())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT),
                this.drawElements(a, b, m, l),
                l = d(n)))
                    return l;
                k--;
                l = m
            }
        }
    }
    ;
    h.ze = function(a, b, c, d) {
        a.uniform4fv(this.fb.Qq, b);
        a.uniform1f(this.fb.Rq, c);
        a.uniform1f(this.fb.wB, d)
    }
    ;
    h.kb = function(a, b) {
        a = b.Zc;
        this.u.lineCap = void 0 !== a ? a : "round";
        a = b.getLineDash();
        this.u.lineDash = a ? a : ti;
        a = b.Ac;
        this.u.lineDashOffset = a ? a : 0;
        a = b.$c;
        this.u.lineJoin = void 0 !== a ? a : "round";
        a = b.W;
        a = a instanceof CanvasGradient || a instanceof CanvasPattern ? ui : kd(a).map(function(a, b) {
            return 3 != b ? a / 255 : a
        }) || ui;
        var c = b.Sb();
        c = void 0 !== c ? c : 1;
        b = b.ad;
        b = void 0 !== b ? b : 10;
        this.u.strokeColor && wa(this.u.strokeColor, a) && this.u.lineWidth === c && this.u.miterLimit === b || (this.u.a = !0,
        this.u.strokeColor = a,
        this.u.lineWidth = c,
        this.u.miterLimit = b,
        this.ab.push([a, c, b]))
    }
    ;
    var Zi = 3
      , $i = 5
      , Yi = 7
      , aj = 11
      , bj = 13
      , cj = 17
      , dj = 19
      , ej = 23;
    function ij() {
        this.da = "precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n"
    }
    v(ij, ii);
    var jj = new ij;
    function kj() {
        this.da = "\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n"
    }
    v(kj, ji);
    var lj = new kj;
    function mj(a, b) {
        this.Qq = a.getUniformLocation(b, "u_color");
        this.In = a.getUniformLocation(b, "u_offsetRotateMatrix");
        this.Jn = a.getUniformLocation(b, "u_offsetScaleMatrix");
        this.Ni = a.getUniformLocation(b, "u_opacity");
        this.Oi = a.getUniformLocation(b, "u_projectionMatrix");
        this.lb = a.getAttribLocation(b, "a_position")
    }
    ;function nj(a) {
        a = a || {};
        this.W = void 0 !== a.color ? a.color : null;
        this.Zc = a.lineCap;
        this.Dm = void 0 !== a.lineDash ? a.lineDash : null;
        this.Ac = a.lineDashOffset;
        this.$c = a.lineJoin;
        this.ad = a.miterLimit;
        this.ae = a.width;
        this.mb = void 0
    }
    h = nj.prototype;
    h.clone = function() {
        var a = this.W;
        return new nj({
            color: a && a.slice ? a.slice() : a || void 0,
            lineCap: this.Zc,
            lineDash: this.getLineDash() ? this.getLineDash().slice() : void 0,
            lineDashOffset: this.Ac,
            lineJoin: this.$c,
            miterLimit: this.ad,
            width: this.Sb()
        })
    }
    ;
    h.Aj = function() {
        return this.W
    }
    ;
    h.ox = function() {
        return this.Zc
    }
    ;
    h.getLineDash = function() {
        return this.Dm
    }
    ;
    h.px = function() {
        return this.Ac
    }
    ;
    h.qx = function() {
        return this.$c
    }
    ;
    h.wx = function() {
        return this.ad
    }
    ;
    h.Sb = function() {
        return this.ae
    }
    ;
    h.vq = function(a) {
        this.W = a;
        this.mb = void 0
    }
    ;
    h.NA = function(a) {
        this.Zc = a;
        this.mb = void 0
    }
    ;
    h.setLineDash = function(a) {
        this.Dm = a;
        this.mb = void 0
    }
    ;
    h.OA = function(a) {
        this.Ac = a;
        this.mb = void 0
    }
    ;
    h.PA = function(a) {
        this.$c = a;
        this.mb = void 0
    }
    ;
    h.SA = function(a) {
        this.ad = a;
        this.mb = void 0
    }
    ;
    h.XA = function(a) {
        this.ae = a;
        this.mb = void 0
    }
    ;
    h.zj = function() {
        void 0 === this.mb && (this.mb = "s",
        this.mb = this.W ? "string" === typeof this.W ? this.mb + this.W : this.mb + w(this.W).toString() : this.mb + "-",
        this.mb += "," + (void 0 !== this.Zc ? this.Zc.toString() : "-") + "," + (this.Dm ? this.Dm.toString() : "-") + "," + (void 0 !== this.Ac ? this.Ac : "-") + "," + (void 0 !== this.$c ? this.$c : "-") + "," + (void 0 !== this.ad ? this.ad.toString() : "-") + "," + (void 0 !== this.ae ? this.ae.toString() : "-"));
        return this.mb
    }
    ;
    function oj(a) {
        this.ga = this.Yc = this.md = void 0;
        this.Pr = void 0 === a ? !0 : a;
        this.df = 0
    }
    oj.prototype.removeItem = function() {
        var a = this.ga;
        if (a) {
            var b = a.next
              , c = a.cd;
            b && (b.cd = c);
            c && (c.next = b);
            this.ga = b || c;
            this.md === this.Yc ? this.Yc = this.md = this.ga = void 0 : this.md === a ? this.md = this.ga : this.Yc === a && (this.Yc = c ? this.ga.cd : this.ga);
            this.df--
        }
    }
    ;
    function pj(a) {
        a.ga = a.md;
        if (a.ga)
            return a.ga.data
    }
    function qj(a) {
        if (a.ga && a.ga.next)
            return a.ga = a.ga.next,
            a.ga.data
    }
    function rj(a) {
        if (a.ga && a.ga.next)
            return a.ga.next.data
    }
    function sj(a) {
        if (a.ga && a.ga.cd)
            return a.ga = a.ga.cd,
            a.ga.data
    }
    function tj(a) {
        if (a.ga && a.ga.cd)
            return a.ga.cd.data
    }
    function uj(a) {
        if (a.ga)
            return a.ga.data
    }
    oj.prototype.concat = function(a) {
        if (a.ga) {
            if (this.ga) {
                var b = this.ga.next;
                this.ga.next = a.md;
                a.md.cd = this.ga;
                b.cd = a.Yc;
                a.Yc.next = b;
                this.df += a.df
            } else
                this.ga = a.ga,
                this.md = a.md,
                this.Yc = a.Yc,
                this.df = a.df;
            a.ga = void 0;
            a.md = void 0;
            a.Yc = void 0;
            a.df = 0
        }
    }
    ;
    oj.prototype.Wb = function() {
        return this.df
    }
    ;
    var vj = {
        uk: function() {}
    };
    (function(a) {
        function b(a, e, f, g, k) {
            f = f || 0;
            g = g || a.length - 1;
            for (k = k || d; g > f; ) {
                if (600 < g - f) {
                    var l = g - f + 1
                      , m = e - f + 1
                      , n = Math.log(l)
                      , p = .5 * Math.exp(2 * n / 3);
                    n = .5 * Math.sqrt(n * p * (l - p) / l) * (0 > m - l / 2 ? -1 : 1);
                    b(a, e, Math.max(f, Math.floor(e - m * p / l + n)), Math.min(g, Math.floor(e + (l - m) * p / l + n)), k)
                }
                l = a[e];
                m = f;
                p = g;
                c(a, f, e);
                for (0 < k(a[g], l) && c(a, f, g); m < p; ) {
                    c(a, m, p);
                    m++;
                    for (p--; 0 > k(a[m], l); )
                        m++;
                    for (; 0 < k(a[p], l); )
                        p--
                }
                0 === k(a[f], l) ? c(a, f, p) : (p++,
                c(a, p, g));
                p <= e && (f = p + 1);
                e <= p && (g = p - 1)
            }
        }
        function c(a, b, c) {
            var d = a[b];
            a[b] = a[c];
            a[c] = d
        }
        function d(a, b) {
            return a < b ? -1 : a > b ? 1 : 0
        }
        function e(a, b) {
            if (!(this instanceof e))
                return new e(a,b);
            this.eo = Math.max(4, a || 9);
            this.wr = Math.max(2, Math.ceil(.4 * this.eo));
            b && this.Tv(b);
            this.clear()
        }
        function f(a, b) {
            g(a, 0, a.children.length, b, a)
        }
        function g(a, b, c, d, e) {
            e || (e = u(null));
            e.ba = Infinity;
            e.ca = Infinity;
            e.ea = -Infinity;
            e.fa = -Infinity;
            for (var f; b < c; b++)
                f = a.children[b],
                k(e, a.lc ? d(f) : f);
            return e
        }
        function k(a, b) {
            a.ba = Math.min(a.ba, b.ba);
            a.ca = Math.min(a.ca, b.ca);
            a.ea = Math.max(a.ea, b.ea);
            a.fa = Math.max(a.fa, b.fa)
        }
        function l(a, b) {
            return a.ba - b.ba
        }
        function m(a, b) {
            return a.ca - b.ca
        }
        function n(a) {
            return (a.ea - a.ba) * (a.fa - a.ca)
        }
        function p(a) {
            return a.ea - a.ba + (a.fa - a.ca)
        }
        function q(a, b) {
            return a.ba <= b.ba && a.ca <= b.ca && b.ea <= a.ea && b.fa <= a.fa
        }
        function t(a, b) {
            return b.ba <= a.ea && b.ca <= a.fa && b.ea >= a.ba && b.fa >= a.ca
        }
        function u(a) {
            return {
                children: a,
                height: 1,
                lc: !0,
                ba: Infinity,
                ca: Infinity,
                ea: -Infinity,
                fa: -Infinity
            }
        }
        function x(a, b, c, d, e) {
            for (var f = [b, c], g; f.length; )
                c = f.pop(),
                b = f.pop(),
                c - b <= d || (g = b + Math.ceil((c - b) / d / 2) * d,
                B(a, g, b, c, e),
                f.push(b, g, g, c))
        }
        var B = b;
        e.prototype = {
            all: function() {
                return this.rr(this.data, [])
            },
            search: function(a) {
                var b = this.data
                  , c = []
                  , d = this.hd;
                if (!t(a, b))
                    return c;
                for (var e = [], f, g, k, l; b; ) {
                    f = 0;
                    for (g = b.children.length; f < g; f++)
                        k = b.children[f],
                        l = b.lc ? d(k) : k,
                        t(a, l) && (b.lc ? c.push(k) : q(a, l) ? this.rr(k, c) : e.push(k));
                    b = e.pop()
                }
                return c
            },
            load: function(a) {
                if (!a || !a.length)
                    return this;
                if (a.length < this.wr) {
                    for (var b = 0, c = a.length; b < c; b++)
                        this.Pa(a[b]);
                    return this
                }
                a = this.tr(a.slice(), 0, a.length - 1, 0);
                this.data.children.length ? this.data.height === a.height ? this.yr(this.data, a) : (this.data.height < a.height && (b = this.data,
                this.data = a,
                a = b),
                this.vr(a, this.data.height - a.height - 1, !0)) : this.data = a;
                return this
            },
            Pa: function(a) {
                a && this.vr(a, this.data.height - 1);
                return this
            },
            clear: function() {
                this.data = u([]);
                return this
            },
            remove: function(a, b) {
                if (!a)
                    return this;
                for (var c = this.data, d = this.hd(a), e = [], f = [], g, k, l, m; c || e.length; ) {
                    c || (c = e.pop(),
                    k = e[e.length - 1],
                    g = f.pop(),
                    m = !0);
                    if (c.lc) {
                        a: {
                            l = a;
                            var n = c.children
                              , p = b;
                            if (p) {
                                for (var t = 0; t < n.length; t++)
                                    if (p(l, n[t])) {
                                        l = t;
                                        break a
                                    }
                                l = -1
                            } else
                                l = n.indexOf(l)
                        }
                        if (-1 !== l) {
                            c.children.splice(l, 1);
                            e.push(c);
                            this.Rv(e);
                            break
                        }
                    }
                    m || c.lc || !q(c, d) ? k ? (g++,
                    c = k.children[g],
                    m = !1) : c = null : (e.push(c),
                    f.push(g),
                    g = 0,
                    k = c,
                    c = c.children[0])
                }
                return this
            },
            hd: function(a) {
                return a
            },
            so: l,
            to: m,
            toJSON: function() {
                return this.data
            },
            rr: function(a, b) {
                for (var c = []; a; )
                    a.lc ? b.push.apply(b, a.children) : c.push.apply(c, a.children),
                    a = c.pop();
                return b
            },
            tr: function(a, b, c, d) {
                var e = c - b + 1
                  , g = this.eo;
                if (e <= g) {
                    var k = u(a.slice(b, c + 1));
                    f(k, this.hd);
                    return k
                }
                d || (d = Math.ceil(Math.log(e) / Math.log(g)),
                g = Math.ceil(e / Math.pow(g, d - 1)));
                k = u([]);
                k.lc = !1;
                k.height = d;
                e = Math.ceil(e / g);
                g = e * Math.ceil(Math.sqrt(g));
                var l;
                for (x(a, b, c, g, this.so); b <= c; b += g) {
                    var m = Math.min(b + g - 1, c);
                    x(a, b, m, e, this.to);
                    for (l = b; l <= m; l += e) {
                        var n = Math.min(l + e - 1, m);
                        k.children.push(this.tr(a, l, n, d - 1))
                    }
                }
                f(k, this.hd);
                return k
            },
            Qv: function(a, b, c, d) {
                for (var e, f, g, k, l, m, p, q; ; ) {
                    d.push(b);
                    if (b.lc || d.length - 1 === c)
                        break;
                    p = q = Infinity;
                    e = 0;
                    for (f = b.children.length; e < f; e++)
                        g = b.children[e],
                        l = n(g),
                        m = (Math.max(g.ea, a.ea) - Math.min(g.ba, a.ba)) * (Math.max(g.fa, a.fa) - Math.min(g.ca, a.ca)) - l,
                        m < q ? (q = m,
                        p = l < p ? l : p,
                        k = g) : m === q && l < p && (p = l,
                        k = g);
                    b = k || b.children[0]
                }
                return b
            },
            vr: function(a, b, c) {
                var d = this.hd;
                c = c ? a : d(a);
                d = [];
                var e = this.Qv(c, this.data, b, d);
                e.children.push(a);
                for (k(e, c); 0 <= b; )
                    if (d[b].children.length > this.eo)
                        this.Yv(d, b),
                        b--;
                    else
                        break;
                this.Nv(c, d, b)
            },
            Yv: function(a, b) {
                var c = a[b]
                  , d = c.children.length
                  , e = this.wr;
                this.Ov(c, e, d);
                d = this.Pv(c, e, d);
                d = u(c.children.splice(d, c.children.length - d));
                d.height = c.height;
                d.lc = c.lc;
                f(c, this.hd);
                f(d, this.hd);
                b ? a[b - 1].children.push(d) : this.yr(c, d)
            },
            yr: function(a, b) {
                this.data = u([a, b]);
                this.data.height = a.height + 1;
                this.data.lc = !1;
                f(this.data, this.hd)
            },
            Pv: function(a, b, c) {
                var d, e;
                var f = e = Infinity;
                for (d = b; d <= c - b; d++) {
                    var k = g(a, 0, d, this.hd);
                    var l = g(a, d, c, this.hd);
                    var m = Math.max(0, Math.min(k.ea, l.ea) - Math.max(k.ba, l.ba)) * Math.max(0, Math.min(k.fa, l.fa) - Math.max(k.ca, l.ca));
                    k = n(k) + n(l);
                    if (m < f) {
                        f = m;
                        var p = d;
                        e = k < e ? k : e
                    } else
                        m === f && k < e && (e = k,
                        p = d)
                }
                return p
            },
            Ov: function(a, b, c) {
                var d = a.lc ? this.so : l
                  , e = a.lc ? this.to : m
                  , f = this.sr(a, b, c, d);
                b = this.sr(a, b, c, e);
                f < b && a.children.sort(d)
            },
            sr: function(a, b, c, d) {
                a.children.sort(d);
                d = this.hd;
                var e = g(a, 0, b, d), f = g(a, c - b, c, d), l = p(e) + p(f), m;
                for (m = b; m < c - b; m++) {
                    var n = a.children[m];
                    k(e, a.lc ? d(n) : n);
                    l += p(e)
                }
                for (m = c - b - 1; m >= b; m--)
                    n = a.children[m],
                    k(f, a.lc ? d(n) : n),
                    l += p(f);
                return l
            },
            Nv: function(a, b, c) {
                for (; 0 <= c; c--)
                    k(b[c], a)
            },
            Rv: function(a) {
                for (var b = a.length - 1, c; 0 <= b; b--)
                    0 === a[b].children.length ? 0 < b ? (c = a[b - 1].children,
                    c.splice(c.indexOf(a[b]), 1)) : this.clear() : f(a[b], this.hd)
            },
            Tv: function(a) {
                var b = ["return a", " - b", ";"];
                this.so = new Function("a","b",b.join(a[0]));
                this.to = new Function("a","b",b.join(a[1]));
                this.hd = new Function("a","return {minX: a" + a[0] + ", minY: a" + a[1] + ", maxX: a" + a[2] + ", maxY: a" + a[3] + "};")
            }
        };
        a["default"] = e
    }
    )(vj.uk = vj.uk || {});
    vj.uk = vj.uk.default;
    function wj(a) {
        this.gf = vj.uk(a);
        this.me = {}
    }
    h = wj.prototype;
    h.Pa = function(a, b) {
        a = {
            ba: a[0],
            ca: a[1],
            ea: a[2],
            fa: a[3],
            value: b
        };
        this.gf.Pa(a);
        this.me[w(b)] = a
    }
    ;
    h.load = function(a, b) {
        for (var c = Array(b.length), d = 0, e = b.length; d < e; d++) {
            var f = a[d]
              , g = b[d];
            f = {
                ba: f[0],
                ca: f[1],
                ea: f[2],
                fa: f[3],
                value: g
            };
            c[d] = f;
            this.me[w(g)] = f
        }
        this.gf.load(c)
    }
    ;
    h.remove = function(a) {
        a = w(a);
        var b = this.me[a];
        delete this.me[a];
        return null !== this.gf.remove(b)
    }
    ;
    h.update = function(a, b) {
        var c = this.me[w(b)];
        hb([c.ba, c.ca, c.ea, c.fa], a) || (this.remove(b),
        this.Pa(a, b))
    }
    ;
    h.getAll = function() {
        return this.gf.all().map(function(a) {
            return a.value
        })
    }
    ;
    function xj(a, b) {
        return a.gf.search({
            ba: b[0],
            ca: b[1],
            ea: b[2],
            fa: b[3]
        }).map(function(a) {
            return a.value
        })
    }
    h.forEach = function(a, b) {
        return yj(this.getAll(), a, b)
    }
    ;
    function zj(a, b, c, d) {
        return yj(xj(a, b), c, d)
    }
    function yj(a, b, c) {
        for (var d, e = 0, f = a.length; e < f && !(d = b.call(c, a[e])); e++)
            ;
        return d
    }
    h.Nd = function() {
        return Bb(this.me)
    }
    ;
    h.clear = function() {
        this.gf.clear();
        this.me = {}
    }
    ;
    h.c = function(a) {
        var b = this.gf.data;
        return cb(b.ba, b.ca, b.ea, b.fa, a)
    }
    ;
    h.concat = function(a) {
        this.gf.load(a.gf.all());
        for (var b in a.me)
            this.me[b | 0] = a.me[b | 0]
    }
    ;
    function Aj(a, b) {
        ri.call(this, a, b);
        this.Bc = new Wi(a,b);
        this.fb = null;
        this.ab = [];
        this.Aa = [];
        this.u = {
            fillColor: null,
            a: !1
        }
    }
    v(Aj, ri);
    h = Aj.prototype;
    h.kd = function(a, b, c) {
        var d = new oj
          , e = new wj;
        Bj(this, a, c, d, e, !0);
        a = Cj(d);
        if (b.length) {
            var f, g = [];
            var k = 0;
            for (f = b.length; k < f; ++k) {
                var l = {
                    list: new oj,
                    Yf: void 0,
                    rq: new wj
                };
                g.push(l);
                Bj(this, b[k], c, l.list, l.rq, !1);
                Dj(l.list, l.rq, !0);
                l.Yf = Cj(l.list)
            }
            g.sort(function(a, b) {
                return b.Yf[0] === a.Yf[0] ? a.Yf[1] - b.Yf[1] : b.Yf[0] - a.Yf[0]
            });
            for (k = 0; k < g.length; ++k) {
                b = g[k].list;
                f = c = pj(b);
                do {
                    if (Ej(f, e).length) {
                        var m = !0;
                        break
                    }
                    f = qj(b)
                } while (c !== f);!m && Fj(b, g[k].Yf[0], d, a[0], e) && (e.concat(g[k].rq),
                Dj(d, e, !1))
            }
        } else
            Dj(d, e, !1);
        Gj(this, d, e)
    }
    ;
    function Bj(a, b, c, d, e, f) {
        var g, k = a.G.length / 2, l = [], m = [];
        if (f === Vf(b, 0, b.length, c)) {
            var n = f = Hj(a, b[0], b[1], k++);
            var p = c;
            for (g = b.length; p < g; p += c) {
                var q = Hj(a, b[p], b[p + 1], k++);
                m.push(Ij(n, q, d));
                l.push([Math.min(n.x, q.x), Math.min(n.y, q.y), Math.max(n.x, q.x), Math.max(n.y, q.y)]);
                n = q
            }
        } else
            for (p = b.length - c,
            n = f = Hj(a, b[p], b[p + 1], k++),
            p -= c,
            g = 0; p >= g; p -= c)
                q = Hj(a, b[p], b[p + 1], k++),
                m.push(Ij(n, q, d)),
                l.push([Math.min(n.x, q.x), Math.min(n.y, q.y), Math.max(n.x, q.x), Math.max(n.y, q.y)]),
                n = q;
        m.push(Ij(q, f, d));
        l.push([Math.min(n.x, q.x), Math.min(n.y, q.y), Math.max(n.x, q.x), Math.max(n.y, q.y)]);
        e.load(l, m)
    }
    function Cj(a) {
        var b = pj(a)
          , c = b
          , d = [c.P.x, c.P.y];
        do
            c = qj(a),
            c.P.x > d[0] && (d = [c.P.x, c.P.y]);
        while (c !== b);return d
    }
    function Dj(a, b, c) {
        var d = pj(a)
          , e = d
          , f = qj(a)
          , g = !1;
        do {
            var k = c ? vi(f.L.x, f.L.y, e.L.x, e.L.y, e.P.x, e.P.y) : vi(e.P.x, e.P.y, e.L.x, e.L.y, f.L.x, f.L.y);
            void 0 === k ? (Jj(e, f, a, b),
            g = !0,
            f === d && (d = rj(a)),
            f = e,
            sj(a)) : e.L.yd !== k && (e.L.yd = k,
            g = !0);
            e = f;
            f = qj(a)
        } while (e !== d);return g
    }
    function Fj(a, b, c, d, e) {
        for (var f = pj(a); f.L.x !== b; )
            f = qj(a);
        b = f.L;
        d = {
            x: d,
            y: b.y,
            jc: -1
        };
        var g = Infinity, k;
        var l = Ej({
            P: b,
            L: d
        }, e, !0);
        var m = 0;
        for (k = l.length; m < k; ++m) {
            var n = l[m]
              , p = Kj(b, d, n.P, n.L, !0)
              , q = Math.abs(b.x - p[0]);
            if (q < g && void 0 !== vi(b.x, b.y, n.P.x, n.P.y, n.L.x, n.L.y)) {
                g = q;
                var t = {
                    x: p[0],
                    y: p[1],
                    jc: -1
                };
                f = n
            }
        }
        if (Infinity === g)
            return !1;
        l = f.L;
        if (0 < g && (f = Lj(b, t, f.L, e),
        f.length))
            for (t = Infinity,
            m = 0,
            k = f.length; m < k; ++m)
                if (g = f[m],
                n = Math.atan2(b.y - g.y, d.x - g.x),
                n < t || n === t && g.x < l.x)
                    t = n,
                    l = g;
        for (f = pj(c); f.L.x !== l.x || f.L.y !== l.y; )
            f = qj(c);
        d = {
            x: b.x,
            y: b.y,
            jc: b.jc,
            yd: void 0
        };
        m = {
            x: f.L.x,
            y: f.L.y,
            jc: f.L.jc,
            yd: void 0
        };
        rj(a).P = d;
        Ij(b, f.L, a, e);
        Ij(m, d, a, e);
        f.L = m;
        a.Pr && a.ga && (a.md = a.ga,
        a.Yc = a.ga.cd);
        c.concat(a);
        return !0
    }
    function Gj(a, b, c) {
        for (var d = !1, e = Mj(b, c); 3 < b.Wb(); )
            if (e) {
                if (!Nj(a, b, c, e, d) && !Dj(b, c, d) && !Oj(a, b, c, !0))
                    break
            } else if (!Nj(a, b, c, e, d) && !Dj(b, c, d) && !Oj(a, b, c))
                if (e = Mj(b, c)) {
                    d = b;
                    var f = 2 * d.Wb()
                      , g = Array(f)
                      , k = pj(d)
                      , l = k
                      , m = 0;
                    do
                        g[m++] = l.P.x,
                        g[m++] = l.P.y,
                        l = qj(d);
                    while (l !== k);d = !Vf(g, 0, f, 2);
                    Dj(b, c, d)
                } else {
                    e = a;
                    d = b;
                    f = g = pj(d);
                    do {
                        k = Ej(f, c);
                        if (k.length) {
                            g = k[0];
                            k = Kj(f.P, f.L, g.P, g.L);
                            k = Hj(e, k[0], k[1], e.G.length / 2);
                            l = new oj;
                            m = new wj;
                            Ij(k, f.L, l, m);
                            f.L = k;
                            c.update([Math.min(f.P.x, k.x), Math.min(f.P.y, k.y), Math.max(f.P.x, k.x), Math.max(f.P.y, k.y)], f);
                            for (f = qj(d); f !== g; )
                                Ij(f.P, f.L, l, m),
                                c.remove(f),
                                d.removeItem(),
                                f = uj(d);
                            Ij(g.P, k, l, m);
                            g.P = k;
                            c.update([Math.min(g.L.x, k.x), Math.min(g.L.y, k.y), Math.max(g.L.x, k.x), Math.max(g.L.y, k.y)], g);
                            Dj(d, c, !1);
                            Gj(e, d, c);
                            Dj(l, m, !1);
                            Gj(e, l, m);
                            break
                        }
                        f = qj(d)
                    } while (f !== g);break
                }
        3 === b.Wb() && (e = a.i.length,
        a.i[e++] = tj(b).P.jc,
        a.i[e++] = uj(b).P.jc,
        a.i[e++] = rj(b).P.jc)
    }
    function Nj(a, b, c, d, e) {
        var f = a.i.length
          , g = pj(b)
          , k = tj(b)
          , l = g
          , m = qj(b)
          , n = rj(b)
          , p = !1;
        do {
            var q = l.P;
            var t = l.L;
            var u = m.L;
            if (!1 === t.yd) {
                var x = d ? 0 === Lj(q, t, u, c, !0).length : e ? Pj(n.L, u, t, q, k.P) : Pj(k.P, q, t, u, n.L);
                !d && 0 !== Ej({
                    P: q,
                    L: u
                }, c).length || !x || !d && !1 !== q.yd && !1 !== u.yd && Vf([k.P.x, k.P.y, q.x, q.y, t.x, t.y, u.x, u.y, n.L.x, n.L.y], 0, 10, 2) !== !e || (a.i[f++] = q.jc,
                a.i[f++] = t.jc,
                a.i[f++] = u.jc,
                Jj(l, m, b, c),
                m === g && (g = n),
                p = !0)
            }
            k = tj(b);
            l = uj(b);
            m = qj(b);
            n = rj(b)
        } while (l !== g && 3 < b.Wb());return p
    }
    function Oj(a, b, c, d) {
        var e = pj(b);
        qj(b);
        var f = e
          , g = qj(b)
          , k = !1;
        do {
            var l = Kj(f.P, f.L, g.P, g.L, d);
            if (l) {
                k = a.i.length;
                var m = a.G.length / 2
                  , n = sj(b);
                b.removeItem();
                c.remove(n);
                var p = n === e;
                d ? (l[0] === f.P.x && l[1] === f.P.y ? (sj(b),
                l = f.P,
                g.P = l,
                c.remove(f),
                p = p || f === e) : (l = g.L,
                f.L = l,
                c.remove(g),
                p = p || g === e),
                b.removeItem()) : (l = Hj(a, l[0], l[1], m),
                f.L = l,
                g.P = l,
                c.update([Math.min(f.P.x, f.L.x), Math.min(f.P.y, f.L.y), Math.max(f.P.x, f.L.x), Math.max(f.P.y, f.L.y)], f),
                c.update([Math.min(g.P.x, g.L.x), Math.min(g.P.y, g.L.y), Math.max(g.P.x, g.L.x), Math.max(g.P.y, g.L.y)], g));
                a.i[k++] = n.P.jc;
                a.i[k++] = n.L.jc;
                a.i[k++] = l.jc;
                k = !0;
                if (p)
                    break
            }
            f = tj(b);
            g = qj(b)
        } while (f !== e);return k
    }
    function Mj(a, b) {
        var c = pj(a)
          , d = c;
        do {
            if (Ej(d, b).length)
                return !1;
            d = qj(a)
        } while (d !== c);return !0
    }
    function Hj(a, b, c, d) {
        var e = a.G.length;
        a.G[e++] = b;
        a.G[e++] = c;
        return {
            x: b,
            y: c,
            jc: d,
            yd: void 0
        }
    }
    function Ij(a, b, c, d) {
        var e = {
            P: a,
            L: b
        }
          , f = {
            cd: void 0,
            next: void 0,
            data: e
        }
          , g = c.ga;
        if (g) {
            var k = g.next;
            f.cd = g;
            f.next = k;
            g.next = f;
            k && (k.cd = f);
            g === c.Yc && (c.Yc = f)
        } else
            c.md = f,
            c.Yc = f,
            c.Pr && (f.next = f,
            f.cd = f);
        c.ga = f;
        c.df++;
        d && d.Pa([Math.min(a.x, b.x), Math.min(a.y, b.y), Math.max(a.x, b.x), Math.max(a.y, b.y)], e);
        return e
    }
    function Jj(a, b, c, d) {
        uj(c) === b && (c.removeItem(),
        a.L = b.L,
        d.remove(b),
        d.update([Math.min(a.P.x, a.L.x), Math.min(a.P.y, a.L.y), Math.max(a.P.x, a.L.x), Math.max(a.P.y, a.L.y)], a))
    }
    function Lj(a, b, c, d, e) {
        var f, g, k = [], l = xj(d, [Math.min(a.x, b.x, c.x), Math.min(a.y, b.y, c.y), Math.max(a.x, b.x, c.x), Math.max(a.y, b.y, c.y)]);
        d = 0;
        for (f = l.length; d < f; ++d)
            for (g in l[d]) {
                var m = l[d][g];
                "object" !== typeof m || e && !m.yd || m.x === a.x && m.y === a.y || m.x === b.x && m.y === b.y || m.x === c.x && m.y === c.y || -1 !== k.indexOf(m) || !Pf([a.x, a.y, b.x, b.y, c.x, c.y], 0, 6, 2, m.x, m.y) || k.push(m)
            }
        return k
    }
    function Ej(a, b, c) {
        var d = a.P
          , e = a.L;
        b = xj(b, [Math.min(d.x, e.x), Math.min(d.y, e.y), Math.max(d.x, e.x), Math.max(d.y, e.y)]);
        var f = [], g;
        var k = 0;
        for (g = b.length; k < g; ++k) {
            var l = b[k];
            a !== l && (c || l.P !== e || l.L !== d) && Kj(d, e, l.P, l.L, c) && f.push(l)
        }
        return f
    }
    function Kj(a, b, c, d, e) {
        var f = (d.y - c.y) * (b.x - a.x) - (d.x - c.x) * (b.y - a.y);
        if (0 !== f && (d = ((d.x - c.x) * (a.y - c.y) - (d.y - c.y) * (a.x - c.x)) / f,
        c = ((b.x - a.x) * (a.y - c.y) - (b.y - a.y) * (a.x - c.x)) / f,
        !e && d > wi && d < 1 - wi && c > wi && c < 1 - wi || e && 0 <= d && 1 >= d && 0 <= c && 1 >= c))
            return [a.x + d * (b.x - a.x), a.y + d * (b.y - a.y)]
    }
    function Pj(a, b, c, d, e) {
        if (void 0 === b.yd || void 0 === d.yd)
            return !1;
        var f = (c.x - d.x) * (b.y - d.y) > (c.y - d.y) * (b.x - d.x);
        e = (e.x - d.x) * (b.y - d.y) < (e.y - d.y) * (b.x - d.x);
        a = (a.x - b.x) * (d.y - b.y) > (a.y - b.y) * (d.x - b.x);
        c = (c.x - b.x) * (d.y - b.y) < (c.y - b.y) * (d.x - b.x);
        b = b.yd ? c || a : c && a;
        return (d.yd ? e || f : e && f) && b
    }
    h.If = function(a, b) {
        var c = a.Ia
          , d = a.oa()
          , e = this.i.length
          , f = this.Bc.i.length;
        a = a.X();
        var g, k, l;
        var m = k = 0;
        for (g = c.length; m < g; ++m) {
            var n = c[m];
            if (0 < n.length) {
                var p = sf(a, k, n[0], d, -this.origin[0], -this.origin[1]);
                if (p.length) {
                    var q = [];
                    k = 1;
                    for (l = n.length; k < l; ++k)
                        if (n[k] !== n[k - 1]) {
                            var t = sf(a, n[k - 1], n[k], d, -this.origin[0], -this.origin[1]);
                            q.push(t)
                        }
                    gj(this.Bc, p, q, d);
                    this.kd(p, q, d)
                }
            }
            k = n[n.length - 1]
        }
        this.i.length > e && (this.T.push(e),
        this.Ub.push(b),
        this.u.a && (this.Aa.push(e),
        this.u.a = !1));
        this.Bc.i.length > f && hj(this.Bc, b, f)
    }
    ;
    h.Kf = function(a, b) {
        var c = a.U
          , d = a.oa();
        if (0 < c.length) {
            a = a.X().map(Number);
            var e = sf(a, 0, c[0], d, -this.origin[0], -this.origin[1]);
            if (e.length) {
                var f = [], g;
                var k = 1;
                for (g = c.length; k < g; ++k)
                    if (c[k] !== c[k - 1]) {
                        var l = sf(a, c[k - 1], c[k], d, -this.origin[0], -this.origin[1]);
                        f.push(l)
                    }
                this.T.push(this.i.length);
                this.Ub.push(b);
                this.u.a && (this.Aa.push(this.i.length),
                this.u.a = !1);
                hj(this.Bc, b);
                gj(this.Bc, e, f, d);
                this.kd(e, f, d)
            }
        }
    }
    ;
    h.finish = function(a) {
        this.Ie = new xi(this.G);
        this.le = new xi(this.i);
        this.T.push(this.i.length);
        this.Bc.finish(a);
        0 === this.Aa.length && 0 < this.ab.length && (this.ab = []);
        this.i = this.G = null
    }
    ;
    h.Vb = function(a) {
        var b = this.Ie
          , c = this.le
          , d = this.Bc.Vb(a);
        return function() {
            a.deleteBuffer(b);
            a.deleteBuffer(c);
            d()
        }
    }
    ;
    h.pn = function(a, b) {
        var c = Ai(b, jj, lj);
        if (this.fb)
            var d = this.fb;
        else
            this.fb = d = new mj(a,c);
        b.useProgram(c);
        a.enableVertexAttribArray(d.lb);
        a.vertexAttribPointer(d.lb, 2, 5126, !1, 8, 0);
        return d
    }
    ;
    h.qn = function(a, b) {
        a.disableVertexAttribArray(b.lb)
    }
    ;
    h.pj = function(a, b, c, d) {
        var e = a.getParameter(a.DEPTH_FUNC)
          , f = a.getParameter(a.DEPTH_WRITEMASK);
        d || (a.enable(a.DEPTH_TEST),
        a.depthMask(!0),
        a.depthFunc(a.NOTEQUAL));
        if (Bb(c)) {
            var g = this.T[this.T.length - 1];
            for (c = this.Aa.length - 1; 0 <= c; --c) {
                var k = this.Aa[c];
                var l = this.ab[c];
                this.kh(a, l);
                this.drawElements(a, b, k, g);
                g = k
            }
        } else
            this.qj(a, b, c);
        d || (a.disable(a.DEPTH_TEST),
        a.clear(a.DEPTH_BUFFER_BIT),
        a.depthMask(f),
        a.depthFunc(e))
    }
    ;
    h.Kl = function(a, b, c, d, e) {
        var f, g;
        var k = this.T.length - 2;
        var l = this.T[k + 1];
        for (f = this.Aa.length - 1; 0 <= f; --f) {
            var m = this.ab[f];
            this.kh(a, m);
            for (g = this.Aa[f]; 0 <= k && this.T[k] >= g; ) {
                m = this.T[k];
                var n = this.Ub[k];
                var p = w(n).toString();
                if (void 0 === c[p] && n.I() && (void 0 === e || vb(e, n.I().c())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT),
                this.drawElements(a, b, m, l),
                l = d(n)))
                    return l;
                k--;
                l = m
            }
        }
    }
    ;
    h.qj = function(a, b, c) {
        var d, e;
        var f = this.T.length - 2;
        var g = e = this.T[f + 1];
        for (d = this.Aa.length - 1; 0 <= d; --d) {
            var k = this.ab[d];
            this.kh(a, k);
            for (k = this.Aa[d]; 0 <= f && this.T[f] >= k; ) {
                var l = this.T[f];
                var m = this.Ub[f];
                m = w(m).toString();
                c[m] && (e !== g && (this.drawElements(a, b, e, g),
                a.clear(a.DEPTH_BUFFER_BIT)),
                g = l);
                f--;
                e = l
            }
            e !== g && (this.drawElements(a, b, e, g),
            a.clear(a.DEPTH_BUFFER_BIT));
            e = g = k
        }
    }
    ;
    h.kh = function(a, b) {
        a.uniform4fv(this.fb.Qq, b)
    }
    ;
    h.kb = function(a, b) {
        a = a ? a.W : [0, 0, 0, 0];
        a = a instanceof CanvasGradient || a instanceof CanvasPattern ? si : kd(a).map(function(a, b) {
            return 3 != b ? a / 255 : a
        }) || si;
        this.u.fillColor && wa(a, this.u.fillColor) || (this.u.fillColor = a,
        this.u.a = !0,
        this.ab.push(a));
        b ? this.Bc.kb(null, b) : this.Bc.kb(null, new nj({
            color: [0, 0, 0, 0],
            lineWidth: 0
        }))
    }
    ;
    function Qj(a, b) {
        this.Kc = b;
        this.Ml = [{
            x: 0,
            y: 0,
            width: a,
            height: a
        }];
        this.he = {};
        this.$ = pd(a, a);
        this.J = this.$.canvas
    }
    Qj.prototype.get = function(a) {
        return this.he[a] || null
    }
    ;
    Qj.prototype.add = function(a, b, c, d, e) {
        var f;
        var g = 0;
        for (f = this.Ml.length; g < f; ++g) {
            var k = this.Ml[g];
            if (k.width >= b + this.Kc && k.height >= c + this.Kc)
                return f = {
                    offsetX: k.x + this.Kc,
                    offsetY: k.y + this.Kc,
                    image: this.J
                },
                this.he[a] = f,
                d.call(e, this.$, k.x + this.Kc, k.y + this.Kc),
                a = b + this.Kc,
                b = c + this.Kc,
                k.width - a > k.height - b ? (c = {
                    x: k.x + a,
                    y: k.y,
                    width: k.width - a,
                    height: k.height
                },
                k = {
                    x: k.x,
                    y: k.y + b,
                    width: a,
                    height: k.height - b
                }) : (c = {
                    x: k.x + a,
                    y: k.y,
                    width: k.width - a,
                    height: b
                },
                k = {
                    x: k.x,
                    y: k.y + b,
                    width: k.width,
                    height: k.height - b
                }),
                g = [g, 1],
                0 < c.width && 0 < c.height && g.push(c),
                0 < k.width && 0 < k.height && g.push(k),
                this.Ml.splice.apply(this.Ml, g),
                f
        }
        return null
    }
    ;
    function Rj(a) {
        a = a || {};
        this.El = void 0 !== a.initialSize ? a.initialSize : 256;
        this.Mm = void 0 !== a.maxSize ? a.maxSize : void 0 !== oa ? oa : 2048;
        this.Kc = void 0 !== a.space ? a.space : 1;
        this.yg = [new Qj(this.El,this.Kc)];
        this.yo = this.El;
        this.Ys = [new Qj(this.yo,this.Kc)]
    }
    function Sj(a, b) {
        var c;
        var d = 0;
        for (c = a.length; d < c; ++d) {
            var e = a[d];
            if (e = e.get(b))
                return e
        }
        return null
    }
    function Tj(a, b) {
        return {
            offsetX: a.offsetX,
            offsetY: a.offsetY,
            image: a.image,
            Gy: b.image
        }
    }
    Rj.prototype.add = function(a, b, c, d, e, f) {
        if (b + this.Kc > this.Mm || c + this.Kc > this.Mm)
            return null;
        d = Uj(this, !1, a, b, c, d, f);
        if (!d)
            return null;
        a = Uj(this, !0, a, b, c, void 0 !== e ? e : Ba, f);
        return Tj(d, a)
    }
    ;
    function Uj(a, b, c, d, e, f, g) {
        var k = b ? a.Ys : a.yg, l;
        var m = 0;
        for (l = k.length; m < l; ++m) {
            var n = k[m];
            if (n = n.add(c, d, e, f, g))
                return n;
            n || m !== l - 1 || (b ? (n = Math.min(2 * a.yo, a.Mm),
            a.yo = n) : (n = Math.min(2 * a.El, a.Mm),
            a.El = n),
            n = new Qj(n,a.Kc),
            k.push(n),
            ++l)
        }
        return null
    }
    ;function Vj(a, b) {
        Mi.call(this, a, b);
        this.kc = [];
        this.sh = [];
        this.At = pd(0, 0).canvas;
        this.u = {
            strokeColor: null,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: 0,
            miterLimit: void 0,
            fillColor: null,
            font: void 0,
            scale: void 0
        };
        this.S = "";
        this.re = this.qe = this.Ee = this.De = void 0;
        this.yg = {};
        this.ej = void 0;
        this.opacity = this.scale = 1
    }
    v(Vj, Mi);
    h = Vj.prototype;
    h.fe = function(a, b, c, d, e, f) {
        if (this.S) {
            this.T.push(this.i.length);
            this.Ub.push(f);
            e = this.ej;
            f = this.S.split("\n");
            var g = Wj(this, f), k, l, m = Math.round(g[0] * this.De - this.qe), n = Math.round(g[1] * this.Ee - this.re), p = this.u.lineWidth / 2 * this.u.scale;
            g = 0;
            for (k = f.length; g < k; ++g) {
                var q = 0;
                var t = e.height * g;
                var u = f[g].split("");
                var x = 0;
                for (l = u.length; x < l; ++x) {
                    var B = e.Gr;
                    var z = u[x]
                      , E = Sj(B.yg, z);
                    E ? (B = Sj(B.Ys, z),
                    B = Tj(E, B)) : B = null;
                    B && (E = B.image,
                    this.tl = m - q,
                    this.ul = n - t,
                    this.Rm = 0 === x ? B.offsetX - p : B.offsetX,
                    this.Sm = B.offsetY,
                    this.height = e.height,
                    this.width = 0 === x || x === u.length - 1 ? e.width[u[x]] + p : e.width[u[x]],
                    this.imageHeight = E.height,
                    this.imageWidth = E.width,
                    0 === this.kc.length ? this.kc.push(E) : (B = this.kc[this.kc.length - 1],
                    w(B) != w(E) && (this.$h.push(this.i.length),
                    this.kc.push(E))),
                    this.Qb(a, b, c, d));
                    q += this.width
                }
            }
        }
    }
    ;
    function Wj(a, b) {
        var c = a.ej
          , d = b.length * c.height;
        return [b.map(function(b) {
            var d = 0, e;
            var k = 0;
            for (e = b.length; k < e; ++k) {
                var l = b[k];
                c.width[l] || Xj(a, l);
                d += c.width[l] ? c.width[l] : 0
            }
            return d
        }).reduce(function(a, b) {
            return Math.max(a, b)
        }), d]
    }
    h.Qb = function(a, b, c, d) {
        var e;
        for (e = b; e < c; e += d)
            Ni(this, a, b, c, d)
    }
    ;
    function Xj(a, b) {
        if (1 === b.length) {
            var c = a.ej
              , d = a.u;
            a = a.At.getContext("2d");
            a.font = d.font;
            a = Math.ceil(a.measureText(b).width * d.scale);
            c.Gr.add(b, a, c.height, function(a, c, g) {
                a.font = d.font;
                a.fillStyle = d.fillColor;
                a.strokeStyle = d.strokeColor;
                a.lineWidth = d.lineWidth;
                a.lineCap = d.lineCap;
                a.lineJoin = d.lineJoin;
                a.miterLimit = d.miterLimit;
                a.textAlign = "left";
                a.textBaseline = "top";
                Yd && d.lineDash && (a.setLineDash(d.lineDash),
                a.lineDashOffset = d.lineDashOffset);
                1 !== d.scale && a.setTransform(d.scale, 0, 0, d.scale, 0, 0);
                d.strokeColor && a.strokeText(b, c, g);
                d.fillColor && a.fillText(b, c, g)
            }) && (c.width[b] = a)
        }
    }
    h.finish = function(a) {
        var b = a.sa;
        this.$h.push(this.i.length);
        this.ei = this.$h;
        this.Ie = new xi(this.G);
        this.le = new xi(this.i);
        Oi(this.sh, this.kc, {}, b);
        this.u = {
            strokeColor: null,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: 0,
            miterLimit: void 0,
            fillColor: null,
            font: void 0,
            scale: void 0
        };
        this.S = "";
        this.re = this.qe = this.Ee = this.De = void 0;
        this.kc = null;
        this.yg = {};
        this.ej = void 0;
        Mi.prototype.finish.call(this, a)
    }
    ;
    h.bc = function(a) {
        var b = this.u
          , c = a.ja
          , d = a.ia;
        if (a && a.S && (c || d)) {
            c ? (c = c.W,
            b.fillColor = od(c ? c : si)) : b.fillColor = null;
            d ? (c = d.W,
            b.strokeColor = od(c ? c : ui),
            b.lineWidth = d.Sb() || 1,
            b.lineCap = d.Zc || "round",
            b.lineDashOffset = d.Ac || 0,
            b.lineJoin = d.$c || "round",
            b.miterLimit = d.ad || 10,
            d = d.getLineDash(),
            b.lineDash = d ? d.slice() : ti) : (b.strokeColor = null,
            b.lineWidth = 0);
            b.font = a.Lf || "10px sans-serif";
            b.scale = a.Ma || 1;
            this.S = a.S;
            d = Yj[a.De];
            c = Yj[a.Ee];
            this.De = void 0 === d ? .5 : d;
            this.Ee = void 0 === c ? .5 : c;
            this.qe = a.qe || 0;
            this.re = a.re || 0;
            this.rotateWithView = !!a.Db;
            this.rotation = a.ma() || 0;
            a = [];
            for (var e in b)
                if (b[e] || 0 === b[e])
                    Array.isArray(b[e]) ? a = a.concat(b[e]) : a.push(b[e]);
            c = "";
            e = 0;
            for (d = a.length; e < d; ++e)
                c += a[e];
            e = c;
            this.yg[e] || (a = this.At.getContext("2d"),
            a.font = b.font,
            a = Math.ceil((1.5 * a.measureText("M").width + b.lineWidth / 2) * b.scale),
            this.yg[e] = {
                Gr: new Rj({
                    space: b.lineWidth + 1
                }),
                width: {},
                height: a
            });
            this.ej = this.yg[e]
        } else
            this.S = ""
    }
    ;
    h.hp = function() {
        return this.sh
    }
    ;
    h.Zo = function() {
        return this.sh
    }
    ;
    var Yj = {
        left: 0,
        end: 0,
        center: .5,
        right: 1,
        start: 1,
        top: 0,
        pC: .5,
        jC: .2,
        dC: .8,
        lC: .8,
        bottom: 1
    };
    function Zj(a, b, c) {
        this.Lm = b;
        this.Oq = a;
        this.dd = c;
        this.cb = {}
    }
    v(Zj, gi);
    h = Zj.prototype;
    h.Vb = function(a) {
        var b = [], c;
        for (c in this.cb) {
            var d = this.cb[c], e;
            for (e in d)
                b.push(d[e].Vb(a))
        }
        return function() {
            for (var a = b.length, c, d = 0; d < a; d++)
                c = b[d].apply(this, arguments);
            return c
        }
    }
    ;
    h.finish = function(a) {
        for (var b in this.cb) {
            var c = this.cb[b], d;
            for (d in c)
                c[d].finish(a)
        }
    }
    ;
    h.Xa = function(a, b) {
        var c = void 0 !== a ? a.toString() : "0";
        a = this.cb[c];
        void 0 === a && (a = {},
        this.cb[c] = a);
        c = a[b];
        void 0 === c && (c = new ak[b](this.Oq,this.Lm),
        a[b] = c);
        return c
    }
    ;
    h.Nd = function() {
        return Bb(this.cb)
    }
    ;
    h.jb = function(a, b, c, d, e, f, g, k) {
        var l = Object.keys(this.cb).map(Number);
        l.sort(qa);
        var m, n;
        var p = 0;
        for (m = l.length; p < m; ++p) {
            var q = this.cb[l[p].toString()];
            var t = 0;
            for (n = fi.length; t < n; ++t) {
                var u = q[fi[t]];
                void 0 !== u && u.jb(a, b, c, d, e, f, g, k, void 0, !1)
            }
        }
    }
    ;
    h.hn = function(a, b, c, d, e, f, g, k, l, m, n) {
        var p = Object.keys(this.cb).map(Number);
        p.sort(function(a, b) {
            return b - a
        });
        var q, t;
        var u = 0;
        for (q = p.length; u < q; ++u) {
            var x = this.cb[p[u].toString()];
            for (t = fi.length - 1; 0 <= t; --t) {
                var B = x[fi[t]];
                if (void 0 !== B && (B = B.jb(a, b, c, d, e, f, g, k, l, m, n)))
                    return B
            }
        }
    }
    ;
    h.Ta = function(a, b, c, d, e, f, g, k, l, m) {
        var n = b.sa;
        n.bindFramebuffer(n.FRAMEBUFFER, Hi(b));
        var p;
        void 0 !== this.dd && (p = Wa(eb(a), d * this.dd));
        return this.hn(b, a, d, e, bk, g, k, l, function(a) {
            var b = new Uint8Array(4);
            n.readPixels(0, 0, 1, 1, n.RGBA, n.UNSIGNED_BYTE, b);
            if (0 < b[3] && (a = m(a)))
                return a
        }, !0, p)
    }
    ;
    h.af = function(a, b, c, d, e, f, g, k, l) {
        var m = b.sa;
        m.bindFramebuffer(m.FRAMEBUFFER, Hi(b));
        return void 0 !== this.hn(b, a, d, e, bk, g, k, l, function() {
            var a = new Uint8Array(4);
            m.readPixels(0, 0, 1, 1, m.RGBA, m.UNSIGNED_BYTE, a);
            return 0 < a[3]
        }, !1)
    }
    ;
    var bk = [1, 1]
      , ak = {
        Circle: zi,
        Image: Pi,
        LineString: Wi,
        Polygon: Aj,
        Text: Vj
    };
    function ck(a, b, c, d, e, f, g) {
        this.$ = a;
        this.Cf = b;
        this.V = f;
        this.Wa = g;
        this.$a = e;
        this.Za = d;
        this.xe = c;
        this.rf = this.mg = this.Ol = this.xp = null
    }
    v(ck, Vh);
    h = ck.prototype;
    h.Qb = function(a, b, c, d, e) {
        var f = this.$;
        a = a.Xa(0, "Text");
        a.bc(this.rf);
        a.fe(b, c, d, e, null, null);
        a.finish(f);
        a.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        a.Vb(f)()
    }
    ;
    h.Gb = function(a) {
        this.kb(a.ja, a.ia);
        this.ye(a.N());
        this.bc(a.S)
    }
    ;
    h.ld = function(a) {
        switch (a.D()) {
        case "Point":
            this.Jf(a, null);
            break;
        case "LineString":
            this.Ff(a, null);
            break;
        case "Polygon":
            this.Kf(a, null);
            break;
        case "MultiPoint":
            this.Hf(a, null);
            break;
        case "MultiLineString":
            this.Gf(a, null);
            break;
        case "MultiPolygon":
            this.If(a, null);
            break;
        case "GeometryCollection":
            this.Jl(a, null);
            break;
        case "Circle":
            this.Qe(a, null)
        }
    }
    ;
    h.Il = function(a, b) {
        (a = (0,
        b.Rb)(a)) && vb(this.V, a.c()) && (this.Gb(b),
        this.ld(a))
    }
    ;
    h.Jl = function(a) {
        a = a.Ja;
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c)
            this.ld(a[c])
    }
    ;
    h.Jf = function(a, b) {
        var c = this.$
          , d = new Zj(1,this.V)
          , e = d.Xa(0, "Image");
        e.ye(this.xp);
        e.Jf(a, b);
        e.finish(c);
        e.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        e.Vb(c)();
        this.rf && (b = a.X(),
        this.Qb(d, b, 0, b.length, a.oa()))
    }
    ;
    h.Hf = function(a, b) {
        var c = this.$
          , d = new Zj(1,this.V)
          , e = d.Xa(0, "Image");
        e.ye(this.xp);
        e.Hf(a, b);
        e.finish(c);
        e.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        e.Vb(c)();
        this.rf && (b = a.X(),
        this.Qb(d, b, 0, b.length, a.oa()))
    }
    ;
    h.Ff = function(a, b) {
        var c = this.$
          , d = new Zj(1,this.V)
          , e = d.Xa(0, "LineString");
        e.kb(null, this.mg);
        e.Ff(a, b);
        e.finish(c);
        e.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        e.Vb(c)();
        this.rf && (a = bi(a),
        this.Qb(d, a, 0, 2, 2))
    }
    ;
    h.Gf = function(a, b) {
        var c = this.$
          , d = new Zj(1,this.V)
          , e = d.Xa(0, "LineString");
        e.kb(null, this.mg);
        e.Gf(a, b);
        e.finish(c);
        e.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        e.Vb(c)();
        this.rf && (a = ci(a),
        this.Qb(d, a, 0, a.length, 2))
    }
    ;
    h.Kf = function(a, b) {
        var c = this.$
          , d = new Zj(1,this.V)
          , e = d.Xa(0, "Polygon");
        e.kb(this.Ol, this.mg);
        e.Kf(a, b);
        e.finish(c);
        e.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        e.Vb(c)();
        this.rf && (a = Zf(a),
        this.Qb(d, a, 0, 2, 2))
    }
    ;
    h.If = function(a, b) {
        var c = this.$
          , d = new Zj(1,this.V)
          , e = d.Xa(0, "Polygon");
        e.kb(this.Ol, this.mg);
        e.If(a, b);
        e.finish(c);
        e.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        e.Vb(c)();
        this.rf && (a = di(a),
        this.Qb(d, a, 0, a.length, 2))
    }
    ;
    h.Qe = function(a, b) {
        var c = this.$
          , d = new Zj(1,this.V)
          , e = d.Xa(0, "Circle");
        e.kb(this.Ol, this.mg);
        e.Qe(a, b);
        e.finish(c);
        e.jb(this.$, this.Cf, this.xe, this.Za, this.$a, this.Wa, 1, {}, void 0, !1);
        e.Vb(c)();
        this.rf && this.Qb(d, a.Fa(), 0, 2, 2)
    }
    ;
    h.ye = function(a) {
        this.xp = a
    }
    ;
    h.kb = function(a, b) {
        this.Ol = a;
        this.mg = b
    }
    ;
    h.bc = function(a) {
        this.rf = a
    }
    ;
    function dk() {
        this.Eh = 0;
        this.he = {};
        this.wd = this.bd = null
    }
    h = dk.prototype;
    h.clear = function() {
        this.Eh = 0;
        this.he = {};
        this.wd = this.bd = null
    }
    ;
    function ek(a, b) {
        return a.he.hasOwnProperty(b)
    }
    h.forEach = function(a, b) {
        for (var c = this.bd; c; )
            a.call(b, c.rg, c.Vf, this),
            c = c.Pd
    }
    ;
    h.get = function(a) {
        a = this.he[a];
        Fa(void 0 !== a, 15);
        if (a === this.wd)
            return a.rg;
        a === this.bd ? (this.bd = this.bd.Pd,
        this.bd.ag = null) : (a.Pd.ag = a.ag,
        a.ag.Pd = a.Pd);
        a.Pd = null;
        a.ag = this.wd;
        this.wd = this.wd.Pd = a;
        return a.rg
    }
    ;
    h.Bj = function() {
        return this.Eh
    }
    ;
    h.v = function() {
        var a = Array(this.Eh), b = 0, c;
        for (c = this.wd; c; c = c.ag)
            a[b++] = c.Vf;
        return a
    }
    ;
    h.Rs = function() {
        var a = Array(this.Eh), b = 0, c;
        for (c = this.wd; c; c = c.ag)
            a[b++] = c.rg;
        return a
    }
    ;
    h.pop = function() {
        var a = this.bd;
        delete this.he[a.Vf];
        a.Pd && (a.Pd.ag = null);
        this.bd = a.Pd;
        this.bd || (this.wd = null);
        --this.Eh;
        return a.rg
    }
    ;
    h.replace = function(a, b) {
        this.get(a);
        this.he[a].rg = b
    }
    ;
    h.set = function(a, b) {
        Fa(!(a in this.he), 16);
        b = {
            Vf: a,
            Pd: null,
            ag: this.wd,
            rg: b
        };
        this.wd ? this.wd.Pd = b : this.bd = b;
        this.wd = b;
        this.he[a] = b;
        ++this.Eh
    }
    ;
    function fk(a, b) {
        Lh.call(this, 0, b);
        this.J = document.createElement("CANVAS");
        this.J.style.width = "100%";
        this.J.style.height = "100%";
        this.J.style.display = "block";
        this.J.className = "ol-unselectable";
        a.insertBefore(this.J, a.childNodes[0] || null);
        this.Qr = this.Rr = 0;
        this.Sr = pd();
        this.xb = !0;
        this.sa = Qd(this.J, {
            antialias: !0,
            depth: !0,
            failIfMajorPerformanceCaveat: !0,
            preserveDrawingBuffer: !1,
            stencil: !0
        });
        this.$ = new Gi(this.J,this.sa);
        y(this.J, "webglcontextlost", this.Tg, this);
        y(this.J, "webglcontextrestored", this.op, this);
        this.Oc = new dk;
        this.Fg = null;
        this.Vk = new Oe(function(a) {
            var b = a[1];
            a = a[2];
            var c = b[0] - this.Fg[0];
            b = b[1] - this.Fg[1];
            return 65536 * Math.log(a) + Math.sqrt(c * c + b * b) / a
        }
        .bind(this),function(a) {
            return a[0].getKey()
        }
        );
        this.Sy = function() {
            if (!this.Vk.Nd()) {
                Se(this.Vk);
                var a = Pe(this.Vk);
                gk(this, a[0], a[3], a[4])
            }
            return !1
        }
        .bind(this);
        this.Tk = 0;
        hk(this)
    }
    v(fk, Lh);
    function gk(a, b, c, d) {
        var e = a.sa
          , f = b.getKey();
        if (ek(a.Oc, f))
            a = a.Oc.get(f),
            e.bindTexture(3553, a.Cd),
            9729 != a.rt && (e.texParameteri(3553, 10240, 9729),
            a.rt = 9729),
            9729 != a.Ct && (e.texParameteri(3553, 10241, 9729),
            a.Ct = 9729);
        else {
            var g = e.createTexture();
            e.bindTexture(3553, g);
            if (0 < d) {
                var k = a.Sr.canvas
                  , l = a.Sr;
                a.Rr !== c[0] || a.Qr !== c[1] ? (k.width = c[0],
                k.height = c[1],
                a.Rr = c[0],
                a.Qr = c[1]) : l.clearRect(0, 0, c[0], c[1]);
                l.drawImage(b.N(), d, d, c[0], c[1], 0, 0, c[0], c[1]);
                e.texImage2D(3553, 0, 6408, 6408, 5121, k)
            } else
                e.texImage2D(3553, 0, 6408, 6408, 5121, b.N());
            e.texParameteri(3553, 10240, 9729);
            e.texParameteri(3553, 10241, 9729);
            e.texParameteri(3553, 10242, 33071);
            e.texParameteri(3553, 10243, 33071);
            a.Oc.set(f, {
                Cd: g,
                rt: 9729,
                Ct: 9729
            })
        }
    }
    h = fk.prototype;
    h.Rc = function(a, b) {
        var c = this.B();
        if (c.hasListener(a)) {
            var d = this.$
              , e = b.viewState;
            c.dispatchEvent(new Qh(a,new ck(d,e.center,e.resolution,e.rotation,b.size,b.extent,b.pixelRatio),b,null,d))
        }
    }
    ;
    h.la = function() {
        var a = this.sa;
        a.isContextLost() || this.Oc.forEach(function(b) {
            b && a.deleteTexture(b.Cd)
        });
        Vc(this.$);
        Lh.prototype.la.call(this)
    }
    ;
    h.Cw = function(a, b) {
        a = this.sa;
        for (var c; 1024 < this.Oc.Bj() - this.Tk; ) {
            if (c = this.Oc.bd.rg)
                a.deleteTexture(c.Cd);
            else if (+this.Oc.bd.Vf == b.index)
                break;
            else
                --this.Tk;
            this.Oc.pop()
        }
    }
    ;
    h.getContext = function() {
        return this.$
    }
    ;
    h.Hs = function() {
        return this.sa
    }
    ;
    h.D = function() {
        return "webgl"
    }
    ;
    h.Tg = function(a) {
        a.preventDefault();
        this.Oc.clear();
        this.Tk = 0;
        a = this.oe;
        for (var b in a)
            a[b].Tg()
    }
    ;
    h.op = function() {
        hk(this);
        this.B().render()
    }
    ;
    function hk(a) {
        a = a.sa;
        a.activeTexture(33984);
        a.blendFuncSeparate(770, 771, 1, 771);
        a.disable(2884);
        a.disable(2929);
        a.disable(3089);
        a.disable(2960)
    }
    h.iq = function(a) {
        var b = this.getContext()
          , c = this.sa;
        if (c.isContextLost())
            return !1;
        if (!a)
            return this.xb && (this.J.style.display = "none",
            this.xb = !1),
            !1;
        this.Fg = a.focus;
        this.Oc.set((-a.index).toString(), null);
        ++this.Tk;
        this.Rc("precompose", a);
        var d = []
          , e = a.Od;
        xa(e);
        var f = a.viewState.resolution, g;
        var k = 0;
        for (g = e.length; k < g; ++k) {
            var l = e[k];
            if (wh(l, f) && "ready" == l.Ku) {
                var m = Oh(this, l.layer);
                m.ue(a, l, b) && d.push(l)
            }
        }
        e = a.size[0] * a.pixelRatio;
        f = a.size[1] * a.pixelRatio;
        if (this.J.width != e || this.J.height != f)
            this.J.width = e,
            this.J.height = f;
        c.bindFramebuffer(36160, null);
        c.clearColor(0, 0, 0, 0);
        c.clear(16384);
        c.enable(3042);
        c.viewport(0, 0, this.J.width, this.J.height);
        k = 0;
        for (g = d.length; k < g; ++k)
            l = d[k],
            m = Oh(this, l.layer),
            m.Ch(a, l, b);
        this.xb || (this.J.style.display = "",
        this.xb = !0);
        Mh(a);
        1024 < this.Oc.Bj() - this.Tk && a.Rd.push(this.Cw.bind(this));
        this.Vk.Nd() || (a.Rd.push(this.Sy),
        a.rb = !0);
        this.Rc("postcompose", a);
        Ph(this, a);
        a.Rd.push(Nh)
    }
    ;
    h.Ta = function(a, b, c, d, e, f, g) {
        if (this.sa.isContextLost())
            return !1;
        var k = b.viewState, l = b.Od, m;
        for (m = l.length - 1; 0 <= m; --m) {
            var n = l[m];
            var p = n.layer;
            if (wh(n, k.resolution) && f.call(g, p) && (n = Oh(this, p).Ta(a, b, c, d, e)))
                return n
        }
    }
    ;
    h.af = function(a, b, c, d, e) {
        c = !1;
        if (this.sa.isContextLost())
            return !1;
        var f = b.viewState, g = b.Od, k;
        for (k = g.length - 1; 0 <= k; --k) {
            var l = g[k]
              , m = l.layer;
            if (wh(l, f.resolution) && d.call(e, m) && (c = Oh(this, m).af(a, b)))
                return !0
        }
        return c
    }
    ;
    h.Mf = function(a, b, c, d, e) {
        if (this.sa.isContextLost())
            return !1;
        var f = b.viewState, g = b.Od, k;
        for (k = g.length - 1; 0 <= k; --k) {
            var l = g[k];
            var m = l.layer;
            if (wh(l, f.resolution) && e.call(d, m) && (l = Oh(this, m).Mf(a, b, c, d)))
                return l
        }
    }
    ;
    var ik = ["canvas", "webgl"];
    function I(a) {
        $c.call(this);
        var b = jk(a);
        this.Ty = void 0 !== a.loadTilesWhileAnimating ? a.loadTilesWhileAnimating : !1;
        this.Uy = void 0 !== a.loadTilesWhileInteracting ? a.loadTilesWhileInteracting : !1;
        this.Wa = void 0 !== a.pixelRatio ? a.pixelRatio : Xd;
        this.Wy = b.ah;
        this.Er = function() {
            this.wg = void 0;
            this.AA.call(this, Date.now())
        }
        .bind(this);
        this.rw = Ah();
        this.Kz = Ah();
        this.Pw = 0;
        this.zm = this.Qn = this.Rn = this.dg = this.Da = null;
        this.Sa = document.createElement("DIV");
        this.Sa.className = "ol-viewport" + (be ? " ol-touch" : "");
        this.Sa.style.position = "relative";
        this.Sa.style.overflow = "hidden";
        this.Sa.style.width = "100%";
        this.Sa.style.height = "100%";
        this.Sa.style.msTouchAction = "none";
        this.Sa.style.touchAction = "none";
        this.rk = document.createElement("DIV");
        this.rk.className = "ol-overlaycontainer";
        this.Sa.appendChild(this.rk);
        this.qk = document.createElement("DIV");
        this.qk.className = "ol-overlaycontainer-stopevent";
        for (var c = "click dblclick mousedown touchstart MSPointerDown pointerdown mousewheel wheel".split(" "), d = 0, e = c.length; d < e; ++d)
            y(this.qk, c[d], Xc);
        this.Sa.appendChild(this.qk);
        this.st = new Ke(this,a.moveTolerance);
        for (var f in ke)
            y(this.st, ke[f], this.Ts, this);
        this.gt = b.keyboardEventTarget;
        this.Yj = null;
        y(this.Sa, "wheel", this.ai, this);
        y(this.Sa, "mousewheel", this.ai, this);
        this.Dh = b.controls;
        this.Wg = b.interactions;
        this.si = b.overlays;
        this.Hp = {};
        this.Ud = new b.DA(this.Sa,this);
        this.Fg = null;
        this.Tt = [];
        this.zn = new Te(this.Lx.bind(this),this.zy.bind(this));
        this.Bq = {};
        y(this, bd("layergroup"), this.dy, this);
        y(this, bd("view"), this.By, this);
        y(this, bd("size"), this.uy, this);
        y(this, bd("target"), this.yy, this);
        this.f(b.values);
        this.Dh.forEach(function(a) {
            a.setMap(this)
        }, this);
        y(this.Dh, "add", function(a) {
            a.element.setMap(this)
        }, this);
        y(this.Dh, "remove", function(a) {
            a.element.setMap(null)
        }, this);
        this.Wg.forEach(function(a) {
            a.setMap(this)
        }, this);
        y(this.Wg, "add", function(a) {
            a.element.setMap(this)
        }, this);
        y(this.Wg, "remove", function(a) {
            a.element.setMap(null)
        }, this);
        this.si.forEach(this.Dr, this);
        y(this.si, "add", function(a) {
            this.Dr(a.element)
        }, this);
        y(this.si, "remove", function(a) {
            var b = a.element.vb;
            void 0 !== b && delete this.Hp[b.toString()];
            a.element.setMap(null)
        }, this)
    }
    v(I, $c);
    h = I.prototype;
    h.aw = function(a) {
        this.Dh.push(a)
    }
    ;
    h.bw = function(a) {
        this.Wg.push(a)
    }
    ;
    h.Br = function(a) {
        this.Lg().Te().push(a)
    }
    ;
    h.Cr = function(a) {
        this.si.push(a)
    }
    ;
    h.Dr = function(a) {
        var b = a.vb;
        void 0 !== b && (this.Hp[b.toString()] = a);
        a.setMap(this)
    }
    ;
    h.la = function() {
        Vc(this.st);
        Vc(this.Ud);
        Sc(this.Sa, "wheel", this.ai, this);
        Sc(this.Sa, "mousewheel", this.ai, this);
        void 0 !== this.Rf && (window.removeEventListener("resize", this.Rf, !1),
        this.Rf = void 0);
        this.wg && (cancelAnimationFrame(this.wg),
        this.wg = void 0);
        this.ac(null);
        $c.prototype.la.call(this)
    }
    ;
    h.wj = function(a, b, c) {
        if (this.Da)
            return a = this.Jb(a),
            c = void 0 !== c ? c : {},
            this.Ud.Ta(a, this.Da, void 0 !== c.hitTolerance ? c.hitTolerance * this.Da.pixelRatio : 0, b, null, void 0 !== c.layerFilter ? c.layerFilter : of, null)
    }
    ;
    h.cx = function(a, b) {
        var c = null;
        this.wj(a, function(a) {
            c || (c = []);
            c.push(a)
        }, b);
        return c
    }
    ;
    h.Mf = function(a, b, c, d, e) {
        if (this.Da)
            return this.Ud.Mf(a, this.Da, b, void 0 !== c ? c : null, void 0 !== d ? d : of, void 0 !== e ? e : null)
    }
    ;
    h.Dy = function(a, b) {
        if (!this.Da)
            return !1;
        a = this.Jb(a);
        b = void 0 !== b ? b : {};
        return this.Ud.af(a, this.Da, void 0 !== b.hitTolerance ? b.hitTolerance * this.Da.pixelRatio : 0, void 0 !== b.layerFilter ? b.layerFilter : of, null)
    }
    ;
    h.To = function(a) {
        return this.Jb(this.Sl(a))
    }
    ;
    h.Sl = function(a) {
        var b = this.Sa.getBoundingClientRect();
        a = a.changedTouches ? a.changedTouches[0] : a;
        return [a.clientX - b.left, a.clientY - b.top]
    }
    ;
    h.fp = function() {
        return this.get("target")
    }
    ;
    h.Yh = function() {
        var a = this.fp();
        return void 0 !== a ? "string" === typeof a ? document.getElementById(a) : a : null
    }
    ;
    h.Jb = function(a) {
        var b = this.Da;
        return b ? Fh(b.ti, a.slice()) : null
    }
    ;
    h.ex = function() {
        return this.Da
    }
    ;
    h.uid = function(a) {
        return w(a)
    }
    ;
    h.ax = function() {
        return this.Dh
    }
    ;
    h.Ax = function() {
        return this.si
    }
    ;
    h.zx = function(a) {
        a = this.Hp[a.toString()];
        return void 0 !== a ? a : null
    }
    ;
    h.lx = function() {
        return this.Wg
    }
    ;
    h.Lg = function() {
        return this.get("layergroup")
    }
    ;
    h.Te = function() {
        return this.Lg().Te()
    }
    ;
    h.gb = function(a) {
        var b = this.Da;
        return b ? Fh(b.Dg, a.slice(0, 2)) : null
    }
    ;
    h.Os = function() {
        return this.Ud
    }
    ;
    h.Ga = function() {
        return this.get("size")
    }
    ;
    h.R = function() {
        return this.get("view")
    }
    ;
    h.Nx = function() {
        return this.Sa
    }
    ;
    h.Lx = function(a, b, c, d) {
        var e = this.Da;
        if (!(e && b in e.wantedTiles && e.wantedTiles[b][a.getKey()]))
            return Infinity;
        a = c[0] - e.focus[0];
        c = c[1] - e.focus[1];
        return 65536 * Math.log(d) + Math.sqrt(a * a + c * c) / d
    }
    ;
    h.ai = function(a, b) {
        a = new Od(b || a.type,this,a);
        this.Ts(a)
    }
    ;
    h.Ts = function(a) {
        if (this.Da) {
            this.Fg = a.coordinate;
            a.frameState = this.Da;
            var b = this.Wg.ie(), c;
            if (!1 !== this.dispatchEvent(a))
                for (c = b.length - 1; 0 <= c; c--) {
                    var d = b[c];
                    if (d.Va() && !d.handleEvent(a))
                        break
                }
        }
    }
    ;
    h.ry = function() {
        var a = this.Da
          , b = this.zn;
        if (!b.Nd()) {
            var c = 16
              , d = c;
            if (a) {
                var e = a.Dd;
                e[0] && (c = this.Ty ? 8 : 0,
                d = 2);
                e[1] && (c = this.Uy ? 8 : 0,
                d = 2)
            }
            b.Dn < c && (Se(b),
            b.Ep(c, d))
        }
        b = this.Tt;
        c = 0;
        for (d = b.length; c < d; ++c)
            b[c](this, a);
        b.length = 0
    }
    ;
    h.uy = function() {
        this.render()
    }
    ;
    h.yy = function() {
        var a;
        this.fp() && (a = this.Yh());
        if (this.Yj) {
            for (var b = 0, c = this.Yj.length; b < c; ++b)
                Mc(this.Yj[b]);
            this.Yj = null
        }
        a ? (a.appendChild(this.Sa),
        a = this.gt ? this.gt : a,
        this.Yj = [y(a, "keydown", this.ai, this), y(a, "keypress", this.ai, this)],
        this.Rf || (this.Rf = this.Pi.bind(this),
        window.addEventListener("resize", this.Rf, !1))) : (rd(this.Sa),
        void 0 !== this.Rf && (window.removeEventListener("resize", this.Rf, !1),
        this.Rf = void 0));
        this.Pi()
    }
    ;
    h.zy = function() {
        this.render()
    }
    ;
    h.Ws = function() {
        this.render()
    }
    ;
    h.By = function() {
        this.Rn && (Mc(this.Rn),
        this.Rn = null);
        this.Qn && (Mc(this.Qn),
        this.Qn = null);
        var a = this.R();
        a && (this.Sa.setAttribute("data-view", w(a)),
        this.Rn = y(a, "propertychange", this.Ws, this),
        this.Qn = y(a, "change", this.Ws, this));
        this.render()
    }
    ;
    h.dy = function() {
        this.zm && (this.zm.forEach(Mc),
        this.zm = null);
        var a = this.Lg();
        a && (this.zm = [y(a, "propertychange", this.render, this), y(a, "change", this.render, this)]);
        this.render()
    }
    ;
    h.BA = function() {
        this.wg && cancelAnimationFrame(this.wg);
        this.Er()
    }
    ;
    h.render = function() {
        void 0 === this.wg && (this.wg = requestAnimationFrame(this.Er))
    }
    ;
    h.tA = function(a) {
        return this.Dh.remove(a)
    }
    ;
    h.uA = function(a) {
        return this.Wg.remove(a)
    }
    ;
    h.wA = function(a) {
        return this.Lg().Te().remove(a)
    }
    ;
    h.xA = function(a) {
        return this.si.remove(a)
    }
    ;
    h.AA = function(a) {
        var b, c = this.Ga(), d = this.R(), e = Ua(), f = this.Da, g = null;
        if (void 0 !== c && 0 < c[0] && 0 < c[1] && d && mg(d)) {
            g = gg(d, this.Da ? this.Da.Dd : void 0);
            var k = this.Lg().bp()
              , l = {};
            var m = 0;
            for (b = k.length; m < b; ++m)
                l[w(k[m].layer)] = k[m];
            m = d.getState();
            g = {
                rb: !1,
                attributions: {},
                Dg: this.rw,
                extent: e,
                focus: this.Fg ? this.Fg : m.center,
                index: this.Pw++,
                ak: l,
                Od: k,
                ah: yb({}, this.Wy),
                pixelRatio: this.Wa,
                ti: this.Kz,
                Rd: [],
                size: c,
                qh: this.Bq,
                tileQueue: this.zn,
                time: a,
                Qi: {},
                viewState: m,
                Dd: g,
                wantedTiles: {}
            }
        }
        g && (g.extent = tb(m.center, m.resolution, m.rotation, g.size, e));
        this.Da = g;
        this.Ud.iq(g);
        g && (g.rb && this.render(),
        Array.prototype.push.apply(this.Tt, g.Rd),
        !f || this.dg && (pb(this.dg) || hb(g.extent, this.dg)) || (this.dispatchEvent(new Nd("movestart",this,f)),
        this.dg = db(this.dg)),
        !this.dg || g.Dd[0] || g.Dd[1] || hb(g.extent, this.dg) || (this.dispatchEvent(new Nd("moveend",this,g)),
        Xa(g.extent, this.dg)));
        this.dispatchEvent(new Nd("postrender",this,g));
        setTimeout(this.ry.bind(this), 0)
    }
    ;
    h.xu = function(a) {
        this.set("layergroup", a)
    }
    ;
    h.zq = function(a) {
        this.set("size", a)
    }
    ;
    h.ac = function(a) {
        this.set("target", a)
    }
    ;
    h.WA = function(a) {
        this.set("view", a)
    }
    ;
    h.Hu = function(a) {
        a = w(a).toString();
        this.Bq[a] = !0;
        this.render()
    }
    ;
    h.Pi = function() {
        var a = this.Yh();
        if (a) {
            var b = getComputedStyle(a);
            this.zq([a.offsetWidth - parseFloat(b.borderLeftWidth) - parseFloat(b.paddingLeft) - parseFloat(b.paddingRight) - parseFloat(b.borderRightWidth), a.offsetHeight - parseFloat(b.borderTopWidth) - parseFloat(b.paddingTop) - parseFloat(b.paddingBottom) - parseFloat(b.borderBottomWidth)])
        } else
            this.zq(void 0)
    }
    ;
    h.$u = function(a) {
        a = w(a).toString();
        delete this.Bq[a];
        this.render()
    }
    ;
    function jk(a) {
        var b = null;
        void 0 !== a.keyboardEventTarget && (b = "string" === typeof a.keyboardEventTarget ? document.getElementById(a.keyboardEventTarget) : a.keyboardEventTarget);
        var c = {}
          , d = {};
        if (void 0 === a.logo || "boolean" === typeof a.logo && a.logo)
            d["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC"] = "https://openlayers.org/";
        else {
            var e = a.logo;
            "string" === typeof e ? d[e] = "" : e instanceof HTMLElement ? d[w(e).toString()] = e : e && (Fa("string" == typeof e.href, 44),
            Fa("string" == typeof e.src, 45),
            d[e.src] = e.href)
        }
        e = a.layers instanceof th ? a.layers : new th({
            layers: a.layers
        });
        c.layergroup = e;
        c.target = a.target;
        c.view = void 0 !== a.view ? a.view : new H;
        e = Lh;
        var f;
        void 0 !== a.renderer ? (Array.isArray(a.renderer) ? f = a.renderer : "string" === typeof a.renderer ? f = [a.renderer] : Fa(!1, 46),
        0 <= f.indexOf("dom") && (f = f.concat(ik))) : f = ik;
        var g;
        var k = 0;
        for (g = f.length; k < g; ++k) {
            var l = f[k];
            if ("canvas" == l) {
                if (Zd) {
                    e = ei;
                    break
                }
            } else if ("webgl" == l && Rd) {
                e = fk;
                break
            }
        }
        void 0 !== a.controls ? Array.isArray(a.controls) ? f = new C(a.controls.slice()) : (Fa(a.controls instanceof C, 47),
        f = a.controls) : f = Cd();
        void 0 !== a.interactions ? Array.isArray(a.interactions) ? k = new C(a.interactions.slice()) : (Fa(a.interactions instanceof C, 48),
        k = a.interactions) : k = qh();
        void 0 !== a.overlays ? Array.isArray(a.overlays) ? a = new C(a.overlays.slice()) : (Fa(a.overlays instanceof C, 49),
        a = a.overlays) : a = new C;
        return {
            controls: f,
            interactions: k,
            keyboardEventTarget: b,
            ah: d,
            overlays: a,
            DA: e,
            values: c
        }
    }
    ;function kk(a) {
        $c.call(this);
        this.vb = a.id;
        this.Ky = void 0 !== a.insertFirst ? a.insertFirst : !0;
        this.hB = void 0 !== a.stopEvent ? a.stopEvent : !0;
        this.Ba = document.createElement("DIV");
        this.Ba.className = "ol-overlay-container ol-selectable";
        this.Ba.style.position = "absolute";
        this.autoPan = void 0 !== a.autoPan ? a.autoPan : !1;
        this.Ir = a.autoPanAnimation || {};
        this.kw = void 0 !== a.autoPanMargin ? a.autoPanMargin : 20;
        this.Lb = {
            yl: "",
            Cm: "",
            jn: "",
            Gn: "",
            visible: !0
        };
        this.Gm = null;
        y(this, bd(lk), this.Xx, this);
        y(this, bd(mk), this.iy, this);
        y(this, bd(nk), this.ny, this);
        y(this, bd(ok), this.py, this);
        y(this, bd(pk), this.qy, this);
        void 0 !== a.element && this.su(a.element);
        this.yu(void 0 !== a.offset ? a.offset : [0, 0]);
        this.Cu(void 0 !== a.positioning ? a.positioning : "top-left");
        void 0 !== a.position && this.setPosition(a.position)
    }
    v(kk, $c);
    h = kk.prototype;
    h.Cj = function() {
        return this.get(lk)
    }
    ;
    h.Ej = function() {
        return this.vb
    }
    ;
    h.B = function() {
        return this.get(mk)
    }
    ;
    h.Ks = function() {
        return this.get(nk)
    }
    ;
    h.Ul = function() {
        return this.get(ok)
    }
    ;
    h.Ms = function() {
        return this.get(pk)
    }
    ;
    h.Xx = function() {
        for (var a = this.Ba; a.lastChild; )
            a.removeChild(a.lastChild);
        (a = this.Cj()) && this.Ba.appendChild(a)
    }
    ;
    h.iy = function() {
        this.Gm && (rd(this.Ba),
        Mc(this.Gm),
        this.Gm = null);
        var a = this.B();
        a && (this.Gm = y(a, "postrender", this.render, this),
        qk(this),
        a = this.hB ? a.qk : a.rk,
        this.Ky ? a.insertBefore(this.Ba, a.childNodes[0] || null) : a.appendChild(this.Ba))
    }
    ;
    h.render = function() {
        qk(this)
    }
    ;
    h.ny = function() {
        qk(this)
    }
    ;
    h.py = function() {
        qk(this);
        if (this.get(ok) && this.autoPan) {
            var a = this.B();
            if (a && a.Yh()) {
                var b = rk(a.Yh(), a.Ga())
                  , c = this.Cj()
                  , d = c.offsetWidth
                  , e = getComputedStyle(c);
                d += parseInt(e.marginLeft, 10) + parseInt(e.marginRight, 10);
                e = c.offsetHeight;
                var f = getComputedStyle(c);
                e += parseInt(f.marginTop, 10) + parseInt(f.marginBottom, 10);
                var g = rk(c, [d, e]);
                c = this.kw;
                ab(b, g) || (d = g[0] - b[0],
                e = b[2] - g[2],
                f = g[1] - b[1],
                g = b[3] - g[3],
                b = [0, 0],
                0 > d ? b[0] = d - c : 0 > e && (b[0] = Math.abs(e) + c),
                0 > f ? b[1] = f - c : 0 > g && (b[1] = Math.abs(g) + c),
                0 === b[0] && 0 === b[1]) || (c = a.R().Fa(),
                c = a.gb(c),
                b = [c[0] + b[0], c[1] + b[1]],
                a.R().rb({
                    center: a.Jb(b),
                    duration: this.Ir.duration,
                    easing: this.Ir.easing
                }))
            }
        }
    }
    ;
    h.qy = function() {
        qk(this)
    }
    ;
    h.su = function(a) {
        this.set(lk, a)
    }
    ;
    h.setMap = function(a) {
        this.set(mk, a)
    }
    ;
    h.yu = function(a) {
        this.set(nk, a)
    }
    ;
    h.setPosition = function(a) {
        this.set(ok, a)
    }
    ;
    function rk(a, b) {
        var c = a.getBoundingClientRect();
        a = c.left + window.pageXOffset;
        c = c.top + window.pageYOffset;
        return [a, c, a + b[0], c + b[1]]
    }
    h.Cu = function(a) {
        this.set(pk, a)
    }
    ;
    h.Yd = function(a) {
        this.Lb.visible !== a && (this.Ba.style.display = a ? "" : "none",
        this.Lb.visible = a)
    }
    ;
    function qk(a) {
        var b = a.B()
          , c = a.Ul();
        if (b && b.Da && c) {
            c = b.gb(c);
            var d = b.Ga();
            b = a.Ba.style;
            var e = a.Ks()
              , f = a.Ms();
            a.Yd(!0);
            var g = e[0];
            e = e[1];
            if ("bottom-right" == f || "center-right" == f || "top-right" == f)
                "" !== a.Lb.Cm && (a.Lb.Cm = b.left = ""),
                g = Math.round(d[0] - c[0] - g) + "px",
                a.Lb.jn != g && (a.Lb.jn = b.right = g);
            else {
                "" !== a.Lb.jn && (a.Lb.jn = b.right = "");
                if ("bottom-center" == f || "center-center" == f || "top-center" == f)
                    g -= a.Ba.offsetWidth / 2;
                g = Math.round(c[0] + g) + "px";
                a.Lb.Cm != g && (a.Lb.Cm = b.left = g)
            }
            if ("bottom-left" == f || "bottom-center" == f || "bottom-right" == f)
                "" !== a.Lb.Gn && (a.Lb.Gn = b.top = ""),
                c = Math.round(d[1] - c[1] - e) + "px",
                a.Lb.yl != c && (a.Lb.yl = b.bottom = c);
            else {
                "" !== a.Lb.yl && (a.Lb.yl = b.bottom = "");
                if ("center-left" == f || "center-center" == f || "center-right" == f)
                    e -= a.Ba.offsetHeight / 2;
                c = Math.round(c[1] + e) + "px";
                a.Lb.Gn != c && (a.Lb.Gn = b.top = c)
            }
        } else
            a.Yd(!1)
    }
    var lk = "element"
      , mk = "map"
      , nk = "offset"
      , ok = "position"
      , pk = "positioning";
    function sk(a) {
        function b(a) {
            a = k.To(a);
            l.B().R().Jc(a);
            window.removeEventListener("mousemove", c);
            window.removeEventListener("mouseup", b)
        }
        function c(a) {
            a = k.To({
                clientX: a.clientX - n.offsetWidth / 2,
                clientY: a.clientY + n.offsetHeight / 2
            });
            m.setPosition(a)
        }
        a = a ? a : {};
        this.sb = void 0 !== a.collapsed ? a.collapsed : !0;
        this.Ob = void 0 !== a.collapsible ? a.collapsible : !0;
        this.Ob || (this.sb = !1);
        var d = void 0 !== a.className ? a.className : "ol-overviewmap"
          , e = void 0 !== a.tipLabel ? a.tipLabel : "Overview map"
          , f = void 0 !== a.collapseLabel ? a.collapseLabel : "\u00ab";
        "string" === typeof f ? (this.Fd = document.createElement("span"),
        this.Fd.textContent = f) : this.Fd = f;
        f = void 0 !== a.label ? a.label : "\u00bb";
        "string" === typeof f ? (this.nb = document.createElement("span"),
        this.nb.textContent = f) : this.nb = f;
        var g = this.Ob && !this.sb ? this.Fd : this.nb;
        f = document.createElement("button");
        f.setAttribute("type", "button");
        f.title = e;
        f.appendChild(g);
        y(f, "click", this.qd, this);
        this.Ip = document.createElement("DIV");
        this.Ip.className = "ol-overviewmap-map";
        var k = this.Gc = new I({
            controls: new C,
            interactions: new C,
            view: a.view
        });
        a.layers && a.layers.forEach(function(a) {
            k.Br(a)
        }, this);
        e = document.createElement("DIV");
        e.className = "ol-overviewmap-box";
        e.style.boxSizing = "border-box";
        this.Zi = new kk({
            position: [0, 0],
            positioning: "bottom-left",
            element: e
        });
        this.Gc.Cr(this.Zi);
        e = document.createElement("div");
        e.className = d + " ol-unselectable ol-control" + (this.sb && this.Ob ? " ol-collapsed" : "") + (this.Ob ? "" : " ol-uncollapsible");
        e.appendChild(this.Ip);
        e.appendChild(f);
        sd.call(this, {
            element: e,
            render: a.render ? a.render : tk,
            target: a.target
        });
        var l = this
          , m = this.Zi
          , n = this.Zi.Cj();
        n.addEventListener("mousedown", function() {
            window.addEventListener("mousemove", c);
            window.addEventListener("mouseup", b)
        })
    }
    v(sk, sd);
    h = sk.prototype;
    h.setMap = function(a) {
        var b = this.B();
        a !== b && (b && ((b = b.R()) && Sc(b, bd("rotation"), this.gm, this),
        this.Gc.ac(null)),
        sd.prototype.setMap.call(this, a),
        a && (this.Gc.ac(this.Ip),
        this.Yg.push(y(a, "propertychange", this.jy, this)),
        0 === this.Gc.Te().Wb() && this.Gc.xu(a.Lg()),
        a = a.R())) && (y(a, bd("rotation"), this.gm, this),
        mg(a) && (this.Gc.Pi(),
        uk(this)))
    }
    ;
    h.jy = function(a) {
        "view" === a.key && ((a = a.oldValue) && Sc(a, bd("rotation"), this.gm, this),
        a = this.B().R(),
        y(a, bd("rotation"), this.gm, this))
    }
    ;
    h.gm = function() {
        this.Gc.R().Wd(this.B().R().ma())
    }
    ;
    function tk() {
        var a = this.B()
          , b = this.Gc;
        if (a.Da && b.Da) {
            var c = a.Ga();
            a = a.R().Ah(c);
            var d = b.Ga();
            c = b.R().Ah(d);
            var e = b.gb(nb(a))
              , f = b.gb(lb(a));
            b = Math.abs(e[0] - f[0]);
            e = Math.abs(e[1] - f[1]);
            f = d[0];
            d = d[1];
            b < .1 * f || e < .1 * d || b > .75 * f || e > .75 * d ? uk(this) : ab(c, a) || (c = this.B(),
            a = this.Gc,
            c = c.R(),
            a.R().Jc(c.Fa()))
        }
        vk(this)
    }
    function uk(a) {
        var b = a.B();
        a = a.Gc;
        var c = b.Ga();
        b = b.R().Ah(c);
        a = a.R();
        wb(b, 1 / (.1 * Math.pow(2, Math.log(7.5) / Math.LN2 / 2)));
        a.Io(b)
    }
    function vk(a) {
        var b = a.B()
          , c = a.Gc;
        if (b.Da && c.Da) {
            var d = b.Ga()
              , e = b.R()
              , f = c.R();
            c = e.ma();
            b = a.Zi;
            var g = a.Zi.Cj()
              , k = e.Ah(d);
            d = f.O();
            e = kb(k);
            f = mb(k);
            if (a = a.B().R().Fa()) {
                var l = [e[0] - a[0], e[1] - a[1]];
                gf(l, c);
                af(l, a)
            }
            b.setPosition(l);
            g && (g.style.width = Math.abs((e[0] - f[0]) / d) + "px",
            g.style.height = Math.abs((f[1] - e[1]) / d) + "px")
        }
    }
    h.qd = function(a) {
        a.preventDefault();
        this.Sg()
    }
    ;
    h.Sg = function() {
        this.element.classList.toggle("ol-collapsed");
        this.sb ? qd(this.Fd, this.nb) : qd(this.nb, this.Fd);
        this.sb = !this.sb;
        var a = this.Gc;
        this.sb || a.Da || (a.Pi(),
        uk(this),
        Rc(a, "postrender", function() {
            vk(this)
        }, this))
    }
    ;
    h.Qo = function() {
        return this.Ob
    }
    ;
    h.uq = function(a) {
        this.Ob !== a && (this.Ob = a,
        this.element.classList.toggle("ol-uncollapsible"),
        !a && this.sb && this.Sg())
    }
    ;
    h.tq = function(a) {
        this.Ob && this.sb !== a && this.Sg()
    }
    ;
    h.Po = function() {
        return this.sb
    }
    ;
    h.Bx = function() {
        return this.Gc
    }
    ;
    function wk(a) {
        a = a ? a : {};
        var b = void 0 !== a.className ? a.className : "ol-scale-line";
        this.rm = document.createElement("DIV");
        this.rm.className = b + "-inner";
        this.Ba = document.createElement("DIV");
        this.Ba.className = b + " ol-unselectable";
        this.Ba.appendChild(this.rm);
        this.iv = null;
        this.Gp = void 0 !== a.minWidth ? a.minWidth : 64;
        this.xb = !1;
        this.hu = void 0;
        this.zi = "";
        sd.call(this, {
            element: this.Ba,
            render: a.render ? a.render : xk,
            target: a.target
        });
        y(this, bd(yk), this.Ay, this);
        this.Fu(a.units || "metric")
    }
    v(wk, sd);
    var zk = [1, 2, 5];
    wk.prototype.pd = function() {
        return this.get(yk)
    }
    ;
    function xk(a) {
        this.iv = (a = a.frameState) ? a.viewState : null;
        this.On()
    }
    wk.prototype.Ay = function() {
        this.On()
    }
    ;
    wk.prototype.Fu = function(a) {
        this.set(yk, a)
    }
    ;
    wk.prototype.On = function() {
        var a = this.iv;
        if (a) {
            var b = a.center
              , c = a.projection
              , d = this.pd();
            a = dc(c, a.resolution, b, "degrees" == d ? "degrees" : "m");
            var e = this.Gp * a;
            b = "";
            "degrees" == d ? (b = Ib.degrees,
            "degrees" == c.pd() ? e *= b : a /= b,
            e < b / 60 ? (b = "\u2033",
            a *= 3600) : e < b ? (b = "\u2032",
            a *= 60) : b = "\u00b0") : "imperial" == d ? .9144 > e ? (b = "in",
            a /= .0254) : 1609.344 > e ? (b = "ft",
            a /= .3048) : (b = "mi",
            a /= 1609.344) : "nautical" == d ? (a /= 1852,
            b = "nm") : "metric" == d ? .001 > e ? (b = "\u03bcm",
            a *= 1E6) : 1 > e ? (b = "mm",
            a *= 1E3) : 1E3 > e ? b = "m" : (b = "km",
            a /= 1E3) : "us" == d ? .9144 > e ? (b = "in",
            a *= 39.37) : 1609.344 > e ? (b = "ft",
            a /= .30480061) : (b = "mi",
            a /= 1609.3472) : Fa(!1, 33);
            for (d = 3 * Math.floor(Math.log(this.Gp * a) / Math.log(10)); ; ) {
                e = zk[(d % 3 + 3) % 3] * Math.pow(10, Math.floor(d / 3));
                c = Math.round(e / a);
                if (isNaN(c)) {
                    this.Ba.style.display = "none";
                    this.xb = !1;
                    return
                }
                if (c >= this.Gp)
                    break;
                ++d
            }
            a = e + " " + b;
            this.zi != a && (this.zi = this.rm.innerHTML = a);
            this.hu != c && (this.rm.style.width = c + "px",
            this.hu = c);
            this.xb || (this.Ba.style.display = "",
            this.xb = !0)
        } else
            this.xb && (this.Ba.style.display = "none",
            this.xb = !1)
    }
    ;
    var yk = "units";
    function Ak(a) {
        a = a ? a : {};
        this.Fh = void 0;
        this.nj = Bk;
        this.Sn = this.im = 0;
        this.Jq = null;
        this.Iu = !1;
        this.Ha = void 0 !== a.duration ? a.duration : 200;
        var b = void 0 !== a.className ? a.className : "ol-zoomslider"
          , c = document.createElement("button");
        c.setAttribute("type", "button");
        c.className = b + "-thumb ol-unselectable";
        var d = document.createElement("div");
        d.className = b + " ol-unselectable ol-control";
        d.appendChild(c);
        this.Hl = new Fe(d);
        y(this.Hl, "pointerdown", this.Wx, this);
        y(this.Hl, "pointermove", this.Ux, this);
        y(this.Hl, "pointerup", this.Vx, this);
        y(d, "click", this.Rx, this);
        y(c, "click", Xc);
        sd.call(this, {
            element: d,
            render: a.render ? a.render : Ck
        })
    }
    v(Ak, sd);
    Ak.prototype.la = function() {
        Vc(this.Hl);
        sd.prototype.la.call(this)
    }
    ;
    var Bk = 0;
    h = Ak.prototype;
    h.setMap = function(a) {
        sd.prototype.setMap.call(this, a);
        a && a.render()
    }
    ;
    function Ck(a) {
        if (a.frameState) {
            if (!this.Iu) {
                var b = this.element
                  , c = b.offsetWidth
                  , d = b.offsetHeight
                  , e = b.firstElementChild
                  , f = getComputedStyle(e);
                b = e.offsetWidth + parseFloat(f.marginRight) + parseFloat(f.marginLeft);
                e = e.offsetHeight + parseFloat(f.marginTop) + parseFloat(f.marginBottom);
                this.Jq = [b, e];
                c > d ? (this.nj = 1,
                this.Sn = c - b) : (this.nj = Bk,
                this.im = d - e);
                this.Iu = !0
            }
            a = a.frameState.viewState.resolution;
            a !== this.Fh && (this.Fh = a,
            Dk(this, a))
        }
    }
    h.Rx = function(a) {
        var b = this.B().R();
        a = Ek(this, Ia(1 === this.nj ? (a.offsetX - this.Jq[0] / 2) / this.Sn : (a.offsetY - this.Jq[1] / 2) / this.im, 0, 1));
        b.rb({
            resolution: b.constrainResolution(a),
            duration: this.Ha,
            easing: wd
        })
    }
    ;
    h.Wx = function(a) {
        this.Pe || a.originalEvent.target !== this.element.firstElementChild || (fg(this.B().R(), 1, 1),
        this.Pp = a.clientX,
        this.Qp = a.clientY,
        this.Pe = !0)
    }
    ;
    h.Ux = function(a) {
        if (this.Pe) {
            var b = this.element.firstElementChild;
            this.Fh = Ek(this, Ia(1 === this.nj ? (a.clientX - this.Pp + parseInt(b.style.left, 10)) / this.Sn : (a.clientY - this.Qp + parseInt(b.style.top, 10)) / this.im, 0, 1));
            this.B().R().nh(this.Fh);
            Dk(this, this.Fh);
            this.Pp = a.clientX;
            this.Qp = a.clientY
        }
    }
    ;
    h.Vx = function() {
        if (this.Pe) {
            var a = this.B().R();
            fg(a, 1, -1);
            a.rb({
                resolution: a.constrainResolution(this.Fh),
                duration: this.Ha,
                easing: wd
            });
            this.Pe = !1;
            this.Qp = this.Pp = void 0
        }
    }
    ;
    function Dk(a, b) {
        b = 1 - lg(a.B().R())(b);
        var c = a.element.firstElementChild;
        1 == a.nj ? c.style.left = a.Sn * b + "px" : c.style.top = a.im * b + "px"
    }
    function Ek(a, b) {
        return kg(a.B().R())(1 - b)
    }
    ;function Fk(a) {
        a = a ? a : {};
        this.V = a.extent ? a.extent : null;
        var b = void 0 !== a.className ? a.className : "ol-zoom-extent"
          , c = void 0 !== a.label ? a.label : "E"
          , d = void 0 !== a.tipLabel ? a.tipLabel : "Fit to extent"
          , e = document.createElement("button");
        e.setAttribute("type", "button");
        e.title = d;
        e.appendChild("string" === typeof c ? document.createTextNode(c) : c);
        y(e, "click", this.qd, this);
        c = document.createElement("div");
        c.className = b + " ol-unselectable ol-control";
        c.appendChild(e);
        sd.call(this, {
            element: c,
            target: a.target
        })
    }
    v(Fk, sd);
    Fk.prototype.qd = function(a) {
        a.preventDefault();
        a = this.B().R();
        var b = this.V ? this.V : a.M().c();
        a.Io(b)
    }
    ;
    function Gk(a) {
        $c.call(this);
        a = a ? a : {};
        this.bk = null;
        y(this, bd(Hk), this.np, this);
        this.hg(void 0 !== a.tracking ? a.tracking : !1)
    }
    v(Gk, $c);
    h = Gk.prototype;
    h.la = function() {
        this.hg(!1);
        $c.prototype.la.call(this)
    }
    ;
    h.Bz = function(a) {
        if (null !== a.alpha) {
            var b = Na(a.alpha);
            this.set(Ik, b);
            "boolean" === typeof a.absolute && a.absolute ? this.set(Jk, b) : "number" === typeof a.webkitCompassHeading && -1 != a.webkitCompassAccuracy && this.set(Jk, Na(a.webkitCompassHeading))
        }
        null !== a.beta && this.set(Kk, Na(a.beta));
        null !== a.gamma && this.set(Lk, Na(a.gamma));
        this.a()
    }
    ;
    h.Uw = function() {
        return this.get(Ik)
    }
    ;
    h.Yw = function() {
        return this.get(Kk)
    }
    ;
    h.fx = function() {
        return this.get(Lk)
    }
    ;
    h.Yo = function() {
        return this.get(Jk)
    }
    ;
    h.Rj = function() {
        return this.get(Hk)
    }
    ;
    h.np = function() {
        if ($d) {
            var a = this.Rj();
            a && !this.bk ? this.bk = y(window, "deviceorientation", this.Bz, this) : a || null === this.bk || (Mc(this.bk),
            this.bk = null)
        }
    }
    ;
    h.hg = function(a) {
        this.set(Hk, a)
    }
    ;
    var Ik = "alpha"
      , Kk = "beta"
      , Lk = "gamma"
      , Jk = "heading"
      , Hk = "tracking";
    function Mk(a) {
        this.ff = a.opacity;
        this.Db = a.rotateWithView;
        this.Za = a.rotation;
        this.Ma = a.scale;
        this.fd = a.snapToPixel
    }
    h = Mk.prototype;
    h.tb = function() {
        return this.ff
    }
    ;
    h.Uh = function() {
        return this.Db
    }
    ;
    h.ma = function() {
        return this.Za
    }
    ;
    h.Vh = function() {
        return this.Ma
    }
    ;
    h.Wl = function() {
        return this.fd
    }
    ;
    h.oc = function(a) {
        this.ff = a
    }
    ;
    h.Wd = function(a) {
        this.Za = a
    }
    ;
    h.mf = function(a) {
        this.Ma = a
    }
    ;
    function Nk(a) {
        this.jm = this.J = this.Oe = null;
        this.ja = void 0 !== a.fill ? a.fill : null;
        this.Fc = [0, 0];
        this.wb = a.points;
        this.ob = void 0 !== a.radius ? a.radius : a.radius1;
        this.ve = a.radius2;
        this.Pc = void 0 !== a.angle ? a.angle : 0;
        this.ia = void 0 !== a.stroke ? a.stroke : null;
        this.yc = this.$a = this.Ib = null;
        this.vl = a.atlasManager;
        this.zk(this.vl);
        Mk.call(this, {
            opacity: 1,
            rotateWithView: void 0 !== a.rotateWithView ? a.rotateWithView : !1,
            rotation: void 0 !== a.rotation ? a.rotation : 0,
            scale: 1,
            snapToPixel: void 0 !== a.snapToPixel ? a.snapToPixel : !0
        })
    }
    v(Nk, Mk);
    h = Nk.prototype;
    h.clone = function() {
        var a = new Nk({
            fill: this.ja ? this.ja.clone() : void 0,
            points: this.We(),
            radius: this.wc(),
            radius2: this.ve,
            angle: this.Pc,
            snapToPixel: this.fd,
            stroke: this.ia ? this.ia.clone() : void 0,
            rotation: this.ma(),
            rotateWithView: this.Db,
            atlasManager: this.vl
        });
        a.oc(this.tb());
        a.mf(this.Ma);
        return a
    }
    ;
    h.Hg = function() {
        return this.Ib
    }
    ;
    h.No = function() {
        return this.Pc
    }
    ;
    h.Ph = function() {
        return this.ja
    }
    ;
    h.Dj = function() {
        return this.jm
    }
    ;
    h.N = function() {
        return this.J
    }
    ;
    h.Tl = function() {
        return this.yc
    }
    ;
    h.Kg = function() {
        return 2
    }
    ;
    h.ic = function() {
        return this.Fc
    }
    ;
    h.We = function() {
        return this.wb
    }
    ;
    h.wc = function() {
        return this.ob
    }
    ;
    h.Ns = function() {
        return this.ve
    }
    ;
    h.Ga = function() {
        return this.$a
    }
    ;
    h.Xh = function() {
        return this.ia
    }
    ;
    h.nt = function() {}
    ;
    h.load = function() {}
    ;
    h.Zu = function() {}
    ;
    h.zk = function(a) {
        var b = ""
          , c = ""
          , d = 0
          , e = null
          , f = 0
          , g = 0;
        if (this.ia) {
            var k = this.ia.W;
            null === k && (k = Th);
            k = od(k);
            g = this.ia.Sb();
            void 0 === g && (g = 1);
            e = this.ia.getLineDash();
            f = this.ia.Ac;
            Yd || (e = null,
            f = 0);
            c = this.ia.$c;
            void 0 === c && (c = "round");
            b = this.ia.Zc;
            void 0 === b && (b = "round");
            d = this.ia.ad;
            void 0 === d && (d = 10)
        }
        var l = 2 * (this.ob + g) + 1;
        b = {
            strokeStyle: k,
            Nu: g,
            size: l,
            lineCap: b,
            lineDash: e,
            lineDashOffset: f,
            lineJoin: c,
            miterLimit: d
        };
        if (void 0 === a) {
            var m = pd(l, l);
            this.J = m.canvas;
            a = l = this.J.width;
            this.gs(b, m, 0, 0);
            this.ja ? this.jm = this.J : (m = pd(b.size, b.size),
            this.jm = m.canvas,
            this.fs(b, m, 0, 0))
        } else
            l = Math.round(l),
            (c = !this.ja) && (m = this.fs.bind(this, b)),
            d = this.zj(),
            m = a.add(d, l, l, this.gs.bind(this, b), m),
            this.J = m.image,
            this.Fc = [m.offsetX, m.offsetY],
            a = m.image.width,
            this.jm = c ? m.Gy : this.J;
        this.Ib = [l / 2, l / 2];
        this.$a = [l, l];
        this.yc = [a, a]
    }
    ;
    h.gs = function(a, b, c, d) {
        b.setTransform(1, 0, 0, 1, 0, 0);
        b.translate(c, d);
        b.beginPath();
        var e = this.wb;
        if (Infinity === e)
            b.arc(a.size / 2, a.size / 2, this.ob, 0, 2 * Math.PI, !0);
        else {
            var f = void 0 !== this.ve ? this.ve : this.ob;
            f !== this.ob && (e *= 2);
            for (c = 0; c <= e; c++) {
                d = 2 * c * Math.PI / e - Math.PI / 2 + this.Pc;
                var g = 0 === c % 2 ? this.ob : f;
                b.lineTo(a.size / 2 + g * Math.cos(d), a.size / 2 + g * Math.sin(d))
            }
        }
        this.ja && (c = this.ja.W,
        null === c && (c = Rh),
        b.fillStyle = od(c),
        b.fill());
        this.ia && (b.strokeStyle = a.strokeStyle,
        b.lineWidth = a.Nu,
        a.lineDash && (b.setLineDash(a.lineDash),
        b.lineDashOffset = a.lineDashOffset),
        b.lineCap = a.lineCap,
        b.lineJoin = a.lineJoin,
        b.miterLimit = a.miterLimit,
        b.stroke());
        b.closePath()
    }
    ;
    h.fs = function(a, b, c, d) {
        b.setTransform(1, 0, 0, 1, 0, 0);
        b.translate(c, d);
        b.beginPath();
        c = this.wb;
        if (Infinity === c)
            b.arc(a.size / 2, a.size / 2, this.ob, 0, 2 * Math.PI, !0);
        else {
            d = void 0 !== this.ve ? this.ve : this.ob;
            d !== this.ob && (c *= 2);
            var e;
            for (e = 0; e <= c; e++) {
                var f = 2 * e * Math.PI / c - Math.PI / 2 + this.Pc;
                var g = 0 === e % 2 ? this.ob : d;
                b.lineTo(a.size / 2 + g * Math.cos(f), a.size / 2 + g * Math.sin(f))
            }
        }
        b.fillStyle = Rh;
        b.fill();
        this.ia && (b.strokeStyle = a.strokeStyle,
        b.lineWidth = a.Nu,
        a.lineDash && (b.setLineDash(a.lineDash),
        b.lineDashOffset = a.lineDashOffset),
        b.stroke());
        b.closePath()
    }
    ;
    h.zj = function() {
        var a = this.ia ? this.ia.zj() : "-"
          , b = this.ja ? this.ja.zj() : "-";
        this.Oe && a == this.Oe[1] && b == this.Oe[2] && this.ob == this.Oe[3] && this.ve == this.Oe[4] && this.Pc == this.Oe[5] && this.wb == this.Oe[6] || (this.Oe = ["r" + a + b + (void 0 !== this.ob ? this.ob.toString() : "-") + (void 0 !== this.ve ? this.ve.toString() : "-") + (void 0 !== this.Pc ? this.Pc.toString() : "-") + (void 0 !== this.wb ? this.wb.toString() : "-"), a, b, this.ob, this.ve, this.Pc, this.wb]);
        return this.Oe[0]
    }
    ;
    function Ok(a) {
        a = a || {};
        Nk.call(this, {
            points: Infinity,
            fill: a.fill,
            radius: a.radius,
            snapToPixel: a.snapToPixel,
            stroke: a.stroke,
            atlasManager: a.atlasManager
        })
    }
    v(Ok, Nk);
    Ok.prototype.clone = function() {
        var a = new Ok({
            fill: this.ja ? this.ja.clone() : void 0,
            stroke: this.ia ? this.ia.clone() : void 0,
            radius: this.wc(),
            snapToPixel: this.fd,
            atlasManager: this.vl
        });
        a.oc(this.tb());
        a.mf(this.Ma);
        return a
    }
    ;
    Ok.prototype.mh = function(a) {
        this.ob = a;
        this.zk(this.vl)
    }
    ;
    function Pk(a) {
        a = a || {};
        this.W = void 0 !== a.color ? a.color : null;
        this.mb = void 0
    }
    Pk.prototype.clone = function() {
        var a = this.W;
        return new Pk({
            color: a && a.slice ? a.slice() : a || void 0
        })
    }
    ;
    Pk.prototype.Aj = function() {
        return this.W
    }
    ;
    Pk.prototype.vq = function(a) {
        this.W = a;
        this.mb = void 0
    }
    ;
    Pk.prototype.zj = function() {
        void 0 === this.mb && (this.mb = this.W instanceof CanvasPattern || this.W instanceof CanvasGradient ? w(this.W).toString() : "f" + (this.W ? md(this.W) : "-"));
        return this.mb
    }
    ;
    function Qk(a) {
        a = a || {};
        this.Gg = null;
        this.Rb = Rk;
        void 0 !== a.geometry && this.Ab(a.geometry);
        this.ja = void 0 !== a.fill ? a.fill : null;
        this.s = void 0 !== a.image ? a.image : null;
        this.Ud = void 0 !== a.renderer ? a.renderer : null;
        this.ia = void 0 !== a.stroke ? a.stroke : null;
        this.S = void 0 !== a.text ? a.text : null;
        this.ov = a.zIndex
    }
    h = Qk.prototype;
    h.clone = function() {
        var a = this.I();
        a && a.clone && (a = a.clone());
        return new Qk({
            geometry: a,
            fill: this.ja ? this.ja.clone() : void 0,
            image: this.N() ? this.N().clone() : void 0,
            stroke: this.ia ? this.ia.clone() : void 0,
            text: this.S ? this.S.clone() : void 0,
            zIndex: this.La()
        })
    }
    ;
    h.Os = function() {
        return this.Ud
    }
    ;
    h.UA = function(a) {
        this.Ud = a
    }
    ;
    h.I = function() {
        return this.Gg
    }
    ;
    h.gx = function() {
        return this.Rb
    }
    ;
    h.Ph = function() {
        return this.ja
    }
    ;
    h.ln = function(a) {
        this.ja = a
    }
    ;
    h.N = function() {
        return this.s
    }
    ;
    h.xq = function(a) {
        this.s = a
    }
    ;
    h.Xh = function() {
        return this.ia
    }
    ;
    h.nn = function(a) {
        this.ia = a
    }
    ;
    h.gp = function() {
        return this.S
    }
    ;
    h.Bi = function(a) {
        this.S = a
    }
    ;
    h.La = function() {
        return this.ov
    }
    ;
    h.Ab = function(a) {
        "function" === typeof a ? this.Rb = a : "string" === typeof a ? this.Rb = function(b) {
            return b.get(a)
        }
        : a ? void 0 !== a && (this.Rb = function() {
            return a
        }
        ) : this.Rb = Rk;
        this.Gg = a
    }
    ;
    h.Ae = function(a) {
        this.ov = a
    }
    ;
    function Sk(a) {
        if ("function" !== typeof a) {
            if (Array.isArray(a))
                var b = a;
            else
                Fa(a instanceof Qk, 41),
                b = [a];
            a = function() {
                return b
            }
        }
        return a
    }
    var Tk = null;
    function Uk() {
        if (!Tk) {
            var a = new Pk({
                color: "rgba(255,255,255,0.4)"
            })
              , b = new nj({
                color: "#3399CC",
                width: 1.25
            });
            Tk = [new Qk({
                image: new Ok({
                    fill: a,
                    stroke: b,
                    radius: 5
                }),
                fill: a,
                stroke: b
            })]
        }
        return Tk
    }
    function Vk() {
        var a = {}
          , b = [255, 255, 255, 1]
          , c = [0, 153, 255, 1];
        a.Polygon = [new Qk({
            fill: new Pk({
                color: [255, 255, 255, .5]
            })
        })];
        a.MultiPolygon = a.Polygon;
        a.LineString = [new Qk({
            stroke: new nj({
                color: b,
                width: 5
            })
        }), new Qk({
            stroke: new nj({
                color: c,
                width: 3
            })
        })];
        a.MultiLineString = a.LineString;
        a.Circle = a.Polygon.concat(a.LineString);
        a.Point = [new Qk({
            image: new Ok({
                radius: 6,
                fill: new Pk({
                    color: c
                }),
                stroke: new nj({
                    color: b,
                    width: 1.5
                })
            }),
            zIndex: Infinity
        })];
        a.MultiPoint = a.Point;
        a.GeometryCollection = a.Polygon.concat(a.LineString, a.Point);
        return a
    }
    function Rk(a) {
        return a.I()
    }
    ;function Wk(a) {
        $c.call(this);
        this.vb = void 0;
        this.Ua = "geometry";
        this.Lc = null;
        this.Ce = void 0;
        this.Ql = null;
        y(this, bd(this.Ua), this.dm, this);
        void 0 !== a && (a instanceof qf || !a ? this.Ab(a) : this.f(a))
    }
    v(Wk, $c);
    h = Wk.prototype;
    h.clone = function() {
        var a = new Wk(this.l());
        a.lh(this.Ua);
        var b = this.I();
        b && a.Ab(b.clone());
        (b = this.Lc) && a.Gb(b);
        return a
    }
    ;
    h.I = function() {
        return this.get(this.Ua)
    }
    ;
    h.Ej = function() {
        return this.vb
    }
    ;
    h.hx = function() {
        return this.Ua
    }
    ;
    h.Ye = function() {
        return this.Lc
    }
    ;
    h.Xb = function() {
        return this.Ce
    }
    ;
    h.Zx = function() {
        this.a()
    }
    ;
    h.dm = function() {
        this.Ql && (Mc(this.Ql),
        this.Ql = null);
        var a = this.I();
        a && (this.Ql = y(a, "change", this.Zx, this));
        this.a()
    }
    ;
    h.Ab = function(a) {
        this.set(this.Ua, a)
    }
    ;
    h.Gb = function(a) {
        this.Ce = (this.Lc = a) ? Xk(a) : void 0;
        this.a()
    }
    ;
    h.kf = function(a) {
        this.vb = a;
        this.a()
    }
    ;
    h.lh = function(a) {
        Sc(this, bd(this.Ua), this.dm, this);
        this.Ua = a;
        y(this, bd(this.Ua), this.dm, this);
        this.dm()
    }
    ;
    function Xk(a) {
        if ("function" === typeof a)
            var b = 2 == a.length ? function(b) {
                return a(this, b)
            }
            : a;
        else {
            if (Array.isArray(a))
                var c = a;
            else
                Fa(a instanceof Qk, 41),
                c = [a];
            b = function() {
                return c
            }
        }
        return b
    }
    ;var Yk = document.implementation.createDocument("", "", null);
    function Zk(a, b) {
        return Yk.createElementNS(a, b)
    }
    function $k(a, b) {
        return al(a, b, []).join("")
    }
    function al(a, b, c) {
        if (a.nodeType == Node.CDATA_SECTION_NODE || a.nodeType == Node.TEXT_NODE)
            b ? c.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g, "")) : c.push(a.nodeValue);
        else
            for (a = a.firstChild; a; a = a.nextSibling)
                al(a, b, c);
        return c
    }
    function bl(a) {
        return a instanceof Document
    }
    function cl(a) {
        return a instanceof Node
    }
    function dl(a) {
        return (new DOMParser).parseFromString(a, "application/xml")
    }
    function el(a, b) {
        return function(c, d) {
            c = a.call(b, c, d);
            void 0 !== c && ta(d[d.length - 1], c)
        }
    }
    function fl(a, b) {
        return function(c, d) {
            c = a.call(void 0 !== b ? b : this, c, d);
            void 0 !== c && d[d.length - 1].push(c)
        }
    }
    function gl(a, b) {
        return function(c, d) {
            c = a.call(void 0 !== b ? b : this, c, d);
            void 0 !== c && (d[d.length - 1] = c)
        }
    }
    function hl(a) {
        return function(b, c) {
            var d = a.call(this, b, c);
            void 0 !== d && (c = c[c.length - 1],
            b = b.localName,
            (b in c ? c[b] : c[b] = []).push(d))
        }
    }
    function J(a, b) {
        return function(c, d) {
            var e = a.call(this, c, d);
            void 0 !== e && (d[d.length - 1][void 0 !== b ? b : c.localName] = e)
        }
    }
    function K(a, b) {
        return function(c, d, e) {
            a.call(void 0 !== b ? b : this, c, d, e);
            e[e.length - 1].node.appendChild(c)
        }
    }
    function il(a) {
        var b, c;
        return function(d, e, f) {
            if (void 0 === b) {
                b = {};
                var g = {};
                g[d.localName] = a;
                b[d.namespaceURI] = g;
                c = jl(d.localName)
            }
            kl(b, c, e, f)
        }
    }
    function jl(a, b) {
        return function(c, d, e) {
            c = d[d.length - 1].node;
            d = a;
            void 0 === d && (d = e);
            e = b;
            void 0 === b && (e = c.namespaceURI);
            return Zk(e, d)
        }
    }
    var ll = jl();
    function ml(a, b) {
        for (var c = b.length, d = Array(c), e = 0; e < c; ++e)
            d[e] = a[b[e]];
        return d
    }
    function L(a, b, c) {
        c = void 0 !== c ? c : {};
        var d;
        var e = 0;
        for (d = a.length; e < d; ++e)
            c[a[e]] = b;
        return c
    }
    function nl(a, b, c, d) {
        for (b = b.firstElementChild; b; b = b.nextElementSibling) {
            var e = a[b.namespaceURI];
            void 0 !== e && (e = e[b.localName],
            void 0 !== e && e.call(d, b, c))
        }
    }
    function M(a, b, c, d, e) {
        d.push(a);
        nl(b, c, d, e);
        return d.pop()
    }
    function kl(a, b, c, d, e, f) {
        for (var g = (void 0 !== e ? e : c).length, k, l, m = 0; m < g; ++m)
            k = c[m],
            void 0 !== k && (l = b.call(f, k, d, void 0 !== e ? e[m] : void 0),
            void 0 !== l && a[l.namespaceURI][l.localName].call(f, l, k, d))
    }
    function ql(a, b, c, d, e, f, g) {
        e.push(a);
        kl(b, c, d, e, f, g);
        e.pop()
    }
    ;function rl(a, b, c, d) {
        return function(e, f, g) {
            var k = new XMLHttpRequest;
            k.open("GET", "function" === typeof a ? a(e, f, g) : a, !0);
            "arraybuffer" == b.D() && (k.responseType = "arraybuffer");
            k.onload = function() {
                if (!k.status || 200 <= k.status && 300 > k.status) {
                    var a = b.D();
                    if ("json" == a || "text" == a)
                        var e = k.responseText;
                    else
                        "xml" == a ? (e = k.responseXML) || (e = dl(k.responseText)) : "arraybuffer" == a && (e = k.response);
                    e ? c.call(this, b.pb(e, {
                        featureProjection: g
                    }), b.mc(e), b.ap()) : d.call(this)
                } else
                    d.call(this)
            }
            .bind(this);
            k.onerror = function() {
                d.call(this)
            }
            .bind(this);
            k.send()
        }
    }
    function sl(a, b) {
        return rl(a, b, function(a) {
            this.vg(a)
        }, Ba)
    }
    ;function tl() {
        this.as = this.defaultDataProjection = null
    }
    function ul(a, b, c) {
        var d;
        c && (d = {
            dataProjection: c.dataProjection ? c.dataProjection : a.mc(b),
            featureProjection: c.featureProjection
        });
        return vl(a, d)
    }
    function vl(a, b) {
        return yb({
            dataProjection: a.defaultDataProjection,
            featureProjection: a.as
        }, b)
    }
    tl.prototype.ap = function() {
        return null
    }
    ;
    function wl(a, b, c) {
        var d = c ? ec(c.featureProjection) : null
          , e = c ? ec(c.dataProjection) : null;
        d = d && e && !nc(d, e) ? a instanceof qf ? (b ? a.clone() : a).transform(b ? d : e, b ? e : d) : rc(a, e, d) : a;
        if (b && c && void 0 !== c.decimals) {
            var f = Math.pow(10, c.decimals);
            d === a && (d = d.clone());
            d.xg(function(a) {
                for (var b = 0, c = a.length; b < c; ++b)
                    a[b] = Math.round(a[b] * f) / f;
                return a
            })
        }
        return d
    }
    ;function xl() {
        tl.call(this)
    }
    v(xl, tl);
    function yl(a) {
        return "string" === typeof a ? (a = JSON.parse(a)) ? a : null : null !== a ? a : null
    }
    h = xl.prototype;
    h.D = function() {
        return "json"
    }
    ;
    h.we = function(a, b) {
        return this.dh(yl(a), ul(this, a, b))
    }
    ;
    h.pb = function(a, b) {
        return this.Wp(yl(a), ul(this, a, b))
    }
    ;
    h.fh = function(a, b) {
        return this.$p(yl(a), ul(this, a, b))
    }
    ;
    h.mc = function(a) {
        return this.cq(yl(a))
    }
    ;
    h.Si = function(a, b) {
        return JSON.stringify(this.th(a, b))
    }
    ;
    h.Je = function(a, b) {
        return JSON.stringify(this.al(a, b))
    }
    ;
    h.uh = function(a, b) {
        return JSON.stringify(this.cl(a, b))
    }
    ;
    function zl(a, b, c, d, e, f) {
        var g = NaN
          , k = NaN
          , l = (c - b) / d;
        if (1 === l)
            g = a[b],
            k = a[b + 1];
        else if (2 == l)
            g = (1 - e) * a[b] + e * a[b + d],
            k = (1 - e) * a[b + 1] + e * a[b + d + 1];
        else if (0 !== l) {
            k = a[b];
            l = a[b + 1];
            var m = 0;
            g = [0];
            var n;
            for (n = b + d; n < c; n += d) {
                var p = a[n]
                  , q = a[n + 1];
                m += Math.sqrt((p - k) * (p - k) + (q - l) * (q - l));
                g.push(m);
                k = p;
                l = q
            }
            c = e * m;
            l = 0;
            m = g.length;
            for (n = !1; l < m; )
                e = l + (m - l >> 1),
                k = +qa(g[e], c),
                0 > k ? l = e + 1 : (m = e,
                n = !k);
            e = n ? l : ~l;
            0 > e ? (c = (c - g[-e - 2]) / (g[-e - 1] - g[-e - 2]),
            b += (-e - 2) * d,
            g = Pa(a[b], a[b + d], c),
            k = Pa(a[b + 1], a[b + d + 1], c)) : (g = a[b + e * d],
            k = a[b + e * d + 1])
        }
        return f ? (f[0] = g,
        f[1] = k,
        f) : [g, k]
    }
    function Al(a, b, c, d, e, f) {
        if (c == b)
            return null;
        if (e < a[b + d - 1])
            return f ? (c = a.slice(b, b + d),
            c[d - 1] = e,
            c) : null;
        if (a[c - 1] < e)
            return f ? (c = a.slice(c - d, c),
            c[d - 1] = e,
            c) : null;
        if (e == a[b + d - 1])
            return a.slice(b, b + d);
        b /= d;
        for (c /= d; b < c; )
            f = b + c >> 1,
            e < a[(f + 1) * d - 1] ? c = f : b = f + 1;
        c = a[b * d - 1];
        if (e == c)
            return a.slice((b - 1) * d, (b - 1) * d + d);
        f = (e - c) / (a[(b + 1) * d - 1] - c);
        c = [];
        var g;
        for (g = 0; g < d - 1; ++g)
            c.push(Pa(a[(b - 1) * d + g], a[b * d + g], f));
        c.push(e);
        return c
    }
    function Bl(a, b, c, d, e, f) {
        var g = 0;
        if (f)
            return Al(a, g, b[b.length - 1], c, d, e);
        if (d < a[c - 1])
            return e ? (a = a.slice(0, c),
            a[c - 1] = d,
            a) : null;
        if (a[a.length - 1] < d)
            return e ? (a = a.slice(a.length - c),
            a[c - 1] = d,
            a) : null;
        e = 0;
        for (f = b.length; e < f; ++e) {
            var k = b[e];
            if (g != k) {
                if (d < a[g + c - 1])
                    break;
                else if (d <= a[k - 1])
                    return Al(a, g, k, c, d, !1);
                g = k
            }
        }
        return null
    }
    ;function N(a, b) {
        tf.call(this);
        this.Jo = null;
        this.Cc = this.Dc = this.ws = -1;
        this.pa(a, b)
    }
    v(N, tf);
    h = N.prototype;
    h.dw = function(a) {
        this.b ? ta(this.b, a) : this.b = a.slice();
        this.a()
    }
    ;
    h.clone = function() {
        var a = new N(null);
        a.K(this.ha, this.b.slice());
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        if (d < Ya(this.c(), a, b))
            return d;
        this.Cc != this.Z && (this.Dc = Math.sqrt(Af(this.b, 0, this.b.length, this.C, 0)),
        this.Cc = this.Z);
        return Cf(this.b, 0, this.b.length, this.C, this.Dc, !1, a, b, c, d)
    }
    ;
    h.Mw = function(a, b) {
        return Sf(this.b, 0, this.b.length, this.C, a, b)
    }
    ;
    h.Ro = function(a, b) {
        return "XYM" != this.ha && "XYZM" != this.ha ? null : Al(this.b, 0, this.b.length, this.C, a, void 0 !== b ? b : !1)
    }
    ;
    h.H = function() {
        return Hf(this.b, 0, this.b.length, this.C)
    }
    ;
    h.Cs = function(a, b) {
        return zl(this.b, 0, this.b.length, this.C, a, b)
    }
    ;
    h.Wb = function() {
        var a = this.b, b = this.C, c = a[0], d = a[1], e = 0, f;
        for (f = 0 + b; f < this.b.length; f += b) {
            var g = a[f]
              , k = a[f + 1];
            e += Math.sqrt((g - c) * (g - c) + (k - d) * (k - d));
            c = g;
            d = k
        }
        return e
    }
    ;
    function bi(a) {
        a.ws != a.Z && (a.Jo = a.Cs(.5, a.Jo),
        a.ws = a.Z);
        return a.Jo
    }
    h.Wh = function(a) {
        var b = [];
        b.length = Lf(this.b, 0, this.b.length, this.C, a, b, 0);
        a = new N(null);
        a.K("XY", b);
        return a
    }
    ;
    h.D = function() {
        return "LineString"
    }
    ;
    h.Kb = function(a) {
        return Tf(this.b, 0, this.b.length, this.C, a)
    }
    ;
    h.pa = function(a, b) {
        a ? (wf(this, b, a, 1),
        this.b || (this.b = []),
        this.b.length = Ff(this.b, 0, a, this.C),
        this.a()) : this.K("XY", null)
    }
    ;
    h.K = function(a, b) {
        vf(this, a, b);
        this.a()
    }
    ;
    function P(a, b) {
        tf.call(this);
        this.U = [];
        this.Cc = this.Dc = -1;
        this.pa(a, b)
    }
    v(P, tf);
    h = P.prototype;
    h.ew = function(a) {
        this.b ? ta(this.b, a.X().slice()) : this.b = a.X().slice();
        this.U.push(this.b.length);
        this.a()
    }
    ;
    h.clone = function() {
        var a = new P(null);
        a.K(this.ha, this.b.slice(), this.U.slice());
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        if (d < Ya(this.c(), a, b))
            return d;
        this.Cc != this.Z && (this.Dc = Math.sqrt(Bf(this.b, 0, this.U, this.C, 0)),
        this.Cc = this.Z);
        return Df(this.b, 0, this.U, this.C, this.Dc, !1, a, b, c, d)
    }
    ;
    h.Ro = function(a, b, c) {
        return "XYM" != this.ha && "XYZM" != this.ha || 0 === this.b.length ? null : Bl(this.b, this.U, this.C, a, void 0 !== b ? b : !1, void 0 !== c ? c : !1)
    }
    ;
    h.H = function() {
        return If(this.b, 0, this.U, this.C)
    }
    ;
    h.rx = function(a) {
        if (0 > a || this.U.length <= a)
            return null;
        var b = new N(null);
        b.K(this.ha, this.b.slice(0 === a ? 0 : this.U[a - 1], this.U[a]));
        return b
    }
    ;
    h.Sh = function() {
        var a = this.b, b = this.U, c = this.ha, d = [], e = 0, f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var k = b[g]
              , l = new N(null);
            l.K(c, a.slice(e, k));
            d.push(l);
            e = k
        }
        return d
    }
    ;
    function ci(a) {
        var b = []
          , c = a.b
          , d = 0
          , e = a.U;
        a = a.C;
        var f;
        var g = 0;
        for (f = e.length; g < f; ++g) {
            var k = e[g];
            d = zl(c, d, k, a, .5);
            ta(b, d);
            d = k
        }
        return b
    }
    h.Wh = function(a) {
        var b = [], c = [], d = this.b, e = this.U, f = this.C, g = 0, k = 0, l;
        var m = 0;
        for (l = e.length; m < l; ++m) {
            var n = e[m];
            k = Lf(d, g, n, f, a, b, k);
            c.push(k);
            g = n
        }
        b.length = k;
        a = new P(null);
        a.K("XY", b, c);
        return a
    }
    ;
    h.D = function() {
        return "MultiLineString"
    }
    ;
    h.Kb = function(a) {
        a: {
            var b = this.b, c = this.U, d = this.C, e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g) {
                if (Tf(b, e, c[g], d, a)) {
                    a = !0;
                    break a
                }
                e = c[g]
            }
            a = !1
        }
        return a
    }
    ;
    h.pa = function(a, b) {
        a ? (wf(this, b, a, 2),
        this.b || (this.b = []),
        a = Gf(this.b, 0, a, this.C, this.U),
        this.b.length = 0 === a.length ? 0 : a[a.length - 1],
        this.a()) : this.K("XY", null, this.U)
    }
    ;
    h.K = function(a, b, c) {
        vf(this, a, b);
        this.U = c;
        this.a()
    }
    ;
    function Cl(a, b) {
        var c = a.ha, d = [], e = [], f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var k = b[g];
            0 === g && (c = k.ha);
            ta(d, k.X());
            e.push(d.length)
        }
        a.K(c, d, e)
    }
    ;function Q(a, b) {
        tf.call(this);
        this.pa(a, b)
    }
    v(Q, tf);
    h = Q.prototype;
    h.gw = function(a) {
        this.b ? ta(this.b, a.X()) : this.b = a.X().slice();
        this.a()
    }
    ;
    h.clone = function() {
        var a = new Q(null);
        a.K(this.ha, this.b.slice());
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        if (d < Ya(this.c(), a, b))
            return d;
        var e = this.b, f = this.C, g;
        var k = 0;
        for (g = e.length; k < g; k += f) {
            var l = Ma(a, b, e[k], e[k + 1]);
            if (l < d) {
                d = l;
                for (l = 0; l < f; ++l)
                    c[l] = e[k + l];
                c.length = f
            }
        }
        return d
    }
    ;
    h.H = function() {
        return Hf(this.b, 0, this.b.length, this.C)
    }
    ;
    h.Dx = function(a) {
        var b = this.b ? this.b.length / this.C : 0;
        if (0 > a || b <= a)
            return null;
        b = new D(null);
        b.K(this.ha, this.b.slice(a * this.C, (a + 1) * this.C));
        return b
    }
    ;
    h.We = function() {
        var a = this.b, b = this.ha, c = this.C, d = [], e;
        var f = 0;
        for (e = a.length; f < e; f += c) {
            var g = new D(null);
            g.K(b, a.slice(f, f + c));
            d.push(g)
        }
        return d
    }
    ;
    h.D = function() {
        return "MultiPoint"
    }
    ;
    h.Kb = function(a) {
        var b = this.b, c = this.C, d;
        var e = 0;
        for (d = b.length; e < d; e += c) {
            var f = b[e];
            var g = b[e + 1];
            if ($a(a, f, g))
                return !0
        }
        return !1
    }
    ;
    h.pa = function(a, b) {
        a ? (wf(this, b, a, 1),
        this.b || (this.b = []),
        this.b.length = Ff(this.b, 0, a, this.C),
        this.a()) : this.K("XY", null)
    }
    ;
    h.K = function(a, b) {
        vf(this, a, b);
        this.a()
    }
    ;
    function R(a, b) {
        tf.call(this);
        this.Ia = [];
        this.us = -1;
        this.vs = null;
        this.pk = this.Cc = this.Dc = -1;
        this.Qd = null;
        this.pa(a, b)
    }
    v(R, tf);
    h = R.prototype;
    h.hw = function(a) {
        if (this.b) {
            var b = this.b.length;
            ta(this.b, a.X());
            a = a.U.slice();
            var c;
            var d = 0;
            for (c = a.length; d < c; ++d)
                a[d] += b
        } else
            this.b = a.X().slice(),
            a = a.U.slice(),
            this.Ia.push();
        this.Ia.push(a);
        this.a()
    }
    ;
    h.clone = function() {
        for (var a = new R(null), b = this.Ia.length, c = Array(b), d = 0; d < b; ++d)
            c[d] = this.Ia[d].slice();
        a.K(this.ha, this.b.slice(), c);
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        if (d < Ya(this.c(), a, b))
            return d;
        if (this.Cc != this.Z) {
            var e = this.Ia, f = 0, g = 0, k;
            var l = 0;
            for (k = e.length; l < k; ++l) {
                var m = e[l];
                g = Bf(this.b, f, m, this.C, g);
                f = m[m.length - 1]
            }
            this.Dc = Math.sqrt(g);
            this.Cc = this.Z
        }
        e = this.ub();
        f = this.Ia;
        g = this.C;
        l = this.Dc;
        k = 0;
        m = [NaN, NaN];
        var n;
        var p = 0;
        for (n = f.length; p < n; ++p) {
            var q = f[p];
            d = Df(e, k, q, g, l, !0, a, b, c, d, m);
            k = q[q.length - 1]
        }
        return d
    }
    ;
    h.de = function(a, b) {
        a: {
            var c = this.ub()
              , d = this.Ia
              , e = 0;
            if (0 !== d.length) {
                var f;
                var g = 0;
                for (f = d.length; g < f; ++g) {
                    var k = d[g];
                    if (Qf(c, e, k, this.C, a, b)) {
                        a = !0;
                        break a
                    }
                    e = k[k.length - 1]
                }
            }
            a = !1
        }
        return a
    }
    ;
    h.yj = function() {
        var a = this.ub(), b = this.Ia, c = 0, d = 0, e;
        var f = 0;
        for (e = b.length; f < e; ++f) {
            var g = b[f];
            d += yf(a, c, g, this.C);
            c = g[g.length - 1]
        }
        return d
    }
    ;
    h.H = function(a) {
        if (void 0 !== a) {
            var b = this.ub().slice();
            Yf(b, this.Ia, this.C, a)
        } else
            b = this.b;
        return Kf(b, 0, this.Ia, this.C)
    }
    ;
    function di(a) {
        if (a.us != a.Z) {
            var b = a.b, c = a.Ia, d = a.C, e = 0, f = [], g;
            var k = 0;
            for (g = c.length; k < g; ++k) {
                var l = c[k];
                e = fb(b, e, l[0], d);
                f.push((e[0] + e[2]) / 2, (e[1] + e[3]) / 2);
                e = l[l.length - 1]
            }
            b = a.ub();
            c = a.Ia;
            d = a.C;
            k = 0;
            g = [];
            l = 0;
            for (e = c.length; l < e; ++l) {
                var m = c[l];
                g = Rf(b, k, m, d, f, 2 * l, g);
                k = m[m.length - 1]
            }
            a.vs = g;
            a.us = a.Z
        }
        return a.vs
    }
    h.nx = function() {
        var a = new Q(null);
        a.K("XY", di(this).slice());
        return a
    }
    ;
    h.ub = function() {
        if (this.pk != this.Z) {
            var a = this.b;
            a: {
                var b = this.Ia;
                var c;
                var d = 0;
                for (c = b.length; d < c; ++d)
                    if (!Wf(a, b[d], this.C, void 0)) {
                        b = !1;
                        break a
                    }
                b = !0
            }
            b ? this.Qd = a : (this.Qd = a.slice(),
            this.Qd.length = Yf(this.Qd, this.Ia, this.C));
            this.pk = this.Z
        }
        return this.Qd
    }
    ;
    h.Wh = function(a) {
        var b = []
          , c = []
          , d = this.b
          , e = this.Ia
          , f = this.C;
        a = Math.sqrt(a);
        var g = 0, k = 0, l;
        var m = 0;
        for (l = e.length; m < l; ++m) {
            var n = e[m]
              , p = [];
            k = Mf(d, g, n, f, a, b, k, p);
            c.push(p);
            g = n[n.length - 1]
        }
        b.length = k;
        d = new R(null);
        d.K("XY", b, c);
        return d
    }
    ;
    h.Ex = function(a) {
        if (0 > a || this.Ia.length <= a)
            return null;
        if (0 === a)
            var b = 0;
        else
            b = this.Ia[a - 1],
            b = b[b.length - 1];
        a = this.Ia[a].slice();
        var c = a[a.length - 1];
        if (0 !== b) {
            var d;
            var e = 0;
            for (d = a.length; e < d; ++e)
                a[e] -= b
        }
        e = new F(null);
        e.K(this.ha, this.b.slice(b, c), a);
        return e
    }
    ;
    h.Jj = function() {
        var a = this.ha, b = this.b, c = this.Ia, d = [], e = 0, f, g;
        var k = 0;
        for (f = c.length; k < f; ++k) {
            var l = c[k].slice()
              , m = l[l.length - 1];
            if (0 !== e) {
                var n = 0;
                for (g = l.length; n < g; ++n)
                    l[n] -= e
            }
            n = new F(null);
            n.K(a, b.slice(e, m), l);
            d.push(n);
            e = m
        }
        return d
    }
    ;
    h.D = function() {
        return "MultiPolygon"
    }
    ;
    h.Kb = function(a) {
        a: {
            var b = this.ub(), c = this.Ia, d = this.C, e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g) {
                var k = c[g];
                if (Uf(b, e, k, d, a)) {
                    a = !0;
                    break a
                }
                e = k[k.length - 1]
            }
            a = !1
        }
        return a
    }
    ;
    h.pa = function(a, b) {
        if (a) {
            wf(this, b, a, 3);
            this.b || (this.b = []);
            b = this.b;
            var c = this.C
              , d = this.Ia
              , e = 0;
            d = d ? d : [];
            var f = 0, g;
            var k = 0;
            for (g = a.length; k < g; ++k)
                e = Gf(b, e, a[k], c, d[f]),
                d[f++] = e,
                e = e[e.length - 1];
            d.length = f;
            0 === d.length ? this.b.length = 0 : (a = d[d.length - 1],
            this.b.length = 0 === a.length ? 0 : a[a.length - 1]);
            this.a()
        } else
            this.K("XY", null, this.Ia)
    }
    ;
    h.K = function(a, b, c) {
        vf(this, a, b);
        this.Ia = c;
        this.a()
    }
    ;
    function Dl(a, b) {
        var c = a.ha, d = [], e = [], f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var k = b[g];
            0 === g && (c = k.ha);
            var l = d.length;
            var m = k.U;
            var n;
            var p = 0;
            for (n = m.length; p < n; ++p)
                m[p] += l;
            ta(d, k.X());
            e.push(m)
        }
        a.K(c, d, e)
    }
    ;function El(a) {
        a = a ? a : {};
        tl.call(this);
        this.Ua = a.geometryName
    }
    v(El, xl);
    function Fl(a, b) {
        if (!a)
            return null;
        if ("number" === typeof a.x && "number" === typeof a.y)
            var c = "Point";
        else if (a.points)
            c = "MultiPoint";
        else if (a.sk)
            c = 1 === a.sk.length ? "LineString" : "MultiLineString";
        else if (a.jh) {
            var d = a.jh
              , e = Gl(a)
              , f = []
              , g = [];
            c = [];
            var k;
            var l = 0;
            for (k = d.length; l < k; ++l)
                f.length = 0,
                Ff(f, 0, d[l], e.length),
                Vf(f, 0, f.length, e.length) ? g.push([d[l]]) : c.push(d[l]);
            for (; c.length; ) {
                d = c.shift();
                e = !1;
                for (l = g.length - 1; 0 <= l; l--)
                    if (ab((new Nf(g[l][0])).c(), (new Nf(d)).c())) {
                        g[l].push(d);
                        e = !0;
                        break
                    }
                e || g.push([d.reverse()])
            }
            a = yb({}, a);
            1 === g.length ? (c = "Polygon",
            a.jh = g[0]) : (c = "MultiPolygon",
            a.jh = g)
        }
        return wl((0,
        Hl[c])(a), !1, b)
    }
    function Gl(a) {
        var b = "XY";
        !0 === a.hasZ && !0 === a.$b ? b = "XYZM" : !0 === a.hasZ ? b = "XYZ" : !0 === a.$b && (b = "XYM");
        return b
    }
    function Il(a) {
        a = a.ha;
        return {
            hasZ: "XYZ" === a || "XYZM" === a,
            $b: "XYM" === a || "XYZM" === a
        }
    }
    var Hl = {
        Point: function(a) {
            return void 0 !== a.dk && void 0 !== a.z ? new D([a.x, a.y, a.z, a.dk],"XYZM") : void 0 !== a.z ? new D([a.x, a.y, a.z],"XYZ") : void 0 !== a.dk ? new D([a.x, a.y, a.dk],"XYM") : new D([a.x, a.y])
        },
        LineString: function(a) {
            return new N(a.sk[0],Gl(a))
        },
        Polygon: function(a) {
            return new F(a.jh,Gl(a))
        },
        MultiPoint: function(a) {
            return new Q(a.points,Gl(a))
        },
        MultiLineString: function(a) {
            return new P(a.sk,Gl(a))
        },
        MultiPolygon: function(a) {
            return new R(a.jh,Gl(a))
        }
    }
      , Jl = {
        Point: function(a) {
            var b = a.H(), c;
            a = a.ha;
            "XYZ" === a ? c = {
                x: b[0],
                y: b[1],
                z: b[2]
            } : "XYM" === a ? c = {
                x: b[0],
                y: b[1],
                dk: b[2]
            } : "XYZM" === a ? c = {
                x: b[0],
                y: b[1],
                z: b[2],
                dk: b[3]
            } : "XY" === a ? c = {
                x: b[0],
                y: b[1]
            } : Fa(!1, 34);
            return c
        },
        LineString: function(a) {
            var b = Il(a);
            return {
                hasZ: b.hasZ,
                $b: b.$b,
                sk: [a.H()]
            }
        },
        Polygon: function(a) {
            var b = Il(a);
            return {
                hasZ: b.hasZ,
                $b: b.$b,
                jh: a.H(!1)
            }
        },
        MultiPoint: function(a) {
            var b = Il(a);
            return {
                hasZ: b.hasZ,
                $b: b.$b,
                points: a.H()
            }
        },
        MultiLineString: function(a) {
            var b = Il(a);
            return {
                hasZ: b.hasZ,
                $b: b.$b,
                sk: a.H()
            }
        },
        MultiPolygon: function(a) {
            var b = Il(a);
            a = a.H(!1);
            for (var c = [], d = 0; d < a.length; d++)
                for (var e = a[d].length - 1; 0 <= e; e--)
                    c.push(a[d][e]);
            return {
                hasZ: b.hasZ,
                $b: b.$b,
                jh: c
            }
        }
    };
    h = El.prototype;
    h.dh = function(a, b) {
        var c = Fl(a.geometry, b)
          , d = new Wk;
        this.Ua && d.lh(this.Ua);
        d.Ab(c);
        b && b.tp && a.attributes[b.tp] && d.kf(a.attributes[b.tp]);
        a.attributes && d.f(a.attributes);
        return d
    }
    ;
    h.Wp = function(a, b) {
        b = b ? b : {};
        if (a.features) {
            var c = [], d = a.features, e;
            b.tp = a.qC;
            a = 0;
            for (e = d.length; a < e; ++a)
                c.push(this.dh(d[a], b));
            return c
        }
        return [this.dh(a, b)]
    }
    ;
    h.$p = function(a, b) {
        return Fl(a, b)
    }
    ;
    h.cq = function(a) {
        return a.Lu && a.Lu.kv ? ec("EPSG:" + a.Lu.kv) : null
    }
    ;
    function Kl(a, b) {
        return (0,
        Jl[a.D()])(wl(a, !0, b), b)
    }
    h.cl = function(a, b) {
        return Kl(a, vl(this, b))
    }
    ;
    h.th = function(a, b) {
        b = vl(this, b);
        var c = {}
          , d = a.I();
        d && (c.geometry = Kl(d, b),
        b && b.featureProjection && (c.geometry.spatialReference = {
            kv: ec(b.featureProjection).qc.split(":").pop()
        }));
        b = a.l();
        delete b[a.Ua];
        c.attributes = Bb(b) ? {} : b;
        return c
    }
    ;
    h.al = function(a, b) {
        b = vl(this, b);
        var c = [], d;
        var e = 0;
        for (d = a.length; e < d; ++e)
            c.push(this.th(a[e], b));
        return {
            features: c
        }
    }
    ;
    function Ll(a) {
        this.pf = a
    }
    ;function Ml(a, b) {
        this.pf = a;
        this.Tr = Array.prototype.slice.call(arguments, 1);
        Fa(2 <= this.Tr.length, 57)
    }
    v(Ml, Ll);
    function Nl(a) {
        var b = ["And"].concat(Array.prototype.slice.call(arguments));
        Ml.apply(this, b)
    }
    v(Nl, Ml);
    function Ol(a, b, c) {
        this.pf = "BBOX";
        this.geometryName = a;
        this.extent = b;
        this.srsName = c
    }
    v(Ol, Ll);
    function Pl(a, b) {
        this.pf = a;
        this.propertyName = b
    }
    v(Pl, Ll);
    function Ql(a, b, c) {
        Pl.call(this, "During", a);
        this.Yi = b;
        this.end = c
    }
    v(Ql, Pl);
    function Rl(a, b, c, d) {
        Pl.call(this, a, b);
        this.Dw = c;
        this.fk = d
    }
    v(Rl, Pl);
    function Sl(a, b, c) {
        Rl.call(this, "PropertyIsEqualTo", a, b, c)
    }
    v(Sl, Rl);
    function Tl(a, b) {
        Rl.call(this, "PropertyIsGreaterThan", a, b)
    }
    v(Tl, Rl);
    function Ul(a, b) {
        Rl.call(this, "PropertyIsGreaterThanOrEqualTo", a, b)
    }
    v(Ul, Rl);
    function Vl(a, b, c, d) {
        this.pf = a;
        this.geometryName = b || "the_geom";
        this.geometry = c;
        this.srsName = d
    }
    v(Vl, Ll);
    function Wl(a, b, c) {
        Vl.call(this, "Intersects", a, b, c)
    }
    v(Wl, Vl);
    function Xl(a, b, c) {
        Pl.call(this, "PropertyIsBetween", a);
        this.$y = b;
        this.EB = c
    }
    v(Xl, Pl);
    function Yl(a, b, c, d, e, f) {
        Pl.call(this, "PropertyIsLike", a);
        this.pattern = b;
        this.KB = void 0 !== c ? c : "*";
        this.aB = void 0 !== d ? d : ".";
        this.Bw = void 0 !== e ? e : "!";
        this.fk = f
    }
    v(Yl, Pl);
    function Zl(a) {
        Pl.call(this, "PropertyIsNull", a)
    }
    v(Zl, Pl);
    function $l(a, b) {
        Rl.call(this, "PropertyIsLessThan", a, b)
    }
    v($l, Rl);
    function am(a, b) {
        Rl.call(this, "PropertyIsLessThanOrEqualTo", a, b)
    }
    v(am, Rl);
    function bm(a) {
        this.pf = "Not";
        this.condition = a
    }
    v(bm, Ll);
    function cm(a, b, c) {
        Rl.call(this, "PropertyIsNotEqualTo", a, b, c)
    }
    v(cm, Rl);
    function dm(a) {
        var b = ["Or"].concat(Array.prototype.slice.call(arguments));
        Ml.apply(this, b)
    }
    v(dm, Ml);
    function em(a, b, c) {
        Vl.call(this, "Within", a, b, c)
    }
    v(em, Vl);
    function fm(a) {
        var b = [null].concat(Array.prototype.slice.call(arguments));
        return new (Function.prototype.bind.apply(Nl, b))
    }
    function gm(a, b, c) {
        return new Ol(a,b,c)
    }
    ;function hm(a) {
        qf.call(this);
        this.Ja = a ? a : null;
        im(this)
    }
    v(hm, qf);
    function jm(a) {
        var b = [], c;
        var d = 0;
        for (c = a.length; d < c; ++d)
            b.push(a[d].clone());
        return b
    }
    function km(a) {
        var b;
        if (a.Ja) {
            var c = 0;
            for (b = a.Ja.length; c < b; ++c)
                Sc(a.Ja[c], "change", a.a, a)
        }
    }
    function im(a) {
        var b;
        if (a.Ja) {
            var c = 0;
            for (b = a.Ja.length; c < b; ++c)
                y(a.Ja[c], "change", a.a, a)
        }
    }
    h = hm.prototype;
    h.clone = function() {
        var a = new hm(null);
        a.vu(this.Ja);
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        if (d < Ya(this.c(), a, b))
            return d;
        var e = this.Ja, f;
        var g = 0;
        for (f = e.length; g < f; ++g)
            d = e[g].Ed(a, b, c, d);
        return d
    }
    ;
    h.de = function(a, b) {
        var c = this.Ja, d;
        var e = 0;
        for (d = c.length; e < d; ++e)
            if (c[e].de(a, b))
                return !0;
        return !1
    }
    ;
    h.Bl = function(a) {
        db(a);
        for (var b = this.Ja, c = 0, d = b.length; c < d; ++c)
            ib(a, b[c].c());
        return a
    }
    ;
    h.Rh = function() {
        return jm(this.Ja)
    }
    ;
    h.Kj = function(a) {
        this.rn != this.Z && (zb(this.ig),
        this.jg = 0,
        this.rn = this.Z);
        if (0 > a || 0 !== this.jg && a < this.jg)
            return this;
        var b = a.toString();
        if (this.ig.hasOwnProperty(b))
            return this.ig[b];
        var c = [], d = this.Ja, e = !1, f;
        var g = 0;
        for (f = d.length; g < f; ++g) {
            var k = d[g]
              , l = k.Kj(a);
            c.push(l);
            l !== k && (e = !0)
        }
        if (e)
            return a = new hm(null),
            km(a),
            a.Ja = c,
            im(a),
            a.a(),
            this.ig[b] = a;
        this.jg = a;
        return this
    }
    ;
    h.D = function() {
        return "GeometryCollection"
    }
    ;
    h.Kb = function(a) {
        var b = this.Ja, c;
        var d = 0;
        for (c = b.length; d < c; ++d)
            if (b[d].Kb(a))
                return !0;
        return !1
    }
    ;
    h.Nd = function() {
        return 0 === this.Ja.length
    }
    ;
    h.rotate = function(a, b) {
        for (var c = this.Ja, d = 0, e = c.length; d < e; ++d)
            c[d].rotate(a, b);
        this.a()
    }
    ;
    h.scale = function(a, b, c) {
        c || (c = sb(this.c()));
        for (var d = this.Ja, e = 0, f = d.length; e < f; ++e)
            d[e].scale(a, b, c);
        this.a()
    }
    ;
    h.vu = function(a) {
        a = jm(a);
        km(this);
        this.Ja = a;
        im(this);
        this.a()
    }
    ;
    h.xg = function(a) {
        var b = this.Ja, c;
        var d = 0;
        for (c = b.length; d < c; ++d)
            b[d].xg(a);
        this.a()
    }
    ;
    h.translate = function(a, b) {
        var c = this.Ja, d;
        var e = 0;
        for (d = c.length; e < d; ++e)
            c[e].translate(a, b);
        this.a()
    }
    ;
    h.la = function() {
        km(this);
        qf.prototype.la.call(this)
    }
    ;
    function lm(a) {
        a = a ? a : {};
        tl.call(this);
        this.defaultDataProjection = ec(a.defaultDataProjection ? a.defaultDataProjection : "EPSG:4326");
        a.featureProjection && (this.as = ec(a.featureProjection));
        this.Ua = a.geometryName
    }
    v(lm, xl);
    function mm(a, b) {
        return a ? wl((0,
        nm[a.type])(a), !1, b) : null
    }
    function om(a, b) {
        return (0,
        pm[a.D()])(wl(a, !0, b), b)
    }
    var nm = {
        Point: function(a) {
            return new D(a.coordinates)
        },
        LineString: function(a) {
            return new N(a.coordinates)
        },
        Polygon: function(a) {
            return new F(a.coordinates)
        },
        MultiPoint: function(a) {
            return new Q(a.coordinates)
        },
        MultiLineString: function(a) {
            return new P(a.coordinates)
        },
        MultiPolygon: function(a) {
            return new R(a.coordinates)
        },
        GeometryCollection: function(a, b) {
            a = a.geometries.map(function(a) {
                return mm(a, b)
            });
            return new hm(a)
        }
    }
      , pm = {
        Point: function(a) {
            return {
                type: "Point",
                coordinates: a.H()
            }
        },
        LineString: function(a) {
            return {
                type: "LineString",
                coordinates: a.H()
            }
        },
        Polygon: function(a, b) {
            if (b)
                var c = b.rightHanded;
            return {
                type: "Polygon",
                coordinates: a.H(c)
            }
        },
        MultiPoint: function(a) {
            return {
                type: "MultiPoint",
                coordinates: a.H()
            }
        },
        MultiLineString: function(a) {
            return {
                type: "MultiLineString",
                coordinates: a.H()
            }
        },
        MultiPolygon: function(a, b) {
            if (b)
                var c = b.rightHanded;
            return {
                type: "MultiPolygon",
                coordinates: a.H(c)
            }
        },
        GeometryCollection: function(a, b) {
            return {
                type: "GeometryCollection",
                geometries: a.Ja.map(function(a) {
                    var c = yb({}, b);
                    delete c.featureProjection;
                    return om(a, c)
                })
            }
        },
        Circle: function() {
            return {
                type: "GeometryCollection",
                geometries: []
            }
        }
    };
    h = lm.prototype;
    h.dh = function(a, b) {
        a = "Feature" === a.type ? a : {
            type: "Feature",
            geometry: a
        };
        b = mm(a.geometry, b);
        var c = new Wk;
        this.Ua && c.lh(this.Ua);
        c.Ab(b);
        void 0 !== a.id && c.kf(a.id);
        a.properties && c.f(a.properties);
        return c
    }
    ;
    h.Wp = function(a, b) {
        if ("FeatureCollection" === a.type) {
            var c = [];
            a = a.features;
            var d;
            var e = 0;
            for (d = a.length; e < d; ++e)
                c.push(this.dh(a[e], b))
        } else
            c = [this.dh(a, b)];
        return c
    }
    ;
    h.$p = function(a, b) {
        return mm(a, b)
    }
    ;
    h.cq = function(a) {
        a = a.crs;
        var b;
        a ? "name" == a.type ? b = ec(a.properties.name) : "EPSG" == a.type ? b = ec("EPSG:" + a.properties.code) : Fa(!1, 36) : b = this.defaultDataProjection;
        return b
    }
    ;
    h.th = function(a, b) {
        b = vl(this, b);
        var c = {
            type: "Feature"
        }
          , d = a.vb;
        void 0 !== d && (c.id = d);
        d = a.I();
        c.geometry = d ? om(d, b) : null;
        b = a.l();
        delete b[a.Ua];
        c.properties = Bb(b) ? null : b;
        return c
    }
    ;
    h.al = function(a, b) {
        b = vl(this, b);
        var c = [], d;
        var e = 0;
        for (d = a.length; e < d; ++e)
            c.push(this.th(a[e], b));
        return {
            type: "FeatureCollection",
            features: c
        }
    }
    ;
    h.cl = function(a, b) {
        return om(a, vl(this, b))
    }
    ;
    function qm() {
        this.nr = new XMLSerializer;
        tl.call(this)
    }
    v(qm, tl);
    h = qm.prototype;
    h.D = function() {
        return "xml"
    }
    ;
    h.we = function(a, b) {
        return bl(a) ? rm(this, a, b) : cl(a) ? this.Vp(a, b) : "string" === typeof a ? (a = dl(a),
        rm(this, a, b)) : null
    }
    ;
    function rm(a, b, c) {
        a = sm(a, b, c);
        return 0 < a.length ? a[0] : null
    }
    h.Vp = function() {
        return null
    }
    ;
    h.pb = function(a, b) {
        return bl(a) ? sm(this, a, b) : cl(a) ? this.eg(a, b) : "string" === typeof a ? (a = dl(a),
        sm(this, a, b)) : []
    }
    ;
    function sm(a, b, c) {
        var d = [];
        for (b = b.firstChild; b; b = b.nextSibling)
            b.nodeType == Node.ELEMENT_NODE && ta(d, a.eg(b, c));
        return d
    }
    h.fh = function(a, b) {
        if (bl(a))
            return null;
        if (cl(a))
            return this.Zt(a, b);
        "string" === typeof a && dl(a);
        return null
    }
    ;
    h.Zt = function() {
        return null
    }
    ;
    h.mc = function(a) {
        return bl(a) ? this.bq(a) : cl(a) ? this.bn(a) : "string" === typeof a ? (a = dl(a),
        this.bq(a)) : null
    }
    ;
    h.bq = function() {
        return this.defaultDataProjection
    }
    ;
    h.bn = function() {
        return this.defaultDataProjection
    }
    ;
    h.Si = function(a, b) {
        return this.nr.serializeToString(this.cr(a, b))
    }
    ;
    h.cr = function() {
        return null
    }
    ;
    h.Je = function(a, b) {
        a = this.Ke(a, b);
        return this.nr.serializeToString(a)
    }
    ;
    h.Ke = function() {
        return null
    }
    ;
    h.uh = function(a, b) {
        a = this.bl(a, b);
        return this.nr.serializeToString(a)
    }
    ;
    h.bl = function() {
        return null
    }
    ;
    function tm(a) {
        a = a ? a : {};
        this.featureType = a.featureType;
        this.featureNS = a.featureNS;
        this.srsName = a.srsName;
        this.schemaLocation = "";
        this.sg = {};
        this.sg["http://www.opengis.net/gml"] = {
            featureMember: gl(tm.prototype.wk),
            featureMembers: gl(tm.prototype.wk)
        };
        qm.call(this)
    }
    v(tm, qm);
    var um = /^[\s\xa0]*$/;
    h = tm.prototype;
    h.wk = function(a, b) {
        var c = a.localName
          , d = null;
        if ("FeatureCollection" == c)
            d = "http://www.opengis.net/wfs" === a.namespaceURI ? M([], this.sg, a, b, this) : M(null, this.sg, a, b, this);
        else if ("featureMembers" == c || "featureMember" == c) {
            var e = b[0]
              , f = e.featureType;
            d = e.featureNS;
            var g;
            if (!f && a.childNodes) {
                f = [];
                d = {};
                var k = 0;
                for (g = a.childNodes.length; k < g; ++k) {
                    var l = a.childNodes[k];
                    if (1 === l.nodeType) {
                        var m = l.nodeName.split(":").pop();
                        if (-1 === f.indexOf(m)) {
                            var n = ""
                              , p = 0;
                            l = l.namespaceURI;
                            for (var q in d) {
                                if (d[q] === l) {
                                    n = q;
                                    break
                                }
                                ++p
                            }
                            n || (n = "p" + p,
                            d[n] = l);
                            f.push(n + ":" + m)
                        }
                    }
                }
                "featureMember" != c && (e.featureType = f,
                e.featureNS = d)
            }
            "string" === typeof d && (k = d,
            d = {},
            d.p0 = k);
            q = {};
            f = Array.isArray(f) ? f : [f];
            for (var t in d) {
                e = {};
                k = 0;
                for (g = f.length; k < g; ++k)
                    (-1 === f[k].indexOf(":") ? "p0" : f[k].split(":")[0]) === t && (e[f[k].split(":").pop()] = "featureMembers" == c ? fl(this.Up, this) : gl(this.Up, this));
                q[d[t]] = e
            }
            d = "featureMember" == c ? M(void 0, q, a, b) : M([], q, a, b)
        }
        null === d && (d = []);
        return d
    }
    ;
    h.Zm = function(a, b) {
        var c = b[0];
        c.srsName = a.firstElementChild.getAttribute("srsName");
        if (a = M(null, this.qr, a, b, this))
            return wl(a, !1, c)
    }
    ;
    h.Up = function(a, b) {
        var c;
        (c = a.getAttribute("fid")) || (c = a.getAttributeNS("http://www.opengis.net/gml", "id") || "");
        var d = {}, e;
        for (a = a.firstElementChild; a; a = a.nextElementSibling) {
            var f = a.localName;
            if (0 === a.childNodes.length || 1 === a.childNodes.length && (3 === a.firstChild.nodeType || 4 === a.firstChild.nodeType)) {
                var g = $k(a, !1);
                um.test(g) && (g = void 0);
                d[f] = g
            } else
                "boundedBy" !== f && (e = f),
                d[f] = this.Zm(a, b)
        }
        b = new Wk(d);
        e && b.lh(e);
        c && b.kf(c);
        return b
    }
    ;
    h.du = function(a, b) {
        if (a = this.Xm(a, b))
            return b = new D(null),
            b.K("XYZ", a),
            b
    }
    ;
    h.bu = function(a, b) {
        if (a = M([], this.zv, a, b, this))
            return new Q(a)
    }
    ;
    h.au = function(a, b) {
        if (a = M([], this.yv, a, b, this))
            return b = new P(null),
            Cl(b, a),
            b
    }
    ;
    h.cu = function(a, b) {
        if (a = M([], this.Av, a, b, this))
            return b = new R(null),
            Dl(b, a),
            b
    }
    ;
    h.Rt = function(a, b) {
        nl(this.Ev, a, b, this)
    }
    ;
    h.mt = function(a, b) {
        nl(this.wv, a, b, this)
    }
    ;
    h.St = function(a, b) {
        nl(this.Fv, a, b, this)
    }
    ;
    h.$m = function(a, b) {
        if (a = this.Xm(a, b))
            return b = new N(null),
            b.K("XYZ", a),
            b
    }
    ;
    h.bA = function(a, b) {
        if (a = M(null, this.ll, a, b, this))
            return a
    }
    ;
    h.$t = function(a, b) {
        if (a = this.Xm(a, b))
            return b = new Nf(null),
            b.K("XYZ", a),
            b
    }
    ;
    h.an = function(a, b) {
        if ((a = M([null], this.Xn, a, b, this)) && a[0]) {
            b = new F(null);
            var c = a[0], d = [c.length], e;
            var f = 1;
            for (e = a.length; f < e; ++f)
                ta(c, a[f]),
                d.push(c.length);
            b.K("XYZ", c, d);
            return b
        }
    }
    ;
    h.Xm = function(a, b) {
        return M(null, this.ll, a, b, this)
    }
    ;
    h.zv = {
        "http://www.opengis.net/gml": {
            pointMember: fl(tm.prototype.Rt),
            pointMembers: fl(tm.prototype.Rt)
        }
    };
    h.yv = {
        "http://www.opengis.net/gml": {
            lineStringMember: fl(tm.prototype.mt),
            lineStringMembers: fl(tm.prototype.mt)
        }
    };
    h.Av = {
        "http://www.opengis.net/gml": {
            polygonMember: fl(tm.prototype.St),
            polygonMembers: fl(tm.prototype.St)
        }
    };
    h.Ev = {
        "http://www.opengis.net/gml": {
            Point: fl(tm.prototype.Xm)
        }
    };
    h.wv = {
        "http://www.opengis.net/gml": {
            LineString: fl(tm.prototype.$m)
        }
    };
    h.Fv = {
        "http://www.opengis.net/gml": {
            Polygon: fl(tm.prototype.an)
        }
    };
    h.ml = {
        "http://www.opengis.net/gml": {
            LinearRing: gl(tm.prototype.bA)
        }
    };
    h.Zt = function(a, b) {
        return (a = this.Zm(a, [ul(this, a, b ? b : {})])) ? a : null
    }
    ;
    h.eg = function(a, b) {
        var c = {
            featureType: this.featureType,
            featureNS: this.featureNS
        };
        b && yb(c, ul(this, a, b));
        return this.wk(a, [c]) || []
    }
    ;
    h.bn = function(a) {
        return ec(this.srsName ? this.srsName : a.firstElementChild.getAttribute("srsName"))
    }
    ;
    function vm(a) {
        a = $k(a, !1);
        return wm(a)
    }
    function wm(a) {
        if (a = /^\s*(true|1)|(false|0)\s*$/.exec(a))
            return void 0 !== a[1] || !1
    }
    function xm(a) {
        a = $k(a, !1);
        a = Date.parse(a);
        return isNaN(a) ? void 0 : a / 1E3
    }
    function ym(a) {
        a = $k(a, !1);
        return zm(a)
    }
    function zm(a) {
        if (a = /^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(a))
            return parseFloat(a[1])
    }
    function Am(a) {
        a = $k(a, !1);
        return Bm(a)
    }
    function Bm(a) {
        if (a = /^\s*(\d+)\s*$/.exec(a))
            return parseInt(a[1], 10)
    }
    function S(a) {
        return $k(a, !1).trim()
    }
    function Cm(a, b) {
        Dm(a, b ? "1" : "0")
    }
    function Em(a, b) {
        a.appendChild(Yk.createTextNode(b.toPrecision()))
    }
    function Fm(a, b) {
        a.appendChild(Yk.createTextNode(b.toString()))
    }
    function Dm(a, b) {
        a.appendChild(Yk.createTextNode(b))
    }
    ;function Gm(a) {
        a = a ? a : {};
        tm.call(this, a);
        this.Pu = void 0 !== a.surface ? a.surface : !1;
        this.$r = void 0 !== a.curve ? a.curve : !1;
        this.It = void 0 !== a.multiCurve ? a.multiCurve : !0;
        this.Jt = void 0 !== a.multiSurface ? a.multiSurface : !0;
        this.schemaLocation = a.schemaLocation ? a.schemaLocation : "http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd";
        this.hasZ = void 0 !== a.hasZ ? a.hasZ : !1
    }
    v(Gm, tm);
    h = Gm.prototype;
    h.fA = function(a, b) {
        if (a = M([], this.xv, a, b, this))
            return b = new P(null),
            Cl(b, a),
            b
    }
    ;
    h.gA = function(a, b) {
        if (a = M([], this.Bv, a, b, this))
            return b = new R(null),
            Dl(b, a),
            b
    }
    ;
    h.Zr = function(a, b) {
        nl(this.rv, a, b, this)
    }
    ;
    h.Ou = function(a, b) {
        nl(this.Hv, a, b, this)
    }
    ;
    h.jA = function(a, b) {
        return M([null], this.Cv, a, b, this)
    }
    ;
    h.mA = function(a, b) {
        return M([null], this.Gv, a, b, this)
    }
    ;
    h.kA = function(a, b) {
        return M([null], this.Xn, a, b, this)
    }
    ;
    h.eA = function(a, b) {
        return M([null], this.ll, a, b, this)
    }
    ;
    h.Ny = function(a, b) {
        (a = M(void 0, this.ml, a, b, this)) && b[b.length - 1].push(a)
    }
    ;
    h.Ew = function(a, b) {
        (a = M(void 0, this.ml, a, b, this)) && (b[b.length - 1][0] = a)
    }
    ;
    h.eu = function(a, b) {
        if ((a = M([null], this.Iv, a, b, this)) && a[0]) {
            b = new F(null);
            var c = a[0], d = [c.length], e;
            var f = 1;
            for (e = a.length; f < e; ++f)
                ta(c, a[f]),
                d.push(c.length);
            b.K("XYZ", c, d);
            return b
        }
    }
    ;
    h.Wt = function(a, b) {
        if (a = M([null], this.sv, a, b, this))
            return b = new N(null),
            b.K("XYZ", a),
            b
    }
    ;
    h.$z = function(a, b) {
        a = M([null], this.tv, a, b, this);
        return cb(a[1][0], a[1][1], a[2][0], a[2][1])
    }
    ;
    h.cA = function(a, b) {
        var c = $k(a, !1)
          , d = /^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/;
        a = [];
        for (var e; e = d.exec(c); )
            a.push(parseFloat(e[1])),
            c = c.substr(e[0].length);
        if ("" === c) {
            b = b[0].srsName;
            c = "enu";
            b && (c = ec(b).be);
            if ("neu" === c)
                for (b = 0,
                c = a.length; b < c; b += 3)
                    d = a[b],
                    a[b] = a[b + 1],
                    a[b + 1] = d;
            b = a.length;
            2 == b && a.push(0);
            if (0 !== b)
                return a
        }
    }
    ;
    h.Zp = function(a, b) {
        var c = $k(a, !1).replace(/^\s*|\s*$/g, "")
          , d = b[0].srsName
          , e = a.parentNode.getAttribute("srsDimension");
        b = "enu";
        d && (b = ec(d).be);
        c = c.split(/\s+/);
        d = 2;
        a.getAttribute("srsDimension") ? d = Bm(a.getAttribute("srsDimension")) : a.getAttribute("dimension") ? d = Bm(a.getAttribute("dimension")) : e && (d = Bm(e));
        for (var f, g = [], k = 0, l = c.length; k < l; k += d)
            a = parseFloat(c[k]),
            e = parseFloat(c[k + 1]),
            f = 3 === d ? parseFloat(c[k + 2]) : 0,
            "en" === b.substr(0, 2) ? g.push(a, e, f) : g.push(e, a, f);
        return g
    }
    ;
    h.ll = {
        "http://www.opengis.net/gml": {
            pos: gl(Gm.prototype.cA),
            posList: gl(Gm.prototype.Zp)
        }
    };
    h.Xn = {
        "http://www.opengis.net/gml": {
            interior: Gm.prototype.Ny,
            exterior: Gm.prototype.Ew
        }
    };
    h.qr = {
        "http://www.opengis.net/gml": {
            Point: gl(tm.prototype.du),
            MultiPoint: gl(tm.prototype.bu),
            LineString: gl(tm.prototype.$m),
            MultiLineString: gl(tm.prototype.au),
            LinearRing: gl(tm.prototype.$t),
            Polygon: gl(tm.prototype.an),
            MultiPolygon: gl(tm.prototype.cu),
            Surface: gl(Gm.prototype.eu),
            MultiSurface: gl(Gm.prototype.gA),
            Curve: gl(Gm.prototype.Wt),
            MultiCurve: gl(Gm.prototype.fA),
            Envelope: gl(Gm.prototype.$z)
        }
    };
    h.xv = {
        "http://www.opengis.net/gml": {
            curveMember: fl(Gm.prototype.Zr),
            curveMembers: fl(Gm.prototype.Zr)
        }
    };
    h.Bv = {
        "http://www.opengis.net/gml": {
            surfaceMember: fl(Gm.prototype.Ou),
            surfaceMembers: fl(Gm.prototype.Ou)
        }
    };
    h.rv = {
        "http://www.opengis.net/gml": {
            LineString: fl(tm.prototype.$m),
            Curve: fl(Gm.prototype.Wt)
        }
    };
    h.Hv = {
        "http://www.opengis.net/gml": {
            Polygon: fl(tm.prototype.an),
            Surface: fl(Gm.prototype.eu)
        }
    };
    h.Iv = {
        "http://www.opengis.net/gml": {
            patches: gl(Gm.prototype.jA)
        }
    };
    h.sv = {
        "http://www.opengis.net/gml": {
            segments: gl(Gm.prototype.mA)
        }
    };
    h.tv = {
        "http://www.opengis.net/gml": {
            lowerCorner: fl(Gm.prototype.Zp),
            upperCorner: fl(Gm.prototype.Zp)
        }
    };
    h.Cv = {
        "http://www.opengis.net/gml": {
            PolygonPatch: gl(Gm.prototype.kA)
        }
    };
    h.Gv = {
        "http://www.opengis.net/gml": {
            LineStringSegment: gl(Gm.prototype.eA)
        }
    };
    h.Rl = function(a, b, c) {
        var d = "enu";
        b && (d = ec(b).be);
        b = "en" === d.substr(0, 2) ? a[0] + " " + a[1] : a[1] + " " + a[0];
        c && (b += " " + (a[2] || 0));
        return b
    }
    ;
    function Hm(a, b, c, d) {
        var e = d[d.length - 1];
        d = e.hasZ;
        e = e.srsName;
        c = c.H();
        for (var f = c.length, g = Array(f), k, l = 0; l < f; ++l)
            k = c[l],
            g[l] = a.Rl(k, e, d);
        Dm(b, g.join(" "))
    }
    h.il = function(a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute("srsName", d);
        d = Zk(a.namespaceURI, "pos");
        a.appendChild(d);
        c = c[c.length - 1];
        a = c.hasZ;
        var e = c.srsName;
        c = "enu";
        e && (c = ec(e).be);
        b = b.H();
        c = "en" === c.substr(0, 2) ? b[0] + " " + b[1] : b[1] + " " + b[0];
        a && (c += " " + (b[2] || 0));
        Dm(d, c)
    }
    ;
    var Im = {
        "http://www.opengis.net/gml": {
            lowerCorner: K(Dm),
            upperCorner: K(Dm)
        }
    };
    h = Gm.prototype;
    h.br = function(a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute("srsName", d);
        ql({
            node: a
        }, Im, ll, [b[0] + " " + b[1], b[2] + " " + b[3]], c, ["lowerCorner", "upperCorner"], this)
    }
    ;
    h.fl = function(a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute("srsName", d);
        d = Zk(a.namespaceURI, "posList");
        a.appendChild(d);
        Hm(this, d, b, c)
    }
    ;
    h.Zn = function(a, b) {
        a = b[b.length - 1];
        b = a.node;
        var c = a.exteriorWritten;
        void 0 === c && (a.exteriorWritten = !0);
        return Zk(b.namespaceURI, void 0 !== c ? "interior" : "exterior")
    }
    ;
    h.yf = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.hasZ;
        d = d.srsName;
        "PolygonPatch" !== a.nodeName && d && a.setAttribute("srsName", d);
        "Polygon" === a.nodeName || "PolygonPatch" === a.nodeName ? (b = b.Hj(),
        ql({
            node: a,
            hasZ: e,
            srsName: d
        }, Jm, this.Zn, b, c, void 0, this)) : "Surface" === a.nodeName && (e = Zk(a.namespaceURI, "patches"),
        a.appendChild(e),
        this.mr(e, b, c))
    }
    ;
    h.wf = function(a, b, c) {
        var d = c[c.length - 1].srsName;
        "LineStringSegment" !== a.nodeName && d && a.setAttribute("srsName", d);
        "LineString" === a.nodeName || "LineStringSegment" === a.nodeName ? (d = Zk(a.namespaceURI, "posList"),
        a.appendChild(d),
        Hm(this, d, b, c)) : "Curve" === a.nodeName && (d = Zk(a.namespaceURI, "segments"),
        a.appendChild(d),
        this.ar(d, b, c))
    }
    ;
    h.hl = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.hasZ
          , f = d.srsName;
        d = d.surface;
        f && a.setAttribute("srsName", f);
        b = b.Jj();
        ql({
            node: a,
            hasZ: e,
            srsName: f,
            surface: d
        }, Km, this.Ui, b, c, void 0, this)
    }
    ;
    h.hr = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.srsName;
        d = d.hasZ;
        e && a.setAttribute("srsName", e);
        b = b.We();
        ql({
            node: a,
            hasZ: d,
            srsName: e
        }, Lm, jl("pointMember"), b, c, void 0, this)
    }
    ;
    h.gl = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.hasZ
          , f = d.srsName;
        d = d.curve;
        f && a.setAttribute("srsName", f);
        b = b.Sh();
        ql({
            node: a,
            hasZ: e,
            srsName: f,
            curve: d
        }, Mm, this.Ui, b, c, void 0, this)
    }
    ;
    h.jl = function(a, b, c) {
        var d = Zk(a.namespaceURI, "LinearRing");
        a.appendChild(d);
        this.fl(d, b, c)
    }
    ;
    h.kl = function(a, b, c) {
        var d = this.tg(b, c);
        d && (a.appendChild(d),
        this.yf(d, b, c))
    }
    ;
    h.kr = function(a, b, c) {
        var d = Zk(a.namespaceURI, "Point");
        a.appendChild(d);
        this.il(d, b, c)
    }
    ;
    h.el = function(a, b, c) {
        var d = this.tg(b, c);
        d && (a.appendChild(d),
        this.wf(d, b, c))
    }
    ;
    h.mr = function(a, b, c) {
        var d = Zk(a.namespaceURI, "PolygonPatch");
        a.appendChild(d);
        this.yf(d, b, c)
    }
    ;
    h.ar = function(a, b, c) {
        var d = Zk(a.namespaceURI, "LineStringSegment");
        a.appendChild(d);
        this.wf(d, b, c)
    }
    ;
    h.xf = function(a, b, c) {
        var d = c[c.length - 1]
          , e = yb({}, d);
        e.node = a;
        a = Array.isArray(b) ? d.dataProjection ? rc(b, d.featureProjection, d.dataProjection) : b : wl(b, !0, d);
        ql(e, Nm, this.tg, [a], c, void 0, this)
    }
    ;
    h.Vn = function(a, b, c) {
        var d = b.vb;
        d && a.setAttribute("fid", d);
        d = c[c.length - 1];
        var e = d.featureNS
          , f = b.Ua;
        d.nc || (d.nc = {},
        d.nc[e] = {});
        var g = b.l();
        b = [];
        var k = [];
        for (m in g) {
            var l = g[m];
            null !== l && (b.push(m),
            k.push(l),
            m == f || l instanceof qf ? m in d.nc[e] || (d.nc[e][m] = K(this.xf, this)) : m in d.nc[e] || (d.nc[e][m] = K(Dm)))
        }
        var m = yb({}, d);
        m.node = a;
        ql(m, d.nc, jl(void 0, e), k, c, b)
    }
    ;
    var Km = {
        "http://www.opengis.net/gml": {
            surfaceMember: K(Gm.prototype.kl),
            polygonMember: K(Gm.prototype.kl)
        }
    }
      , Lm = {
        "http://www.opengis.net/gml": {
            pointMember: K(Gm.prototype.kr)
        }
    }
      , Mm = {
        "http://www.opengis.net/gml": {
            lineStringMember: K(Gm.prototype.el),
            curveMember: K(Gm.prototype.el)
        }
    }
      , Jm = {
        "http://www.opengis.net/gml": {
            exterior: K(Gm.prototype.jl),
            interior: K(Gm.prototype.jl)
        }
    }
      , Nm = {
        "http://www.opengis.net/gml": {
            Curve: K(Gm.prototype.wf),
            MultiCurve: K(Gm.prototype.gl),
            Point: K(Gm.prototype.il),
            MultiPoint: K(Gm.prototype.hr),
            LineString: K(Gm.prototype.wf),
            MultiLineString: K(Gm.prototype.gl),
            LinearRing: K(Gm.prototype.fl),
            Polygon: K(Gm.prototype.yf),
            MultiPolygon: K(Gm.prototype.hl),
            Surface: K(Gm.prototype.yf),
            MultiSurface: K(Gm.prototype.hl),
            Envelope: K(Gm.prototype.br)
        }
    }
      , Om = {
        MultiLineString: "lineStringMember",
        MultiCurve: "curveMember",
        MultiPolygon: "polygonMember",
        MultiSurface: "surfaceMember"
    };
    Gm.prototype.Ui = function(a, b) {
        return Zk("http://www.opengis.net/gml", Om[b[b.length - 1].node.nodeName])
    }
    ;
    Gm.prototype.tg = function(a, b) {
        var c = b[b.length - 1];
        b = c.multiSurface;
        var d = c.surface
          , e = c.curve;
        c = c.multiCurve;
        Array.isArray(a) ? a = "Envelope" : (a = a.D(),
        "MultiPolygon" === a && !0 === b ? a = "MultiSurface" : "Polygon" === a && !0 === d ? a = "Surface" : "LineString" === a && !0 === e ? a = "Curve" : "MultiLineString" === a && !0 === c && (a = "MultiCurve"));
        return Zk("http://www.opengis.net/gml", a)
    }
    ;
    Gm.prototype.bl = function(a, b) {
        b = vl(this, b);
        var c = Zk("http://www.opengis.net/gml", "geom")
          , d = {
            node: c,
            hasZ: this.hasZ,
            srsName: this.srsName,
            curve: this.$r,
            surface: this.Pu,
            multiSurface: this.Jt,
            multiCurve: this.It
        };
        b && yb(d, b);
        this.xf(c, a, [d]);
        return c
    }
    ;
    Gm.prototype.Ke = function(a, b) {
        b = vl(this, b);
        var c = Zk("http://www.opengis.net/gml", "featureMembers");
        c.setAttributeNS("http://www.w3.org/2001/XMLSchema-instance", "xsi:schemaLocation", this.schemaLocation);
        var d = {
            srsName: this.srsName,
            hasZ: this.hasZ,
            curve: this.$r,
            surface: this.Pu,
            multiSurface: this.Jt,
            multiCurve: this.It,
            featureNS: this.featureNS,
            featureType: this.featureType
        };
        b && yb(d, b);
        b = [d];
        var e = b[b.length - 1];
        d = e.featureType;
        var f = e.featureNS
          , g = {};
        g[f] = {};
        g[f][d] = K(this.Vn, this);
        e = yb({}, e);
        e.node = c;
        ql(e, g, jl(d, f), a, b);
        return c
    }
    ;
    function Pm(a) {
        a = a ? a : {};
        tm.call(this, a);
        this.sg["http://www.opengis.net/gml"].featureMember = fl(tm.prototype.wk);
        this.schemaLocation = a.schemaLocation ? a.schemaLocation : "http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd"
    }
    v(Pm, tm);
    h = Pm.prototype;
    h.Yt = function(a, b) {
        a = $k(a, !1).replace(/^\s*|\s*$/g, "");
        var c = b[0].srsName;
        b = "enu";
        c && (c = ec(c)) && (b = c.be);
        a = a.trim().split(/\s+/);
        for (var d, e, f = [], g = 0, k = a.length; g < k; g++)
            e = a[g].split(/,+/),
            c = parseFloat(e[0]),
            d = parseFloat(e[1]),
            e = 3 === e.length ? parseFloat(e[2]) : 0,
            "en" === b.substr(0, 2) ? f.push(c, d, e) : f.push(d, c, e);
        return f
    }
    ;
    h.Yz = function(a, b) {
        a = M([null], this.pv, a, b, this);
        return cb(a[1][0], a[1][1], a[1][3], a[1][4])
    }
    ;
    h.Jy = function(a, b) {
        (a = M(void 0, this.ml, a, b, this)) && b[b.length - 1].push(a)
    }
    ;
    h.Dz = function(a, b) {
        (a = M(void 0, this.ml, a, b, this)) && (b[b.length - 1][0] = a)
    }
    ;
    h.ll = {
        "http://www.opengis.net/gml": {
            coordinates: gl(Pm.prototype.Yt)
        }
    };
    h.Xn = {
        "http://www.opengis.net/gml": {
            innerBoundaryIs: Pm.prototype.Jy,
            outerBoundaryIs: Pm.prototype.Dz
        }
    };
    h.pv = {
        "http://www.opengis.net/gml": {
            coordinates: fl(Pm.prototype.Yt)
        }
    };
    h.qr = {
        "http://www.opengis.net/gml": {
            Point: gl(tm.prototype.du),
            MultiPoint: gl(tm.prototype.bu),
            LineString: gl(tm.prototype.$m),
            MultiLineString: gl(tm.prototype.au),
            LinearRing: gl(tm.prototype.$t),
            Polygon: gl(tm.prototype.an),
            MultiPolygon: gl(tm.prototype.cu),
            Box: gl(Pm.prototype.Yz)
        }
    };
    h.tg = function(a, b) {
        var c = b[b.length - 1];
        b = c.multiSurface;
        var d = c.surface;
        c = c.multiCurve;
        Array.isArray(a) ? a = "Envelope" : (a = a.D(),
        "MultiPolygon" === a && !0 === b ? a = "MultiSurface" : "Polygon" === a && !0 === d ? a = "Surface" : "MultiLineString" === a && !0 === c && (a = "MultiCurve"));
        return Zk("http://www.opengis.net/gml", a)
    }
    ;
    h.Vn = function(a, b, c) {
        var d = b.vb;
        d && a.setAttribute("fid", d);
        d = c[c.length - 1];
        var e = d.featureNS
          , f = b.Ua;
        d.nc || (d.nc = {},
        d.nc[e] = {});
        var g = b.l();
        b = [];
        var k = [];
        for (m in g) {
            var l = g[m];
            null !== l && (b.push(m),
            k.push(l),
            m == f || l instanceof qf ? m in d.nc[e] || (d.nc[e][m] = K(this.xf, this)) : m in d.nc[e] || (d.nc[e][m] = K(Dm)))
        }
        var m = yb({}, d);
        m.node = a;
        ql(m, d.nc, jl(void 0, e), k, c, b)
    }
    ;
    h.xf = function(a, b, c) {
        var d = c[c.length - 1]
          , e = yb({}, d);
        e.node = a;
        a = Array.isArray(b) ? d.dataProjection ? rc(b, d.featureProjection, d.dataProjection) : b : wl(b, !0, d);
        ql(e, Qm, this.tg, [a], c, void 0, this)
    }
    ;
    h.wf = function(a, b, c) {
        var d = c[c.length - 1].srsName;
        "LineStringSegment" !== a.nodeName && d && a.setAttribute("srsName", d);
        "LineString" === a.nodeName || "LineStringSegment" === a.nodeName ? (d = Rm(a.namespaceURI),
        a.appendChild(d),
        Sm(this, d, b, c)) : "Curve" === a.nodeName && (d = Zk(a.namespaceURI, "segments"),
        a.appendChild(d),
        this.ar(d, b, c))
    }
    ;
    function Rm(a) {
        a = Zk(a, "coordinates");
        a.setAttribute("decimal", ".");
        a.setAttribute("cs", ",");
        a.setAttribute("ts", " ");
        return a
    }
    function Sm(a, b, c, d) {
        var e = d[d.length - 1];
        d = e.hasZ;
        e = e.srsName;
        c = c.H();
        for (var f = c.length, g = Array(f), k, l = 0; l < f; ++l)
            k = c[l],
            g[l] = a.Rl(k, e, d);
        Dm(b, g.join(" "))
    }
    h.ar = function(a, b, c) {
        var d = Zk(a.namespaceURI, "LineStringSegment");
        a.appendChild(d);
        this.wf(d, b, c)
    }
    ;
    h.yf = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.hasZ;
        d = d.srsName;
        "PolygonPatch" !== a.nodeName && d && a.setAttribute("srsName", d);
        "Polygon" === a.nodeName || "PolygonPatch" === a.nodeName ? (b = b.Hj(),
        ql({
            node: a,
            hasZ: e,
            srsName: d
        }, Tm, this.Zn, b, c, void 0, this)) : "Surface" === a.nodeName && (e = Zk(a.namespaceURI, "patches"),
        a.appendChild(e),
        this.mr(e, b, c))
    }
    ;
    h.Zn = function(a, b) {
        a = b[b.length - 1];
        b = a.node;
        var c = a.exteriorWritten;
        void 0 === c && (a.exteriorWritten = !0);
        return Zk(b.namespaceURI, void 0 !== c ? "innerBoundaryIs" : "outerBoundaryIs")
    }
    ;
    h.mr = function(a, b, c) {
        var d = Zk(a.namespaceURI, "PolygonPatch");
        a.appendChild(d);
        this.yf(d, b, c)
    }
    ;
    h.jl = function(a, b, c) {
        var d = Zk(a.namespaceURI, "LinearRing");
        a.appendChild(d);
        this.fl(d, b, c)
    }
    ;
    h.Rl = function(a, b, c) {
        var d = "enu";
        b && (d = ec(b).be);
        b = "en" === d.substr(0, 2) ? a[0] + "," + a[1] : a[1] + "," + a[0];
        c && (b += "," + (a[2] || 0));
        return b
    }
    ;
    h.gl = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.hasZ
          , f = d.srsName;
        d = d.curve;
        f && a.setAttribute("srsName", f);
        b = b.Sh();
        ql({
            node: a,
            hasZ: e,
            srsName: f,
            curve: d
        }, Um, this.Ui, b, c, void 0, this)
    }
    ;
    h.il = function(a, b, c) {
        var d = c[c.length - 1];
        c = d.hasZ;
        var e = d.srsName;
        e && a.setAttribute("srsName", e);
        d = Rm(a.namespaceURI);
        a.appendChild(d);
        a = b.H();
        a = this.Rl(a, e, c);
        Dm(d, a)
    }
    ;
    h.hr = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.hasZ;
        (d = d.srsName) && a.setAttribute("srsName", d);
        b = b.We();
        ql({
            node: a,
            hasZ: e,
            srsName: d
        }, Vm, jl("pointMember"), b, c, void 0, this)
    }
    ;
    h.kr = function(a, b, c) {
        var d = Zk(a.namespaceURI, "Point");
        a.appendChild(d);
        this.il(d, b, c)
    }
    ;
    h.el = function(a, b, c) {
        var d = this.tg(b, c);
        d && (a.appendChild(d),
        this.wf(d, b, c))
    }
    ;
    h.fl = function(a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute("srsName", d);
        d = Rm(a.namespaceURI);
        a.appendChild(d);
        Sm(this, d, b, c)
    }
    ;
    h.hl = function(a, b, c) {
        var d = c[c.length - 1]
          , e = d.hasZ
          , f = d.srsName;
        d = d.surface;
        f && a.setAttribute("srsName", f);
        b = b.Jj();
        ql({
            node: a,
            hasZ: e,
            srsName: f,
            surface: d
        }, Wm, this.Ui, b, c, void 0, this)
    }
    ;
    h.kl = function(a, b, c) {
        var d = this.tg(b, c);
        d && (a.appendChild(d),
        this.yf(d, b, c))
    }
    ;
    h.br = function(a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute("srsName", d);
        ql({
            node: a
        }, Xm, ll, [b[0] + " " + b[1], b[2] + " " + b[3]], c, ["lowerCorner", "upperCorner"], this)
    }
    ;
    var Qm = {
        "http://www.opengis.net/gml": {
            Curve: K(Pm.prototype.wf),
            MultiCurve: K(Pm.prototype.gl),
            Point: K(Pm.prototype.il),
            MultiPoint: K(Pm.prototype.hr),
            LineString: K(Pm.prototype.wf),
            MultiLineString: K(Pm.prototype.gl),
            LinearRing: K(Pm.prototype.fl),
            Polygon: K(Pm.prototype.yf),
            MultiPolygon: K(Pm.prototype.hl),
            Surface: K(Pm.prototype.yf),
            MultiSurface: K(Pm.prototype.hl),
            Envelope: K(Pm.prototype.br)
        }
    }
      , Tm = {
        "http://www.opengis.net/gml": {
            outerBoundaryIs: K(Pm.prototype.jl),
            innerBoundaryIs: K(Pm.prototype.jl)
        }
    }
      , Vm = {
        "http://www.opengis.net/gml": {
            pointMember: K(Pm.prototype.kr)
        }
    }
      , Um = {
        "http://www.opengis.net/gml": {
            lineStringMember: K(Pm.prototype.el),
            curveMember: K(Pm.prototype.el)
        }
    };
    Pm.prototype.Ui = function(a, b) {
        return Zk("http://www.opengis.net/gml", Ym[b[b.length - 1].node.nodeName])
    }
    ;
    var Ym = {
        MultiLineString: "lineStringMember",
        MultiCurve: "curveMember",
        MultiPolygon: "polygonMember",
        MultiSurface: "surfaceMember"
    }
      , Wm = {
        "http://www.opengis.net/gml": {
            surfaceMember: K(Pm.prototype.kl),
            polygonMember: K(Pm.prototype.kl)
        }
    }
      , Xm = {
        "http://www.opengis.net/gml": {
            lowerCorner: K(Dm),
            upperCorner: K(Dm)
        }
    };
    function Zm(a) {
        a = a ? a : {};
        qm.call(this);
        this.defaultDataProjection = ec("EPSG:4326");
        this.Xt = a.readExtensions
    }
    v(Zm, qm);
    var $m = [null, "http://www.topografix.com/GPX/1/0", "http://www.topografix.com/GPX/1/1"];
    function an(a, b, c, d) {
        a.push(parseFloat(c.getAttribute("lon")), parseFloat(c.getAttribute("lat")));
        "ele"in d ? (a.push(d.ele),
        delete d.ele,
        b.hasZ = !0) : a.push(0);
        "time"in d ? (a.push(d.time),
        delete d.time,
        b.$b = !0) : a.push(0);
        return a
    }
    function bn(a, b, c) {
        var d = "XY"
          , e = 2;
        a.hasZ && a.$b ? (d = "XYZM",
        e = 4) : a.hasZ ? (d = "XYZ",
        e = 3) : a.$b && (d = "XYM",
        e = 3);
        if (4 !== e) {
            var f;
            var g = 0;
            for (f = b.length / 4; g < f; g++)
                b[g * e] = b[4 * g],
                b[g * e + 1] = b[4 * g + 1],
                a.hasZ && (b[g * e + 2] = b[4 * g + 2]),
                a.$b && (b[g * e + 2] = b[4 * g + 3]);
            b.length = b.length / 4 * e;
            if (c)
                for (g = 0,
                f = c.length; g < f; g++)
                    c[g] = c[g] / 4 * e
        }
        return d
    }
    function cn(a, b) {
        var c = b[b.length - 1]
          , d = a.getAttribute("href");
        null !== d && (c.link = d);
        nl(dn, a, b)
    }
    function en(a, b) {
        b[b.length - 1].extensionsNode_ = a
    }
    function fn(a, b) {
        var c = b[0];
        if (a = M({
            flatCoordinates: [],
            layoutOptions: {}
        }, gn, a, b)) {
            b = a.flatCoordinates;
            delete a.flatCoordinates;
            var d = a.layoutOptions;
            delete a.layoutOptions;
            d = bn(d, b);
            var e = new N(null);
            e.K(d, b);
            wl(e, !1, c);
            c = new Wk(e);
            c.f(a);
            return c
        }
    }
    function hn(a, b) {
        var c = b[0];
        if (a = M({
            flatCoordinates: [],
            ends: [],
            layoutOptions: {}
        }, jn, a, b)) {
            b = a.flatCoordinates;
            delete a.flatCoordinates;
            var d = a.ends;
            delete a.ends;
            var e = a.layoutOptions;
            delete a.layoutOptions;
            e = bn(e, b, d);
            var f = new P(null);
            f.K(e, b, d);
            wl(f, !1, c);
            c = new Wk(f);
            c.f(a);
            return c
        }
    }
    function kn(a, b) {
        var c = b[0];
        if (b = M({}, ln, a, b)) {
            var d = {};
            a = an([], d, a, b);
            d = bn(d, a);
            a = new D(a,d);
            wl(a, !1, c);
            c = new Wk(a);
            c.f(b);
            return c
        }
    }
    var mn = {
        rte: fn,
        trk: hn,
        wpt: kn
    }
      , nn = L($m, {
        rte: fl(fn),
        trk: fl(hn),
        wpt: fl(kn)
    })
      , dn = L($m, {
        text: J(S, "linkText"),
        type: J(S, "linkType")
    })
      , gn = L($m, {
        name: J(S),
        cmt: J(S),
        desc: J(S),
        src: J(S),
        link: cn,
        number: J(Am),
        extensions: en,
        type: J(S),
        rtept: function(a, b) {
            var c = M({}, on, a, b);
            c && (b = b[b.length - 1],
            an(b.flatCoordinates, b.layoutOptions, a, c))
        }
    })
      , on = L($m, {
        ele: J(ym),
        time: J(xm)
    })
      , jn = L($m, {
        name: J(S),
        cmt: J(S),
        desc: J(S),
        src: J(S),
        link: cn,
        number: J(Am),
        type: J(S),
        extensions: en,
        trkseg: function(a, b) {
            var c = b[b.length - 1];
            nl(pn, a, b);
            c.ends.push(c.flatCoordinates.length)
        }
    })
      , pn = L($m, {
        trkpt: function(a, b) {
            var c = M({}, qn, a, b);
            c && (b = b[b.length - 1],
            an(b.flatCoordinates, b.layoutOptions, a, c))
        }
    })
      , qn = L($m, {
        ele: J(ym),
        time: J(xm)
    })
      , ln = L($m, {
        ele: J(ym),
        time: J(xm),
        magvar: J(ym),
        geoidheight: J(ym),
        name: J(S),
        cmt: J(S),
        desc: J(S),
        src: J(S),
        link: cn,
        sym: J(S),
        type: J(S),
        fix: J(S),
        sat: J(Am),
        hdop: J(ym),
        vdop: J(ym),
        pdop: J(ym),
        ageofdgpsdata: J(ym),
        dgpsid: J(Am),
        extensions: en
    });
    function rn(a, b) {
        b || (b = []);
        for (var c = 0, d = b.length; c < d; ++c) {
            var e = b[c];
            if (a.Xt) {
                var f = e.get("extensionsNode_") || null;
                a.Xt(e, f)
            }
            e.set("extensionsNode_", void 0)
        }
    }
    Zm.prototype.Vp = function(a, b) {
        if (!ra($m, a.namespaceURI))
            return null;
        var c = mn[a.localName];
        if (!c)
            return null;
        a = c(a, [ul(this, a, b)]);
        if (!a)
            return null;
        rn(this, [a]);
        return a
    }
    ;
    Zm.prototype.eg = function(a, b) {
        return ra($m, a.namespaceURI) ? "gpx" == a.localName && (a = M([], nn, a, [ul(this, a, b)])) ? (rn(this, a),
        a) : [] : []
    }
    ;
    function sn(a, b, c) {
        a.setAttribute("href", b);
        b = c[c.length - 1].properties;
        ql({
            node: a
        }, tn, ll, [b.linkText, b.linkType], c, un)
    }
    function vn(a, b, c) {
        var d = c[c.length - 1]
          , e = d.node.namespaceURI
          , f = d.properties;
        a.setAttributeNS(null, "lat", b[1]);
        a.setAttributeNS(null, "lon", b[0]);
        switch (d.geometryLayout) {
        case "XYZM":
            0 !== b[3] && (f.time = b[3]);
        case "XYZ":
            0 !== b[2] && (f.ele = b[2]);
            break;
        case "XYM":
            0 !== b[2] && (f.time = b[2])
        }
        b = "rtept" == a.nodeName ? wn[e] : xn[e];
        d = ml(f, b);
        ql({
            node: a,
            properties: f
        }, yn, ll, d, c, b)
    }
    var un = ["text", "type"]
      , tn = L($m, {
        text: K(Dm),
        type: K(Dm)
    })
      , zn = L($m, "name cmt desc src link number type rtept".split(" "))
      , An = L($m, {
        name: K(Dm),
        cmt: K(Dm),
        desc: K(Dm),
        src: K(Dm),
        link: K(sn),
        number: K(Fm),
        type: K(Dm),
        rtept: il(K(vn))
    })
      , wn = L($m, ["ele", "time"])
      , Bn = L($m, "name cmt desc src link number type trkseg".split(" "))
      , En = L($m, {
        name: K(Dm),
        cmt: K(Dm),
        desc: K(Dm),
        src: K(Dm),
        link: K(sn),
        number: K(Fm),
        type: K(Dm),
        trkseg: il(K(function(a, b, c) {
            ql({
                node: a,
                geometryLayout: b.ha,
                properties: {}
            }, Cn, Dn, b.H(), c)
        }))
    })
      , Dn = jl("trkpt")
      , Cn = L($m, {
        trkpt: K(vn)
    })
      , xn = L($m, "ele time magvar geoidheight name cmt desc src link sym type fix sat hdop vdop pdop ageofdgpsdata dgpsid".split(" "))
      , yn = L($m, {
        ele: K(Em),
        time: K(function(a, b) {
            b = new Date(1E3 * b);
            a.appendChild(Yk.createTextNode(b.getUTCFullYear() + "-" + $e(b.getUTCMonth() + 1) + "-" + $e(b.getUTCDate()) + "T" + $e(b.getUTCHours()) + ":" + $e(b.getUTCMinutes()) + ":" + $e(b.getUTCSeconds()) + "Z"))
        }),
        magvar: K(Em),
        geoidheight: K(Em),
        name: K(Dm),
        cmt: K(Dm),
        desc: K(Dm),
        src: K(Dm),
        link: K(sn),
        sym: K(Dm),
        type: K(Dm),
        fix: K(Dm),
        sat: K(Fm),
        hdop: K(Em),
        vdop: K(Em),
        pdop: K(Em),
        ageofdgpsdata: K(Em),
        dgpsid: K(Fm)
    })
      , Fn = {
        Point: "wpt",
        LineString: "rte",
        MultiLineString: "trk"
    };
    function Gn(a, b) {
        if (a = a.I())
            if (a = Fn[a.D()])
                return Zk(b[b.length - 1].node.namespaceURI, a)
    }
    var Hn = L($m, {
        rte: K(function(a, b, c) {
            var d = c[0]
              , e = b.l();
            a = {
                node: a,
                properties: e
            };
            if (b = b.I())
                b = wl(b, !0, d),
                a.geometryLayout = b.ha,
                e.rtept = b.H();
            d = zn[c[c.length - 1].node.namespaceURI];
            e = ml(e, d);
            ql(a, An, ll, e, c, d)
        }),
        trk: K(function(a, b, c) {
            var d = c[0]
              , e = b.l();
            a = {
                node: a,
                properties: e
            };
            if (b = b.I())
                b = wl(b, !0, d),
                e.trkseg = b.Sh();
            d = Bn[c[c.length - 1].node.namespaceURI];
            e = ml(e, d);
            ql(a, En, ll, e, c, d)
        }),
        wpt: K(function(a, b, c) {
            var d = c[0]
              , e = c[c.length - 1];
            e.properties = b.l();
            if (b = b.I())
                b = wl(b, !0, d),
                e.geometryLayout = b.ha,
                vn(a, b.H(), c)
        })
    });
    Zm.prototype.Ke = function(a, b) {
        b = vl(this, b);
        var c = Zk("http://www.topografix.com/GPX/1/1", "gpx");
        c.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:xsi", "http://www.w3.org/2001/XMLSchema-instance");
        c.setAttributeNS("http://www.w3.org/2001/XMLSchema-instance", "xsi:schemaLocation", "http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd");
        c.setAttribute("version", "1.1");
        c.setAttribute("creator", "OpenLayers");
        ql({
            node: c
        }, Hn, Gn, a, [b]);
        return c
    }
    ;
    function In() {
        tl.call(this)
    }
    v(In, tl);
    function Jn(a) {
        return "string" === typeof a ? a : ""
    }
    h = In.prototype;
    h.D = function() {
        return "text"
    }
    ;
    h.we = function(a, b) {
        return this.vk(Jn(a), vl(this, b))
    }
    ;
    h.pb = function(a, b) {
        return this.Xp(Jn(a), vl(this, b))
    }
    ;
    h.fh = function(a, b) {
        return this.yi(Jn(a), vl(this, b))
    }
    ;
    h.mc = function() {
        return this.defaultDataProjection
    }
    ;
    h.Si = function(a, b) {
        return this.$k(a, vl(this, b))
    }
    ;
    h.Je = function(a, b) {
        return this.dr(a, vl(this, b))
    }
    ;
    h.uh = function(a, b) {
        return this.Ti(a, vl(this, b))
    }
    ;
    function Kn(a) {
        a = a ? a : {};
        tl.call(this);
        this.defaultDataProjection = ec("EPSG:4326");
        this.cw = a.altitudeMode ? a.altitudeMode : "none"
    }
    v(Kn, In);
    var Ln = /^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/
      , Mn = /^H.([A-Z]{3}).*?:(.*)/
      , Nn = /^HFDTE(\d{2})(\d{2})(\d{2})/
      , On = /\r\n|\r|\n/;
    h = Kn.prototype;
    h.vk = function(a, b) {
        var c = this.cw
          , d = a.split(On);
        a = {};
        var e = [], f = 2E3, g = 0, k = 1, l = -1, m;
        var n = 0;
        for (m = d.length; n < m; ++n) {
            var p = d[n], q;
            if ("B" == p.charAt(0)) {
                if (q = Ln.exec(p)) {
                    p = parseInt(q[1], 10);
                    var t = parseInt(q[2], 10)
                      , u = parseInt(q[3], 10)
                      , x = parseInt(q[4], 10) + parseInt(q[5], 10) / 6E4;
                    "S" == q[6] && (x = -x);
                    var B = parseInt(q[7], 10) + parseInt(q[8], 10) / 6E4;
                    "W" == q[9] && (B = -B);
                    e.push(B, x);
                    "none" != c && e.push("gps" == c ? parseInt(q[11], 10) : "barometric" == c ? parseInt(q[12], 10) : 0);
                    q = Date.UTC(f, g, k, p, t, u);
                    q < l && (q = Date.UTC(f, g, k + 1, p, t, u));
                    e.push(q / 1E3);
                    l = q
                }
            } else
                "H" == p.charAt(0) && ((q = Nn.exec(p)) ? (k = parseInt(q[1], 10),
                g = parseInt(q[2], 10) - 1,
                f = 2E3 + parseInt(q[3], 10)) : (q = Mn.exec(p)) && (a[q[1]] = q[2].trim()))
        }
        if (0 === e.length)
            return null;
        d = new N(null);
        d.K("none" == c ? "XYM" : "XYZM", e);
        b = new Wk(wl(d, !1, b));
        b.f(a);
        return b
    }
    ;
    h.Xp = function(a, b) {
        return (a = this.vk(a, b)) ? [a] : []
    }
    ;
    h.$k = function() {}
    ;
    h.dr = function() {}
    ;
    h.Ti = function() {}
    ;
    h.yi = function() {}
    ;
    function Pn(a, b, c, d, e, f) {
        Yc.call(this);
        this.bf = null;
        this.s = a ? a : new Image;
        null !== d && (this.s.crossOrigin = d);
        this.J = f ? document.createElement("CANVAS") : null;
        this.W = f;
        this.Vg = null;
        this.fi = e;
        this.$a = c;
        this.gd = b;
        this.Eq = !1;
        2 == this.fi && Qn(this)
    }
    v(Pn, Yc);
    function Qn(a) {
        var b = pd(1, 1);
        try {
            b.drawImage(a.s, 0, 0),
            b.getImageData(0, 0, 1, 1)
        } catch (c) {
            a.Eq = !0
        }
    }
    h = Pn.prototype;
    h.ci = function() {
        this.fi = 3;
        Rn(this);
        this.dispatchEvent("change")
    }
    ;
    h.Tj = function() {
        this.fi = 2;
        this.$a && (this.s.width = this.$a[0],
        this.s.height = this.$a[1]);
        this.$a = [this.s.width, this.s.height];
        Rn(this);
        Qn(this);
        if (!this.Eq && null !== this.W) {
            this.J.width = this.s.width;
            this.J.height = this.s.height;
            var a = this.J.getContext("2d");
            a.drawImage(this.s, 0, 0);
            for (var b = a.getImageData(0, 0, this.s.width, this.s.height), c = b.data, d = this.W[0] / 255, e = this.W[1] / 255, f = this.W[2] / 255, g = 0, k = c.length; g < k; g += 4)
                c[g] *= d,
                c[g + 1] *= e,
                c[g + 2] *= f;
            a.putImageData(b, 0, 0)
        }
        this.dispatchEvent("change")
    }
    ;
    h.N = function() {
        return this.J ? this.J : this.s
    }
    ;
    h.Kg = function() {
        return this.fi
    }
    ;
    h.Dj = function() {
        if (!this.bf)
            if (this.Eq) {
                var a = this.$a[0]
                  , b = this.$a[1]
                  , c = pd(a, b);
                c.fillRect(0, 0, a, b);
                this.bf = c.canvas
            } else
                this.bf = this.s;
        return this.bf
    }
    ;
    h.Ga = function() {
        return this.$a
    }
    ;
    h.Lj = function() {
        return this.gd
    }
    ;
    h.load = function() {
        if (0 == this.fi) {
            this.fi = 1;
            this.Vg = [Rc(this.s, "error", this.ci, this), Rc(this.s, "load", this.Tj, this)];
            try {
                this.s.src = this.gd
            } catch (a) {
                this.ci()
            }
        }
    }
    ;
    function Rn(a) {
        a.Vg.forEach(Mc);
        a.Vg = null
    }
    ;function Sn(a) {
        a = a || {};
        this.Ib = void 0 !== a.anchor ? a.anchor : [.5, .5];
        this.Pm = null;
        this.xh = void 0 !== a.anchorOrigin ? a.anchorOrigin : "top-left";
        this.oo = void 0 !== a.anchorXUnits ? a.anchorXUnits : "fraction";
        this.po = void 0 !== a.anchorYUnits ? a.anchorYUnits : "fraction";
        this.Df = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        var b = void 0 !== a.img ? a.img : null
          , c = void 0 !== a.imgSize ? a.imgSize : null
          , d = a.src;
        Fa(!(void 0 !== d && b), 4);
        Fa(!b || b && c, 5);
        void 0 !== d && 0 !== d.length || !b || (d = b.src || w(b).toString());
        Fa(void 0 !== d && 0 < d.length, 6);
        var e = void 0 !== a.src ? 0 : 2;
        this.W = void 0 !== a.color ? kd(a.color) : null;
        var f = this.Df
          , g = this.W
          , k = yh.get(d, f, g);
        k || (k = new Pn(b,d,c,f,e,g),
        yh.set(d, f, g, k));
        this.sd = k;
        this.Nt = void 0 !== a.offset ? a.offset : [0, 0];
        this.mi = void 0 !== a.offsetOrigin ? a.offsetOrigin : "top-left";
        this.Fc = null;
        this.$a = void 0 !== a.size ? a.size : null;
        Mk.call(this, {
            opacity: void 0 !== a.opacity ? a.opacity : 1,
            rotation: void 0 !== a.rotation ? a.rotation : 0,
            scale: void 0 !== a.scale ? a.scale : 1,
            snapToPixel: void 0 !== a.snapToPixel ? a.snapToPixel : !0,
            rotateWithView: void 0 !== a.rotateWithView ? a.rotateWithView : !1
        })
    }
    v(Sn, Mk);
    h = Sn.prototype;
    h.clone = function() {
        var a = this.N(1);
        if (2 === this.sd.Kg())
            if ("IMG" === a.tagName.toUpperCase())
                var b = a.cloneNode(!0);
            else {
                b = document.createElement("canvas");
                var c = b.getContext("2d");
                b.width = a.width;
                b.height = a.height;
                c.drawImage(a, 0, 0)
            }
        return new Sn({
            anchor: this.Ib.slice(),
            anchorOrigin: this.xh,
            anchorXUnits: this.oo,
            anchorYUnits: this.po,
            crossOrigin: this.Df,
            color: this.W && this.W.slice ? this.W.slice() : this.W || void 0,
            img: b ? b : void 0,
            imgSize: b ? this.sd.Ga().slice() : void 0,
            src: b ? void 0 : this.Lj(),
            offset: this.Nt.slice(),
            offsetOrigin: this.mi,
            size: null !== this.$a ? this.$a.slice() : void 0,
            opacity: this.tb(),
            scale: this.Ma,
            snapToPixel: this.fd,
            rotation: this.ma(),
            rotateWithView: this.Db
        })
    }
    ;
    h.Hg = function() {
        if (this.Pm)
            return this.Pm;
        var a = this.Ib
          , b = this.Ga();
        if ("fraction" == this.oo || "fraction" == this.po) {
            if (!b)
                return null;
            a = this.Ib.slice();
            "fraction" == this.oo && (a[0] *= b[0]);
            "fraction" == this.po && (a[1] *= b[1])
        }
        if ("top-left" != this.xh) {
            if (!b)
                return null;
            a === this.Ib && (a = this.Ib.slice());
            if ("top-right" == this.xh || "bottom-right" == this.xh)
                a[0] = -a[0] + b[0];
            if ("bottom-left" == this.xh || "bottom-right" == this.xh)
                a[1] = -a[1] + b[1]
        }
        return this.Pm = a
    }
    ;
    h.Aj = function() {
        return this.W
    }
    ;
    h.N = function(a) {
        return this.sd.N(a)
    }
    ;
    h.Tl = function() {
        return this.sd.Ga()
    }
    ;
    h.Kg = function() {
        return this.sd.Kg()
    }
    ;
    h.Dj = function(a) {
        return this.sd.Dj(a)
    }
    ;
    h.ic = function() {
        if (this.Fc)
            return this.Fc;
        var a = this.Nt;
        if ("top-left" != this.mi) {
            var b = this.Ga()
              , c = this.sd.Ga();
            if (!b || !c)
                return null;
            a = a.slice();
            if ("top-right" == this.mi || "bottom-right" == this.mi)
                a[0] = c[0] - b[0] - a[0];
            if ("bottom-left" == this.mi || "bottom-right" == this.mi)
                a[1] = c[1] - b[1] - a[1]
        }
        return this.Fc = a
    }
    ;
    h.Lj = function() {
        return this.sd.Lj()
    }
    ;
    h.Ga = function() {
        return this.$a ? this.$a : this.sd.Ga()
    }
    ;
    h.nt = function(a, b) {
        return y(this.sd, "change", a, b)
    }
    ;
    h.load = function() {
        this.sd.load()
    }
    ;
    h.Zu = function(a, b) {
        Sc(this.sd, "change", a, b)
    }
    ;
    function Tn(a) {
        a = a || {};
        this.Lf = a.font;
        this.Za = a.rotation;
        this.Db = a.rotateWithView;
        this.Ma = a.scale;
        this.S = a.text;
        this.De = a.textAlign;
        this.Ee = a.textBaseline;
        this.ja = void 0 !== a.fill ? a.fill : new Pk({
            color: "#333"
        });
        this.ia = void 0 !== a.stroke ? a.stroke : null;
        this.qe = void 0 !== a.offsetX ? a.offsetX : 0;
        this.re = void 0 !== a.offsetY ? a.offsetY : 0
    }
    h = Tn.prototype;
    h.clone = function() {
        return new Tn({
            font: this.Lf,
            rotation: this.ma(),
            rotateWithView: this.Db,
            scale: this.Ma,
            text: this.S,
            textAlign: this.De,
            textBaseline: this.Ee,
            fill: this.ja ? this.ja.clone() : void 0,
            stroke: this.ia ? this.ia.clone() : void 0,
            offsetX: this.qe,
            offsetY: this.re
        })
    }
    ;
    h.dx = function() {
        return this.Lf
    }
    ;
    h.xx = function() {
        return this.qe
    }
    ;
    h.yx = function() {
        return this.re
    }
    ;
    h.Ph = function() {
        return this.ja
    }
    ;
    h.Uh = function() {
        return this.Db
    }
    ;
    h.ma = function() {
        return this.Za
    }
    ;
    h.Vh = function() {
        return this.Ma
    }
    ;
    h.Xh = function() {
        return this.ia
    }
    ;
    h.gp = function() {
        return this.S
    }
    ;
    h.Ix = function() {
        return this.De
    }
    ;
    h.Jx = function() {
        return this.Ee
    }
    ;
    h.uu = function(a) {
        this.Lf = a
    }
    ;
    h.zu = function(a) {
        this.qe = a
    }
    ;
    h.Au = function(a) {
        this.re = a
    }
    ;
    h.ln = function(a) {
        this.ja = a
    }
    ;
    h.Wd = function(a) {
        this.Za = a
    }
    ;
    h.mf = function(a) {
        this.Ma = a
    }
    ;
    h.nn = function(a) {
        this.ia = a
    }
    ;
    h.Bi = function(a) {
        this.S = a
    }
    ;
    h.Du = function(a) {
        this.De = a
    }
    ;
    h.VA = function(a) {
        this.Ee = a
    }
    ;
    function Un(a) {
        a = a ? a : {};
        qm.call(this);
        Vn || (Wn = [255, 255, 255, 1],
        Xn = new Pk({
            color: Wn
        }),
        Yn = [20, 2],
        Zn = $n = "pixels",
        ao = [64, 64],
        bo = "https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",
        co = .5,
        eo = new Sn({
            anchor: Yn,
            anchorOrigin: "bottom-left",
            anchorXUnits: $n,
            anchorYUnits: Zn,
            crossOrigin: "anonymous",
            rotation: 0,
            scale: co,
            size: ao,
            src: bo
        }),
        fo = "NO_IMAGE",
        go = new nj({
            color: Wn,
            width: 1
        }),
        ho = new nj({
            color: [51, 51, 51, 1],
            width: 2
        }),
        io = new Tn({
            font: "bold 16px Helvetica",
            fill: Xn,
            stroke: ho,
            scale: .8
        }),
        jo = new Qk({
            fill: Xn,
            image: eo,
            text: io,
            stroke: go,
            zIndex: 0
        }),
        Vn = [jo]);
        this.defaultDataProjection = ec("EPSG:4326");
        this.xw = a.defaultStyle ? a.defaultStyle : Vn;
        this.Fw = void 0 !== a.extractStyles ? a.extractStyles : !0;
        this.MB = void 0 !== a.writeStyles ? a.writeStyles : !0;
        this.Aq = {};
        this.$A = void 0 !== a.showPointNames ? a.showPointNames : !0
    }
    var Vn, Wn, Xn, Yn, $n, Zn, ao, bo, co, eo, fo, go, ho, io, jo;
    v(Un, qm);
    var ko = ["http://www.google.com/kml/ext/2.2"]
      , lo = [null, "http://earth.google.com/kml/2.0", "http://earth.google.com/kml/2.1", "http://earth.google.com/kml/2.2", "http://www.opengis.net/kml/2.2"]
      , mo = {
        fraction: "fraction",
        pixels: "pixels",
        insetPixels: "pixels"
    };
    function no(a, b) {
        var c = [0, 0]
          , d = "start";
        if (a.N()) {
            var e = a.N().Tl();
            null === e && (e = ao);
            2 == e.length && (d = a.N().Ma,
            c[0] = d * e[0] / 2,
            c[1] = -d * e[1] / 2,
            d = "left")
        }
        null !== a.S ? (e = a.S,
        a = e.clone(),
        a.uu(e.Lf || io.Lf),
        a.mf(e.Ma || io.Ma),
        a.ln(e.ja || io.ja),
        a.nn(e.ia || ho)) : a = io.clone();
        a.Bi(b);
        a.zu(c[0]);
        a.Au(c[1]);
        a.Du(d);
        return new Qk({
            text: a
        })
    }
    function oo(a, b, c, d, e) {
        return function() {
            var f = e
              , g = "";
            f && this.I() && (f = "Point" === this.I().D());
            f && (g = this.get("name"),
            f = f && g);
            if (a)
                return f ? (f = no(a[0], g),
                a.concat(f)) : a;
            if (b) {
                var k = po(b, c, d);
                return f ? (f = no(k[0], g),
                k.concat(f)) : k
            }
            return f ? (f = no(c[0], g),
            c.concat(f)) : c
        }
    }
    function po(a, b, c) {
        return Array.isArray(a) ? a : "string" === typeof a ? (!(a in c) && "#" + a in c && (a = "#" + a),
        po(c[a], b, c)) : b
    }
    function qo(a) {
        a = $k(a, !1);
        if (a = /^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(a))
            return a = a[1],
            [parseInt(a.substr(6, 2), 16), parseInt(a.substr(4, 2), 16), parseInt(a.substr(2, 2), 16), parseInt(a.substr(0, 2), 16) / 255]
    }
    function ro(a) {
        a = $k(a, !1);
        for (var b = [], c = /^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i, d; d = c.exec(a); )
            b.push(parseFloat(d[1]), parseFloat(d[2]), d[3] ? parseFloat(d[3]) : 0),
            a = a.substr(d[0].length);
        if ("" === a)
            return b
    }
    function so(a) {
        var b = $k(a, !1).trim();
        return a.baseURI && "about:blank" !== a.baseURI ? (new URL(b,a.baseURI)).href : b
    }
    function to(a) {
        return ym(a)
    }
    function uo(a, b) {
        return M(null, vo, a, b)
    }
    function wo(a, b) {
        if (b = M({
            b: [],
            jv: []
        }, xo, a, b)) {
            a = b.b;
            b = b.jv;
            var c;
            var d = 0;
            for (c = Math.min(a.length, b.length); d < c; ++d)
                a[4 * d + 3] = b[d];
            b = new N(null);
            b.K("XYZM", a);
            return b
        }
    }
    function yo(a, b) {
        var c = M({}, zo, a, b);
        if (a = M(null, Ao, a, b))
            return b = new N(null),
            b.K("XYZ", a),
            b.f(c),
            b
    }
    function Bo(a, b) {
        var c = M({}, zo, a, b);
        if (a = M(null, Ao, a, b))
            return b = new F(null),
            b.K("XYZ", a, [a.length]),
            b.f(c),
            b
    }
    function Co(a, b) {
        a = M([], Do, a, b);
        if (!a)
            return null;
        if (0 === a.length)
            return new hm(a);
        var c = !0, d = a[0].D(), e;
        var f = 1;
        for (e = a.length; f < e; ++f)
            if (b = a[f],
            b.D() != d) {
                c = !1;
                break
            }
        if (c)
            if ("Point" == d) {
                var g = a[0];
                c = g.ha;
                d = g.X();
                f = 1;
                for (e = a.length; f < e; ++f)
                    b = a[f],
                    ta(d, b.X());
                g = new Q(null);
                g.K(c, d);
                Eo(g, a)
            } else
                "LineString" == d ? (g = new P(null),
                Cl(g, a),
                Eo(g, a)) : "Polygon" == d ? (g = new R(null),
                Dl(g, a),
                Eo(g, a)) : "GeometryCollection" == d ? g = new hm(a) : Fa(!1, 37);
        else
            g = new hm(a);
        return g
    }
    function Fo(a, b) {
        var c = M({}, zo, a, b);
        if (a = M(null, Ao, a, b))
            return b = new D(null),
            b.K("XYZ", a),
            b.f(c),
            b
    }
    function Go(a, b) {
        var c = M({}, zo, a, b);
        if ((a = M([null], Ho, a, b)) && a[0]) {
            b = new F(null);
            var d = a[0], e = [d.length], f;
            var g = 1;
            for (f = a.length; g < f; ++g)
                ta(d, a[g]),
                e.push(d.length);
            b.K("XYZ", d, e);
            b.f(c);
            return b
        }
    }
    function Io(a, b) {
        b = M({}, Jo, a, b);
        if (!b)
            return null;
        a = "fillStyle"in b ? b.fillStyle : Xn;
        var c = b.fill;
        void 0 === c || c || (a = null);
        c = "imageStyle"in b ? b.imageStyle : eo;
        c == fo && (c = void 0);
        var d = "textStyle"in b ? b.textStyle : io
          , e = "strokeStyle"in b ? b.strokeStyle : go;
        b = b.outline;
        void 0 === b || b || (e = null);
        return [new Qk({
            fill: a,
            image: c,
            stroke: e,
            text: d,
            zIndex: void 0
        })]
    }
    function Eo(a, b) {
        var c = b.length, d = Array(b.length), e = Array(b.length), f = Array(b.length), g, k, l;
        var m = k = l = !1;
        for (g = 0; g < c; ++g) {
            var n = b[g];
            d[g] = n.get("extrude");
            e[g] = n.get("tessellate");
            f[g] = n.get("altitudeMode");
            m = m || void 0 !== d[g];
            k = k || void 0 !== e[g];
            l = l || f[g]
        }
        m && a.set("extrude", d);
        k && a.set("tessellate", e);
        l && a.set("altitudeMode", f)
    }
    function Ko(a, b) {
        nl(Lo, a, b)
    }
    function Mo(a, b) {
        nl(No, a, b)
    }
    var Oo = L(lo, {
        displayName: J(S),
        value: J(S)
    })
      , Lo = L(lo, {
        Data: function(a, b) {
            var c = a.getAttribute("name");
            nl(Oo, a, b);
            a = b[b.length - 1];
            null !== c ? a[c] = a.value : null !== a.displayName && (a[a.displayName] = a.value);
            delete a.value
        },
        SchemaData: function(a, b) {
            nl(Po, a, b)
        }
    })
      , No = L(lo, {
        LatLonAltBox: function(a, b) {
            if (a = M({}, Qo, a, b))
                b = b[b.length - 1],
                b.extent = [parseFloat(a.west), parseFloat(a.south), parseFloat(a.east), parseFloat(a.north)],
                b.altitudeMode = a.altitudeMode,
                b.minAltitude = parseFloat(a.minAltitude),
                b.maxAltitude = parseFloat(a.maxAltitude)
        },
        Lod: function(a, b) {
            if (a = M({}, Ro, a, b))
                b = b[b.length - 1],
                b.minLodPixels = parseFloat(a.minLodPixels),
                b.maxLodPixels = parseFloat(a.maxLodPixels),
                b.minFadeExtent = parseFloat(a.minFadeExtent),
                b.maxFadeExtent = parseFloat(a.maxFadeExtent)
        }
    })
      , Qo = L(lo, {
        altitudeMode: J(S),
        minAltitude: J(ym),
        maxAltitude: J(ym),
        north: J(ym),
        south: J(ym),
        east: J(ym),
        west: J(ym)
    })
      , Ro = L(lo, {
        minLodPixels: J(ym),
        maxLodPixels: J(ym),
        minFadeExtent: J(ym),
        maxFadeExtent: J(ym)
    })
      , zo = L(lo, {
        extrude: J(vm),
        tessellate: J(vm),
        altitudeMode: J(S)
    })
      , vo = L(lo, {
        coordinates: gl(ro)
    })
      , Ho = L(lo, {
        innerBoundaryIs: function(a, b) {
            (a = M(void 0, So, a, b)) && b[b.length - 1].push(a)
        },
        outerBoundaryIs: function(a, b) {
            (a = M(void 0, To, a, b)) && (b[b.length - 1][0] = a)
        }
    })
      , xo = L(lo, {
        when: function(a, b) {
            b = b[b.length - 1].jv;
            a = $k(a, !1);
            a = Date.parse(a);
            b.push(isNaN(a) ? 0 : a)
        }
    }, L(ko, {
        coord: function(a, b) {
            b = b[b.length - 1].b;
            a = $k(a, !1);
            (a = /^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(a)) ? b.push(parseFloat(a[1]), parseFloat(a[2]), parseFloat(a[3]), 0) : b.push(0, 0, 0, 0)
        }
    }))
      , Ao = L(lo, {
        coordinates: gl(ro)
    })
      , Uo = L(lo, {
        href: J(so)
    }, L(ko, {
        x: J(ym),
        y: J(ym),
        w: J(ym),
        h: J(ym)
    }))
      , Vo = L(lo, {
        Icon: J(function(a, b) {
            return (a = M({}, Uo, a, b)) ? a : null
        }),
        heading: J(ym),
        hotSpot: J(function(a) {
            var b = a.getAttribute("xunits")
              , c = a.getAttribute("yunits");
            var d = "insetPixels" !== b ? "insetPixels" !== c ? "bottom-left" : "top-left" : "insetPixels" !== c ? "bottom-right" : "top-right";
            return {
                x: parseFloat(a.getAttribute("x")),
                or: mo[b],
                y: parseFloat(a.getAttribute("y")),
                pr: mo[c],
                origin: d
            }
        }),
        scale: J(to)
    })
      , So = L(lo, {
        LinearRing: gl(uo)
    })
      , Wo = L(lo, {
        color: J(qo),
        scale: J(to)
    })
      , Xo = L(lo, {
        color: J(qo),
        width: J(ym)
    })
      , Do = L(lo, {
        LineString: fl(yo),
        LinearRing: fl(Bo),
        MultiGeometry: fl(Co),
        Point: fl(Fo),
        Polygon: fl(Go)
    })
      , Yo = L(ko, {
        Track: fl(wo)
    })
      , $o = L(lo, {
        ExtendedData: Ko,
        Region: Mo,
        Link: function(a, b) {
            nl(Zo, a, b)
        },
        address: J(S),
        description: J(S),
        name: J(S),
        open: J(vm),
        phoneNumber: J(S),
        visibility: J(vm)
    })
      , Zo = L(lo, {
        href: J(so)
    })
      , To = L(lo, {
        LinearRing: gl(uo)
    })
      , ap = L(lo, {
        Style: J(Io),
        key: J(S),
        styleUrl: J(so)
    })
      , cp = L(lo, {
        ExtendedData: Ko,
        Region: Mo,
        MultiGeometry: J(Co, "geometry"),
        LineString: J(yo, "geometry"),
        LinearRing: J(Bo, "geometry"),
        Point: J(Fo, "geometry"),
        Polygon: J(Go, "geometry"),
        Style: J(Io),
        StyleMap: function(a, b) {
            if (a = M(void 0, bp, a, b))
                b = b[b.length - 1],
                Array.isArray(a) ? b.Style = a : "string" === typeof a ? b.styleUrl = a : Fa(!1, 38)
        },
        address: J(S),
        description: J(S),
        name: J(S),
        open: J(vm),
        phoneNumber: J(S),
        styleUrl: J(so),
        visibility: J(vm)
    }, L(ko, {
        MultiTrack: J(function(a, b) {
            if (a = M([], Yo, a, b))
                return b = new P(null),
                Cl(b, a),
                b
        }, "geometry"),
        Track: J(wo, "geometry")
    }))
      , dp = L(lo, {
        color: J(qo),
        fill: J(vm),
        outline: J(vm)
    })
      , Po = L(lo, {
        SimpleData: function(a, b) {
            var c = a.getAttribute("name");
            null !== c && (a = S(a),
            b[b.length - 1][c] = a)
        }
    })
      , Jo = L(lo, {
        IconStyle: function(a, b) {
            if (a = M({}, Vo, a, b)) {
                b = b[b.length - 1];
                var c = "Icon"in a ? a.Icon : {}, d = !("Icon"in a) || 0 < Object.keys(c).length, e, f = c.href;
                f ? e = f : d && (e = bo);
                f = "bottom-left";
                var g = a.hotSpot;
                if (g) {
                    var k = [g.x, g.y];
                    var l = g.or;
                    var m = g.pr;
                    f = g.origin
                } else
                    e === bo ? (k = Yn,
                    l = $n,
                    m = Zn) : /^http:\/\/maps\.(?:google|gstatic)\.com\//.test(e) && (k = [.5, 0],
                    m = l = "fraction");
                var n;
                g = c.x;
                var p = c.y;
                void 0 !== g && void 0 !== p && (n = [g, p]);
                var q;
                g = c.w;
                c = c.h;
                void 0 !== g && void 0 !== c && (q = [g, c]);
                var t;
                c = a.heading;
                void 0 !== c && (t = Na(c));
                a = a.scale;
                d ? (e == bo && (q = ao,
                void 0 === a && (a = co)),
                e = new Sn({
                    anchor: k,
                    anchorOrigin: f,
                    anchorXUnits: l,
                    anchorYUnits: m,
                    crossOrigin: "anonymous",
                    offset: n,
                    offsetOrigin: "bottom-left",
                    rotation: t,
                    scale: a,
                    size: q,
                    src: e
                }),
                b.imageStyle = e) : b.imageStyle = fo
            }
        },
        LabelStyle: function(a, b) {
            (a = M({}, Wo, a, b)) && (b[b.length - 1].textStyle = new Tn({
                fill: new Pk({
                    color: "color"in a ? a.color : Wn
                }),
                scale: a.scale
            }))
        },
        LineStyle: function(a, b) {
            (a = M({}, Xo, a, b)) && (b[b.length - 1].strokeStyle = new nj({
                color: "color"in a ? a.color : Wn,
                width: "width"in a ? a.width : 1
            }))
        },
        PolyStyle: function(a, b) {
            if (a = M({}, dp, a, b)) {
                b = b[b.length - 1];
                b.fillStyle = new Pk({
                    color: "color"in a ? a.color : Wn
                });
                var c = a.fill;
                void 0 !== c && (b.fill = c);
                a = a.outline;
                void 0 !== a && (b.outline = a)
            }
        }
    })
      , bp = L(lo, {
        Pair: function(a, b) {
            if (a = M({}, ap, a, b)) {
                var c = a.key;
                c && "normal" == c && ((c = a.styleUrl) && (b[b.length - 1] = c),
                (a = a.Style) && (b[b.length - 1] = a))
            }
        }
    });
    h = Un.prototype;
    h.Tp = function(a, b) {
        var c = L(lo, {
            Document: el(this.Tp, this),
            Folder: el(this.Tp, this),
            Placemark: fl(this.aq, this),
            Style: this.oA.bind(this),
            StyleMap: this.nA.bind(this)
        });
        if (a = M([], c, a, b, this))
            return a
    }
    ;
    h.aq = function(a, b) {
        var c = M({
            geometry: null
        }, cp, a, b);
        if (c) {
            var d = new Wk;
            a = a.getAttribute("id");
            null !== a && d.kf(a);
            b = b[0];
            (a = c.geometry) && wl(a, !1, b);
            d.Ab(a);
            delete c.geometry;
            this.Fw && d.Gb(oo(c.Style, c.styleUrl, this.xw, this.Aq, this.$A));
            delete c.Style;
            d.f(c);
            return d
        }
    }
    ;
    h.oA = function(a, b) {
        var c = a.getAttribute("id");
        null !== c && (b = Io(a, b)) && (a = a.baseURI && "about:blank" !== a.baseURI ? (new URL("#" + c,a.baseURI)).href : "#" + c,
        this.Aq[a] = b)
    }
    ;
    h.nA = function(a, b) {
        var c = a.getAttribute("id");
        null !== c && (b = M(void 0, bp, a, b)) && (a = a.baseURI && "about:blank" !== a.baseURI ? (new URL("#" + c,a.baseURI)).href : "#" + c,
        this.Aq[a] = b)
    }
    ;
    h.Vp = function(a, b) {
        return ra(lo, a.namespaceURI) ? (a = this.aq(a, [ul(this, a, b)])) ? a : null : null
    }
    ;
    h.eg = function(a, b) {
        if (!ra(lo, a.namespaceURI))
            return [];
        var c = a.localName;
        if ("Document" == c || "Folder" == c)
            return (c = this.Tp(a, [ul(this, a, b)])) ? c : [];
        if ("Placemark" == c)
            return (b = this.aq(a, [ul(this, a, b)])) ? [b] : [];
        if ("kml" == c) {
            c = [];
            for (a = a.firstElementChild; a; a = a.nextElementSibling) {
                var d = this.eg(a, b);
                d && ta(c, d)
            }
            return c
        }
        return []
    }
    ;
    h.hA = function(a) {
        if (bl(a))
            return ep(this, a);
        if (cl(a))
            return fp(this, a);
        if ("string" === typeof a)
            return a = dl(a),
            ep(this, a)
    }
    ;
    function ep(a, b) {
        for (b = b.firstChild; b; b = b.nextSibling)
            if (b.nodeType == Node.ELEMENT_NODE) {
                var c = fp(a, b);
                if (c)
                    return c
            }
    }
    function fp(a, b) {
        var c;
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            if (ra(lo, c.namespaceURI) && "name" == c.localName)
                return S(c);
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            if (b = c.localName,
            ra(lo, c.namespaceURI) && ("Document" == b || "Folder" == b || "Placemark" == b || "kml" == b) && (b = fp(a, c)))
                return b
    }
    h.iA = function(a) {
        var b = [];
        bl(a) ? ta(b, gp(this, a)) : cl(a) ? ta(b, hp(this, a)) : "string" === typeof a && (a = dl(a),
        ta(b, gp(this, a)));
        return b
    }
    ;
    function gp(a, b) {
        var c = [];
        for (b = b.firstChild; b; b = b.nextSibling)
            b.nodeType == Node.ELEMENT_NODE && ta(c, hp(a, b));
        return c
    }
    function hp(a, b) {
        var c, d = [];
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            if (ra(lo, c.namespaceURI) && "NetworkLink" == c.localName) {
                var e = M({}, $o, c, []);
                d.push(e)
            }
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            b = c.localName,
            !ra(lo, c.namespaceURI) || "Document" != b && "Folder" != b && "kml" != b || ta(d, hp(a, c));
        return d
    }
    h.lA = function(a) {
        var b = [];
        bl(a) ? ta(b, ip(this, a)) : cl(a) ? ta(b, this.cn(a)) : "string" === typeof a && (a = dl(a),
        ta(b, ip(this, a)));
        return b
    }
    ;
    function ip(a, b) {
        var c = [];
        for (b = b.firstChild; b; b = b.nextSibling)
            b.nodeType == Node.ELEMENT_NODE && ta(c, a.cn(b));
        return c
    }
    h.cn = function(a) {
        var b, c = [];
        for (b = a.firstElementChild; b; b = b.nextElementSibling)
            if (ra(lo, b.namespaceURI) && "Region" == b.localName) {
                var d = M({}, No, b, []);
                c.push(d)
            }
        for (b = a.firstElementChild; b; b = b.nextElementSibling)
            a = b.localName,
            !ra(lo, b.namespaceURI) || "Document" != a && "Folder" != a && "kml" != a || ta(c, this.cn(b));
        return c
    }
    ;
    function jp(a, b) {
        b = kd(b);
        b = [255 * (4 == b.length ? b[3] : 1), b[2], b[1], b[0]];
        var c;
        for (c = 0; 4 > c; ++c) {
            var d = parseInt(b[c], 10).toString(16);
            b[c] = 1 == d.length ? "0" + d : d
        }
        Dm(a, b.join(""))
    }
    function kp(a, b, c) {
        a = {
            node: a
        };
        var d = b.D();
        if ("GeometryCollection" == d) {
            var e = b.Rh();
            var f = lp
        } else
            "MultiPoint" == d ? (e = b.We(),
            f = mp) : "MultiLineString" == d ? (e = b.Sh(),
            f = np) : "MultiPolygon" == d ? (e = b.Jj(),
            f = op) : Fa(!1, 39);
        ql(a, pp, f, e, c)
    }
    function qp(a, b, c) {
        ql({
            node: a
        }, rp, sp, [b], c)
    }
    function tp(a, b, c) {
        var d = {
            node: a
        };
        b.vb && a.setAttribute("id", b.vb);
        a = b.l();
        var e = {
            address: 1,
            description: 1,
            name: 1,
            open: 1,
            phoneNumber: 1,
            styleUrl: 1,
            visibility: 1
        };
        e[b.Ua] = 1;
        var f = Object.keys(a || {}).sort().filter(function(a) {
            return !e[a]
        });
        if (0 < f.length) {
            var g = ml(a, f);
            ql(d, up, vp, [{
                names: f,
                values: g
            }], c)
        }
        if (f = b.Xb())
            if (f = f.call(b, 0))
                f = Array.isArray(f) ? f[0] : f,
                this.MB && (a.Style = f),
                (f = f.S) && (a.name = f.S);
        f = wp[c[c.length - 1].node.namespaceURI];
        a = ml(a, f);
        ql(d, up, ll, a, c, f);
        a = c[0];
        (b = b.I()) && (b = wl(b, !0, a));
        ql(d, up, lp, [b], c)
    }
    function xp(a, b, c) {
        var d = b.X();
        a = {
            node: a
        };
        a.layout = b.ha;
        a.stride = b.oa();
        b = b.l();
        b.coordinates = d;
        d = yp[c[c.length - 1].node.namespaceURI];
        b = ml(b, d);
        ql(a, zp, ll, b, c, d)
    }
    function Ap(a, b, c) {
        b = b.Hj();
        var d = b.shift();
        a = {
            node: a
        };
        ql(a, Bp, Cp, b, c);
        ql(a, Bp, Dp, [d], c)
    }
    function Ep(a, b) {
        Em(a, Math.round(1E6 * b) / 1E6)
    }
    var Fp = L(lo, ["Document", "Placemark"])
      , Ip = L(lo, {
        Document: K(function(a, b, c) {
            ql({
                node: a
            }, Gp, Hp, b, c, void 0, this)
        }),
        Placemark: K(tp)
    })
      , Gp = L(lo, {
        Placemark: K(tp)
    })
      , Jp = L(lo, {
        Data: K(function(a, b, c) {
            a.setAttribute("name", b.name);
            a = {
                node: a
            };
            b = b.value;
            "object" == typeof b ? (null !== b && b.displayName && ql(a, Jp, ll, [b.displayName], c, ["displayName"]),
            null !== b && b.value && ql(a, Jp, ll, [b.value], c, ["value"])) : ql(a, Jp, ll, [b], c, ["value"])
        }),
        value: K(function(a, b) {
            Dm(a, b)
        }),
        displayName: K(function(a, b) {
            a.appendChild(Yk.createCDATASection(b))
        })
    })
      , Kp = {
        Point: "Point",
        LineString: "LineString",
        LinearRing: "LinearRing",
        Polygon: "Polygon",
        MultiPoint: "MultiGeometry",
        MultiLineString: "MultiGeometry",
        MultiPolygon: "MultiGeometry",
        GeometryCollection: "MultiGeometry"
    }
      , Lp = L(lo, ["href"], L(ko, ["x", "y", "w", "h"]))
      , Mp = L(lo, {
        href: K(Dm)
    }, L(ko, {
        x: K(Em),
        y: K(Em),
        w: K(Em),
        h: K(Em)
    }))
      , Np = L(lo, ["scale", "heading", "Icon", "hotSpot"])
      , Pp = L(lo, {
        Icon: K(function(a, b, c) {
            a = {
                node: a
            };
            var d = Lp[c[c.length - 1].node.namespaceURI]
              , e = ml(b, d);
            ql(a, Mp, ll, e, c, d);
            d = Lp[ko[0]];
            e = ml(b, d);
            ql(a, Mp, Op, e, c, d)
        }),
        heading: K(Em),
        hotSpot: K(function(a, b) {
            a.setAttribute("x", b.x);
            a.setAttribute("y", b.y);
            a.setAttribute("xunits", b.or);
            a.setAttribute("yunits", b.pr)
        }),
        scale: K(Ep)
    })
      , Qp = L(lo, ["color", "scale"])
      , Rp = L(lo, {
        color: K(jp),
        scale: K(Ep)
    })
      , Sp = L(lo, ["color", "width"])
      , Tp = L(lo, {
        color: K(jp),
        width: K(Em)
    })
      , rp = L(lo, {
        LinearRing: K(xp)
    })
      , pp = L(lo, {
        LineString: K(xp),
        Point: K(xp),
        Polygon: K(Ap),
        GeometryCollection: K(kp)
    })
      , wp = L(lo, "name open visibility address phoneNumber description styleUrl Style".split(" "))
      , up = L(lo, {
        ExtendedData: K(function(a, b, c) {
            a = {
                node: a
            };
            var d = b.names;
            b = b.values;
            for (var e = d.length, f = 0; f < e; f++)
                ql(a, Jp, Up, [{
                    name: d[f],
                    value: b[f]
                }], c)
        }),
        MultiGeometry: K(kp),
        LineString: K(xp),
        LinearRing: K(xp),
        Point: K(xp),
        Polygon: K(Ap),
        Style: K(function(a, b, c) {
            a = {
                node: a
            };
            var d = {}
              , e = b.ja
              , f = b.ia
              , g = b.N();
            b = b.S;
            g instanceof Sn && (d.IconStyle = g);
            b && (d.LabelStyle = b);
            f && (d.LineStyle = f);
            e && (d.PolyStyle = e);
            b = Vp[c[c.length - 1].node.namespaceURI];
            d = ml(d, b);
            ql(a, Wp, ll, d, c, b)
        }),
        address: K(Dm),
        description: K(Dm),
        name: K(Dm),
        open: K(Cm),
        phoneNumber: K(Dm),
        styleUrl: K(Dm),
        visibility: K(Cm)
    })
      , yp = L(lo, ["extrude", "tessellate", "altitudeMode", "coordinates"])
      , zp = L(lo, {
        extrude: K(Cm),
        tessellate: K(Cm),
        altitudeMode: K(Dm),
        coordinates: K(function(a, b, c) {
            c = c[c.length - 1];
            var d = c.layout;
            c = c.stride;
            var e;
            "XY" == d || "XYM" == d ? e = 2 : "XYZ" == d || "XYZM" == d ? e = 3 : Fa(!1, 34);
            var f, g = b.length, k = "";
            if (0 < g) {
                k += b[0];
                for (d = 1; d < e; ++d)
                    k += "," + b[d];
                for (f = c; f < g; f += c)
                    for (k += " " + b[f],
                    d = 1; d < e; ++d)
                        k += "," + b[f + d]
            }
            Dm(a, k)
        })
    })
      , Bp = L(lo, {
        outerBoundaryIs: K(qp),
        innerBoundaryIs: K(qp)
    })
      , Xp = L(lo, {
        color: K(jp)
    })
      , Vp = L(lo, ["IconStyle", "LabelStyle", "LineStyle", "PolyStyle"])
      , Wp = L(lo, {
        IconStyle: K(function(a, b, c) {
            a = {
                node: a
            };
            var d = {}
              , e = b.Lj()
              , f = b.Ga()
              , g = b.Tl();
            e = {
                href: e
            };
            if (f) {
                e.w = f[0];
                e.h = f[1];
                var k = b.Hg()
                  , l = b.ic();
                l && g && 0 !== l[0] && l[1] !== f[1] && (e.x = l[0],
                e.y = g[1] - (l[1] + f[1]));
                !k || k[0] === f[0] / 2 && k[1] === f[1] / 2 || (d.hotSpot = {
                    x: k[0],
                    or: "pixels",
                    y: f[1] - k[1],
                    pr: "pixels"
                })
            }
            d.Icon = e;
            f = b.Ma;
            1 !== f && (d.scale = f);
            b = b.ma();
            0 !== b && (d.heading = b);
            b = Np[c[c.length - 1].node.namespaceURI];
            d = ml(d, b);
            ql(a, Pp, ll, d, c, b)
        }),
        LabelStyle: K(function(a, b, c) {
            a = {
                node: a
            };
            var d = {}
              , e = b.ja;
            e && (d.color = e.W);
            (b = b.Ma) && 1 !== b && (d.scale = b);
            b = Qp[c[c.length - 1].node.namespaceURI];
            d = ml(d, b);
            ql(a, Rp, ll, d, c, b)
        }),
        LineStyle: K(function(a, b, c) {
            a = {
                node: a
            };
            var d = Sp[c[c.length - 1].node.namespaceURI];
            b = ml({
                color: b.W,
                width: b.Sb()
            }, d);
            ql(a, Tp, ll, b, c, d)
        }),
        PolyStyle: K(function(a, b, c) {
            ql({
                node: a
            }, Xp, Yp, [b.W], c)
        })
    });
    function Op(a, b, c) {
        return Zk(ko[0], "gx:" + c)
    }
    function Hp(a, b) {
        return Zk(b[b.length - 1].node.namespaceURI, "Placemark")
    }
    function lp(a, b) {
        if (a)
            return Zk(b[b.length - 1].node.namespaceURI, Kp[a.D()])
    }
    var Yp = jl("color")
      , Up = jl("Data")
      , vp = jl("ExtendedData")
      , Cp = jl("innerBoundaryIs")
      , mp = jl("Point")
      , np = jl("LineString")
      , sp = jl("LinearRing")
      , op = jl("Polygon")
      , Dp = jl("outerBoundaryIs");
    Un.prototype.Ke = function(a, b) {
        b = vl(this, b);
        var c = Zk(lo[4], "kml");
        c.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:gx", ko[0]);
        c.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:xsi", "http://www.w3.org/2001/XMLSchema-instance");
        c.setAttributeNS("http://www.w3.org/2001/XMLSchema-instance", "xsi:schemaLocation", "http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");
        var d = {
            node: c
        }
          , e = {};
        1 < a.length ? e.Document = a : 1 == a.length && (e.Placemark = a[0]);
        a = Fp[c.namespaceURI];
        e = ml(e, a);
        ql(d, Ip, ll, e, [b], a, this);
        return c
    }
    ;
    vj.Vi = function() {}
    ;
    (function(a) {
        function b(a) {
            this.Ne = ArrayBuffer.isView && ArrayBuffer.isView(a) ? a : new Uint8Array(a || 0);
            this.type = this.aa = 0;
            this.length = this.Ne.length
        }
        function c(a, b, c) {
            var e = c.Ne;
            var f = e[c.aa++];
            var g = (f & 112) >> 4;
            if (128 > f)
                return d(a, g, b);
            f = e[c.aa++];
            g |= (f & 127) << 3;
            if (128 > f)
                return d(a, g, b);
            f = e[c.aa++];
            g |= (f & 127) << 10;
            if (128 > f)
                return d(a, g, b);
            f = e[c.aa++];
            g |= (f & 127) << 17;
            if (128 > f)
                return d(a, g, b);
            f = e[c.aa++];
            g |= (f & 127) << 24;
            if (128 > f)
                return d(a, g, b);
            f = e[c.aa++];
            if (128 > f)
                return d(a, g | (f & 1) << 31, b);
            throw Error("Expected varint not more than 10 bytes");
        }
        function d(a, b, c) {
            return c ? 4294967296 * b + (a >>> 0) : 4294967296 * (b >>> 0) + (a >>> 0)
        }
        var e = {
            read: function(a, b, c, d, e) {
                var f = 8 * e - d - 1;
                var g = (1 << f) - 1
                  , k = g >> 1
                  , l = -7;
                e = c ? e - 1 : 0;
                var m = c ? -1 : 1
                  , x = a[b + e];
                e += m;
                c = x & (1 << -l) - 1;
                x >>= -l;
                for (l += f; 0 < l; c = 256 * c + a[b + e],
                e += m,
                l -= 8)
                    ;
                f = c & (1 << -l) - 1;
                c >>= -l;
                for (l += d; 0 < l; f = 256 * f + a[b + e],
                e += m,
                l -= 8)
                    ;
                if (0 === c)
                    c = 1 - k;
                else {
                    if (c === g)
                        return f ? NaN : Infinity * (x ? -1 : 1);
                    f += Math.pow(2, d);
                    c -= k
                }
                return (x ? -1 : 1) * f * Math.pow(2, c - d)
            },
            write: function(a, b, c, d, e, n) {
                var f, g = 8 * n - e - 1, k = (1 << g) - 1, l = k >> 1, m = 23 === e ? Math.pow(2, -24) - Math.pow(2, -77) : 0;
                n = d ? 0 : n - 1;
                var B = d ? 1 : -1
                  , z = 0 > b || 0 === b && 0 > 1 / b ? 1 : 0;
                b = Math.abs(b);
                isNaN(b) || Infinity === b ? (b = isNaN(b) ? 1 : 0,
                d = k) : (d = Math.floor(Math.log(b) / Math.LN2),
                1 > b * (f = Math.pow(2, -d)) && (d--,
                f *= 2),
                b = 1 <= d + l ? b + m / f : b + m * Math.pow(2, 1 - l),
                2 <= b * f && (d++,
                f /= 2),
                d + l >= k ? (b = 0,
                d = k) : 1 <= d + l ? (b = (b * f - 1) * Math.pow(2, e),
                d += l) : (b = b * Math.pow(2, l - 1) * Math.pow(2, e),
                d = 0));
                for (; 8 <= e; a[c + n] = b & 255,
                n += B,
                b /= 256,
                e -= 8)
                    ;
                d = d << e | b;
                for (g += e; 0 < g; a[c + n] = d & 255,
                n += B,
                d /= 256,
                g -= 8)
                    ;
                a[c + n - B] |= 128 * z
            }
        };
        b.Jv = 0;
        b.vv = 1;
        b.qv = 2;
        b.uv = 5;
        b.prototype = {
            Yp: function(a, b, c) {
                for (c = c || this.length; this.aa < c; ) {
                    var d = this.ib()
                      , e = d >> 3
                      , f = this.aa;
                    this.type = d & 7;
                    a(e, b, this);
                    this.aa === f && this.bB(d)
                }
                return b
            },
            dA: function() {
                var a = e.read(this.Ne, this.aa, !0, 23, 4);
                this.aa += 4;
                return a
            },
            Zz: function() {
                var a = e.read(this.Ne, this.aa, !0, 52, 8);
                this.aa += 8;
                return a
            },
            ib: function(a) {
                var b = this.Ne;
                var d = b[this.aa++];
                var e = d & 127;
                if (128 > d)
                    return e;
                d = b[this.aa++];
                e |= (d & 127) << 7;
                if (128 > d)
                    return e;
                d = b[this.aa++];
                e |= (d & 127) << 14;
                if (128 > d)
                    return e;
                d = b[this.aa++];
                e |= (d & 127) << 21;
                if (128 > d)
                    return e;
                d = b[this.aa];
                return c(e | (d & 15) << 28, a, this)
            },
            qA: function() {
                return this.ib(!0)
            },
            xk: function() {
                var a = this.ib();
                return 1 === a % 2 ? (a + 1) / -2 : a / 2
            },
            Xz: function() {
                return !!this.ib()
            },
            eq: function() {
                for (var a = this.ib() + this.aa, b = this.Ne, c = "", d = this.aa; d < a; ) {
                    var e = b[d]
                      , n = null
                      , p = 239 < e ? 4 : 223 < e ? 3 : 191 < e ? 2 : 1;
                    if (d + p > a)
                        break;
                    if (1 === p)
                        128 > e && (n = e);
                    else if (2 === p) {
                        var q = b[d + 1];
                        128 === (q & 192) && (n = (e & 31) << 6 | q & 63,
                        127 >= n && (n = null))
                    } else if (3 === p) {
                        q = b[d + 1];
                        var t = b[d + 2];
                        128 === (q & 192) && 128 === (t & 192) && (n = (e & 15) << 12 | (q & 63) << 6 | t & 63,
                        2047 >= n || 55296 <= n && 57343 >= n) && (n = null)
                    } else if (4 === p) {
                        q = b[d + 1];
                        t = b[d + 2];
                        var u = b[d + 3];
                        128 === (q & 192) && 128 === (t & 192) && 128 === (u & 192) && (n = (e & 15) << 18 | (q & 63) << 12 | (t & 63) << 6 | u & 63,
                        65535 >= n || 1114112 <= n) && (n = null)
                    }
                    null === n ? (n = 65533,
                    p = 1) : 65535 < n && (n -= 65536,
                    c += String.fromCharCode(n >>> 10 & 1023 | 55296),
                    n = 56320 | n & 1023);
                    c += String.fromCharCode(n);
                    d += p
                }
                this.aa = a;
                return c
            },
            bB: function(a) {
                a &= 7;
                if (a === b.Jv)
                    for (; 127 < this.Ne[this.aa++]; )
                        ;
                else if (a === b.qv)
                    this.aa = this.ib() + this.aa;
                else if (a === b.uv)
                    this.aa += 4;
                else if (a === b.vv)
                    this.aa += 8;
                else
                    throw Error("Unimplemented type: " + a);
            },
            finish: function() {
                this.length = this.aa;
                this.aa = 0;
                return this.Ne.subarray(0, this.length)
            }
        };
        a["default"] = b
    }
    )(vj.Vi = vj.Vi || {});
    vj.Vi = vj.Vi.default;
    vj.Pn = {};
    vj.Pn.$n = function() {}
    ;
    (function(a) {
        function b(a, b) {
            this.layers = a.Yp(l, {}, b)
        }
        function c(a, b) {
            this.x = a;
            this.y = b
        }
        function d(a, b, c, d, f) {
            this.properties = {};
            this.extent = c;
            this.type = 0;
            this.ug = a;
            this.ao = -1;
            this.pl = d;
            this.rl = f;
            a.Yp(e, this, b)
        }
        function e(a, b, c) {
            if (1 == a)
                b.id = c.ib();
            else if (2 == a)
                for (a = c.ib() + c.aa; c.aa < a; ) {
                    var d = b.pl[c.ib()]
                      , e = b.rl[c.ib()];
                    b.properties[d] = e
                }
            else
                3 == a ? b.type = c.ib() : 4 == a && (b.ao = c.aa)
        }
        function f(a, b) {
            this.version = 1;
            this.name = null;
            this.extent = 4096;
            this.length = 0;
            this.ug = a;
            this.pl = [];
            this.rl = [];
            this.nl = [];
            a.Yp(g, this, b);
            this.length = this.nl.length
        }
        function g(a, b, c) {
            15 === a ? b.version = c.ib() : 1 === a ? b.name = c.eq() : 5 === a ? b.extent = c.ib() : 2 === a ? b.nl.push(c.aa) : 3 === a ? b.pl.push(c.eq()) : 4 === a && b.rl.push(k(c))
        }
        function k(a) {
            for (var b = null, c = a.ib() + a.aa; a.aa < c; )
                b = a.ib() >> 3,
                b = 1 === b ? a.eq() : 2 === b ? a.dA() : 3 === b ? a.Zz() : 4 === b ? a.qA() : 5 === b ? a.ib() : 6 === b ? a.xk() : 7 === b ? a.Xz() : null;
            return b
        }
        function l(a, b, c) {
            3 === a && (a = new m(c,c.ib() + c.aa),
            a.length && (b[a.name] = a))
        }
        c.prototype = {
            clone: function() {
                return new c(this.x,this.y)
            },
            add: function(a) {
                return this.clone().Mv(a)
            },
            sub: function(a) {
                return this.clone().Zv(a)
            },
            rotate: function(a) {
                return this.clone().Wv(a)
            },
            round: function() {
                return this.clone().Xv()
            },
            hs: function(a) {
                return this.x === a.x && this.y === a.y
            },
            angle: function() {
                return Math.atan2(this.y, this.x)
            },
            Mv: function(a) {
                this.x += a.x;
                this.y += a.y;
                return this
            },
            Zv: function(a) {
                this.x -= a.x;
                this.y -= a.y;
                return this
            },
            Wv: function(a) {
                var b = Math.cos(a);
                a = Math.sin(a);
                var c = a * this.x + b * this.y;
                this.x = b * this.x - a * this.y;
                this.y = c;
                return this
            },
            Xv: function() {
                this.x = Math.round(this.x);
                this.y = Math.round(this.y);
                return this
            }
        };
        c.hC = function(a) {
            return a instanceof c ? a : Array.isArray(a) ? new c(a[0],a[1]) : a
        }
        ;
        d.types = ["Unknown", "Point", "LineString", "Polygon"];
        d.prototype.ot = function() {
            var a = this.ug;
            a.aa = this.ao;
            for (var b = a.ib() + a.aa, d = 1, e = 0, f = 0, g = 0, k = [], l; a.aa < b; )
                if (e || (e = a.ib(),
                d = e & 7,
                e >>= 3),
                e--,
                1 === d || 2 === d)
                    f += a.xk(),
                    g += a.xk(),
                    1 === d && (l && k.push(l),
                    l = []),
                    l.push(new c(f,g));
                else if (7 === d)
                    l && l.push(l[0].clone());
                else
                    throw Error("unknown command " + d);
            l && k.push(l);
            return k
        }
        ;
        d.prototype.bbox = function() {
            var a = this.ug;
            a.aa = this.ao;
            for (var b = a.ib() + a.aa, c = 1, d = 0, e = 0, f = 0, g = Infinity, k = -Infinity, l = Infinity, m = -Infinity; a.aa < b; )
                if (d || (d = a.ib(),
                c = d & 7,
                d >>= 3),
                d--,
                1 === c || 2 === c)
                    e += a.xk(),
                    f += a.xk(),
                    e < g && (g = e),
                    e > k && (k = e),
                    f < l && (l = f),
                    f > m && (m = f);
                else if (7 !== c)
                    throw Error("unknown command " + c);
            return [g, l, k, m]
        }
        ;
        var m = f;
        f.prototype.feature = function(a) {
            if (0 > a || a >= this.nl.length)
                throw Error("feature index out of bounds");
            this.ug.aa = this.nl[a];
            a = this.ug.ib() + this.ug.aa;
            return new d(this.ug,a,this.extent,this.pl,this.rl)
        }
        ;
        var n = m;
        a["default"] = {
            $n: b,
            Kv: d,
            Lv: n
        };
        a.$n = b;
        a.Kv = d;
        a.Lv = n
    }
    )(vj.Pn = vj.Pn || {});
    function Zp(a, b, c, d, e) {
        this.vb = e;
        this.pg = a;
        this.Pl = b;
        this.U = c;
        this.Vt = d
    }
    h = Zp.prototype;
    h.get = function(a) {
        return this.Vt[a]
    }
    ;
    h.c = function() {
        this.V || (this.V = "Point" === this.pg ? eb(this.Pl) : fb(this.Pl, 0, this.Pl.length, 2));
        return this.V
    }
    ;
    h.Ej = function() {
        return this.vb
    }
    ;
    h.ub = function() {
        return this.Pl
    }
    ;
    h.X = Zp.prototype.ub;
    h.I = function() {
        return this
    }
    ;
    h.l = function() {
        return this.Vt
    }
    ;
    h.Kj = Zp.prototype.I;
    h.oa = function() {
        return 2
    }
    ;
    h.Xb = Ba;
    h.D = function() {
        return this.pg
    }
    ;
    function $p(a) {
        tl.call(this);
        a = a ? a : {};
        this.defaultDataProjection = new Lb({
            code: "",
            units: "tile-pixels"
        });
        this.Fo = a.featureClass ? a.featureClass : Zp;
        this.Ua = a.geometryName;
        this.Am = a.layerName ? a.layerName : "layer";
        this.Wf = a.layers ? a.layers : null;
        this.V = null
    }
    v($p, tl);
    h = $p.prototype;
    h.ap = function() {
        return this.V
    }
    ;
    h.D = function() {
        return "arraybuffer"
    }
    ;
    h.pb = function(a, b) {
        var c = this.Wf;
        a = new vj.Vi(a);
        a = new vj.Pn.$n(a);
        var d = [], e = this.Fo, f;
        for (f in a.layers)
            if (!c || -1 != c.indexOf(f)) {
                var g = a.layers[f];
                for (var k, l = 0, m = g.length; l < m; ++l) {
                    k = g.feature(l);
                    if (e === Zp) {
                        var n = void 0;
                        var p = f
                          , q = k.ot()
                          , t = []
                          , u = [];
                        aq(q, u, t);
                        var x = k.type;
                        1 === x ? n = 1 === q.length ? "Point" : "MultiPoint" : 2 === x ? n = 1 === q.length ? "LineString" : "MultiLineString" : 3 === x && (n = "Polygon");
                        q = k.properties;
                        q[this.Am] = p;
                        n = new this.Fo(n,u,t,q,k.id)
                    } else {
                        x = k;
                        u = f;
                        t = b;
                        n = new this.Fo;
                        k = x.id;
                        p = x.properties;
                        p[this.Am] = u;
                        this.Ua && n.lh(this.Ua);
                        u = void 0;
                        q = x.type;
                        if (0 === q)
                            u = null;
                        else {
                            x = x.ot();
                            var B = []
                              , z = [];
                            aq(x, z, B);
                            1 === q ? u = 1 === x.length ? new D(null) : new Q(null) : 2 === q ? u = 1 === x.length ? new N(null) : new P(null) : 3 === q && (u = new F(null));
                            u.K("XY", z, B)
                        }
                        t = wl(u, !1, vl(this, t));
                        n.Ab(t);
                        n.kf(k);
                        n.f(p)
                    }
                    d.push(n)
                }
                this.V = g ? [0, 0, g.extent, g.extent] : null
            }
        return d
    }
    ;
    h.mc = function() {
        return this.defaultDataProjection
    }
    ;
    h.mn = function(a) {
        this.Wf = a
    }
    ;
    function aq(a, b, c) {
        for (var d = 0, e = 0, f = a.length; e < f; ++e) {
            var g = a[e], k;
            var l = 0;
            for (k = g.length; l < k; ++l) {
                var m = g[l];
                b.push(m.x, m.y)
            }
            d += 2 * l;
            c.push(d)
        }
    }
    h.we = function() {}
    ;
    h.fh = function() {}
    ;
    h.Si = function() {}
    ;
    h.uh = function() {}
    ;
    h.Je = function() {}
    ;
    function bq() {
        qm.call(this);
        this.defaultDataProjection = ec("EPSG:4326")
    }
    v(bq, qm);
    function cq(a, b) {
        b[b.length - 1].Mk[a.getAttribute("k")] = a.getAttribute("v")
    }
    var dq = [null]
      , eq = L(dq, {
        nd: function(a, b) {
            b[b.length - 1].li.push(a.getAttribute("ref"))
        },
        tag: cq
    })
      , gq = L(dq, {
        node: function(a, b) {
            var c = b[0]
              , d = b[b.length - 1]
              , e = a.getAttribute("id")
              , f = [parseFloat(a.getAttribute("lon")), parseFloat(a.getAttribute("lat"))];
            d.Mt[e] = f;
            a = M({
                Mk: {}
            }, fq, a, b);
            Bb(a.Mk) || (f = new D(f),
            wl(f, !1, c),
            c = new Wk(f),
            c.kf(e),
            c.f(a.Mk),
            d.features.push(c))
        },
        way: function(a, b) {
            var c = b[0]
              , d = a.getAttribute("id");
            a = M({
                li: [],
                Mk: {}
            }, eq, a, b);
            b = b[b.length - 1];
            for (var e = [], f = 0, g = a.li.length; f < g; f++)
                ta(e, b.Mt[a.li[f]]);
            a.li[0] == a.li[a.li.length - 1] ? (f = new F(null),
            f.K("XY", e, [e.length])) : (f = new N(null),
            f.K("XY", e));
            wl(f, !1, c);
            c = new Wk(f);
            c.kf(d);
            c.f(a.Mk);
            b.features.push(c)
        }
    })
      , fq = L(dq, {
        tag: cq
    });
    bq.prototype.eg = function(a, b) {
        b = ul(this, a, b);
        return "osm" == a.localName && (a = M({
            Mt: {},
            features: []
        }, gq, a, [b]),
        a.features) ? a.features : []
    }
    ;
    bq.prototype.cr = function() {}
    ;
    bq.prototype.Ke = function() {}
    ;
    bq.prototype.bl = function() {}
    ;
    function hq(a) {
        return a.getAttributeNS("http://www.w3.org/1999/xlink", "href")
    }
    ;function iq() {}
    iq.prototype.read = function(a) {
        return bl(a) ? this.Ym(a) : cl(a) ? this.eh(a) : "string" === typeof a ? (a = dl(a),
        this.Ym(a)) : null
    }
    ;
    function jq() {}
    v(jq, iq);
    jq.prototype.Ym = function(a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.eh(a);
        return null
    }
    ;
    jq.prototype.eh = function(a) {
        return (a = M({}, kq, a, [])) ? a : null
    }
    ;
    var lq = [null, "http://www.opengis.net/ows/1.1"]
      , kq = L(lq, {
        ServiceIdentification: J(function(a, b) {
            return M({}, mq, a, b)
        }),
        ServiceProvider: J(function(a, b) {
            return M({}, nq, a, b)
        }),
        OperationsMetadata: J(function(a, b) {
            return M({}, oq, a, b)
        })
    })
      , qq = L(lq, {
        DeliveryPoint: J(S),
        City: J(S),
        AdministrativeArea: J(S),
        PostalCode: J(S),
        Country: J(S),
        ElectronicMailAddress: J(S)
    })
      , rq = L(lq, {
        Value: hl(function(a) {
            return S(a)
        })
    })
      , sq = L(lq, {
        AllowedValues: J(function(a, b) {
            return M({}, rq, a, b)
        })
    })
      , uq = L(lq, {
        Phone: J(function(a, b) {
            return M({}, tq, a, b)
        }),
        Address: J(function(a, b) {
            return M({}, qq, a, b)
        })
    })
      , wq = L(lq, {
        HTTP: J(function(a, b) {
            return M({}, vq, a, b)
        })
    })
      , vq = L(lq, {
        Get: hl(function(a, b) {
            var c = hq(a);
            if (c)
                return M({
                    href: c
                }, xq, a, b)
        }),
        Post: void 0
    })
      , yq = L(lq, {
        DCP: J(function(a, b) {
            return M({}, wq, a, b)
        })
    })
      , oq = L(lq, {
        Operation: function(a, b) {
            var c = a.getAttribute("name");
            (a = M({}, yq, a, b)) && (b[b.length - 1][c] = a)
        }
    })
      , tq = L(lq, {
        Voice: J(S),
        Facsimile: J(S)
    })
      , xq = L(lq, {
        Constraint: hl(function(a, b) {
            var c = a.getAttribute("name");
            if (c)
                return M({
                    name: c
                }, sq, a, b)
        })
    })
      , zq = L(lq, {
        IndividualName: J(S),
        PositionName: J(S),
        ContactInfo: J(function(a, b) {
            return M({}, uq, a, b)
        })
    })
      , mq = L(lq, {
        Title: J(S),
        ServiceTypeVersion: J(S),
        ServiceType: J(S)
    })
      , nq = L(lq, {
        ProviderName: J(S),
        ProviderSite: J(hq),
        ServiceContact: J(function(a, b) {
            return M({}, zq, a, b)
        })
    });
    function Aq(a, b, c, d) {
        var e;
        d = void 0 !== d ? d : [];
        for (var f = e = 0; f < b; ) {
            var g = a[f++];
            d[e++] = a[f++];
            d[e++] = g;
            for (g = 2; g < c; ++g)
                d[e++] = a[f++]
        }
        d.length = e
    }
    ;function Bq(a) {
        a = a ? a : {};
        tl.call(this);
        this.defaultDataProjection = ec("EPSG:4326");
        this.ps = a.factor ? a.factor : 1E5;
        this.zs = a.geometryLayout ? a.geometryLayout : "XY"
    }
    v(Bq, In);
    function Cq(a, b, c) {
        var d, e = Array(b);
        for (d = 0; d < b; ++d)
            e[d] = 0;
        var f;
        var g = 0;
        for (f = a.length; g < f; )
            for (d = 0; d < b; ++d,
            ++g) {
                var k = a[g]
                  , l = k - e[d];
                e[d] = k;
                a[g] = l
            }
        return Dq(a, c ? c : 1E5)
    }
    function Eq(a, b, c) {
        var d, e = Array(b);
        for (d = 0; d < b; ++d)
            e[d] = 0;
        a = Fq(a, c ? c : 1E5);
        var f;
        c = 0;
        for (f = a.length; c < f; )
            for (d = 0; d < b; ++d,
            ++c)
                e[d] += a[c],
                a[c] = e[d];
        return a
    }
    function Dq(a, b) {
        b = b ? b : 1E5;
        var c;
        var d = 0;
        for (c = a.length; d < c; ++d)
            a[d] = Math.round(a[d] * b);
        b = 0;
        for (d = a.length; b < d; ++b)
            c = a[b],
            a[b] = 0 > c ? ~(c << 1) : c << 1;
        b = "";
        d = 0;
        for (c = a.length; d < c; ++d) {
            for (var e, f = a[d], g = ""; 32 <= f; )
                e = (32 | f & 31) + 63,
                g += String.fromCharCode(e),
                f >>= 5;
            g += String.fromCharCode(f + 63);
            b += g
        }
        return b
    }
    function Fq(a, b) {
        b = b ? b : 1E5;
        var c = [], d = 0, e = 0, f;
        var g = 0;
        for (f = a.length; g < f; ++g) {
            var k = a.charCodeAt(g) - 63;
            d |= (k & 31) << e;
            32 > k ? (c.push(d),
            e = d = 0) : e += 5
        }
        a = 0;
        for (d = c.length; a < d; ++a)
            e = c[a],
            c[a] = e & 1 ? ~(e >> 1) : e >> 1;
        a = 0;
        for (d = c.length; a < d; ++a)
            c[a] /= b;
        return c
    }
    h = Bq.prototype;
    h.vk = function(a, b) {
        a = this.yi(a, b);
        return new Wk(a)
    }
    ;
    h.Xp = function(a, b) {
        return [this.vk(a, b)]
    }
    ;
    h.yi = function(a, b) {
        var c = uf(this.zs);
        a = Eq(a, c, this.ps);
        Aq(a, a.length, c, a);
        c = Hf(a, 0, a.length, c);
        return wl(new N(c,this.zs), !1, vl(this, b))
    }
    ;
    h.$k = function(a, b) {
        if (a = a.I())
            return this.Ti(a, b);
        Fa(!1, 40);
        return ""
    }
    ;
    h.dr = function(a, b) {
        return this.$k(a[0], b)
    }
    ;
    h.Ti = function(a, b) {
        a = wl(a, !0, vl(this, b));
        b = a.X();
        a = a.oa();
        Aq(b, b.length, a, b);
        return Cq(b, a, this.ps)
    }
    ;
    function Gq(a) {
        a = a ? a : {};
        tl.call(this);
        this.Am = a.layerName;
        this.Wf = a.layers ? a.layers : null;
        this.defaultDataProjection = ec(a.defaultDataProjection ? a.defaultDataProjection : "EPSG:4326")
    }
    v(Gq, xl);
    function Hq(a, b) {
        var c = [], d;
        var e = 0;
        for (d = a.length; e < d; ++e) {
            var f = a[e];
            0 < e && c.pop();
            f = 0 <= f ? b[f] : b[~f].slice().reverse();
            c.push.apply(c, f)
        }
        a = 0;
        for (b = c.length; a < b; ++a)
            c[a] = c[a].slice();
        return c
    }
    function Iq(a, b, c, d, e, f, g) {
        a = a.geometries;
        var k = [], l;
        var m = 0;
        for (l = a.length; m < l; ++m)
            k[m] = Jq(a[m], b, c, d, e, f, g);
        return k
    }
    function Jq(a, b, c, d, e, f, g) {
        var k = a.type
          , l = Kq[k];
        c = "Point" === k || "MultiPoint" === k ? l(a, c, d) : l(a, b);
        b = new Wk;
        b.Ab(wl(c, !1, g));
        void 0 !== a.id && b.kf(a.id);
        a = a.properties;
        e && (a || (a = {}),
        a[e] = f);
        a && b.f(a);
        return b
    }
    Gq.prototype.Wp = function(a, b) {
        if ("Topology" == a.type) {
            var c = null
              , d = null;
            if (a.transform) {
                var e = a.transform;
                c = e.scale;
                d = e.translate
            }
            var f = a.arcs;
            if (e) {
                e = c;
                var g = d, k;
                var l = 0;
                for (k = f.length; l < k; ++l) {
                    var m, n = f[l], p = e, q = g, t = 0, u = 0;
                    var x = 0;
                    for (m = n.length; x < m; ++x) {
                        var B = n[x];
                        t += B[0];
                        u += B[1];
                        B[0] = t;
                        B[1] = u;
                        Lq(B, p, q)
                    }
                }
            }
            e = [];
            a = a.objects;
            g = this.Am;
            for (var z in a)
                this.Wf && -1 == this.Wf.indexOf(z) || ("GeometryCollection" === a[z].type ? (l = a[z],
                e.push.apply(e, Iq(l, f, c, d, g, z, b))) : (l = a[z],
                e.push(Jq(l, f, c, d, g, z, b))));
            return e
        }
        return []
    }
    ;
    function Lq(a, b, c) {
        a[0] = a[0] * b[0] + c[0];
        a[1] = a[1] * b[1] + c[1]
    }
    Gq.prototype.cq = function() {
        return this.defaultDataProjection
    }
    ;
    var Kq = {
        Point: function(a, b, c) {
            a = a.coordinates;
            b && c && Lq(a, b, c);
            return new D(a)
        },
        LineString: function(a, b) {
            a = Hq(a.arcs, b);
            return new N(a)
        },
        Polygon: function(a, b) {
            var c = [], d;
            var e = 0;
            for (d = a.arcs.length; e < d; ++e)
                c[e] = Hq(a.arcs[e], b);
            return new F(c)
        },
        MultiPoint: function(a, b, c) {
            a = a.coordinates;
            var d;
            if (b && c) {
                var e = 0;
                for (d = a.length; e < d; ++e)
                    Lq(a[e], b, c)
            }
            return new Q(a)
        },
        MultiLineString: function(a, b) {
            var c = [], d;
            var e = 0;
            for (d = a.arcs.length; e < d; ++e)
                c[e] = Hq(a.arcs[e], b);
            return new P(c)
        },
        MultiPolygon: function(a, b) {
            var c = [], d, e;
            var f = 0;
            for (e = a.arcs.length; f < e; ++f) {
                var g = a.arcs[f];
                var k = [];
                var l = 0;
                for (d = g.length; l < d; ++l)
                    k[l] = Hq(g[l], b);
                c[f] = k
            }
            return new R(c)
        }
    };
    h = Gq.prototype;
    h.th = function() {}
    ;
    h.al = function() {}
    ;
    h.cl = function() {}
    ;
    h.$p = function() {}
    ;
    h.dh = function() {}
    ;
    function Mq(a) {
        a = a ? a : {};
        this.Gw = a.featureType;
        this.Lh = a.featureNS;
        this.Kd = a.gmlFormat ? a.gmlFormat : new Gm;
        this.HA = a.schemaLocation ? a.schemaLocation : Nq["1.1.0"];
        qm.call(this)
    }
    v(Mq, qm);
    var Nq = {
        "1.1.0": "http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd",
        "1.0.0": "http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"
    };
    Mq.prototype.eg = function(a, b) {
        var c = {
            featureType: this.Gw,
            featureNS: this.Lh
        };
        yb(c, ul(this, a, b ? b : {}));
        b = [c];
        this.Kd.sg["http://www.opengis.net/gml"].featureMember = fl(tm.prototype.wk);
        (a = M([], this.Kd.sg, a, b, this.Kd)) || (a = []);
        return a
    }
    ;
    Mq.prototype.pA = function(a) {
        if (bl(a))
            return Oq(a);
        if (cl(a))
            return M({}, Pq, a, []);
        if ("string" === typeof a)
            return a = dl(a),
            Oq(a)
    }
    ;
    Mq.prototype.aA = function(a) {
        if (bl(a))
            return Qq(this, a);
        if (cl(a))
            return Rq(this, a);
        if ("string" === typeof a)
            return a = dl(a),
            Qq(this, a)
    }
    ;
    function Qq(a, b) {
        for (b = b.firstChild; b; b = b.nextSibling)
            if (b.nodeType == Node.ELEMENT_NODE)
                return Rq(a, b)
    }
    var Sq = {
        "http://www.opengis.net/gml": {
            boundedBy: J(tm.prototype.Zm, "bounds")
        }
    };
    function Rq(a, b) {
        var c = {}
          , d = Bm(b.getAttribute("numberOfFeatures"));
        c.numberOfFeatures = d;
        return M(c, Sq, b, [], a.Kd)
    }
    var Tq = {
        "http://www.opengis.net/wfs": {
            totalInserted: J(Am),
            totalUpdated: J(Am),
            totalDeleted: J(Am)
        }
    }
      , Uq = {
        "http://www.opengis.net/ogc": {
            FeatureId: fl(function(a) {
                return a.getAttribute("fid")
            })
        }
    }
      , Vq = {
        "http://www.opengis.net/wfs": {
            Feature: function(a, b) {
                nl(Uq, a, b)
            }
        }
    }
      , Pq = {
        "http://www.opengis.net/wfs": {
            TransactionSummary: J(function(a, b) {
                return M({}, Tq, a, b)
            }, "transactionSummary"),
            InsertResults: J(function(a, b) {
                return M([], Vq, a, b)
            }, "insertIds")
        }
    };
    function Oq(a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return M({}, Pq, a, [])
    }
    var Wq = {
        "http://www.opengis.net/wfs": {
            PropertyName: K(Dm)
        }
    };
    function Xq(a, b) {
        var c = Zk("http://www.opengis.net/ogc", "Filter")
          , d = Zk("http://www.opengis.net/ogc", "FeatureId");
        c.appendChild(d);
        d.setAttribute("fid", b);
        a.appendChild(c)
    }
    function Yq(a, b) {
        a = (a ? a : "feature") + ":";
        return 0 === b.indexOf(a) ? b : a + b
    }
    var Zq = {
        "http://www.opengis.net/wfs": {
            Insert: K(function(a, b, c) {
                var d = c[c.length - 1]
                  , e = d.gmlVersion;
                d = Zk(d.featureNS, d.featureType);
                a.appendChild(d);
                2 === e ? Pm.prototype.Vn(d, b, c) : Gm.prototype.Vn(d, b, c)
            }),
            Update: K(function(a, b, c) {
                var d = c[c.length - 1];
                Fa(void 0 !== b.vb, 27);
                var e = d.featurePrefix
                  , f = d.featureNS;
                a.setAttribute("typeName", Yq(e, d.featureType));
                a.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:" + e, f);
                e = b.vb;
                if (void 0 !== e) {
                    f = b.v();
                    for (var g = [], k = 0, l = f.length; k < l; k++) {
                        var m = b.get(f[k]);
                        void 0 !== m && g.push({
                            name: f[k],
                            value: m
                        })
                    }
                    ql({
                        gmlVersion: d.gmlVersion,
                        node: a,
                        hasZ: d.hasZ,
                        srsName: d.srsName
                    }, Zq, jl("Property"), g, c);
                    Xq(a, e)
                }
            }),
            Delete: K(function(a, b, c) {
                c = c[c.length - 1];
                Fa(void 0 !== b.vb, 26);
                var d = c.featurePrefix
                  , e = c.featureNS;
                a.setAttribute("typeName", Yq(d, c.featureType));
                a.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:" + d, e);
                b = b.vb;
                void 0 !== b && Xq(a, b)
            }),
            Property: K(function(a, b, c) {
                var d = Zk("http://www.opengis.net/wfs", "Name")
                  , e = c[c.length - 1].gmlVersion;
                a.appendChild(d);
                Dm(d, b.name);
                void 0 !== b.value && null !== b.value && (d = Zk("http://www.opengis.net/wfs", "Value"),
                a.appendChild(d),
                b.value instanceof qf ? 2 === e ? Pm.prototype.xf(d, b.value, c) : Gm.prototype.xf(d, b.value, c) : Dm(d, b.value))
            }),
            Native: K(function(a, b) {
                b.HB && a.setAttribute("vendorId", b.HB);
                void 0 !== b.GA && a.setAttribute("safeToIgnore", b.GA);
                void 0 !== b.value && Dm(a, b.value)
            })
        }
    };
    function $q(a, b, c) {
        a = {
            node: a
        };
        b = b.Tr;
        for (var d = 0, e = b.length; d < e; ++d) {
            var f = b[d];
            ql(a, ar, jl(f.pf), [f], c)
        }
    }
    function br(a, b) {
        void 0 !== b.fk && a.setAttribute("matchCase", b.fk.toString());
        cr(a, b.propertyName);
        dr(a, "" + b.Dw)
    }
    function er(a, b, c) {
        a = Zk("http://www.opengis.net/ogc", a);
        Dm(a, c);
        b.appendChild(a)
    }
    function cr(a, b) {
        er("PropertyName", a, b)
    }
    function dr(a, b) {
        er("Literal", a, b)
    }
    function fr(a, b) {
        var c = Zk("http://www.opengis.net/gml", "TimeInstant");
        a.appendChild(c);
        a = Zk("http://www.opengis.net/gml", "timePosition");
        c.appendChild(a);
        Dm(a, b)
    }
    var ar = {
        "http://www.opengis.net/wfs": {
            Query: K(function(a, b, c) {
                var d = c[c.length - 1]
                  , e = d.featurePrefix
                  , f = d.featureNS
                  , g = d.propertyNames
                  , k = d.srsName;
                a.setAttribute("typeName", e ? Yq(e, b) : b);
                k && a.setAttribute("srsName", k);
                f && a.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:" + e, f);
                b = yb({}, d);
                b.node = a;
                ql(b, Wq, jl("PropertyName"), g, c);
                if (d = d.filter)
                    g = Zk("http://www.opengis.net/ogc", "Filter"),
                    a.appendChild(g),
                    ql({
                        node: g
                    }, ar, jl(d.pf), [d], c)
            })
        },
        "http://www.opengis.net/ogc": {
            During: K(function(a, b) {
                var c = Zk("http://www.opengis.net/fes", "ValueReference");
                Dm(c, b.propertyName);
                a.appendChild(c);
                c = Zk("http://www.opengis.net/gml", "TimePeriod");
                a.appendChild(c);
                a = Zk("http://www.opengis.net/gml", "begin");
                c.appendChild(a);
                fr(a, b.Yi);
                a = Zk("http://www.opengis.net/gml", "end");
                c.appendChild(a);
                fr(a, b.end)
            }),
            And: K($q),
            Or: K($q),
            Not: K(function(a, b, c) {
                b = b.condition;
                ql({
                    node: a
                }, ar, jl(b.pf), [b], c)
            }),
            BBOX: K(function(a, b, c) {
                c[c.length - 1].srsName = b.srsName;
                cr(a, b.geometryName);
                Gm.prototype.xf(a, b.extent, c)
            }),
            Intersects: K(function(a, b, c) {
                c[c.length - 1].srsName = b.srsName;
                cr(a, b.geometryName);
                Gm.prototype.xf(a, b.geometry, c)
            }),
            Within: K(function(a, b, c) {
                c[c.length - 1].srsName = b.srsName;
                cr(a, b.geometryName);
                Gm.prototype.xf(a, b.geometry, c)
            }),
            PropertyIsEqualTo: K(br),
            PropertyIsNotEqualTo: K(br),
            PropertyIsLessThan: K(br),
            PropertyIsLessThanOrEqualTo: K(br),
            PropertyIsGreaterThan: K(br),
            PropertyIsGreaterThanOrEqualTo: K(br),
            PropertyIsNull: K(function(a, b) {
                cr(a, b.propertyName)
            }),
            PropertyIsBetween: K(function(a, b) {
                cr(a, b.propertyName);
                var c = Zk("http://www.opengis.net/ogc", "LowerBoundary");
                a.appendChild(c);
                dr(c, "" + b.$y);
                c = Zk("http://www.opengis.net/ogc", "UpperBoundary");
                a.appendChild(c);
                dr(c, "" + b.EB)
            }),
            PropertyIsLike: K(function(a, b) {
                a.setAttribute("wildCard", b.KB);
                a.setAttribute("singleChar", b.aB);
                a.setAttribute("escapeChar", b.Bw);
                void 0 !== b.fk && a.setAttribute("matchCase", b.fk.toString());
                cr(a, b.propertyName);
                dr(a, "" + b.pattern)
            })
        }
    };
    Mq.prototype.LB = function(a) {
        var b = Zk("http://www.opengis.net/wfs", "GetFeature");
        b.setAttribute("service", "WFS");
        b.setAttribute("version", "1.1.0");
        if (a) {
            a.handle && b.setAttribute("handle", a.handle);
            a.outputFormat && b.setAttribute("outputFormat", a.outputFormat);
            void 0 !== a.maxFeatures && b.setAttribute("maxFeatures", a.maxFeatures);
            a.resultType && b.setAttribute("resultType", a.resultType);
            void 0 !== a.startIndex && b.setAttribute("startIndex", a.startIndex);
            void 0 !== a.count && b.setAttribute("count", a.count);
            var c = a.filter;
            if (a.bbox) {
                Fa(a.geometryName, 12);
                var d = gm(a.geometryName, a.bbox, a.srsName);
                c = c ? fm(c, d) : d
            }
        }
        b.setAttributeNS("http://www.w3.org/2001/XMLSchema-instance", "xsi:schemaLocation", this.HA);
        c = {
            node: b,
            srsName: a.srsName,
            featureNS: a.featureNS ? a.featureNS : this.Lh,
            featurePrefix: a.featurePrefix,
            geometryName: a.geometryName,
            filter: c,
            propertyNames: a.propertyNames ? a.propertyNames : []
        };
        Fa(Array.isArray(a.featureTypes), 11);
        a = a.featureTypes;
        c = [c];
        d = yb({}, c[c.length - 1]);
        d.node = b;
        ql(d, ar, jl("Query"), a, c);
        return b
    }
    ;
    Mq.prototype.NB = function(a, b, c, d) {
        var e = []
          , f = Zk("http://www.opengis.net/wfs", "Transaction")
          , g = d.version ? d.version : "1.1.0"
          , k = "1.0.0" === g ? 2 : 3;
        f.setAttribute("service", "WFS");
        f.setAttribute("version", g);
        if (d) {
            var l = d.gmlOptions ? d.gmlOptions : {};
            d.handle && f.setAttribute("handle", d.handle)
        }
        f.setAttributeNS("http://www.w3.org/2001/XMLSchema-instance", "xsi:schemaLocation", Nq[g]);
        var m = d.featurePrefix ? d.featurePrefix : "feature";
        a && (g = {
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: k,
            hasZ: d.hasZ,
            srsName: d.srsName
        },
        yb(g, l),
        ql(g, Zq, jl("Insert"), a, e));
        b && (g = {
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: k,
            hasZ: d.hasZ,
            srsName: d.srsName
        },
        yb(g, l),
        ql(g, Zq, jl("Update"), b, e));
        c && ql({
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: k,
            srsName: d.srsName
        }, Zq, jl("Delete"), c, e);
        d.nativeElements && ql({
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: k,
            srsName: d.srsName
        }, Zq, jl("Native"), d.nativeElements, e);
        return f
    }
    ;
    Mq.prototype.bq = function(a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.bn(a);
        return null
    }
    ;
    Mq.prototype.bn = function(a) {
        if (a.firstElementChild && a.firstElementChild.firstElementChild)
            for (a = a.firstElementChild.firstElementChild,
            a = a.firstElementChild; a; a = a.nextElementSibling)
                if (0 !== a.childNodes.length && (1 !== a.childNodes.length || 3 !== a.firstChild.nodeType)) {
                    var b = [{}];
                    this.Kd.Zm(a, b);
                    return ec(b.pop().srsName)
                }
        return null
    }
    ;
    function gr(a) {
        a = a ? a : {};
        tl.call(this);
        this.gB = void 0 !== a.splitCollection ? a.splitCollection : !1
    }
    v(gr, In);
    function hr(a) {
        a = a.H();
        return 0 === a.length ? "" : a.join(" ")
    }
    function ir(a) {
        a = a.H();
        for (var b = [], c = 0, d = a.length; c < d; ++c)
            b.push(a[c].join(" "));
        return b.join(",")
    }
    function jr(a) {
        var b = [];
        a = a.Hj();
        for (var c = 0, d = a.length; c < d; ++c)
            b.push("(" + ir(a[c]) + ")");
        return b.join(",")
    }
    function kr(a) {
        var b = a.D()
          , c = (0,
        lr[b])(a);
        b = b.toUpperCase();
        if (a instanceof tf) {
            a = a.ha;
            var d = "";
            if ("XYZ" === a || "XYZM" === a)
                d += "Z";
            if ("XYM" === a || "XYZM" === a)
                d += "M";
            a = d;
            0 < a.length && (b += " " + a)
        }
        return 0 === c.length ? b + " EMPTY" : b + "(" + c + ")"
    }
    var lr = {
        Point: hr,
        LineString: ir,
        Polygon: jr,
        MultiPoint: function(a) {
            var b = [];
            a = a.We();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push("(" + hr(a[c]) + ")");
            return b.join(",")
        },
        MultiLineString: function(a) {
            var b = [];
            a = a.Sh();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push("(" + ir(a[c]) + ")");
            return b.join(",")
        },
        MultiPolygon: function(a) {
            var b = [];
            a = a.Jj();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push("(" + jr(a[c]) + ")");
            return b.join(",")
        },
        GeometryCollection: function(a) {
            var b = [];
            a = a.Rh();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push(kr(a[c]));
            return b.join(",")
        }
    };
    h = gr.prototype;
    h.vk = function(a, b) {
        return (a = this.yi(a, b)) ? (b = new Wk,
        b.Ab(a),
        b) : null
    }
    ;
    h.Xp = function(a, b) {
        a = this.yi(a, b);
        a = this.gB && "GeometryCollection" == a.D() ? a.Ja : [a];
        for (var c = [], d = 0, e = a.length; d < e; ++d)
            b = new Wk,
            b.Ab(a[d]),
            c.push(b);
        return c
    }
    ;
    h.yi = function(a, b) {
        return (a = (new mr(new nr(a))).parse()) ? wl(a, !1, b) : null
    }
    ;
    h.$k = function(a, b) {
        return (a = a.I()) ? this.Ti(a, b) : ""
    }
    ;
    h.dr = function(a, b) {
        if (1 == a.length)
            return this.$k(a[0], b);
        for (var c = [], d = 0, e = a.length; d < e; ++d)
            c.push(a[d].I());
        a = new hm(c);
        return this.Ti(a, b)
    }
    ;
    h.Ti = function(a, b) {
        return kr(wl(a, !0, b))
    }
    ;
    function nr(a) {
        this.Ri = a;
        this.Uf = -1
    }
    function or(a) {
        var b = a.Ri.charAt(++a.Uf)
          , c = {
            position: a.Uf,
            value: b
        };
        if ("(" == b)
            c.type = 2;
        else if ("," == b)
            c.type = 5;
        else if (")" == b)
            c.type = 3;
        else if ("0" <= b && "9" >= b || "." == b || "-" == b) {
            c.type = 4;
            b = a.Uf;
            var d = !1
              , e = !1;
            do {
                if ("." == f)
                    d = !0;
                else if ("e" == f || "E" == f)
                    e = !0;
                var f = a.Ri.charAt(++a.Uf)
            } while ("0" <= f && "9" >= f || "." == f && (void 0 === d || !d) || !e && ("e" == f || "E" == f) || e && ("-" == f || "+" == f));a = parseFloat(a.Ri.substring(b, a.Uf--));
            c.value = a
        } else if ("a" <= b && "z" >= b || "A" <= b && "Z" >= b) {
            c.type = 1;
            b = a.Uf;
            do
                f = a.Ri.charAt(++a.Uf);
            while ("a" <= f && "z" >= f || "A" <= f && "Z" >= f);a = a.Ri.substring(b, a.Uf--).toUpperCase();
            c.value = a
        } else {
            if (" " == b || "\t" == b || "\r" == b || "\n" == b)
                return or(a);
            if ("" === b)
                c.type = 6;
            else
                throw Error("Unexpected character: " + b);
        }
        return c
    }
    function mr(a) {
        this.lt = a;
        this.Dp = "XY"
    }
    function pr(a) {
        a.Fe = or(a.lt)
    }
    h = mr.prototype;
    h.match = function(a) {
        (a = this.Fe.type == a) && pr(this);
        return a
    }
    ;
    h.parse = function() {
        pr(this);
        return qr(this)
    }
    ;
    function qr(a) {
        var b = a.Fe;
        if (a.match(1)) {
            b = b.value;
            var c = "XY"
              , d = a.Fe;
            1 == a.Fe.type && (d = d.value,
            "Z" === d ? c = "XYZ" : "M" === d ? c = "XYM" : "ZM" === d && (c = "XYZM"),
            "XY" !== c && pr(a));
            a.Dp = c;
            if ("GEOMETRYCOLLECTION" == b) {
                a: {
                    if (a.match(2)) {
                        b = [];
                        do
                            b.push(qr(a));
                        while (a.match(5));if (a.match(3)) {
                            a = b;
                            break a
                        }
                    } else if (rr(a)) {
                        a = [];
                        break a
                    }
                    throw Error(sr(a));
                }
                return new hm(a)
            }
            d = tr[b];
            c = ur[b];
            if (!d || !c)
                throw Error("Invalid geometry type: " + b);
            b = d.call(a);
            return new c(b,a.Dp)
        }
        throw Error(sr(a));
    }
    h.Kp = function() {
        if (this.match(2)) {
            var a = vr(this);
            if (this.match(3))
                return a
        } else if (rr(this))
            return null;
        throw Error(sr(this));
    }
    ;
    h.Jp = function() {
        if (this.match(2)) {
            var a = wr(this);
            if (this.match(3))
                return a
        } else if (rr(this))
            return [];
        throw Error(sr(this));
    }
    ;
    h.Lp = function() {
        if (this.match(2)) {
            var a = xr(this);
            if (this.match(3))
                return a
        } else if (rr(this))
            return [];
        throw Error(sr(this));
    }
    ;
    h.Hz = function() {
        if (this.match(2)) {
            var a;
            if (2 == this.Fe.type)
                for (a = [this.Kp()]; this.match(5); )
                    a.push(this.Kp());
            else
                a = wr(this);
            if (this.match(3))
                return a
        } else if (rr(this))
            return [];
        throw Error(sr(this));
    }
    ;
    h.Gz = function() {
        if (this.match(2)) {
            var a = xr(this);
            if (this.match(3))
                return a
        } else if (rr(this))
            return [];
        throw Error(sr(this));
    }
    ;
    h.Iz = function() {
        if (this.match(2)) {
            for (var a = [this.Lp()]; this.match(5); )
                a.push(this.Lp());
            if (this.match(3))
                return a
        } else if (rr(this))
            return [];
        throw Error(sr(this));
    }
    ;
    function vr(a) {
        for (var b = [], c = a.Dp.length, d = 0; d < c; ++d) {
            var e = a.Fe;
            if (a.match(4))
                b.push(e.value);
            else
                break
        }
        if (b.length == c)
            return b;
        throw Error(sr(a));
    }
    function wr(a) {
        for (var b = [vr(a)]; a.match(5); )
            b.push(vr(a));
        return b
    }
    function xr(a) {
        for (var b = [a.Jp()]; a.match(5); )
            b.push(a.Jp());
        return b
    }
    function rr(a) {
        var b = 1 == a.Fe.type && "EMPTY" == a.Fe.value;
        b && pr(a);
        return b
    }
    function sr(a) {
        return "Unexpected `" + a.Fe.value + "` at position " + a.Fe.position + " in `" + a.lt.Ri + "`"
    }
    var ur = {
        POINT: D,
        LINESTRING: N,
        POLYGON: F,
        MULTIPOINT: Q,
        MULTILINESTRING: P,
        MULTIPOLYGON: R
    }
      , tr = {
        POINT: mr.prototype.Kp,
        LINESTRING: mr.prototype.Jp,
        POLYGON: mr.prototype.Lp,
        MULTIPOINT: mr.prototype.Hz,
        MULTILINESTRING: mr.prototype.Gz,
        MULTIPOLYGON: mr.prototype.Iz
    };
    function yr() {
        this.version = void 0
    }
    v(yr, iq);
    yr.prototype.Ym = function(a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.eh(a);
        return null
    }
    ;
    yr.prototype.eh = function(a) {
        this.version = a.getAttribute("version").trim();
        return (a = M({
            version: this.version
        }, zr, a, [])) ? a : null
    }
    ;
    function Ar(a, b) {
        return M({}, Br, a, b)
    }
    function Cr(a, b) {
        return M({}, Dr, a, b)
    }
    function Er(a, b) {
        if (b = Ar(a, b))
            return a = [Bm(a.getAttribute("width")), Bm(a.getAttribute("height"))],
            b.size = a,
            b
    }
    function Fr(a, b) {
        return M([], Gr, a, b)
    }
    var Hr = [null, "http://www.opengis.net/wms"]
      , zr = L(Hr, {
        Service: J(function(a, b) {
            return M({}, Ir, a, b)
        }),
        Capability: J(function(a, b) {
            return M({}, Jr, a, b)
        })
    })
      , Jr = L(Hr, {
        Request: J(function(a, b) {
            return M({}, Kr, a, b)
        }),
        Exception: J(function(a, b) {
            return M([], Lr, a, b)
        }),
        Layer: J(function(a, b) {
            return M({}, Mr, a, b)
        })
    })
      , Ir = L(Hr, {
        Name: J(S),
        Title: J(S),
        Abstract: J(S),
        KeywordList: J(Fr),
        OnlineResource: J(hq),
        ContactInformation: J(function(a, b) {
            return M({}, Nr, a, b)
        }),
        Fees: J(S),
        AccessConstraints: J(S),
        LayerLimit: J(Am),
        MaxWidth: J(Am),
        MaxHeight: J(Am)
    })
      , Nr = L(Hr, {
        ContactPersonPrimary: J(function(a, b) {
            return M({}, Or, a, b)
        }),
        ContactPosition: J(S),
        ContactAddress: J(function(a, b) {
            return M({}, Pr, a, b)
        }),
        ContactVoiceTelephone: J(S),
        ContactFacsimileTelephone: J(S),
        ContactElectronicMailAddress: J(S)
    })
      , Or = L(Hr, {
        ContactPerson: J(S),
        ContactOrganization: J(S)
    })
      , Pr = L(Hr, {
        AddressType: J(S),
        Address: J(S),
        City: J(S),
        StateOrProvince: J(S),
        PostCode: J(S),
        Country: J(S)
    })
      , Lr = L(Hr, {
        Format: fl(S)
    })
      , Mr = L(Hr, {
        Name: J(S),
        Title: J(S),
        Abstract: J(S),
        KeywordList: J(Fr),
        CRS: hl(S),
        EX_GeographicBoundingBox: J(function(a, b) {
            var c = M({}, Qr, a, b);
            if (c) {
                a = c.westBoundLongitude;
                b = c.southBoundLatitude;
                var d = c.eastBoundLongitude;
                c = c.northBoundLatitude;
                if (void 0 !== a && void 0 !== b && void 0 !== d && void 0 !== c)
                    return [a, b, d, c]
            }
        }),
        BoundingBox: hl(function(a) {
            var b = [zm(a.getAttribute("minx")), zm(a.getAttribute("miny")), zm(a.getAttribute("maxx")), zm(a.getAttribute("maxy"))]
              , c = [zm(a.getAttribute("resx")), zm(a.getAttribute("resy"))];
            return {
                crs: a.getAttribute("CRS"),
                extent: b,
                res: c
            }
        }),
        Dimension: hl(function(a) {
            return {
                name: a.getAttribute("name"),
                units: a.getAttribute("units"),
                unitSymbol: a.getAttribute("unitSymbol"),
                "default": a.getAttribute("default"),
                multipleValues: wm(a.getAttribute("multipleValues")),
                nearestValue: wm(a.getAttribute("nearestValue")),
                current: wm(a.getAttribute("current")),
                values: S(a)
            }
        }),
        Attribution: J(function(a, b) {
            return M({}, Rr, a, b)
        }),
        AuthorityURL: hl(function(a, b) {
            if (b = Ar(a, b))
                return b.name = a.getAttribute("name"),
                b
        }),
        Identifier: hl(S),
        MetadataURL: hl(function(a, b) {
            if (b = Ar(a, b))
                return b.type = a.getAttribute("type"),
                b
        }),
        DataURL: hl(Ar),
        FeatureListURL: hl(Ar),
        Style: hl(function(a, b) {
            return M({}, Sr, a, b)
        }),
        MinScaleDenominator: J(ym),
        MaxScaleDenominator: J(ym),
        Layer: hl(function(a, b) {
            var c = b[b.length - 1]
              , d = M({}, Mr, a, b);
            if (d)
                return b = wm(a.getAttribute("queryable")),
                void 0 === b && (b = c.queryable),
                d.queryable = void 0 !== b ? b : !1,
                b = Bm(a.getAttribute("cascaded")),
                void 0 === b && (b = c.cascaded),
                d.cascaded = b,
                b = wm(a.getAttribute("opaque")),
                void 0 === b && (b = c.opaque),
                d.opaque = void 0 !== b ? b : !1,
                b = wm(a.getAttribute("noSubsets")),
                void 0 === b && (b = c.noSubsets),
                d.noSubsets = void 0 !== b ? b : !1,
                (b = zm(a.getAttribute("fixedWidth"))) || (b = c.fixedWidth),
                d.fixedWidth = b,
                (a = zm(a.getAttribute("fixedHeight"))) || (a = c.fixedHeight),
                d.fixedHeight = a,
                ["Style", "CRS", "AuthorityURL"].forEach(function(a) {
                    a in c && (d[a] = (d[a] || []).concat(c[a]))
                }),
                "EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator".split(" ").forEach(function(a) {
                    a in d || (d[a] = c[a])
                }),
                d
        })
    })
      , Rr = L(Hr, {
        Title: J(S),
        OnlineResource: J(hq),
        LogoURL: J(Er)
    })
      , Qr = L(Hr, {
        westBoundLongitude: J(ym),
        eastBoundLongitude: J(ym),
        southBoundLatitude: J(ym),
        northBoundLatitude: J(ym)
    })
      , Kr = L(Hr, {
        GetCapabilities: J(Cr),
        GetMap: J(Cr),
        GetFeatureInfo: J(Cr)
    })
      , Dr = L(Hr, {
        Format: hl(S),
        DCPType: hl(function(a, b) {
            return M({}, Tr, a, b)
        })
    })
      , Tr = L(Hr, {
        HTTP: J(function(a, b) {
            return M({}, Ur, a, b)
        })
    })
      , Ur = L(Hr, {
        Get: J(Ar),
        Post: J(Ar)
    })
      , Sr = L(Hr, {
        Name: J(S),
        Title: J(S),
        Abstract: J(S),
        LegendURL: hl(Er),
        StyleSheetURL: J(Ar),
        StyleURL: J(Ar)
    })
      , Br = L(Hr, {
        Format: J(S),
        OnlineResource: J(hq)
    })
      , Gr = L(Hr, {
        Keyword: fl(S)
    });
    function Vr(a) {
        a = a ? a : {};
        this.Lh = "http://mapserver.gis.umn.edu/mapserver";
        this.Kd = new Pm;
        this.Wf = a.layers ? a.layers : null;
        qm.call(this)
    }
    v(Vr, qm);
    Vr.prototype.eg = function(a, b) {
        var c = {};
        b && yb(c, ul(this, a, b));
        c = [c];
        a.setAttribute("namespaceURI", this.Lh);
        var d = a.localName;
        b = [];
        if (0 !== a.childNodes.length) {
            if ("msGMLOutput" == d)
                for (var e = 0, f = a.childNodes.length; e < f; e++) {
                    var g = a.childNodes[e];
                    if (g.nodeType === Node.ELEMENT_NODE) {
                        var k = c[0]
                          , l = g.localName.replace("_layer", "");
                        if (!this.Wf || ra(this.Wf, l)) {
                            l += "_feature";
                            k.featureType = l;
                            k.featureNS = this.Lh;
                            var m = {};
                            m[l] = fl(this.Kd.Up, this.Kd);
                            k = L([k.featureNS, null], m);
                            g.setAttribute("namespaceURI", this.Lh);
                            (g = M([], k, g, c, this.Kd)) && ta(b, g)
                        }
                    }
                }
            "FeatureCollection" == d && (a = M([], this.Kd.sg, a, [{}], this.Kd)) && (b = a)
        }
        return b
    }
    ;
    Vr.prototype.cr = function() {}
    ;
    Vr.prototype.Ke = function() {}
    ;
    Vr.prototype.bl = function() {}
    ;
    function Wr() {
        this.Fz = new jq
    }
    v(Wr, iq);
    Wr.prototype.Ym = function(a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.eh(a);
        return null
    }
    ;
    Wr.prototype.eh = function(a) {
        var b = a.getAttribute("version").trim()
          , c = this.Fz.eh(a);
        if (!c)
            return null;
        c.version = b;
        return (c = M(c, Xr, a, [])) ? c : null
    }
    ;
    function Yr(a) {
        var b = S(a).split(" ");
        if (b && 2 == b.length && (a = +b[0],
        b = +b[1],
        !isNaN(a) && !isNaN(b)))
            return [a, b]
    }
    var Zr = [null, "http://www.opengis.net/wmts/1.0"]
      , $r = [null, "http://www.opengis.net/ows/1.1"]
      , Xr = L(Zr, {
        Contents: J(function(a, b) {
            return M({}, as, a, b)
        })
    })
      , as = L(Zr, {
        Layer: hl(function(a, b) {
            return M({}, bs, a, b)
        }),
        TileMatrixSet: hl(function(a, b) {
            return M({}, cs, a, b)
        })
    })
      , bs = L(Zr, {
        Style: hl(function(a, b) {
            if (b = M({}, ds, a, b))
                return a = "true" === a.getAttribute("isDefault"),
                b.isDefault = a,
                b
        }),
        Format: hl(S),
        TileMatrixSetLink: hl(function(a, b) {
            return M({}, es, a, b)
        }),
        Dimension: hl(function(a, b) {
            return M({}, fs, a, b)
        }),
        ResourceURL: hl(function(a) {
            var b = a.getAttribute("format")
              , c = a.getAttribute("template");
            a = a.getAttribute("resourceType");
            var d = {};
            b && (d.format = b);
            c && (d.template = c);
            a && (d.resourceType = a);
            return d
        })
    }, L($r, {
        Title: J(S),
        Abstract: J(S),
        WGS84BoundingBox: J(function(a, b) {
            a = M([], gs, a, b);
            if (2 == a.length)
                return Ta(a)
        }),
        Identifier: J(S)
    }))
      , ds = L(Zr, {
        LegendURL: hl(function(a) {
            var b = {};
            b.format = a.getAttribute("format");
            b.href = hq(a);
            return b
        })
    }, L($r, {
        Title: J(S),
        Identifier: J(S)
    }))
      , es = L(Zr, {
        TileMatrixSet: J(S),
        TileMatrixSetLimits: J(function(a, b) {
            return M([], hs, a, b)
        })
    })
      , hs = L(Zr, {
        TileMatrixLimits: fl(function(a, b) {
            return M({}, is, a, b)
        })
    })
      , is = L(Zr, {
        TileMatrix: J(S),
        MinTileRow: J(Am),
        MaxTileRow: J(Am),
        MinTileCol: J(Am),
        MaxTileCol: J(Am)
    })
      , fs = L(Zr, {
        Default: J(S),
        Value: hl(S)
    }, L($r, {
        Identifier: J(S)
    }))
      , gs = L($r, {
        LowerCorner: fl(Yr),
        UpperCorner: fl(Yr)
    })
      , cs = L(Zr, {
        WellKnownScaleSet: J(S),
        TileMatrix: hl(function(a, b) {
            return M({}, js, a, b)
        })
    }, L($r, {
        SupportedCRS: J(S),
        Identifier: J(S)
    }))
      , js = L(Zr, {
        TopLeftCorner: J(Yr),
        ScaleDenominator: J(ym),
        TileWidth: J(Am),
        TileHeight: J(Am),
        MatrixWidth: J(Am),
        MatrixHeight: J(Am)
    }, L($r, {
        Identifier: J(S)
    }));
    function ks(a) {
        $c.call(this);
        a = a || {};
        this.cg = null;
        this.qb = pc;
        this.fB = new Cb(6378137);
        this.Zk = void 0;
        y(this, bd("projection"), this.kp, this);
        y(this, bd("tracking"), this.np, this);
        void 0 !== a.projection && this.lf(a.projection);
        void 0 !== a.trackingOptions && this.Eu(a.trackingOptions);
        this.hg(void 0 !== a.tracking ? a.tracking : !1)
    }
    v(ks, $c);
    h = ks.prototype;
    h.la = function() {
        this.hg(!1);
        $c.prototype.la.call(this)
    }
    ;
    h.kp = function() {
        var a = this.M();
        a && (this.qb = fc(ec("EPSG:4326"), a),
        this.cg && this.set("position", this.qb(this.cg)))
    }
    ;
    h.np = function() {
        if (ae) {
            var a = this.Rj();
            a && void 0 === this.Zk ? this.Zk = navigator.geolocation.watchPosition(this.Rz.bind(this), this.Sz.bind(this), this.Qs()) : a || void 0 === this.Zk || (navigator.geolocation.clearWatch(this.Zk),
            this.Zk = void 0)
        }
    }
    ;
    h.Rz = function(a) {
        a = a.coords;
        this.set("accuracy", a.accuracy);
        this.set("altitude", null === a.altitude ? void 0 : a.altitude);
        this.set("altitudeAccuracy", null === a.altitudeAccuracy ? void 0 : a.altitudeAccuracy);
        this.set("heading", null === a.heading ? void 0 : Na(a.heading));
        this.cg ? (this.cg[0] = a.longitude,
        this.cg[1] = a.latitude) : this.cg = [a.longitude, a.latitude];
        var b = this.qb(this.cg);
        this.set("position", b);
        this.set("speed", null === a.speed ? void 0 : a.speed);
        a = $f(this.fB, this.cg, a.accuracy);
        a.xg(this.qb);
        this.set("accuracyGeometry", a);
        this.a()
    }
    ;
    h.Sz = function(a) {
        a.type = "error";
        this.hg(!1);
        this.dispatchEvent(a)
    }
    ;
    h.Sw = function() {
        return this.get("accuracy")
    }
    ;
    h.Tw = function() {
        return this.get("accuracyGeometry") || null
    }
    ;
    h.Vw = function() {
        return this.get("altitude")
    }
    ;
    h.Ww = function() {
        return this.get("altitudeAccuracy")
    }
    ;
    h.Yo = function() {
        return this.get("heading")
    }
    ;
    h.Ul = function() {
        return this.get("position")
    }
    ;
    h.M = function() {
        return this.get("projection")
    }
    ;
    h.Gx = function() {
        return this.get("speed")
    }
    ;
    h.Rj = function() {
        return this.get("tracking")
    }
    ;
    h.Qs = function() {
        return this.get("trackingOptions")
    }
    ;
    h.lf = function(a) {
        this.set("projection", ec(a))
    }
    ;
    h.hg = function(a) {
        this.set("tracking", a)
    }
    ;
    h.Eu = function(a) {
        this.set("trackingOptions", a)
    }
    ;
    function ls(a, b, c) {
        tf.call(this);
        this.sq(a, b ? b : 0, c)
    }
    v(ls, tf);
    h = ls.prototype;
    h.clone = function() {
        var a = new ls(null);
        a.K(this.ha, this.b.slice());
        return a
    }
    ;
    h.Ed = function(a, b, c, d) {
        var e = this.b;
        a -= e[0];
        var f = b - e[1];
        b = a * a + f * f;
        if (b < d) {
            0 === b ? d = 0 : (d = this.wc() / Math.sqrt(b),
            c[0] = e[0] + d * a,
            c[1] = e[1] + d * f,
            d = 2);
            for (; d < this.C; ++d)
                c[d] = e[d];
            c.length = this.C;
            return b
        }
        return d
    }
    ;
    h.de = function(a, b) {
        var c = this.b;
        a -= c[0];
        b -= c[1];
        return a * a + b * b <= ms(this)
    }
    ;
    h.Fa = function() {
        return this.b.slice(0, this.C)
    }
    ;
    h.Bl = function(a) {
        var b = this.b
          , c = b[this.C] - b[0];
        return cb(b[0] - c, b[1] - c, b[0] + c, b[1] + c, a)
    }
    ;
    h.wc = function() {
        return Math.sqrt(ms(this))
    }
    ;
    function ms(a) {
        var b = a.b[a.C] - a.b[0];
        a = a.b[a.C + 1] - a.b[1];
        return b * b + a * a
    }
    h.D = function() {
        return "Circle"
    }
    ;
    h.Kb = function(a) {
        var b = this.c();
        return vb(a, b) ? (b = this.Fa(),
        a[0] <= b[0] && a[2] >= b[0] || a[1] <= b[1] && a[3] >= b[1] ? !0 : jb(a, this.Xc, this)) : !1
    }
    ;
    h.Jc = function(a) {
        var b = this.C
          , c = a.slice();
        c[b] = c[0] + (this.b[b] - this.b[0]);
        var d;
        for (d = 1; d < b; ++d)
            c[b + d] = a[d];
        this.K(this.ha, c)
    }
    ;
    h.sq = function(a, b, c) {
        if (a) {
            wf(this, c, a, 0);
            this.b || (this.b = []);
            c = this.b;
            a = Ef(c, a);
            c[a++] = c[0] + b;
            var d;
            b = 1;
            for (d = this.C; b < d; ++b)
                c[a++] = c[b];
            c.length = a;
            this.a()
        } else
            this.K("XY", null)
    }
    ;
    h.H = function() {}
    ;
    h.pa = function() {}
    ;
    h.K = function(a, b) {
        vf(this, a, b);
        this.a()
    }
    ;
    h.mh = function(a) {
        this.b[this.C] = this.b[0] + a;
        this.a()
    }
    ;
    function ns(a, b, c) {
        for (var d = [], e = a(0), f = a(1), g = b(e), k = b(f), l = [f, e], m = [k, g], n = [1, 0], p = {}, q = 1E5, t, u, x, B, z; 0 < --q && 0 < n.length; )
            x = n.pop(),
            e = l.pop(),
            g = m.pop(),
            f = x.toString(),
            f in p || (d.push(g[0], g[1]),
            p[f] = !0),
            B = n.pop(),
            f = l.pop(),
            k = m.pop(),
            z = (x + B) / 2,
            t = a(z),
            u = b(t),
            La(u[0], u[1], g[0], g[1], k[0], k[1]) < c ? (d.push(k[0], k[1]),
            f = B.toString(),
            p[f] = !0) : (n.push(B, z, z, x),
            m.push(k, u, u, g),
            l.push(f, t, t, e));
        return d
    }
    function os(a, b, c, d, e) {
        var f = ec("EPSG:4326");
        return ns(function(d) {
            return [a, b + (c - b) * d]
        }, oc(f, d), e)
    }
    function ps(a, b, c, d, e) {
        var f = ec("EPSG:4326");
        return ns(function(d) {
            return [b + (c - b) * d, a]
        }, oc(f, d), e)
    }
    ;function qs(a) {
        a = a || {};
        this.Ic = this.ra = null;
        this.hk = this.gk = Infinity;
        this.jk = this.ik = -Infinity;
        this.xt = this.wt = Infinity;
        this.Et = this.Dt = -Infinity;
        this.jB = void 0 !== a.targetSize ? a.targetSize : 100;
        this.bz = void 0 !== a.maxLines ? a.maxLines : 100;
        this.$f = [];
        this.bg = [];
        this.mg = void 0 !== a.strokeStyle ? a.strokeStyle : rs;
        this.Nq = this.Mo = void 0;
        this.xd = this.vd = this.Rp = null;
        1 == a.showLabels && (this.Xy = void 0 == a.lonLabelFormatter ? df.bind(this, "EW") : a.lonLabelFormatter,
        this.Qy = void 0 == a.latLabelFormatter ? df.bind(this, "NS") : a.latLabelFormatter,
        this.Yy = void 0 == a.lonLabelPosition ? 0 : a.lonLabelPosition,
        this.Ry = void 0 == a.latLabelPosition ? 1 : a.latLabelPosition,
        this.qt = void 0 !== a.lonLabelStyle ? a.lonLabelStyle : new Tn({
            font: "12px Calibri,sans-serif",
            textBaseline: "bottom",
            fill: new Pk({
                color: "rgba(0,0,0,1)"
            }),
            stroke: new nj({
                color: "rgba(255,255,255,1)",
                width: 3
            })
        }),
        this.kt = void 0 !== a.latLabelStyle ? a.latLabelStyle : new Tn({
            font: "12px Calibri,sans-serif",
            textAlign: "end",
            fill: new Pk({
                color: "rgba(0,0,0,1)"
            }),
            stroke: new nj({
                color: "rgba(255,255,255,1)",
                width: 3
            })
        }),
        this.vd = [],
        this.xd = []);
        this.setMap(void 0 !== a.map ? a.map : null)
    }
    var rs = new nj({
        color: "rgba(0,0,0,0.2)"
    })
      , ss = [90, 45, 30, 20, 10, 5, 2, 1, .5, .2, .1, .05, .01, .005, .002, .001];
    function ts(a, b, c, d, e, f, g) {
        var k = g;
        c = os(b, c, d, a.Ic, e);
        k = void 0 !== a.$f[k] ? a.$f[k] : new N(null);
        k.K("XY", c);
        vb(k.c(), f) && (a.vd && (c = g,
        d = k.X(),
        f = [d[0], Ia(f[1] + Math.abs(f[1] - f[3]) * a.Yy, Math.max(f[1], d[1]), Math.min(f[3], d[d.length - 1]))],
        c = void 0 !== a.vd[c] ? a.vd[c].xj : new D(null),
        c.pa(f),
        a.vd[g] = {
            xj: c,
            text: a.Xy(b)
        }),
        a.$f[g++] = k);
        return g
    }
    function us(a, b, c, d, e, f, g) {
        var k = g;
        c = ps(b, c, d, a.Ic, e);
        k = void 0 !== a.bg[k] ? a.bg[k] : new N(null);
        k.K("XY", c);
        vb(k.c(), f) && (a.xd && (c = g,
        d = k.X(),
        f = [Ia(f[0] + Math.abs(f[0] - f[2]) * a.Ry, Math.max(f[0], d[0]), Math.min(f[2], d[d.length - 2])), d[1]],
        c = void 0 !== a.xd[c] ? a.xd[c].xj : new D(null),
        c.pa(f),
        a.xd[g] = {
            xj: c,
            text: a.Qy(b)
        }),
        a.bg[g++] = k);
        return g
    }
    h = qs.prototype;
    h.B = function() {
        return this.ra
    }
    ;
    h.vx = function() {
        return this.$f
    }
    ;
    h.Cx = function() {
        return this.bg
    }
    ;
    h.Vs = function(a) {
        var b = a.vectorContext
          , c = a.frameState;
        a = c.extent;
        var d = c.viewState
          , e = d.center
          , f = d.projection;
        d = d.resolution;
        c = c.pixelRatio;
        c = d * d / (4 * c * c);
        if (!this.Ic || !nc(this.Ic, f)) {
            var g = ec("EPSG:4326")
              , k = f.c()
              , l = f.Yq
              , m = rc(l, g, f)
              , n = l[2]
              , p = l[1]
              , q = l[0]
              , t = m[3]
              , u = m[2]
              , x = m[1];
            m = m[0];
            this.gk = l[3];
            this.hk = n;
            this.ik = p;
            this.jk = q;
            this.wt = t;
            this.xt = u;
            this.Dt = x;
            this.Et = m;
            this.Mo = oc(g, f);
            this.Nq = oc(f, g);
            this.Rp = this.Nq(sb(k));
            this.Ic = f
        }
        f = this.Rp[0];
        g = this.Rp[1];
        k = -1;
        n = Math.pow(this.jB * d, 2);
        p = [];
        q = [];
        d = 0;
        for (l = ss.length; d < l; ++d) {
            t = ss[d] / 2;
            p[0] = f - t;
            p[1] = g - t;
            q[0] = f + t;
            q[1] = g + t;
            this.Mo(p, p);
            this.Mo(q, q);
            t = Math.pow(q[0] - p[0], 2) + Math.pow(q[1] - p[1], 2);
            if (t <= n)
                break;
            k = ss[d]
        }
        d = k;
        if (-1 == d)
            this.$f.length = this.bg.length = 0,
            this.vd && (this.vd.length = 0),
            this.xd && (this.xd.length = 0);
        else {
            f = this.Nq(e);
            e = f[0];
            f = f[1];
            g = this.bz;
            l = [Math.max(a[0], this.Et), Math.max(a[1], this.Dt), Math.min(a[2], this.xt), Math.min(a[3], this.wt)];
            l = rc(l, this.Ic, "EPSG:4326");
            p = l[3];
            k = l[2];
            q = l[1];
            t = l[0];
            e = Math.floor(e / d) * d;
            u = Ia(e, this.jk, this.hk);
            n = ts(this, u, q, p, c, a, 0);
            for (l = 0; u != this.jk && l++ < g; )
                u = Math.max(u - d, this.jk),
                n = ts(this, u, q, p, c, a, n);
            u = Ia(e, this.jk, this.hk);
            for (l = 0; u != this.hk && l++ < g; )
                u = Math.min(u + d, this.hk),
                n = ts(this, u, q, p, c, a, n);
            this.$f.length = n;
            this.vd && (this.vd.length = n);
            f = Math.floor(f / d) * d;
            e = Ia(f, this.ik, this.gk);
            n = us(this, e, t, k, c, a, 0);
            for (l = 0; e != this.ik && l++ < g; )
                e = Math.max(e - d, this.ik),
                n = us(this, e, t, k, c, a, n);
            e = Ia(f, this.ik, this.gk);
            for (l = 0; e != this.gk && l++ < g; )
                e = Math.min(e + d, this.gk),
                n = us(this, e, t, k, c, a, n);
            this.bg.length = n;
            this.xd && (this.xd.length = n)
        }
        b.kb(null, this.mg);
        a = 0;
        for (c = this.$f.length; a < c; ++a)
            e = this.$f[a],
            b.ld(e);
        a = 0;
        for (c = this.bg.length; a < c; ++a)
            e = this.bg[a],
            b.ld(e);
        if (this.vd)
            for (a = 0,
            c = this.vd.length; a < c; ++a)
                e = this.vd[a],
                this.qt.Bi(e.text),
                b.bc(this.qt),
                b.ld(e.xj);
        if (this.xd)
            for (a = 0,
            c = this.xd.length; a < c; ++a)
                e = this.xd[a],
                this.kt.Bi(e.text),
                b.bc(this.kt),
                b.ld(e.xj)
    }
    ;
    h.setMap = function(a) {
        this.ra && (this.ra.j("postcompose", this.Vs, this),
        this.ra.render());
        a && (a.g("postcompose", this.Vs, this),
        a.render());
        this.ra = a
    }
    ;
    function vs(a, b, c, d, e) {
        Yc.call(this);
        this.Nb = e;
        this.extent = a;
        this.Wa = c;
        this.resolution = b;
        this.state = d
    }
    v(vs, Yc);
    h = vs.prototype;
    h.a = function() {
        this.dispatchEvent("change")
    }
    ;
    h.Ea = function() {
        return this.Nb
    }
    ;
    h.c = function() {
        return this.extent
    }
    ;
    h.O = function() {
        return this.resolution
    }
    ;
    h.getState = function() {
        return this.state
    }
    ;
    function ws(a, b, c, d, e, f, g) {
        vs.call(this, a, b, c, 0, d);
        this.gd = e;
        this.s = new Image;
        null !== f && (this.s.crossOrigin = f);
        this.nm = {};
        this.Vg = null;
        this.state = 0;
        this.Wc = g
    }
    v(ws, vs);
    h = ws.prototype;
    h.N = function(a) {
        if (void 0 !== a) {
            var b = w(a);
            if (b in this.nm)
                return this.nm[b];
            a = Bb(this.nm) ? this.s : this.s.cloneNode(!1);
            return this.nm[b] = a
        }
        return this.s
    }
    ;
    h.ci = function() {
        this.state = 3;
        Rn(this);
        this.a()
    }
    ;
    h.Tj = function() {
        void 0 === this.resolution && (this.resolution = rb(this.extent) / this.s.height);
        this.state = 2;
        Rn(this);
        this.a()
    }
    ;
    h.load = function() {
        if (0 == this.state || 3 == this.state)
            this.state = 1,
            this.a(),
            this.Vg = [Rc(this.s, "error", this.ci, this), Rc(this.s, "load", this.Tj, this)],
            this.Wc(this, this.gd)
    }
    ;
    h.xq = function(a) {
        this.s = a
    }
    ;
    function xs(a, b, c, d, e, f) {
        this.Xf = void 0 !== f ? f : null;
        vs.call(this, a, b, c, void 0 !== f ? 0 : 2, d);
        this.J = e;
        this.js = null
    }
    v(xs, vs);
    xs.prototype.getError = function() {
        return this.js
    }
    ;
    xs.prototype.fm = function(a) {
        a ? (this.js = a,
        this.state = 3) : this.state = 2;
        this.a()
    }
    ;
    xs.prototype.load = function() {
        0 == this.state && (this.state = 1,
        this.a(),
        this.Xf(this.fm.bind(this)))
    }
    ;
    xs.prototype.N = function() {
        return this.J
    }
    ;
    function ys(a, b) {
        Yc.call(this);
        this.ta = a;
        this.state = b;
        this.Tb = null;
        this.key = ""
    }
    v(ys, Yc);
    h = ys.prototype;
    h.a = function() {
        this.dispatchEvent("change")
    }
    ;
    h.getKey = function() {
        return this.key + "/" + this.ta
    }
    ;
    function zs(a) {
        if (!a.Tb)
            return a;
        var b = a.Tb;
        do {
            if (2 == b.getState())
                return b;
            b = b.Tb
        } while (b);return a
    }
    function As(a) {
        if (a.Tb) {
            var b = a.Tb;
            do {
                if (2 == b.getState()) {
                    b.Tb = null;
                    break
                } else
                    1 == b.getState() ? a = b : 0 == b.getState() ? a.Tb = b.Tb : a = b;
                b = a.Tb
            } while (b)
        }
    }
    h.Nj = function() {
        return this.ta
    }
    ;
    h.getState = function() {
        return this.state
    }
    ;
    h.Fb = function(a) {
        this.state = a;
        this.a()
    }
    ;
    function Bs(a, b, c, d, e) {
        ys.call(this, a, b);
        this.gd = c;
        this.s = new Image;
        null !== d && (this.s.crossOrigin = d);
        this.Vg = null;
        this.Kq = e
    }
    v(Bs, ys);
    h = Bs.prototype;
    h.la = function() {
        1 == this.state && (Rn(this),
        this.s.src = Cs.toDataURL("image/png"));
        this.Tb && Vc(this.Tb);
        this.state = 5;
        this.a();
        ys.prototype.la.call(this)
    }
    ;
    h.N = function() {
        return this.s
    }
    ;
    h.getKey = function() {
        return this.gd
    }
    ;
    h.ci = function() {
        this.state = 3;
        Rn(this);
        this.s = Cs;
        this.a()
    }
    ;
    h.Tj = function() {
        this.state = this.s.naturalWidth && this.s.naturalHeight ? 2 : 4;
        Rn(this);
        this.a()
    }
    ;
    h.load = function() {
        if (0 == this.state || 3 == this.state)
            this.state = 1,
            this.a(),
            this.Vg = [Rc(this.s, "error", this.ci, this), Rc(this.s, "load", this.Tj, this)],
            this.Kq(this, this.gd)
    }
    ;
    var Cs, Ds = pd(1, 1);
    Ds.fillStyle = "rgba(0,0,0,0)";
    Ds.fillRect(0, 0, 1, 1);
    Cs = Ds.canvas;
    function Es(a) {
        a = a ? a : {};
        og.call(this, {
            handleEvent: of
        });
        this.Nw = a.formatConstructors ? a.formatConstructors : [];
        this.Ic = a.projection ? ec(a.projection) : null;
        this.Ll = null;
        this.da = a.source || null;
        this.target = a.target ? a.target : null
    }
    v(Es, og);
    function Fs(a) {
        a = a.dataTransfer.files;
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c) {
            var d = a.item(c);
            var e = new FileReader;
            e.addEventListener("load", this.ty.bind(this, d));
            e.readAsText(d)
        }
    }
    function Gs(a) {
        a.stopPropagation();
        a.preventDefault();
        a.dataTransfer.dropEffect = "copy"
    }
    Es.prototype.ty = function(a, b) {
        b = b.target.result;
        var c = this.B()
          , d = this.Ic;
        d || (d = c.R().M());
        c = this.Nw;
        var e = [], f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var k = new c[g];
            var l = {
                featureProjection: d
            };
            try {
                e = k.pb(b, l)
            } catch (m) {
                e = null
            }
            if (e && 0 < e.length)
                break
        }
        this.da && (this.da.clear(),
        this.da.vg(e));
        this.dispatchEvent(new Hs(Is,a,e,d))
    }
    ;
    function Js(a) {
        var b = a.B();
        b && (b = a.target ? a.target : b.Sa,
        a.Ll = [y(b, "drop", Fs, a), y(b, "dragenter", Gs, a), y(b, "dragover", Gs, a), y(b, "drop", Gs, a)])
    }
    Es.prototype.setActive = function(a) {
        og.prototype.setActive.call(this, a);
        a ? Js(this) : Ks(this)
    }
    ;
    Es.prototype.setMap = function(a) {
        Ks(this);
        og.prototype.setMap.call(this, a);
        this.Va() && Js(this)
    }
    ;
    function Ks(a) {
        a.Ll && (a.Ll.forEach(Mc),
        a.Ll = null)
    }
    var Is = "addfeatures";
    function Hs(a, b, c, d) {
        Wc.call(this, a);
        this.features = c;
        this.file = b;
        this.projection = d
    }
    v(Hs, Wc);
    function Ls(a) {
        a = a ? a : {};
        Dg.call(this, {
            handleDownEvent: Ms,
            handleDragEvent: Ns,
            handleUpEvent: Os
        });
        this.Pb = a.condition ? a.condition : yg;
        this.ii = this.zc = void 0;
        this.Xg = 0;
        this.Ha = void 0 !== a.duration ? a.duration : 400
    }
    v(Ls, Dg);
    function Ns(a) {
        if (Bg(a)) {
            var b = a.map
              , c = b.Ga()
              , d = a.pixel;
            a = d[0] - c[0] / 2;
            d = c[1] / 2 - d[1];
            c = Math.atan2(d, a);
            a = Math.sqrt(a * a + d * d);
            b = b.R();
            b.getConstraints().rotation !== We && void 0 !== this.zc && (d = c - this.zc,
            og.rotateWithoutConstraints(b, b.ma() - d));
            this.zc = c;
            void 0 !== this.ii && (c = this.ii * (b.O() / a),
            og.zoomWithoutConstraints(b, c));
            void 0 !== this.ii && (this.Xg = this.ii / a);
            this.ii = a
        }
    }
    function Os(a) {
        if (!Bg(a))
            return !0;
        a = a.map.R();
        fg(a, 1, -1);
        var b = this.Xg - 1;
        pg(a, a.ma());
        var c = a.O()
          , d = this.Ha;
        c = a.constrainResolution(c, 0, b);
        og.zoomWithoutConstraints(a, c, void 0, d);
        this.Xg = 0;
        return !1
    }
    function Ms(a) {
        return Bg(a) && this.Pb(a) ? (fg(a.map.R(), 1, 1),
        this.ii = this.zc = void 0,
        !0) : !1
    }
    ;function Ps(a, b, c, d) {
        this.Wu = a;
        this.Km = b;
        this.overlaps = d;
        this.Zf = 0;
        this.resolution = c;
        this.xl = this.wl = null;
        this.ya = [];
        this.coordinates = [];
        this.qw = {};
        this.nq = Ah();
        this.va = [];
        this.te = null;
        this.Fn = Ah();
        this.ou = Ah()
    }
    v(Ps, Vh);
    function Qs(a, b, c, d, e, f, g) {
        var k = a.coordinates.length
          , l = a.Oo();
        g && (c += e);
        g = [b[c], b[c + 1]];
        var m = [NaN, NaN], n = !0, p;
        for (p = c + e; p < d; p += e) {
            m[0] = b[p];
            m[1] = b[p + 1];
            var q = bb(l, m);
            q !== t ? (n && (a.coordinates[k++] = g[0],
            a.coordinates[k++] = g[1]),
            a.coordinates[k++] = m[0],
            a.coordinates[k++] = m[1],
            n = !1) : 1 === q ? (a.coordinates[k++] = m[0],
            a.coordinates[k++] = m[1],
            n = !1) : n = !0;
            g[0] = m[0];
            g[1] = m[1];
            var t = q
        }
        if (f && n || p === c + e)
            a.coordinates[k++] = g[0],
            a.coordinates[k++] = g[1];
        return k
    }
    function Rs(a, b, c, d, e, f) {
        for (var g = 0, k = d.length; g < k; ++g) {
            var l = d[g];
            c = Qs(a, b, c, l, e, !1, !1);
            f.push(c);
            c = l
        }
        return c
    }
    h = Ps.prototype;
    h.es = function(a, b, c) {
        Ss(this, b);
        var d = a.D(), e = a.oa(), f = this.coordinates.length, g;
        if ("MultiPolygon" == d) {
            d = a.ub();
            var k = [];
            for (var l = a.Ia, m = g = 0, n = l.length; m < n; ++m) {
                var p = [];
                g = Rs(this, d, g, l[m], e, p);
                k.push(p)
            }
            this.ya.push([4, f, k, a, c, Kf])
        } else
            "Polygon" == d || "MultiLineString" == d ? (k = [],
            d = "Polygon" == d ? a.ub() : a.X(),
            Rs(this, d, 0, a.U, e, k),
            this.ya.push([4, f, k, a, c, If])) : "LineString" == d || "MultiPoint" == d ? (d = a.X(),
            e = Qs(this, d, 0, d.length, e, !1, !1),
            this.ya.push([4, f, e, a, c, Hf])) : "Point" == d && (d = a.X(),
            this.coordinates.push(d[0], d[1]),
            e = this.coordinates.length,
            this.ya.push([4, f, e, a, c]));
        Ts(this, b)
    }
    ;
    function Ss(a, b) {
        a.wl = [0, b, 0];
        a.ya.push(a.wl);
        a.xl = [0, b, 0];
        a.va.push(a.xl)
    }
    h.ja = function(a, b) {
        if (this.Ho) {
            var c = Fh(this.nq, this.Ho.slice());
            a.translate(c[0], c[1]);
            a.rotate(b)
        }
        a.fill();
        this.Ho && a.setTransform.apply(a, this.ou)
    }
    ;
    function Us(a, b, c, d, e, f, g, k, l) {
        if (a.te && wa(d, a.nq))
            var m = a.te;
        else
            a.te || (a.te = []),
            m = rf(a.coordinates, 0, a.coordinates.length, 2, d, a.te),
            Eh(a.nq, d);
        d = !Bb(f);
        for (var n = 0, p = g.length, q = 0, t, u = a.Fn, x = a.ou, B, z, E, G, ea = 0, V = 0, O = a.qw, ca = {
            context: b,
            pixelRatio: c,
            resolution: a.resolution,
            rotation: e
        }, va = a.ya != g || a.overlaps ? 0 : 200; n < p; ) {
            var A = g[n];
            switch (A[0]) {
            case 0:
                var Pb = A[1];
                d && f[w(Pb).toString()] || !Pb.I() ? n = A[2] : void 0 === l || vb(l, Pb.I().c()) ? ++n : n = A[2] + 1;
                break;
            case 1:
                ea > va && (a.ja(b, e),
                ea = 0);
                V > va && (b.stroke(),
                V = 0);
                ea || V || (b.beginPath(),
                B = z = NaN);
                ++n;
                break;
            case 2:
                q = A[1];
                t = m[q];
                A = m[q + 1];
                E = m[q + 2] - t;
                q = m[q + 3] - A;
                q = Math.sqrt(E * E + q * q);
                b.moveTo(t + q, A);
                b.arc(t, A, q, 0, 2 * Math.PI, !0);
                ++n;
                break;
            case 3:
                b.closePath();
                ++n;
                break;
            case 4:
                q = A[1];
                t = A[2];
                E = A[4];
                G = 6 == A.length ? A[5] : void 0;
                ca.geometry = A[3];
                ca.feature = Pb;
                n in O || (O[n] = []);
                A = O[n];
                G ? G(m, q, t, 2, A) : (A[0] = m[q],
                A[1] = m[q + 1],
                A.length = 2);
                E(A, ca);
                ++n;
                break;
            case 5:
                q = A[1];
                t = A[2];
                var Jb = A[3];
                var Ca = A[4] * c;
                var Zb = A[5] * c;
                var yc = A[6]
                  , ce = A[7]
                  , de = A[8]
                  , Jf = A[9];
                var zc = A[10];
                E = A[11];
                G = A[12];
                var kh = A[13]
                  , zg = A[14];
                for (zc && (E += e); q < t; q += 2) {
                    A = m[q] - Ca;
                    zc = m[q + 1] - Zb;
                    kh && (A = Math.round(A),
                    zc = Math.round(zc));
                    if (1 != G || 0 !== E) {
                        var jf = A + Ca
                          , lh = zc + Zb;
                        Jh(u, jf, lh, G, G, E, -jf, -lh);
                        b.setTransform.apply(b, u)
                    }
                    jf = b.globalAlpha;
                    1 != ce && (b.globalAlpha = jf * ce);
                    lh = zg + de > Jb.width ? Jb.width - de : zg;
                    var pq = yc + Jf > Jb.height ? Jb.height - Jf : yc;
                    b.drawImage(Jb, de, Jf, lh, pq, A, zc, lh * c, pq * c);
                    1 != ce && (b.globalAlpha = jf);
                    1 == G && 0 === E || b.setTransform.apply(b, x)
                }
                ++n;
                break;
            case 6:
                q = A[1];
                t = A[2];
                Zb = A[3];
                yc = A[4] * c;
                ce = A[5] * c;
                E = A[6];
                G = A[7] * c;
                Jb = A[8];
                Ca = A[9];
                for ((zc = A[10]) && (E += e); q < t; q += 2) {
                    A = m[q] + yc;
                    zc = m[q + 1] + ce;
                    if (1 != G || 0 !== E)
                        Jh(u, A, zc, G, G, E, -A, -zc),
                        b.setTransform.apply(b, u);
                    de = Zb.split("\n");
                    Jf = de.length;
                    1 < Jf ? (kh = Math.round(1.5 * b.measureText("M").width),
                    zc -= (Jf - 1) / 2 * kh) : kh = 0;
                    for (zg = 0; zg < Jf; zg++)
                        jf = de[zg],
                        Ca && b.strokeText(jf, A, zc),
                        Jb && b.fillText(jf, A, zc),
                        zc += kh;
                    1 == G && 0 === E || b.setTransform.apply(b, x)
                }
                ++n;
                break;
            case 7:
                if (void 0 !== k && (Pb = A[1],
                q = k(Pb)))
                    return q;
                ++n;
                break;
            case 8:
                va ? ea++ : a.ja(b, e);
                ++n;
                break;
            case 9:
                q = A[1];
                t = A[2];
                A = m[q];
                zc = m[q + 1];
                E = A + .5 | 0;
                G = zc + .5 | 0;
                if (E !== B || G !== z)
                    b.moveTo(A, zc),
                    B = E,
                    z = G;
                for (q += 2; q < t; q += 2)
                    if (A = m[q],
                    zc = m[q + 1],
                    E = A + .5 | 0,
                    G = zc + .5 | 0,
                    q == t - 2 || E !== B || G !== z)
                        b.lineTo(A, zc),
                        B = E,
                        z = G;
                ++n;
                break;
            case 10:
                a.Ho = A[2];
                ea && (a.ja(b, e),
                ea = 0,
                V && (b.stroke(),
                V = 0));
                b.fillStyle = A[1];
                ++n;
                break;
            case 11:
                q = void 0 !== A[8] ? A[8] : !0;
                var pl = A[9];
                t = A[2];
                V && (b.stroke(),
                V = 0);
                b.strokeStyle = A[1];
                b.lineWidth = q ? t * c : t;
                b.lineCap = A[3];
                b.lineJoin = A[4];
                b.miterLimit = A[5];
                Yd && (t = A[6],
                E = A[7],
                q && c !== pl && (t = t.map(function(a) {
                    return a * c / pl
                }),
                E *= c / pl,
                A[6] = t,
                A[7] = E,
                A[9] = c),
                b.lineDashOffset = E,
                b.setLineDash(t));
                ++n;
                break;
            case 12:
                b.font = A[1];
                b.textAlign = A[2];
                b.textBaseline = A[3];
                ++n;
                break;
            case 13:
                va ? V++ : b.stroke();
                ++n;
                break;
            default:
                ++n
            }
        }
        ea && a.ja(b, e);
        V && b.stroke()
    }
    h.jb = function(a, b, c, d, e) {
        Us(this, a, b, c, d, e, this.ya, void 0, void 0)
    }
    ;
    function Vs(a) {
        var b = a.va;
        b.reverse();
        var c, d = b.length, e = -1;
        for (c = 0; c < d; ++c) {
            var f = b[c];
            var g = f[0];
            if (7 == g)
                e = c;
            else if (0 == g) {
                f[2] = c;
                f = a.va;
                for (g = c; e < g; ) {
                    var k = f[e];
                    f[e] = f[g];
                    f[g] = k;
                    ++e;
                    --g
                }
                e = -1
            }
        }
    }
    function Ts(a, b) {
        a.wl[2] = a.ya.length;
        a.wl = null;
        a.xl[2] = a.va.length;
        a.xl = null;
        b = [7, b];
        a.ya.push(b);
        a.va.push(b)
    }
    h.finish = Ba;
    h.Oo = function() {
        return this.Km
    }
    ;
    function Ws(a, b, c, d) {
        Ps.call(this, a, b, c, d);
        this.s = this.bf = null;
        this.ae = this.fd = this.Ma = this.Za = this.Db = this.oi = this.ni = this.ff = this.di = this.zh = this.yh = void 0
    }
    v(Ws, Ps);
    h = Ws.prototype;
    h.kd = function(a, b, c, d) {
        return Qs(this, a, b, c, d, !1, !1)
    }
    ;
    h.Jf = function(a, b) {
        if (this.s) {
            Ss(this, b);
            var c = a.X()
              , d = this.coordinates.length;
            a = this.kd(c, 0, c.length, a.oa());
            this.ya.push([5, d, a, this.s, this.yh, this.zh, this.di, this.ff, this.ni, this.oi, this.Db, this.Za, this.Ma, this.fd, this.ae]);
            this.va.push([5, d, a, this.bf, this.yh, this.zh, this.di, this.ff, this.ni, this.oi, this.Db, this.Za, this.Ma, this.fd, this.ae]);
            Ts(this, b)
        }
    }
    ;
    h.Hf = function(a, b) {
        if (this.s) {
            Ss(this, b);
            var c = a.X()
              , d = this.coordinates.length;
            a = this.kd(c, 0, c.length, a.oa());
            this.ya.push([5, d, a, this.s, this.yh, this.zh, this.di, this.ff, this.ni, this.oi, this.Db, this.Za, this.Ma, this.fd, this.ae]);
            this.va.push([5, d, a, this.bf, this.yh, this.zh, this.di, this.ff, this.ni, this.oi, this.Db, this.Za, this.Ma, this.fd, this.ae]);
            Ts(this, b)
        }
    }
    ;
    h.finish = function() {
        Vs(this);
        this.zh = this.yh = void 0;
        this.s = this.bf = null;
        this.ae = this.fd = this.Za = this.Db = this.oi = this.ni = this.ff = this.Ma = this.di = void 0
    }
    ;
    h.ye = function(a) {
        var b = a.Hg()
          , c = a.Ga()
          , d = a.Dj(1)
          , e = a.N(1)
          , f = a.ic();
        this.yh = b[0];
        this.zh = b[1];
        this.bf = d;
        this.s = e;
        this.di = c[1];
        this.ff = a.tb();
        this.ni = f[0];
        this.oi = f[1];
        this.Db = a.Db;
        this.Za = a.ma();
        this.Ma = a.Ma;
        this.fd = a.fd;
        this.ae = c[0]
    }
    ;
    function Xs(a, b, c, d) {
        Ps.call(this, a, b, c, d);
        this.Qc = null;
        this.u = {
            lj: void 0,
            fj: void 0,
            gj: null,
            hj: void 0,
            ij: void 0,
            jj: void 0,
            kj: void 0,
            ji: void 0,
            strokeStyle: void 0,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: void 0,
            miterLimit: void 0
        }
    }
    v(Xs, Ps);
    function Ys(a, b, c, d, e) {
        var f = a.coordinates.length;
        b = Qs(a, b, c, d, e, !1, !1);
        f = [9, f, b];
        a.ya.push(f);
        a.va.push(f);
        return d
    }
    h = Xs.prototype;
    h.Oo = function() {
        this.Qc || (this.Qc = Xa(this.Km),
        0 < this.Zf && Wa(this.Qc, this.resolution * (this.Zf + 1) / 2, this.Qc));
        return this.Qc
    }
    ;
    h.ze = function() {
        var a = this.u
          , b = a.strokeStyle
          , c = a.lineCap
          , d = a.lineDash
          , e = a.lineDashOffset
          , f = a.lineJoin
          , g = a.lineWidth
          , k = a.miterLimit;
        a.lj == b && a.fj == c && wa(a.gj, d) && a.hj == e && a.ij == f && a.jj == g && a.kj == k || (void 0 != a.ji && a.ji != this.coordinates.length && (this.ya.push([13]),
        a.ji = this.coordinates.length),
        a.ji = 0,
        this.ya.push([11, b, g, c, f, k, d, e, !0, 1], [1]),
        a.lj = b,
        a.fj = c,
        a.gj = d,
        a.hj = e,
        a.ij = f,
        a.jj = g,
        a.kj = k)
    }
    ;
    h.Ff = function(a, b) {
        var c = this.u
          , d = c.lineWidth;
        void 0 !== c.strokeStyle && void 0 !== d && (this.ze(),
        Ss(this, b),
        this.va.push([11, c.strokeStyle, c.lineWidth, c.lineCap, c.lineJoin, c.miterLimit, c.lineDash, c.lineDashOffset, !0, 1], [1]),
        c = a.X(),
        Ys(this, c, 0, c.length, a.oa()),
        this.va.push([13]),
        Ts(this, b))
    }
    ;
    h.Gf = function(a, b) {
        var c = this.u
          , d = c.lineWidth;
        if (void 0 !== c.strokeStyle && void 0 !== d) {
            this.ze();
            Ss(this, b);
            this.va.push([11, c.strokeStyle, c.lineWidth, c.lineCap, c.lineJoin, c.miterLimit, c.lineDash, c.lineDashOffset, !0, 1], [1]);
            c = a.U;
            d = a.X();
            a = a.oa();
            var e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g)
                e = Ys(this, d, e, c[g], a);
            this.va.push([13]);
            Ts(this, b)
        }
    }
    ;
    h.finish = function() {
        var a = this.u;
        void 0 != a.ji && a.ji != this.coordinates.length && this.ya.push([13]);
        Vs(this);
        this.u = null
    }
    ;
    h.kb = function(a, b) {
        a = b.W;
        this.u.strokeStyle = od(a ? a : Th);
        a = b.Zc;
        this.u.lineCap = void 0 !== a ? a : "round";
        a = b.getLineDash();
        this.u.lineDash = a ? a : Sh;
        a = b.Ac;
        this.u.lineDashOffset = a ? a : 0;
        a = b.$c;
        this.u.lineJoin = void 0 !== a ? a : "round";
        a = b.Sb();
        this.u.lineWidth = void 0 !== a ? a : 1;
        b = b.ad;
        this.u.miterLimit = void 0 !== b ? b : 10;
        this.u.lineWidth > this.Zf && (this.Zf = this.u.lineWidth,
        this.Qc = null)
    }
    ;
    function Zs(a, b, c, d) {
        Ps.call(this, a, b, c, d);
        this.Qc = null;
        this.u = {
            Yr: void 0,
            lj: void 0,
            fj: void 0,
            gj: null,
            hj: void 0,
            ij: void 0,
            jj: void 0,
            kj: void 0,
            fillStyle: void 0,
            strokeStyle: void 0,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: void 0,
            miterLimit: void 0
        }
    }
    v(Zs, Ps);
    function $s(a, b, c, d, e) {
        var f = a.u
          , g = void 0 !== f.fillStyle;
        f = void 0 != f.strokeStyle;
        var k = d.length
          , l = [1];
        a.ya.push(l);
        a.va.push(l);
        for (l = 0; l < k; ++l) {
            var m = d[l]
              , n = a.coordinates.length;
            c = Qs(a, b, c, m, e, !0, !f);
            c = [9, n, c];
            a.ya.push(c);
            a.va.push(c);
            f && (c = [3],
            a.ya.push(c),
            a.va.push(c));
            c = m
        }
        b = [8];
        a.va.push(b);
        g && a.ya.push(b);
        f && (g = [13],
        a.ya.push(g),
        a.va.push(g));
        return c
    }
    h = Zs.prototype;
    h.Qe = function(a, b) {
        var c = this.u
          , d = c.strokeStyle;
        if (void 0 !== c.fillStyle || void 0 !== d) {
            at(this, a);
            Ss(this, b);
            this.va.push([10, md(Rh)]);
            void 0 !== c.strokeStyle && this.va.push([11, c.strokeStyle, c.lineWidth, c.lineCap, c.lineJoin, c.miterLimit, c.lineDash, c.lineDashOffset, !0, 1]);
            var e = a.X();
            d = this.coordinates.length;
            Qs(this, e, 0, e.length, a.oa(), !1, !1);
            a = [1];
            d = [2, d];
            this.ya.push(a, d);
            this.va.push(a, d);
            a = [8];
            this.va.push(a);
            void 0 !== c.fillStyle && this.ya.push(a);
            void 0 !== c.strokeStyle && (c = [13],
            this.ya.push(c),
            this.va.push(c));
            Ts(this, b)
        }
    }
    ;
    h.Kf = function(a, b) {
        var c = this.u;
        at(this, a);
        Ss(this, b);
        this.va.push([10, md(Rh)]);
        void 0 !== c.strokeStyle && this.va.push([11, c.strokeStyle, c.lineWidth, c.lineCap, c.lineJoin, c.miterLimit, c.lineDash, c.lineDashOffset, !0, 1]);
        c = a.U;
        var d = a.ub();
        $s(this, d, 0, c, a.oa());
        Ts(this, b)
    }
    ;
    h.If = function(a, b) {
        var c = this.u
          , d = c.strokeStyle;
        if (void 0 !== c.fillStyle || void 0 !== d) {
            at(this, a);
            Ss(this, b);
            this.va.push([10, md(Rh)]);
            void 0 !== c.strokeStyle && this.va.push([11, c.strokeStyle, c.lineWidth, c.lineCap, c.lineJoin, c.miterLimit, c.lineDash, c.lineDashOffset, !0, 1]);
            c = a.Ia;
            d = a.ub();
            a = a.oa();
            var e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g)
                e = $s(this, d, e, c[g], a);
            Ts(this, b)
        }
    }
    ;
    h.finish = function() {
        Vs(this);
        this.u = null;
        var a = this.Wu;
        if (0 !== a) {
            var b = this.coordinates, c;
            var d = 0;
            for (c = b.length; d < c; ++d)
                b[d] = a * Math.round(b[d] / a)
        }
    }
    ;
    h.Oo = function() {
        this.Qc || (this.Qc = Xa(this.Km),
        0 < this.Zf && Wa(this.Qc, this.resolution * (this.Zf + 1) / 2, this.Qc));
        return this.Qc
    }
    ;
    h.kb = function(a, b) {
        var c = this.u;
        a ? (a = a.W,
        c.fillStyle = od(a ? a : Rh)) : c.fillStyle = void 0;
        b ? (a = b.W,
        c.strokeStyle = od(a ? a : Th),
        a = b.Zc,
        c.lineCap = void 0 !== a ? a : "round",
        a = b.getLineDash(),
        c.lineDash = a ? a.slice() : Sh,
        a = b.Ac,
        c.lineDashOffset = a ? a : 0,
        a = b.$c,
        c.lineJoin = void 0 !== a ? a : "round",
        a = b.Sb(),
        c.lineWidth = void 0 !== a ? a : 1,
        b = b.ad,
        c.miterLimit = void 0 !== b ? b : 10,
        c.lineWidth > this.Zf && (this.Zf = c.lineWidth,
        this.Qc = null)) : (c.strokeStyle = void 0,
        c.lineCap = void 0,
        c.lineDash = null,
        c.lineDashOffset = void 0,
        c.lineJoin = void 0,
        c.lineWidth = void 0,
        c.miterLimit = void 0)
    }
    ;
    function at(a, b) {
        var c = a.u
          , d = c.fillStyle
          , e = c.strokeStyle
          , f = c.lineCap
          , g = c.lineDash
          , k = c.lineDashOffset
          , l = c.lineJoin
          , m = c.lineWidth
          , n = c.miterLimit;
        if (void 0 !== d && ("string" !== typeof d || c.Yr != d)) {
            var p = [10, d];
            "string" !== typeof d && (b = b.c(),
            p.push([b[0], b[3]]));
            a.ya.push(p);
            c.Yr = c.fillStyle
        }
        void 0 === e || c.lj == e && c.fj == f && wa(c.gj, g) && c.hj == k && c.ij == l && c.jj == m && c.kj == n || (a.ya.push([11, e, m, f, l, n, g, k, !0, 1]),
        c.lj = e,
        c.fj = f,
        c.gj = g,
        c.hj = k,
        c.ij = l,
        c.jj = m,
        c.kj = n)
    }
    ;function bt(a, b, c, d) {
        Ps.call(this, a, b, c, d);
        this.ku = this.ju = this.iu = null;
        this.S = "";
        this.Qk = this.Pk = 0;
        this.Rk = void 0;
        this.ng = this.Sk = 0;
        this.qf = this.Nc = this.Mc = null
    }
    v(bt, Ps);
    bt.prototype.fe = function(a, b, c, d, e, f) {
        if ("" !== this.S && this.qf && (this.Mc || this.Nc)) {
            if (this.Mc) {
                e = this.Mc;
                var g = this.iu;
                if (!g || g.fillStyle != e.fillStyle) {
                    var k = [10, e.fillStyle];
                    this.ya.push(k);
                    this.va.push(k);
                    g ? g.fillStyle = e.fillStyle : this.iu = {
                        fillStyle: e.fillStyle
                    }
                }
            }
            this.Nc && (e = this.Nc,
            g = this.ju,
            g && g.lineCap == e.lineCap && g.lineDash == e.lineDash && g.lineDashOffset == e.lineDashOffset && g.lineJoin == e.lineJoin && g.lineWidth == e.lineWidth && g.miterLimit == e.miterLimit && g.strokeStyle == e.strokeStyle || (k = [11, e.strokeStyle, e.lineWidth, e.lineCap, e.lineJoin, e.miterLimit, e.lineDash, e.lineDashOffset, !1, 1],
            this.ya.push(k),
            this.va.push(k),
            g ? (g.lineCap = e.lineCap,
            g.lineDash = e.lineDash,
            g.lineDashOffset = e.lineDashOffset,
            g.lineJoin = e.lineJoin,
            g.lineWidth = e.lineWidth,
            g.miterLimit = e.miterLimit,
            g.strokeStyle = e.strokeStyle) : this.ju = {
                lineCap: e.lineCap,
                lineDash: e.lineDash,
                lineDashOffset: e.lineDashOffset,
                lineJoin: e.lineJoin,
                lineWidth: e.lineWidth,
                miterLimit: e.miterLimit,
                strokeStyle: e.strokeStyle
            }));
            e = this.qf;
            g = this.ku;
            g && g.font == e.font && g.textAlign == e.textAlign && g.textBaseline == e.textBaseline || (k = [12, e.font, e.textAlign, e.textBaseline],
            this.ya.push(k),
            this.va.push(k),
            g ? (g.font = e.font,
            g.textAlign = e.textAlign,
            g.textBaseline = e.textBaseline) : this.ku = {
                font: e.font,
                textAlign: e.textAlign,
                textBaseline: e.textBaseline
            });
            Ss(this, f);
            e = this.coordinates.length;
            a = Qs(this, a, b, c, d, !1, !1);
            a = [6, e, a, this.S, this.Pk, this.Qk, this.Sk, this.ng, !!this.Mc, !!this.Nc, this.Rk];
            this.ya.push(a);
            this.va.push(a);
            Ts(this, f)
        }
    }
    ;
    bt.prototype.bc = function(a) {
        if (a) {
            var b = a.ja;
            b ? (b = b.W,
            b = od(b ? b : Rh),
            this.Mc ? this.Mc.fillStyle = b : this.Mc = {
                fillStyle: b
            }) : this.Mc = null;
            var c = a.ia;
            if (c) {
                b = c.W;
                var d = c.Zc
                  , e = c.getLineDash()
                  , f = c.Ac
                  , g = c.$c
                  , k = c.Sb();
                c = c.ad;
                d = void 0 !== d ? d : "round";
                e = e ? e.slice() : Sh;
                f = void 0 !== f ? f : 0;
                g = void 0 !== g ? g : "round";
                k = void 0 !== k ? k : 1;
                c = void 0 !== c ? c : 10;
                b = od(b ? b : Th);
                if (this.Nc) {
                    var l = this.Nc;
                    l.lineCap = d;
                    l.lineDash = e;
                    l.lineDashOffset = f;
                    l.lineJoin = g;
                    l.lineWidth = k;
                    l.miterLimit = c;
                    l.strokeStyle = b
                } else
                    this.Nc = {
                        lineCap: d,
                        lineDash: e,
                        lineDashOffset: f,
                        lineJoin: g,
                        lineWidth: k,
                        miterLimit: c,
                        strokeStyle: b
                    }
            } else
                this.Nc = null;
            var m = a.Lf;
            b = a.qe;
            d = a.re;
            e = a.Db;
            k = a.ma();
            c = a.Ma;
            f = a.S;
            g = a.De;
            l = a.Ee;
            a = void 0 !== m ? m : "10px sans-serif";
            g = void 0 !== g ? g : "center";
            l = void 0 !== l ? l : "middle";
            this.qf ? (m = this.qf,
            m.font = a,
            m.textAlign = g,
            m.textBaseline = l) : this.qf = {
                font: a,
                textAlign: g,
                textBaseline: l
            };
            this.S = void 0 !== f ? f : "";
            this.Pk = void 0 !== b ? b : 0;
            this.Qk = void 0 !== d ? d : 0;
            this.Rk = void 0 !== e ? e : !1;
            this.Sk = void 0 !== k ? k : 0;
            this.ng = void 0 !== c ? c : 1
        } else
            this.S = ""
    }
    ;
    function ct(a, b, c, d, e) {
        this.Oq = a;
        this.Lm = b;
        this.ri = d;
        this.xe = c;
        this.dd = e;
        this.cb = {};
        this.Ey = pd(1, 1);
        this.Fy = Ah()
    }
    v(ct, gi);
    var dt = {
        0: [[!0]]
    };
    function et(a, b, c) {
        var d, e = Math.floor(a.length / 2);
        if (b >= e)
            for (d = e; d < b; d++)
                a[d][c] = !0;
        else if (b < e)
            for (d = b + 1; d < e; d++)
                a[d][c] = !0
    }
    function ft(a) {
        if (void 0 !== dt[a])
            return dt[a];
        for (var b = 2 * a + 1, c = Array(b), d = 0; d < b; d++)
            c[d] = Array(b);
        b = a;
        for (var e = d = 0; b >= d; )
            et(c, a + b, a + d),
            et(c, a + d, a + b),
            et(c, a - d, a + b),
            et(c, a - b, a + d),
            et(c, a - b, a - d),
            et(c, a - d, a - b),
            et(c, a + d, a - b),
            et(c, a + b, a - d),
            d++,
            e += 1 + 2 * d,
            0 < 2 * (e - b) + 1 && (--b,
            e += 1 - 2 * b);
        return dt[a] = c
    }
    h = ct.prototype;
    h.finish = function() {
        for (var a in this.cb) {
            var b = this.cb[a], c;
            for (c in b)
                b[c].finish()
        }
    }
    ;
    h.Ta = function(a, b, c, d, e, f) {
        d = Math.round(d);
        var g = 2 * d + 1
          , k = Jh(this.Fy, d + .5, d + .5, 1 / b, -1 / b, -c, -a[0], -a[1])
          , l = this.Ey;
        l.canvas.width !== g || l.canvas.height !== g ? (l.canvas.width = g,
        l.canvas.height = g) : l.clearRect(0, 0, g, g);
        if (void 0 !== this.dd) {
            var m = Ua();
            Va(m, a);
            Wa(m, b * (this.dd + d), m)
        }
        var n = ft(d);
        return this.hn(l, k, c, e, function(a) {
            for (var b = l.getImageData(0, 0, g, g).data, c = 0; c < g; c++)
                for (var d = 0; d < g; d++)
                    if (n[c][d] && 0 < b[4 * (d * g + c) + 3]) {
                        if (a = f(a))
                            return a;
                        l.clearRect(0, 0, g, g);
                        return
                    }
        }, m)
    }
    ;
    function gt(a, b) {
        var c = a.Lm;
        a = c[0];
        var d = c[1]
          , e = c[2];
        c = c[3];
        a = [a, d, a, c, e, c, e, d];
        rf(a, 0, 8, 2, b, a);
        return a
    }
    h.Xa = function(a, b) {
        var c = void 0 !== a ? a.toString() : "0";
        a = this.cb[c];
        void 0 === a && (a = {},
        this.cb[c] = a);
        c = a[b];
        void 0 === c && (c = new ht[b](this.Oq,this.Lm,this.xe,this.ri),
        a[b] = c);
        return c
    }
    ;
    h.Nd = function() {
        return Bb(this.cb)
    }
    ;
    h.jb = function(a, b, c, d, e, f) {
        var g = Object.keys(this.cb).map(Number);
        g.sort(qa);
        var k = gt(this, c);
        a.save();
        a.beginPath();
        a.moveTo(k[0], k[1]);
        a.lineTo(k[2], k[3]);
        a.lineTo(k[4], k[5]);
        a.lineTo(k[6], k[7]);
        a.clip();
        f = f ? f : fi;
        var l, m;
        k = 0;
        for (l = g.length; k < l; ++k) {
            var n = this.cb[g[k].toString()];
            var p = 0;
            for (m = f.length; p < m; ++p) {
                var q = n[f[p]];
                void 0 !== q && q.jb(a, b, c, d, e)
            }
        }
        a.restore()
    }
    ;
    h.hn = function(a, b, c, d, e, f) {
        var g = Object.keys(this.cb).map(Number);
        g.sort(function(a, b) {
            return b - a
        });
        var k, l;
        var m = 0;
        for (k = g.length; m < k; ++m) {
            var n = this.cb[g[m].toString()];
            for (l = fi.length - 1; 0 <= l; --l) {
                var p = n[fi[l]];
                if (void 0 !== p && (p = Us(p, a, 1, b, c, d, p.va, e, f)))
                    return p
            }
        }
    }
    ;
    var ht = {
        Circle: Zs,
        Default: Ps,
        Image: Ws,
        LineString: Xs,
        Polygon: Zs,
        Text: bt
    };
    function it(a) {
        Zc.call(this);
        this.Bm = a
    }
    v(it, Zc);
    h = it.prototype;
    h.Ta = Ba;
    h.af = pf;
    h.xo = function(a, b, c) {
        return function(d, e) {
            return jt(a, b, d, e, function(a) {
                c[d] || (c[d] = {});
                c[d][a.ta.toString()] = a
            })
        }
    }
    ;
    h.ka = function() {
        return this.Bm
    }
    ;
    h.jp = function(a) {
        2 === a.target.getState() && kt(this)
    }
    ;
    function lt(a, b) {
        var c = b.getState();
        2 != c && 3 != c && y(b, "change", a.jp, a);
        0 == c && (b.load(),
        c = b.getState());
        return 2 == c
    }
    function kt(a) {
        var b = a.ka();
        b.ke() && "ready" == b.ep() && a.a()
    }
    function mt(a, b) {
        b.Bg() && a.Rd.push(function(a, b, e) {
            b = w(a).toString();
            b in e.Qi && a.Jh(e.viewState.projection, e.Qi[b])
        }
        .bind(null, b))
    }
    function nt(a, b) {
        if (b) {
            var c;
            var d = 0;
            for (c = b.length; d < c; ++d) {
                var e = b[d];
                a[w(e).toString()] = e
            }
        }
    }
    function ot(a, b) {
        b = b.Fp;
        void 0 !== b && ("string" === typeof b ? a.ah[b] = "" : b && (Fa("string" == typeof b.href, 44),
        Fa("string" == typeof b.src, 45),
        a.ah[b.src] = b.href))
    }
    function pt(a, b, c, d) {
        b = w(b).toString();
        c = c.toString();
        b in a ? c in a[b] ? a[b][c].extend(d) : a[b][c] = d : (a[b] = {},
        a[b][c] = d)
    }
    function qt(a, b, c, d, e, f, g, k, l, m) {
        var n = w(b).toString();
        n in a.wantedTiles || (a.wantedTiles[n] = {});
        var p = a.wantedTiles[n];
        a = a.tileQueue;
        var q = c.Ng(), t, u, x;
        for (x = g; x >= q; --x) {
            var B = c.xc(f, x, B);
            var z = c.O(x);
            for (t = B.ba; t <= B.ea; ++t)
                for (u = B.ca; u <= B.fa; ++u)
                    if (g - x <= k) {
                        var E = b.ua(x, t, u, d, e);
                        0 == E.getState() && (p[E.getKey()] = !0,
                        a.zp(E.getKey()) || a.enqueue([E, n, c.Oj(E.ta), z]));
                        void 0 !== l && l.call(m, E)
                    } else
                        b.Wq(x, t, u, e)
        }
    }
    ;function rt(a) {
        it.call(this, a);
        this.qb = Ah()
    }
    v(rt, it);
    h = rt.prototype;
    h.clip = function(a, b, c) {
        var d = b.pixelRatio
          , e = b.size[0] * d
          , f = b.size[1] * d
          , g = b.viewState.rotation
          , k = nb(c)
          , l = mb(c)
          , m = lb(c);
        c = kb(c);
        Fh(b.Dg, k);
        Fh(b.Dg, l);
        Fh(b.Dg, m);
        Fh(b.Dg, c);
        a.save();
        Uh(a, -g, e / 2, f / 2);
        a.beginPath();
        a.moveTo(k[0] * d, k[1] * d);
        a.lineTo(l[0] * d, l[1] * d);
        a.lineTo(m[0] * d, m[1] * d);
        a.lineTo(c[0] * d, c[1] * d);
        a.clip();
        Uh(a, g, e / 2, f / 2)
    }
    ;
    h.Rc = function(a, b, c, d) {
        var e = this.ka();
        if (e.hasListener(a)) {
            var f = c.size[0] * c.pixelRatio
              , g = c.size[1] * c.pixelRatio
              , k = c.viewState.rotation;
            Uh(b, -k, f / 2, g / 2);
            d = void 0 !== d ? d : this.Nf(c, 0);
            e.dispatchEvent(new Qh(a,new Wh(b,c.pixelRatio,c.extent,d,c.viewState.rotation),c,b,null));
            Uh(b, k, f / 2, g / 2)
        }
    }
    ;
    h.Ko = function(a, b, c, d) {
        if (this.Ta(a, b, 0, of, this))
            return c.call(d, this.ka(), null)
    }
    ;
    h.Wm = function(a, b, c, d) {
        this.Rc("postcompose", a, b, d)
    }
    ;
    h.Nf = function(a, b) {
        var c = a.viewState
          , d = a.pixelRatio
          , e = d / c.resolution;
        return Jh(this.qb, d * a.size[0] / 2, d * a.size[1] / 2, e, -e, -c.rotation, -c.center[0] + b, -c.center[1])
    }
    ;
    function st(a, b) {
        return w(a) - w(b)
    }
    function tt(a, b) {
        a = .5 * a / b;
        return a * a
    }
    function ut(a, b, c, d, e, f) {
        var g = !1, k;
        if (k = c.N()) {
            var l = k.Kg();
            2 == l || 3 == l ? k.Zu(e, f) : (0 == l && k.load(),
            k.nt(e, f),
            g = !0)
        }
        if (e = (0,
        c.Rb)(b))
            if (d = e.Kj(d),
            c.Ud)
                vt(a, d, c, b);
            else
                (0,
                wt[d.D()])(a, d, c, b);
        return g
    }
    function vt(a, b, c, d) {
        if ("GeometryCollection" == b.D()) {
            b = b.Rh();
            for (var e = 0, f = b.length; e < f; ++e)
                vt(a, b[e], c, d)
        } else
            a.Xa(c.La(), "Default").es(b, d, c.Ud)
    }
    var wt = {
        Point: function(a, b, c, d) {
            var e = c.N();
            if (e) {
                if (2 != e.Kg())
                    return;
                var f = a.Xa(c.La(), "Image");
                f.ye(e);
                f.Jf(b, d)
            }
            if (e = c.S)
                a = a.Xa(c.La(), "Text"),
                a.bc(e),
                a.fe(b.X(), 0, 2, 2, b, d)
        },
        LineString: function(a, b, c, d) {
            var e = c.ia;
            if (e) {
                var f = a.Xa(c.La(), "LineString");
                f.kb(null, e);
                f.Ff(b, d)
            }
            if (e = c.S)
                a = a.Xa(c.La(), "Text"),
                a.bc(e),
                a.fe(bi(b), 0, 2, 2, b, d)
        },
        Polygon: function(a, b, c, d) {
            var e = c.ja
              , f = c.ia;
            if (e || f) {
                var g = a.Xa(c.La(), "Polygon");
                g.kb(e, f);
                g.Kf(b, d)
            }
            if (e = c.S)
                a = a.Xa(c.La(), "Text"),
                a.bc(e),
                a.fe(Zf(b), 0, 2, 2, b, d)
        },
        MultiPoint: function(a, b, c, d) {
            var e = c.N();
            if (e) {
                if (2 != e.Kg())
                    return;
                var f = a.Xa(c.La(), "Image");
                f.ye(e);
                f.Hf(b, d)
            }
            if (e = c.S)
                a = a.Xa(c.La(), "Text"),
                a.bc(e),
                c = b.X(),
                a.fe(c, 0, c.length, b.oa(), b, d)
        },
        MultiLineString: function(a, b, c, d) {
            var e = c.ia;
            if (e) {
                var f = a.Xa(c.La(), "LineString");
                f.kb(null, e);
                f.Gf(b, d)
            }
            if (e = c.S)
                a = a.Xa(c.La(), "Text"),
                a.bc(e),
                c = ci(b),
                a.fe(c, 0, c.length, 2, b, d)
        },
        MultiPolygon: function(a, b, c, d) {
            var e = c.ja
              , f = c.ia;
            if (f || e) {
                var g = a.Xa(c.La(), "Polygon");
                g.kb(e, f);
                g.If(b, d)
            }
            if (e = c.S)
                a = a.Xa(c.La(), "Text"),
                a.bc(e),
                c = di(b),
                a.fe(c, 0, c.length, 2, b, d)
        },
        GeometryCollection: function(a, b, c, d) {
            b = b.Ja;
            var e;
            var f = 0;
            for (e = b.length; f < e; ++f)
                (0,
                wt[b[f].D()])(a, b[f], c, d)
        },
        Circle: function(a, b, c, d) {
            var e = c.ja
              , f = c.ia;
            if (e || f) {
                var g = a.Xa(c.La(), "Circle");
                g.kb(e, f);
                g.Qe(b, d)
            }
            if (e = c.S)
                a = a.Xa(c.La(), "Text"),
                a.bc(e),
                a.fe(b.Fa(), 0, 2, 2, b, d)
        }
    };
    function xt(a) {
        rt.call(this, a);
        this.rc = !1;
        this.bb = -1;
        this.Bk = NaN;
        this.Td = Ua();
        this.yb = this.Ak = null;
        this.$ = pd()
    }
    v(xt, rt);
    h = xt.prototype;
    h.Ch = function(a, b, c) {
        var d = a.extent
          , e = a.pixelRatio
          , f = b.Fm ? a.qh : {}
          , g = a.viewState
          , k = g.projection
          , l = g.rotation
          , m = k.c()
          , n = this.ka().Y()
          , p = this.Nf(a, 0);
        this.Rc("precompose", c, a, p);
        var q = b.extent;
        (g = void 0 !== q) && this.clip(c, a, q);
        var t = this.yb;
        if (t && !t.Nd()) {
            var u = this.ka()
              , x = q = 0
              , B = 1 !== b.opacity;
            u = u.hasListener("render");
            if (B || u) {
                var z = c.canvas.width;
                var E = c.canvas.height;
                if (l) {
                    var G = Math.round(Math.sqrt(z * z + E * E));
                    q = (G - z) / 2;
                    x = (G - E) / 2;
                    z = E = G
                }
                this.$.canvas.width = z;
                this.$.canvas.height = E;
                z = this.$
            } else
                z = c;
            E = z.globalAlpha;
            B || (z.globalAlpha = b.opacity);
            z != c && z.translate(q, x);
            G = a.size[0] * e;
            var ea = a.size[1] * e;
            Uh(z, -l, G / 2, ea / 2);
            t.jb(z, e, p, l, f);
            if (n.Tn && k.Bf && !ab(m, d)) {
                k = d[0];
                n = qb(m);
                for (var V = 0; k < m[0]; )
                    --V,
                    p = n * V,
                    p = this.Nf(a, p),
                    t.jb(z, e, p, l, f),
                    k += n;
                V = 0;
                for (k = d[2]; k > m[2]; )
                    ++V,
                    p = n * V,
                    p = this.Nf(a, p),
                    t.jb(z, e, p, l, f),
                    k -= n;
                p = this.Nf(a, 0)
            }
            Uh(z, l, G / 2, ea / 2);
            z != c && (u && this.Rc("render", z, a, p),
            B ? (d = c.globalAlpha,
            c.globalAlpha = b.opacity,
            c.drawImage(z.canvas, -q, -x),
            c.globalAlpha = d) : c.drawImage(z.canvas, -q, -x),
            z.translate(-q, -x));
            B || (z.globalAlpha = E)
        }
        g && c.restore();
        this.Wm(c, a, b, p)
    }
    ;
    h.Ta = function(a, b, c, d, e) {
        if (this.yb) {
            var f = b.viewState.resolution;
            b = b.viewState.rotation;
            var g = this.ka()
              , k = {};
            return this.yb.Ta(a, f, b, c, {}, function(a) {
                var b = w(a).toString();
                if (!(b in k))
                    return k[b] = !0,
                    d.call(e, a, g)
            })
        }
    }
    ;
    h.Sf = function() {
        kt(this)
    }
    ;
    h.ue = function(a) {
        var b = this.ka()
          , c = b.Y();
        nt(a.attributions, c.Nb);
        ot(a, c);
        var d = a.Dd[0]
          , e = a.Dd[1]
          , f = b.bv
          , g = b.cv;
        if (!this.rc && !f && d || !g && e)
            return !0;
        f = a.extent;
        var k = a.viewState;
        g = k.projection;
        var l = k.resolution
          , m = a.pixelRatio;
        d = b.Z;
        var n = b.dd;
        e = b.get(yt);
        void 0 === e && (e = st);
        f = Wa(f, n * l);
        n = k.projection.c();
        c.Tn && k.projection.Bf && !ab(n, a.extent) && (a = Math.max(qb(f) / 2, qb(n)),
        f[0] = n[0] - a,
        f[2] = n[2] + a);
        if (!this.rc && this.Bk == l && this.bb == d && this.Ak == e && ab(this.Td, f))
            return !0;
        this.yb = null;
        this.rc = !1;
        var p = new ct(.5 * l / m,f,l,c.ri,b.dd);
        c.loadFeatures(f, l, g);
        a = function(a) {
            var c = a.Xb();
            if (c)
                var d = c.call(a, l);
            else
                (c = b.Xb()) && (d = c(a, l));
            d && (a = this.yk(a, l, m, d, p),
            this.rc = this.rc || a)
        }
        .bind(this);
        if (e) {
            var q = [];
            c.forEachFeatureInExtent(f, function(a) {
                q.push(a)
            }, this);
            q.sort(e);
            c = 0;
            for (g = q.length; c < g; ++c)
                a(q[c])
        } else
            c.forEachFeatureInExtent(f, a, this);
        p.finish();
        this.Bk = l;
        this.bb = d;
        this.Ak = e;
        this.Td = f;
        this.yb = p;
        return !0
    }
    ;
    h.yk = function(a, b, c, d, e) {
        if (!d)
            return !1;
        var f = !1;
        if (Array.isArray(d))
            for (var g = 0, k = d.length; g < k; ++g)
                f = ut(e, a, d[g], tt(b, c), this.Sf, this) || f;
        else
            f = ut(e, a, d, tt(b, c), this.Sf, this) || f;
        return f
    }
    ;
    function zt() {
        this.da = "precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n"
    }
    v(zt, ii);
    var At = new zt;
    function Bt() {
        this.da = "varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n"
    }
    v(Bt, ji);
    var Ct = new Bt;
    function Dt(a, b) {
        this.Ni = a.getUniformLocation(b, "u_opacity");
        this.Oi = a.getUniformLocation(b, "u_projectionMatrix");
        this.yB = a.getUniformLocation(b, "u_texCoordMatrix");
        this.Uq = a.getUniformLocation(b, "u_texture");
        this.lb = a.getAttribLocation(b, "a_position");
        this.Le = a.getAttribLocation(b, "a_texCoord")
    }
    ;function Et(a, b) {
        it.call(this, b);
        this.ud = a;
        this.jw = new xi([-1, -1, 0, 0, 1, -1, 1, 0, -1, 1, 0, 1, 1, 1, 1, 1]);
        this.Mh = this.Cd = null;
        this.Nh = void 0;
        this.yn = Ah();
        this.Sp = Ah();
        this.Ki = pi();
        this.fb = null
    }
    v(Et, it);
    Et.prototype.bindFramebuffer = function(a, b) {
        var c = this.ud.sa;
        if (void 0 === this.Nh || this.Nh != b) {
            a.Rd.push(function(a, b, c) {
                a.isContextLost() || (a.deleteFramebuffer(b),
                a.deleteTexture(c))
            }
            .bind(null, c, this.Mh, this.Cd));
            a = Ii(c, b, b);
            var d = c.createFramebuffer();
            c.bindFramebuffer(36160, d);
            c.framebufferTexture2D(36160, 36064, 3553, a, 0);
            this.Cd = a;
            this.Mh = d;
            this.Nh = b
        } else
            c.bindFramebuffer(36160, this.Mh)
    }
    ;
    Et.prototype.Ch = function(a, b, c) {
        this.Rc("precompose", c, a);
        c.bindBuffer(34962, this.jw);
        var d = c.sa
          , e = Ai(c, At, Ct);
        if (this.fb)
            var f = this.fb;
        else
            this.fb = f = new Dt(d,e);
        c.useProgram(e) && (d.enableVertexAttribArray(f.lb),
        d.vertexAttribPointer(f.lb, 2, 5126, !1, 16, 0),
        d.enableVertexAttribArray(f.Le),
        d.vertexAttribPointer(f.Le, 2, 5126, !1, 16, 8),
        d.uniform1i(f.Uq, 0));
        d.uniformMatrix4fv(f.yB, !1, qi(this.Ki, this.yn));
        d.uniformMatrix4fv(f.Oi, !1, qi(this.Ki, this.Sp));
        d.uniform1f(f.Ni, b.opacity);
        d.bindTexture(3553, this.Cd);
        d.drawArrays(5, 0, 4);
        this.Rc("postcompose", c, a)
    }
    ;
    Et.prototype.Rc = function(a, b, c) {
        var d = this.ka();
        if (d.hasListener(a)) {
            var e = c.viewState;
            d.dispatchEvent(new Qh(a,new ck(b,e.center,e.resolution,e.rotation,c.size,c.extent,c.pixelRatio),c,null,b))
        }
    }
    ;
    Et.prototype.Tg = function() {
        this.Mh = this.Cd = null;
        this.Nh = void 0
    }
    ;
    function Ft(a, b) {
        Et.call(this, a, b);
        this.rc = !1;
        this.bb = -1;
        this.Bk = NaN;
        this.Td = Ua();
        this.$j = this.yb = this.Ak = null
    }
    v(Ft, Et);
    h = Ft.prototype;
    h.Ch = function(a, b, c) {
        this.$j = b;
        var d = a.viewState
          , e = this.yb
          , f = a.size
          , g = a.pixelRatio
          , k = this.ud.sa;
        e && !e.Nd() && (k.enable(k.SCISSOR_TEST),
        k.scissor(0, 0, f[0] * g, f[1] * g),
        e.jb(c, d.center, d.resolution, d.rotation, f, g, b.opacity, b.Fm ? a.qh : {}),
        k.disable(k.SCISSOR_TEST))
    }
    ;
    h.la = function() {
        var a = this.yb;
        if (a) {
            var b = this.ud.getContext();
            a.Vb(b)();
            this.yb = null
        }
        Et.prototype.la.call(this)
    }
    ;
    h.Ta = function(a, b, c, d, e) {
        if (this.yb && this.$j) {
            c = this.ud.getContext();
            var f = b.viewState
              , g = this.ka()
              , k = {};
            return this.yb.Ta(a, c, f.center, f.resolution, f.rotation, b.size, b.pixelRatio, this.$j.opacity, {}, function(a) {
                var b = w(a).toString();
                if (!(b in k))
                    return k[b] = !0,
                    d.call(e, a, g)
            })
        }
    }
    ;
    h.af = function(a, b) {
        if (this.yb && this.$j) {
            var c = this.ud.getContext()
              , d = b.viewState;
            return this.yb.af(a, c, d.center, d.resolution, d.rotation, b.size, b.pixelRatio, this.$j.opacity, b.qh)
        }
        return !1
    }
    ;
    h.Mf = function(a, b, c, d) {
        a = Fh(b.ti, a.slice());
        if (this.af(a, b))
            return c.call(d, this.ka(), null)
    }
    ;
    h.Sf = function() {
        kt(this)
    }
    ;
    h.ue = function(a, b, c) {
        function d(a) {
            var b = a.Xb();
            if (b)
                var c = b.call(a, m);
            else
                (b = e.Xb()) && (c = b(a, m));
            c && (a = this.yk(a, m, n, c, q),
            this.rc = this.rc || a)
        }
        var e = this.ka();
        b = e.Y();
        nt(a.attributions, b.Nb);
        ot(a, b);
        var f = a.Dd[0]
          , g = a.Dd[1]
          , k = e.bv
          , l = e.cv;
        if (!this.rc && !k && f || !l && g)
            return !0;
        g = a.extent;
        k = a.viewState;
        f = k.projection;
        var m = k.resolution
          , n = a.pixelRatio;
        k = e.Z;
        var p = e.dd;
        l = e.get(yt);
        void 0 === l && (l = st);
        g = Wa(g, p * m);
        if (!this.rc && this.Bk == m && this.bb == k && this.Ak == l && ab(this.Td, g))
            return !0;
        this.yb && a.Rd.push(this.yb.Vb(c));
        this.rc = !1;
        var q = new Zj(.5 * m / n,g,e.dd);
        b.loadFeatures(g, m, f);
        if (l) {
            var t = [];
            b.forEachFeatureInExtent(g, function(a) {
                t.push(a)
            }, this);
            t.sort(l);
            t.forEach(d, this)
        } else
            b.forEachFeatureInExtent(g, d, this);
        q.finish(c);
        this.Bk = m;
        this.bb = k;
        this.Ak = l;
        this.Td = g;
        this.yb = q;
        return !0
    }
    ;
    h.yk = function(a, b, c, d, e) {
        if (!d)
            return !1;
        var f = !1;
        if (Array.isArray(d))
            for (var g = d.length - 1; 0 <= g; --g)
                f = ut(e, a, d[g], tt(b, c), this.Sf, this) || f;
        else
            f = ut(e, a, d, tt(b, c), this.Sf, this) || f;
        return f
    }
    ;
    function T(a) {
        a = a ? a : {};
        var b = yb({}, a);
        delete b.style;
        delete b.renderBuffer;
        delete b.updateWhileAnimating;
        delete b.updateWhileInteracting;
        vh.call(this, b);
        this.dd = void 0 !== a.renderBuffer ? a.renderBuffer : 100;
        this.Lc = null;
        this.Ce = void 0;
        this.Gb(a.style);
        this.bv = void 0 !== a.updateWhileAnimating ? a.updateWhileAnimating : !1;
        this.cv = void 0 !== a.updateWhileInteracting ? a.updateWhileInteracting : !1
    }
    v(T, vh);
    T.prototype.dj = function(a) {
        var b = null
          , c = a.D();
        "canvas" === c ? b = new xt(this) : "webgl" === c && (b = new Ft(a,this));
        return b
    }
    ;
    T.prototype.Ye = function() {
        return this.Lc
    }
    ;
    T.prototype.Xb = function() {
        return this.Ce
    }
    ;
    T.prototype.Gb = function(a) {
        this.Lc = void 0 !== a ? a : Uk;
        this.Ce = null === a ? void 0 : Sk(this.Lc);
        this.a()
    }
    ;
    var yt = "renderOrder";
    function Gt() {
        return [[-Infinity, -Infinity, Infinity, Infinity]]
    }
    ;function Ht(a) {
        $c.call(this);
        this.Ic = ec(a.projection);
        this.Nb = It(a.attributions);
        this.Fp = a.logo;
        this.u = void 0 !== a.state ? a.state : "ready";
        this.Tn = void 0 !== a.wrapX ? a.wrapX : !1
    }
    v(Ht, $c);
    function It(a) {
        if ("string" === typeof a)
            return [new Ic({
                html: a
            })];
        if (a instanceof Ic)
            return [a];
        if (Array.isArray(a)) {
            for (var b = a.length, c = Array(b), d = 0; d < b; d++) {
                var e = a[d];
                c[d] = "string" === typeof e ? new Ic({
                    html: e
                }) : e
            }
            return c
        }
        return null
    }
    h = Ht.prototype;
    h.Ta = Ba;
    h.Ea = function() {
        return this.Nb
    }
    ;
    h.Ka = function() {
        return this.Fp
    }
    ;
    h.M = function() {
        return this.Ic
    }
    ;
    h.getState = function() {
        return this.u
    }
    ;
    h.refresh = function() {
        this.a()
    }
    ;
    h.xa = function(a) {
        this.Nb = It(a);
        this.a()
    }
    ;
    h.Fb = function(a) {
        this.u = a;
        this.a()
    }
    ;
    function U(a) {
        a = a || {};
        Ht.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: void 0,
            state: "ready",
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        });
        this.Xf = Ba;
        this.Id = a.format;
        this.ri = void 0 == a.overlaps ? !0 : a.overlaps;
        this.eb = a.url;
        void 0 !== a.loader ? this.Xf = a.loader : void 0 !== this.eb && (Fa(this.Id, 7),
        this.Xf = sl(this.eb, this.Id));
        this.iB = void 0 !== a.strategy ? a.strategy : Gt;
        var b = void 0 !== a.useSpatialIndex ? a.useSpatialIndex : !0;
        this.Na = b ? new wj : null;
        this.pt = new wj;
        this.Ec = {};
        this.Md = {};
        this.qg = {};
        this.Kh = {};
        this.hc = null;
        if (a.features instanceof C) {
            var c = a.features;
            var d = c.ie()
        } else
            Array.isArray(a.features) && (d = a.features);
        b || void 0 !== c || (c = new C(d));
        void 0 !== d && Jt(this, d);
        void 0 !== c && Kt(this, c)
    }
    v(U, Ht);
    h = U.prototype;
    h.jd = function(a) {
        var b = w(a).toString();
        if (Lt(this, b, a)) {
            Mt(this, b, a);
            var c = a.I();
            c ? (b = c.c(),
            this.Na && this.Na.Pa(b, a)) : this.Ec[b] = a;
            this.dispatchEvent(new Nt("addfeature",a))
        }
        this.a()
    }
    ;
    function Mt(a, b, c) {
        a.Kh[b] = [y(c, "change", a.Qg, a), y(c, "propertychange", a.Qg, a)]
    }
    function Lt(a, b, c) {
        var d = !0
          , e = c.vb;
        void 0 !== e ? e.toString()in a.Md ? d = !1 : a.Md[e.toString()] = c : (Fa(!(b in a.qg), 30),
        a.qg[b] = c);
        return d
    }
    h.vg = function(a) {
        Jt(this, a);
        this.a()
    }
    ;
    function Jt(a, b) {
        var c, d = [], e = [], f = [];
        var g = 0;
        for (c = b.length; g < c; g++) {
            var k = b[g];
            var l = w(k).toString();
            Lt(a, l, k) && e.push(k)
        }
        g = 0;
        for (c = e.length; g < c; g++)
            k = e[g],
            l = w(k).toString(),
            Mt(a, l, k),
            (b = k.I()) ? (l = b.c(),
            d.push(l),
            f.push(k)) : a.Ec[l] = k;
        a.Na && a.Na.load(d, f);
        g = 0;
        for (c = e.length; g < c; g++)
            a.dispatchEvent(new Nt("addfeature",e[g]))
    }
    function Kt(a, b) {
        var c = !1;
        y(a, "addfeature", function(a) {
            c || (c = !0,
            b.push(a.feature),
            c = !1)
        });
        y(a, "removefeature", function(a) {
            c || (c = !0,
            b.remove(a.feature),
            c = !1)
        });
        y(b, "add", function(a) {
            c || (c = !0,
            this.jd(a.element),
            c = !1)
        }, a);
        y(b, "remove", function(a) {
            c || (c = !0,
            this.zd(a.element),
            c = !1)
        }, a);
        a.hc = b
    }
    h.clear = function(a) {
        if (a) {
            for (var b in this.Kh)
                this.Kh[b].forEach(Mc);
            this.hc || (this.Kh = {},
            this.Md = {},
            this.qg = {})
        } else if (this.Na) {
            this.Na.forEach(this.hq, this);
            for (var c in this.Ec)
                this.hq(this.Ec[c])
        }
        this.hc && this.hc.clear();
        this.Na && this.Na.clear();
        this.pt.clear();
        this.Ec = {};
        this.dispatchEvent(new Nt("clear"));
        this.a()
    }
    ;
    h.xs = function(a, b) {
        if (this.Na)
            return this.Na.forEach(a, b);
        if (this.hc)
            return this.hc.forEach(a, b)
    }
    ;
    function Ot(a, b, c) {
        a.forEachFeatureInExtent([b[0], b[1], b[0], b[1]], function(a) {
            if (a.I().Xc(b))
                return c.call(void 0, a)
        })
    }
    h.forEachFeatureInExtent = function(a, b, c) {
        if (this.Na)
            return zj(this.Na, a, b, c);
        if (this.hc)
            return this.hc.forEach(b, c)
    }
    ;
    h.ys = function(a, b, c) {
        return this.forEachFeatureInExtent(a, function(d) {
            if (d.I().Kb(a) && (d = b.call(c, d)))
                return d
        })
    }
    ;
    h.Gs = function() {
        return this.hc
    }
    ;
    h.getFeatures = function() {
        if (this.hc)
            var a = this.hc.ie();
        else
            this.Na && (a = this.Na.getAll(),
            Bb(this.Ec) || ta(a, Ab(this.Ec)));
        return a
    }
    ;
    h.Fs = function(a) {
        var b = [];
        Ot(this, a, function(a) {
            b.push(a)
        });
        return b
    }
    ;
    h.Uo = function(a) {
        return xj(this.Na, a)
    }
    ;
    h.Bs = function(a, b) {
        var c = a[0]
          , d = a[1]
          , e = null
          , f = [NaN, NaN]
          , g = Infinity
          , k = [-Infinity, -Infinity, Infinity, Infinity]
          , l = b ? b : of;
        zj(this.Na, k, function(a) {
            if (l(a)) {
                var b = a.I()
                  , m = g;
                g = b.Ed(c, d, f, g);
                g < m && (e = a,
                a = Math.sqrt(g),
                k[0] = c - a,
                k[1] = d - a,
                k[2] = c + a,
                k[3] = d + a)
            }
        });
        return e
    }
    ;
    h.c = function(a) {
        return this.Na.c(a)
    }
    ;
    h.Es = function(a) {
        a = this.Md[a.toString()];
        return void 0 !== a ? a : null
    }
    ;
    h.Qh = function() {
        return this.Id
    }
    ;
    h.Jd = function() {}
    ;
    h.Of = function() {
        return this.eb
    }
    ;
    h.Qg = function(a) {
        a = a.target;
        var b = w(a).toString()
          , c = a.I();
        c ? (c = c.c(),
        b in this.Ec ? (delete this.Ec[b],
        this.Na && this.Na.Pa(c, a)) : this.Na && this.Na.update(c, a)) : b in this.Ec || (this.Na && this.Na.remove(a),
        this.Ec[b] = a);
        c = a.vb;
        void 0 !== c ? (c = c.toString(),
        b in this.qg ? (delete this.qg[b],
        this.Md[c] = a) : this.Md[c] !== a && (Pt(this, a),
        this.Md[c] = a)) : b in this.qg || (Pt(this, a),
        this.qg[b] = a);
        this.a();
        this.dispatchEvent(new Nt("changefeature",a))
    }
    ;
    h.Nd = function() {
        return this.Na.Nd() && Bb(this.Ec)
    }
    ;
    h.loadFeatures = function(a, b, c) {
        var d = this.pt;
        a = this.iB(a, b);
        var e;
        var f = 0;
        for (e = a.length; f < e; ++f) {
            var g = a[f];
            zj(d, g, function(a) {
                return ab(a.extent, g)
            }) || (this.Xf.call(this, g, b, c),
            d.Pa(g, {
                extent: g.slice()
            }))
        }
    }
    ;
    h.zd = function(a) {
        var b = w(a).toString();
        b in this.Ec ? delete this.Ec[b] : this.Na && this.Na.remove(a);
        this.hq(a);
        this.a()
    }
    ;
    h.hq = function(a) {
        var b = w(a).toString();
        this.Kh[b].forEach(Mc);
        delete this.Kh[b];
        var c = a.vb;
        void 0 !== c ? delete this.Md[c.toString()] : delete this.qg[b];
        this.dispatchEvent(new Nt("removefeature",a))
    }
    ;
    function Pt(a, b) {
        for (var c in a.Md)
            if (a.Md[c] === b) {
                delete a.Md[c];
                break
            }
    }
    function Nt(a, b) {
        Wc.call(this, a);
        this.feature = b
    }
    v(Nt, Wc);
    function Qt(a) {
        Dg.call(this, {
            handleDownEvent: Rt,
            handleEvent: St,
            handleUpEvent: Tt
        });
        this.Ik = !1;
        this.Gl = null;
        this.Sc = !1;
        this.da = a.source ? a.source : null;
        this.Ca = a.features ? a.features : null;
        this.cB = a.snapTolerance ? a.snapTolerance : 12;
        this.pg = a.type;
        this.Ya = Ut(this.pg);
        this.Ft = a.minPoints ? a.minPoints : this.Ya === Vt ? 3 : 2;
        this.yt = a.maxPoints ? a.maxPoints : Infinity;
        this.Iw = a.finishCondition ? a.finishCondition : of;
        var b = a.geometryFunction;
        if (!b)
            if ("Circle" === this.pg)
                b = function(a, b) {
                    b = b ? b : new ls([NaN, NaN]);
                    b.sq(a[0], Math.sqrt(kf(a[0], a[1])));
                    return b
                }
                ;
            else {
                var c, d = this.Ya;
                d === Wt ? c = D : d === Xt ? c = N : d === Vt && (c = F);
                b = function(a, b) {
                    b ? d === Vt ? b.pa([a[0].concat([a[0][0]])]) : b.pa(a) : b = new c(a);
                    return b
                }
            }
        this.Rb = b;
        this.Di = this.nf = this.Qa = this.kg = this.ec = this.tc = null;
        this.Mu = a.clickTolerance ? a.clickTolerance * a.clickTolerance : 36;
        this.se = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: a.wrapX ? a.wrapX : !1
            }),
            style: a.style ? a.style : Yt()
        });
        this.Ua = a.geometryName;
        this.Pb = a.condition ? a.condition : xg;
        this.Qw = a.freehand ? of : a.freehandCondition ? a.freehandCondition : yg;
        y(this, bd("active"), this.Yk, this)
    }
    v(Qt, Dg);
    function Yt() {
        var a = Vk();
        return function(b) {
            return a[b.I().D()]
        }
    }
    h = Qt.prototype;
    h.setMap = function(a) {
        Dg.prototype.setMap.call(this, a);
        this.Yk()
    }
    ;
    function St(a) {
        this.Sc = this.Ya !== Wt && this.Qw(a);
        var b = !this.Sc;
        this.Sc && "pointerdrag" === a.type && null !== this.ec ? (Zt(this, a),
        b = !1) : "pointermove" === a.type ? b = this.Qf(a) : "dblclick" === a.type && (b = !1);
        return Eg.call(this, a) && b
    }
    function Rt(a) {
        this.Ik = !this.Sc;
        return this.Sc ? (this.Gl = a.pixel,
        this.tc || $t(this, a),
        !0) : this.Pb(a) ? (this.Gl = a.pixel,
        !0) : !1
    }
    function Tt(a) {
        var b = !0;
        this.Qf(a);
        var c = this.Ya === au;
        this.Ik ? (this.tc ? this.Sc || c ? this.uj() : bu(this, a) ? this.Iw(a) && this.uj() : Zt(this, a) : ($t(this, a),
        this.Ya === Wt && this.uj()),
        b = !1) : this.Sc && (this.tc = null,
        cu(this));
        return b
    }
    h.Qf = function(a) {
        if (this.Gl && (!this.Sc && this.Ik || this.Sc && !this.Ik)) {
            var b = this.Gl
              , c = a.pixel
              , d = b[0] - c[0];
            b = b[1] - c[1];
            d = d * d + b * b;
            this.Ik = this.Sc ? d > this.Mu : d <= this.Mu
        }
        this.tc ? (d = a.coordinate,
        b = this.ec.I(),
        this.Ya === Wt ? c = this.Qa : this.Ya === Vt ? (c = this.Qa[0],
        c = c[c.length - 1],
        bu(this, a) && (d = this.tc.slice())) : (c = this.Qa,
        c = c[c.length - 1]),
        c[0] = d[0],
        c[1] = d[1],
        this.Rb(this.Qa, b),
        this.kg && this.kg.I().pa(d),
        b instanceof F && this.Ya !== Vt ? (this.nf || (this.nf = new Wk(new N(null))),
        d = b.Js(0),
        a = this.nf.I(),
        a.K(d.ha, d.X())) : this.Di && (a = this.nf.I(),
        a.pa(this.Di)),
        du(this)) : (a = a.coordinate.slice(),
        this.kg ? this.kg.I().pa(a) : (this.kg = new Wk(new D(a)),
        du(this)));
        return !0
    }
    ;
    function bu(a, b) {
        var c = !1;
        if (a.ec) {
            var d = !1
              , e = [a.tc];
            a.Ya === Xt ? d = a.Qa.length > a.Ft : a.Ya === Vt && (d = a.Qa[0].length > a.Ft,
            e = [a.Qa[0][0], a.Qa[0][a.Qa[0].length - 2]]);
            if (d) {
                d = b.map;
                for (var f = 0, g = e.length; f < g; f++) {
                    var k = e[f]
                      , l = d.gb(k)
                      , m = b.pixel;
                    c = m[0] - l[0];
                    l = m[1] - l[1];
                    if (c = Math.sqrt(c * c + l * l) <= (a.Sc ? 1 : a.cB)) {
                        a.tc = k;
                        break
                    }
                }
            }
        }
        return c
    }
    function $t(a, b) {
        b = b.coordinate;
        a.tc = b;
        a.Ya === Wt ? a.Qa = b.slice() : a.Ya === Vt ? (a.Qa = [[b.slice(), b.slice()]],
        a.Di = a.Qa[0]) : (a.Qa = [b.slice(), b.slice()],
        a.Ya === au && (a.Di = a.Qa));
        a.Di && (a.nf = new Wk(new N(a.Di)));
        b = a.Rb(a.Qa);
        a.ec = new Wk;
        a.Ua && a.ec.lh(a.Ua);
        a.ec.Ab(b);
        du(a);
        a.dispatchEvent(new eu("drawstart",a.ec))
    }
    function Zt(a, b) {
        b = b.coordinate;
        var c = a.ec.I(), d;
        if (a.Ya === Xt) {
            a.tc = b.slice();
            var e = a.Qa;
            e.length >= a.yt && (a.Sc ? e.pop() : d = !0);
            e.push(b.slice());
            a.Rb(e, c)
        } else
            a.Ya === Vt && (e = a.Qa[0],
            e.length >= a.yt && (a.Sc ? e.pop() : d = !0),
            e.push(b.slice()),
            d && (a.tc = e[0]),
            a.Rb(a.Qa, c));
        du(a);
        d && a.uj()
    }
    h.vA = function() {
        if (this.ec) {
            var a = this.ec.I();
            if (this.Ya === Xt) {
                var b = this.Qa;
                b.splice(-2, 1);
                this.Rb(b, a);
                2 <= b.length && (this.tc = b[b.length - 2].slice())
            } else if (this.Ya === Vt) {
                b = this.Qa[0];
                b.splice(-2, 1);
                var c = this.nf.I();
                c.pa(b);
                this.Rb(this.Qa, a)
            }
            0 === b.length && (this.tc = null);
            du(this)
        }
    }
    ;
    h.uj = function() {
        var a = cu(this)
          , b = this.Qa
          , c = a.I();
        this.Ya === Xt ? (b.pop(),
        this.Rb(b, c)) : this.Ya === Vt && (b[0].pop(),
        this.Rb(b, c),
        b = c.H());
        "MultiPoint" === this.pg ? a.Ab(new Q([b])) : "MultiLineString" === this.pg ? a.Ab(new P([b])) : "MultiPolygon" === this.pg && a.Ab(new R([b]));
        this.dispatchEvent(new eu("drawend",a));
        this.Ca && this.Ca.push(a);
        this.da && this.da.jd(a)
    }
    ;
    function cu(a) {
        a.tc = null;
        var b = a.ec;
        b && (a.ec = null,
        a.kg = null,
        a.nf = null,
        a.se.Y().clear(!0));
        return b
    }
    h.extend = function(a) {
        var b = a.I();
        this.ec = a;
        this.Qa = b.H();
        a = this.Qa[this.Qa.length - 1];
        this.tc = a.slice();
        this.Qa.push(a.slice());
        du(this);
        this.dispatchEvent(new eu("drawstart",this.ec))
    }
    ;
    h.ph = pf;
    function du(a) {
        var b = [];
        a.ec && b.push(a.ec);
        a.nf && b.push(a.nf);
        a.kg && b.push(a.kg);
        a = a.se.Y();
        a.clear(!0);
        a.vg(b)
    }
    h.Yk = function() {
        var a = this.B()
          , b = this.Va();
        a && b || cu(this);
        this.se.setMap(b ? a : null)
    }
    ;
    function Ut(a) {
        var b;
        "Point" === a || "MultiPoint" === a ? b = Wt : "LineString" === a || "MultiLineString" === a ? b = Xt : "Polygon" === a || "MultiPolygon" === a ? b = Vt : "Circle" === a && (b = au);
        return b
    }
    var Wt = "Point"
      , Xt = "LineString"
      , Vt = "Polygon"
      , au = "Circle";
    function eu(a, b) {
        Wc.call(this, a);
        this.feature = b
    }
    v(eu, Wc);
    function fu(a) {
        this.bh = this.V = null;
        this.Hc = 10;
        this.Ei = !1;
        this.Bb = this.ms = null;
        a || (a = {});
        Dg.call(this, {
            handleDownEvent: gu,
            handleDragEvent: hu,
            handleEvent: iu,
            handleUpEvent: ju
        });
        this.ns = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: !!a.wrapX
            }),
            style: a.boxStyle ? a.boxStyle : ku(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        this.fv = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: !!a.wrapX
            }),
            style: a.pointerStyle ? a.pointerStyle : lu(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        a.extent && this.Eb(a.extent)
    }
    v(fu, Dg);
    function iu(a) {
        if (!(a instanceof le))
            return !0;
        "pointermove" != a.type || this.$e || this.Qf(a);
        Eg.call(this, a);
        return !1
    }
    function gu(a) {
        function b(a) {
            var b = null
              , c = null;
            a[0] == e[0] ? b = e[2] : a[0] == e[2] && (b = e[0]);
            a[1] == e[1] ? c = e[3] : a[1] == e[3] && (c = e[1]);
            return null !== b && null !== c ? [b, c] : null
        }
        var c = a.pixel
          , d = a.map
          , e = this.c();
        (a = mu(this, c, d)) && e ? (c = a[0] == e[0] || a[0] == e[2] ? a[0] : null,
        d = a[1] == e[1] || a[1] == e[3] ? a[1] : null,
        null !== c && null !== d ? this.bh = nu(b(a)) : null !== c ? this.bh = ou(b([c, e[1]]), b([c, e[3]])) : null !== d && (this.bh = ou(b([e[0], d]), b([e[2], d])))) : (a = d.Jb(c),
        this.Eb([a[0], a[1], a[0], a[1]]),
        this.bh = nu(a));
        return !0
    }
    function hu(a) {
        this.bh && (a = a.coordinate,
        this.Eb(this.bh(a)),
        pu(this, a));
        return !0
    }
    function ju() {
        this.bh = null;
        var a = this.c();
        a && 0 !== ob(a) || this.Eb(null);
        return !1
    }
    function ku() {
        var a = Vk();
        return function() {
            return a.Polygon
        }
    }
    function lu() {
        var a = Vk();
        return function() {
            return a.Point
        }
    }
    function nu(a) {
        return function(b) {
            return Ta([a, b])
        }
    }
    function ou(a, b) {
        return a[0] == b[0] ? function(c) {
            return Ta([a, [c[0], b[1]]])
        }
        : a[1] == b[1] ? function(c) {
            return Ta([a, [b[0], c[1]]])
        }
        : null
    }
    function mu(a, b, c) {
        function d(a, b) {
            return mf(e, a) - mf(e, b)
        }
        var e = c.Jb(b)
          , f = a.c();
        if (f) {
            f = [[[f[0], f[1]], [f[0], f[3]]], [[f[0], f[3]], [f[2], f[3]]], [[f[2], f[3]], [f[2], f[1]]], [[f[2], f[1]], [f[0], f[1]]]];
            f.sort(d);
            f = f[0];
            var g = cf(e, f)
              , k = c.gb(g);
            if (lf(b, k) <= a.Hc)
                return b = c.gb(f[0]),
                c = c.gb(f[1]),
                b = kf(k, b),
                c = kf(k, c),
                a.Ei = Math.sqrt(Math.min(b, c)) <= a.Hc,
                a.Ei && (g = b > c ? f[1] : f[0]),
                g
        }
        return null
    }
    fu.prototype.Qf = function(a) {
        var b = a.pixel;
        a = a.map;
        var c = mu(this, b, a);
        c || (c = a.Jb(b));
        pu(this, c)
    }
    ;
    function pu(a, b) {
        var c = a.Bb;
        c ? c.I().pa(b) : (c = new Wk(new D(b)),
        a.Bb = c,
        a.fv.Y().jd(c))
    }
    fu.prototype.setMap = function(a) {
        this.ns.setMap(a);
        this.fv.setMap(a);
        Dg.prototype.setMap.call(this, a)
    }
    ;
    fu.prototype.c = function() {
        return this.V
    }
    ;
    fu.prototype.Eb = function(a) {
        this.V = a ? a : null;
        var b = this.ms;
        b ? a ? b.Ab(ag(a)) : b.Ab(void 0) : (this.ms = b = a ? new Wk(ag(a)) : new Wk({}),
        this.ns.Y().jd(b));
        this.dispatchEvent(new qu(this.V))
    }
    ;
    function qu(a) {
        Wc.call(this, "extentchanged");
        this.extent = a
    }
    v(qu, Wc);
    function ru(a) {
        Dg.call(this, {
            handleDownEvent: su,
            handleDragEvent: tu,
            handleEvent: uu,
            handleUpEvent: vu
        });
        this.Pb = a.condition ? a.condition : Cg;
        this.ww = function(a) {
            return sg(a) && wg(a)
        }
        ;
        this.zw = a.deleteCondition ? a.deleteCondition : this.ww;
        this.Ly = a.insertVertexCondition ? a.insertVertexCondition : of;
        this.gv = this.Bb = null;
        this.it = [0, 0];
        this.ki = this.mm = !1;
        this.za = new wj;
        this.Hc = void 0 !== a.pixelTolerance ? a.pixelTolerance : 10;
        this.ce = this.Ei = !1;
        this.Gd = [];
        this.se = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: !!a.wrapX
            }),
            style: a.style ? a.style : wu(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        this.vh = {
            Point: this.jr,
            LineString: this.dl,
            LinearRing: this.dl,
            Polygon: this.lr,
            MultiPoint: this.gr,
            MultiLineString: this.fr,
            MultiPolygon: this.ir,
            Circle: this.$q,
            GeometryCollection: this.er
        };
        this.da = null;
        a.source ? (this.da = a.source,
        a = new C(this.da.getFeatures()),
        y(this.da, "addfeature", this.vy, this),
        y(this.da, "removefeature", this.xy, this)) : a = a.features;
        if (!a)
            throw Error("The modify interaction requires features or a source");
        this.Ca = a;
        this.Ca.forEach(this.Xi, this);
        y(this.Ca, "add", this.bm, this);
        y(this.Ca, "remove", this.cm, this);
        this.xm = null
    }
    v(ru, Dg);
    h = ru.prototype;
    h.Xi = function(a) {
        var b = a.I();
        b && b.D()in this.vh && this.vh[b.D()].call(this, a, b);
        (b = this.B()) && b.Da && this.Va() && xu(this, this.it, b);
        y(a, "change", this.Qg, this)
    }
    ;
    function yu(a, b) {
        a.ki || (a.ki = !0,
        a.dispatchEvent(new zu("modifystart",a.Ca,b)))
    }
    h.dn = function(a) {
        Au(this, a);
        this.Bb && 0 === this.Ca.Wb() && (this.se.Y().zd(this.Bb),
        this.Bb = null);
        Sc(a, "change", this.Qg, this)
    }
    ;
    function Au(a, b) {
        a = a.za;
        var c = [];
        a.forEach(function(a) {
            b === a.feature && c.push(a)
        });
        for (var d = c.length - 1; 0 <= d; --d)
            a.remove(c[d])
    }
    h.setActive = function(a) {
        this.Bb && !a && (this.se.Y().zd(this.Bb),
        this.Bb = null);
        Dg.prototype.setActive.call(this, a)
    }
    ;
    h.setMap = function(a) {
        this.se.setMap(a);
        Dg.prototype.setMap.call(this, a)
    }
    ;
    h.vy = function(a) {
        a.feature && this.Ca.push(a.feature)
    }
    ;
    h.xy = function(a) {
        a.feature && this.Ca.remove(a.feature)
    }
    ;
    h.bm = function(a) {
        this.Xi(a.element)
    }
    ;
    h.Qg = function(a) {
        this.ce || (a = a.target,
        this.dn(a),
        this.Xi(a))
    }
    ;
    h.cm = function(a) {
        this.dn(a.element)
    }
    ;
    h.jr = function(a, b) {
        var c = b.H();
        a = {
            feature: a,
            geometry: b,
            na: [c, c]
        };
        this.za.Pa(b.c(), a)
    }
    ;
    h.gr = function(a, b) {
        var c = b.H(), d;
        var e = 0;
        for (d = c.length; e < d; ++e) {
            var f = c[e];
            f = {
                feature: a,
                geometry: b,
                depth: [e],
                index: e,
                na: [f, f]
            };
            this.za.Pa(b.c(), f)
        }
    }
    ;
    h.dl = function(a, b) {
        var c = b.H(), d;
        var e = 0;
        for (d = c.length - 1; e < d; ++e) {
            var f = c.slice(e, e + 2);
            var g = {
                feature: a,
                geometry: b,
                index: e,
                na: f
            };
            this.za.Pa(Ta(f), g)
        }
    }
    ;
    h.fr = function(a, b) {
        var c = b.H(), d, e;
        var f = 0;
        for (e = c.length; f < e; ++f) {
            var g = c[f];
            var k = 0;
            for (d = g.length - 1; k < d; ++k) {
                var l = g.slice(k, k + 2);
                var m = {
                    feature: a,
                    geometry: b,
                    depth: [f],
                    index: k,
                    na: l
                };
                this.za.Pa(Ta(l), m)
            }
        }
    }
    ;
    h.lr = function(a, b) {
        var c = b.H(), d, e;
        var f = 0;
        for (e = c.length; f < e; ++f) {
            var g = c[f];
            var k = 0;
            for (d = g.length - 1; k < d; ++k) {
                var l = g.slice(k, k + 2);
                var m = {
                    feature: a,
                    geometry: b,
                    depth: [f],
                    index: k,
                    na: l
                };
                this.za.Pa(Ta(l), m)
            }
        }
    }
    ;
    h.ir = function(a, b) {
        var c = b.H(), d, e, f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var k = c[g];
            var l = 0;
            for (e = k.length; l < e; ++l) {
                var m = k[l];
                var n = 0;
                for (d = m.length - 1; n < d; ++n) {
                    var p = m.slice(n, n + 2);
                    var q = {
                        feature: a,
                        geometry: b,
                        depth: [l, g],
                        index: n,
                        na: p
                    };
                    this.za.Pa(Ta(p), q)
                }
            }
        }
    }
    ;
    h.$q = function(a, b) {
        var c = b.Fa()
          , d = {
            feature: a,
            geometry: b,
            index: 0,
            na: [c, c]
        };
        a = {
            feature: a,
            geometry: b,
            index: 1,
            na: [c, c]
        };
        d.Go = a.Go = [d, a];
        this.za.Pa(eb(c), d);
        this.za.Pa(b.c(), a)
    }
    ;
    h.er = function(a, b) {
        var c = b.Ja;
        for (b = 0; b < c.length; ++b)
            this.vh[c[b].D()].call(this, a, c[b])
    }
    ;
    function Bu(a, b) {
        var c = a.Bb;
        c ? c.I().pa(b) : (c = new Wk(new D(b)),
        a.Bb = c,
        a.se.Y().jd(c))
    }
    function Cu(a, b) {
        return a.index - b.index
    }
    function su(a) {
        if (!this.Pb(a))
            return !1;
        xu(this, a.pixel, a.map);
        var b = a.map.Jb(a.pixel);
        this.Gd.length = 0;
        this.ki = !1;
        var c = this.Bb;
        if (c) {
            var d = [];
            c = c.I().H();
            var e = Ta([c]);
            e = xj(this.za, e);
            var f = {};
            e.sort(Cu);
            for (var g = 0, k = e.length; g < k; ++g) {
                var l = e[g]
                  , m = l.na
                  , n = w(l.feature)
                  , p = l.depth;
                p && (n += "-" + p.join("-"));
                f[n] || (f[n] = Array(2));
                if ("Circle" === l.geometry.D() && 1 === l.index)
                    m = Du(b, l),
                    ff(m, c) && !f[n][0] && (this.Gd.push([l, 0]),
                    f[n][0] = l);
                else if (ff(m[0], c) && !f[n][0])
                    this.Gd.push([l, 0]),
                    f[n][0] = l;
                else if (ff(m[1], c) && !f[n][1]) {
                    if ("LineString" !== l.geometry.D() && "MultiLineString" !== l.geometry.D() || !f[n][0] || 0 !== f[n][0].index)
                        this.Gd.push([l, 1]),
                        f[n][1] = l
                } else
                    this.Ly(a) && w(m)in this.gv && !f[n][0] && !f[n][1] && d.push([l, c])
            }
            d.length && yu(this, a);
            for (a = d.length - 1; 0 <= a; --a)
                this.My.apply(this, d[a])
        }
        return !!this.Bb
    }
    function tu(a) {
        this.mm = !1;
        yu(this, a);
        a = a.coordinate;
        for (var b = 0, c = this.Gd.length; b < c; ++b) {
            var d = this.Gd[b]
              , e = d[0]
              , f = e.depth
              , g = e.geometry
              , k = e.na;
            for (d = d[1]; a.length < g.oa(); )
                a.push(k[d][a.length]);
            switch (g.D()) {
            case "Point":
                var l = a;
                k[0] = k[1] = a;
                break;
            case "MultiPoint":
                l = g.H();
                l[e.index] = a;
                k[0] = k[1] = a;
                break;
            case "LineString":
                l = g.H();
                l[e.index + d] = a;
                k[d] = a;
                break;
            case "MultiLineString":
                l = g.H();
                l[f[0]][e.index + d] = a;
                k[d] = a;
                break;
            case "Polygon":
                l = g.H();
                l[f[0]][e.index + d] = a;
                k[d] = a;
                break;
            case "MultiPolygon":
                l = g.H();
                l[f[1]][f[0]][e.index + d] = a;
                k[d] = a;
                break;
            case "Circle":
                k[0] = k[1] = a,
                0 === e.index ? (this.ce = !0,
                g.Jc(a)) : (this.ce = !0,
                g.mh(lf(g.Fa(), a))),
                this.ce = !1
            }
            l && (e = g,
            f = l,
            this.ce = !0,
            e.pa(f),
            this.ce = !1)
        }
        Bu(this, a)
    }
    function vu(a) {
        for (var b, c, d = this.Gd.length - 1; 0 <= d; --d)
            if (b = this.Gd[d][0],
            c = b.geometry,
            "Circle" === c.D()) {
                var e = c.Fa()
                  , f = b.Go[0];
                b = b.Go[1];
                f.na[0] = f.na[1] = e;
                b.na[0] = b.na[1] = e;
                this.za.update(eb(e), f);
                this.za.update(c.c(), b)
            } else
                this.za.update(Ta(b.na), b);
        this.ki && (this.dispatchEvent(new zu("modifyend",this.Ca,a)),
        this.ki = !1);
        return !1
    }
    function uu(a) {
        if (!(a instanceof le))
            return !0;
        this.xm = a;
        var b;
        gg(a.map.R())[1] || "pointermove" != a.type || this.$e || this.Qf(a);
        this.Bb && this.zw(a) && (b = "singleclick" == a.type && this.mm ? !0 : this.fu());
        "singleclick" == a.type && (this.mm = !1);
        return Eg.call(this, a) && !b
    }
    h.Qf = function(a) {
        this.it = a.pixel;
        xu(this, a.pixel, a.map)
    }
    ;
    function xu(a, b, c) {
        function d(a, b) {
            return Eu(e, a) - Eu(e, b)
        }
        var e = c.Jb(b)
          , f = Wa(eb(e), c.R().O() * a.Hc);
        f = xj(a.za, f);
        if (0 < f.length) {
            f.sort(d);
            var g = f[0]
              , k = g.na
              , l = Du(e, g)
              , m = c.gb(l)
              , n = lf(b, m);
            if (n <= a.Hc) {
                b = {};
                if ("Circle" === g.geometry.D() && 1 === g.index)
                    a.Ei = !0,
                    Bu(a, l);
                else
                    for (n = c.gb(k[0]),
                    g = c.gb(k[1]),
                    c = kf(m, n),
                    m = kf(m, g),
                    n = Math.sqrt(Math.min(c, m)),
                    a.Ei = n <= a.Hc,
                    a.Ei && (l = c > m ? k[1] : k[0]),
                    Bu(a, l),
                    m = 1,
                    c = f.length; m < c; ++m)
                        if (l = f[m].na,
                        ff(k[0], l[0]) && ff(k[1], l[1]) || ff(k[0], l[1]) && ff(k[1], l[0]))
                            b[w(l)] = !0;
                        else
                            break;
                b[w(k)] = !0;
                a.gv = b;
                return
            }
        }
        a.Bb && (a.se.Y().zd(a.Bb),
        a.Bb = null)
    }
    function Eu(a, b) {
        var c = b.geometry;
        return "Circle" === c.D() && 1 === b.index ? (a = kf(c.Fa(), a),
        c = Math.sqrt(a) - c.wc(),
        c * c) : mf(a, b.na)
    }
    function Du(a, b) {
        var c = b.geometry;
        return "Circle" === c.D() && 1 === b.index ? c.od(a) : cf(a, b.na)
    }
    h.My = function(a, b) {
        for (var c = a.na, d = a.feature, e = a.geometry, f = a.depth, g = a.index, k; b.length < e.oa(); )
            b.push(0);
        switch (e.D()) {
        case "MultiLineString":
            k = e.H();
            k[f[0]].splice(g + 1, 0, b);
            break;
        case "Polygon":
            k = e.H();
            k[f[0]].splice(g + 1, 0, b);
            break;
        case "MultiPolygon":
            k = e.H();
            k[f[1]][f[0]].splice(g + 1, 0, b);
            break;
        case "LineString":
            k = e.H();
            k.splice(g + 1, 0, b);
            break;
        default:
            return
        }
        this.ce = !0;
        e.pa(k);
        this.ce = !1;
        k = this.za;
        k.remove(a);
        Fu(this, e, g, f, 1);
        a = {
            na: [c[0], b],
            feature: d,
            geometry: e,
            depth: f,
            index: g
        };
        k.Pa(Ta(a.na), a);
        this.Gd.push([a, 1]);
        b = {
            na: [b, c[1]],
            feature: d,
            geometry: e,
            depth: f,
            index: g + 1
        };
        k.Pa(Ta(b.na), b);
        this.Gd.push([b, 0]);
        this.mm = !0
    }
    ;
    h.fu = function() {
        if (this.xm && "pointerdrag" != this.xm.type) {
            var a = this.xm;
            yu(this, a);
            var b = this.Gd, c = {}, d, e;
            for (e = b.length - 1; 0 <= e; --e) {
                var f = b[e];
                var g = f[0];
                var k = w(g.feature);
                g.depth && (k += "-" + g.depth.join("-"));
                k in c || (c[k] = {});
                0 === f[1] ? (c[k].right = g,
                c[k].index = g.index) : 1 == f[1] && (c[k].left = g,
                c[k].index = g.index + 1)
            }
            for (k in c) {
                var l = c[k].right;
                var m = c[k].left;
                e = c[k].index;
                var n = e - 1;
                g = void 0 !== m ? m : l;
                0 > n && (n = 0);
                f = g.geometry;
                var p = d = f.H();
                var q = !1;
                switch (f.D()) {
                case "MultiLineString":
                    2 < d[g.depth[0]].length && (d[g.depth[0]].splice(e, 1),
                    q = !0);
                    break;
                case "LineString":
                    2 < d.length && (d.splice(e, 1),
                    q = !0);
                    break;
                case "MultiPolygon":
                    p = p[g.depth[1]];
                case "Polygon":
                    p = p[g.depth[0]],
                    4 < p.length && (e == p.length - 1 && (e = 0),
                    p.splice(e, 1),
                    q = !0,
                    0 === e && (p.pop(),
                    p.push(p[0]),
                    n = p.length - 1))
                }
                q && (q = f,
                this.ce = !0,
                q.pa(d),
                this.ce = !1,
                d = [],
                void 0 !== m && (this.za.remove(m),
                d.push(m.na[0])),
                void 0 !== l && (this.za.remove(l),
                d.push(l.na[1])),
                void 0 !== m && void 0 !== l && (m = {
                    depth: g.depth,
                    feature: g.feature,
                    geometry: g.geometry,
                    index: n,
                    na: d
                },
                this.za.Pa(Ta(m.na), m)),
                Fu(this, f, e, g.depth, -1),
                this.Bb && (this.se.Y().zd(this.Bb),
                this.Bb = null),
                b.length = 0)
            }
            this.dispatchEvent(new zu("modifyend",this.Ca,a));
            this.ki = !1;
            return !0
        }
        return !1
    }
    ;
    function Fu(a, b, c, d, e) {
        zj(a.za, b.c(), function(a) {
            a.geometry === b && (void 0 === d || void 0 === a.depth || wa(a.depth, d)) && a.index > c && (a.index += e)
        })
    }
    function wu() {
        var a = Vk();
        return function() {
            return a.Point
        }
    }
    function zu(a, b, c) {
        Wc.call(this, a);
        this.features = b;
        this.mapBrowserEvent = c
    }
    v(zu, Wc);
    function Gu(a) {
        og.call(this, {
            handleEvent: Hu
        });
        a = a ? a : {};
        this.Pb = a.condition ? a.condition : wg;
        this.$v = a.addCondition ? a.addCondition : pf;
        this.sA = a.removeCondition ? a.removeCondition : pf;
        this.pB = a.toggleCondition ? a.toggleCondition : yg;
        this.Kt = a.multi ? a.multi : !1;
        this.qs = a.filter ? a.filter : of;
        this.Tf = a.hitTolerance ? a.hitTolerance : 0;
        this.tj = new T({
            source: new U({
                useSpatialIndex: !1,
                features: a.features,
                wrapX: a.wrapX
            }),
            style: a.style ? a.style : Iu(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        if (a.layers)
            if ("function" === typeof a.layers)
                a = a.layers;
            else {
                var b = a.layers;
                a = function(a) {
                    return ra(b, a)
                }
            }
        else
            a = of;
        this.ym = a;
        this.sj = {};
        a = this.tj.Y().hc;
        y(a, "add", this.Xi, this);
        y(a, "remove", this.dn, this)
    }
    v(Gu, og);
    h = Gu.prototype;
    h.getFeatures = function() {
        return this.tj.Y().hc
    }
    ;
    h.$o = function() {
        return this.Tf
    }
    ;
    h.ka = function(a) {
        a = w(a);
        return this.sj[a]
    }
    ;
    function Hu(a) {
        if (!this.Pb(a))
            return !0;
        var b = this.$v(a)
          , c = this.sA(a)
          , d = this.pB(a)
          , e = !b && !c && !d
          , f = a.map
          , g = this.tj.Y().hc
          , k = []
          , l = [];
        if (e) {
            zb(this.sj);
            f.wj(a.pixel, function(a, b) {
                if (this.qs(a, b))
                    return l.push(a),
                    a = w(a),
                    this.sj[a] = b,
                    !this.Kt
            }
            .bind(this), {
                layerFilter: this.ym,
                hitTolerance: this.Tf
            });
            for (e = g.Wb() - 1; 0 <= e; --e) {
                f = g.item(e);
                var m = l.indexOf(f);
                -1 < m ? l.splice(m, 1) : (g.remove(f),
                k.push(f))
            }
            0 !== l.length && g.extend(l)
        } else {
            f.wj(a.pixel, function(a, e) {
                if (this.qs(a, e))
                    return !b && !d || ra(g.ie(), a) ? (c || d) && ra(g.ie(), a) && (k.push(a),
                    e = w(a),
                    delete this.sj[e]) : (l.push(a),
                    a = w(a),
                    this.sj[a] = e),
                    !this.Kt
            }
            .bind(this), {
                layerFilter: this.ym,
                hitTolerance: this.Tf
            });
            for (e = k.length - 1; 0 <= e; --e)
                g.remove(k[e]);
            g.extend(l)
        }
        (0 < l.length || 0 < k.length) && this.dispatchEvent(new Ju(Ku,l,k,a));
        return vg(a)
    }
    h.wq = function(a) {
        this.Tf = a
    }
    ;
    h.setMap = function(a) {
        var b = this.B()
          , c = this.tj.Y().hc;
        b && c.forEach(b.$u, b);
        og.prototype.setMap.call(this, a);
        this.tj.setMap(a);
        a && c.forEach(a.Hu, a)
    }
    ;
    function Iu() {
        var a = Vk();
        ta(a.Polygon, a.LineString);
        ta(a.GeometryCollection, a.LineString);
        return function(b) {
            return b.I() ? a[b.I().D()] : null
        }
    }
    h.Xi = function(a) {
        var b = this.B();
        b && b.Hu(a.element)
    }
    ;
    h.dn = function(a) {
        var b = this.B();
        b && b.$u(a.element)
    }
    ;
    function Ju(a, b, c, d) {
        Wc.call(this, a);
        this.selected = b;
        this.deselected = c;
        this.mapBrowserEvent = d
    }
    v(Ju, Wc);
    var Ku = "select";
    function Lu(a) {
        Dg.call(this, {
            handleEvent: Mu,
            handleDownEvent: of,
            handleUpEvent: Nu
        });
        a = a ? a : {};
        this.da = a.source ? a.source : null;
        this.Xq = void 0 !== a.vertex ? a.vertex : !0;
        this.Do = void 0 !== a.edge ? a.edge : !0;
        this.Ca = a.features ? a.features : null;
        this.Hw = [];
        this.Eo = {};
        this.et = {};
        this.Tm = {};
        this.Mp = null;
        this.Hc = void 0 !== a.pixelTolerance ? a.pixelTolerance : 10;
        this.eB = Ou.bind(this);
        this.za = new wj;
        this.vh = {
            Point: this.jr,
            LineString: this.dl,
            LinearRing: this.dl,
            Polygon: this.lr,
            MultiPoint: this.gr,
            MultiLineString: this.fr,
            MultiPolygon: this.ir,
            GeometryCollection: this.er,
            Circle: this.$q
        }
    }
    v(Lu, Dg);
    h = Lu.prototype;
    h.jd = function(a, b) {
        b = void 0 !== b ? b : !0;
        var c = w(a)
          , d = a.I();
        if (d) {
            var e = this.vh[d.D()];
            e && (this.et[c] = d.c(Ua()),
            e.call(this, a, d))
        }
        b && (this.Eo[c] = y(a, "change", this.Qg, this))
    }
    ;
    h.Kw = function(a) {
        this.jd(a)
    }
    ;
    h.Lw = function(a) {
        this.zd(a)
    }
    ;
    h.bm = function(a) {
        if (a instanceof Nt)
            var b = a.feature;
        else
            a instanceof hd && (b = a.element);
        this.jd(b)
    }
    ;
    h.cm = function(a) {
        if (a instanceof Nt)
            var b = a.feature;
        else
            a instanceof hd && (b = a.element);
        this.zd(b)
    }
    ;
    h.Qg = function(a) {
        a = a.target;
        if (this.$e) {
            var b = w(a);
            b in this.Tm || (this.Tm[b] = a)
        } else
            this.av(a)
    }
    ;
    h.zd = function(a, b) {
        b = void 0 !== b ? b : !0;
        var c = w(a)
          , d = this.et[c];
        if (d) {
            var e = this.za
              , f = [];
            zj(e, d, function(b) {
                a === b.feature && f.push(b)
            });
            for (d = f.length - 1; 0 <= d; --d)
                e.remove(f[d])
        }
        b && (Mc(this.Eo[c]),
        delete this.Eo[c])
    }
    ;
    h.setMap = function(a) {
        var b = this.B(), c = this.Hw, d;
        this.Ca ? d = this.Ca : this.da && (d = this.da.getFeatures());
        b && (c.forEach(Mc),
        c.length = 0,
        d.forEach(this.Lw, this));
        Dg.prototype.setMap.call(this, a);
        a && (this.Ca ? c.push(y(this.Ca, "add", this.bm, this), y(this.Ca, "remove", this.cm, this)) : this.da && c.push(y(this.da, "addfeature", this.bm, this), y(this.da, "removefeature", this.cm, this)),
        d.forEach(this.Kw, this))
    }
    ;
    h.ph = pf;
    function Pu(a, b, c, d) {
        var e = d.Jb([b[0] - a.Hc, b[1] + a.Hc])
          , f = d.Jb([b[0] + a.Hc, b[1] - a.Hc]);
        e = Ta([e, f]);
        var g = xj(a.za, e);
        a.Xq && !a.Do && (g = g.filter(function(a) {
            return "Circle" !== a.feature.I().D()
        }));
        var k = !1;
        e = !1;
        var l = f = null;
        if (0 < g.length) {
            a.Mp = c;
            g.sort(a.eB);
            var m = g[0].na;
            k = "Circle" === g[0].feature.I().D();
            if (a.Xq && !a.Do) {
                if (c = d.gb(m[0]),
                k = d.gb(m[1]),
                c = kf(b, c),
                b = kf(b, k),
                k = Math.sqrt(Math.min(c, b)),
                k = k <= a.Hc)
                    e = !0,
                    f = c > b ? m[1] : m[0],
                    l = d.gb(f)
            } else
                a.Do && (f = k ? bf(c, g[0].feature.I()) : cf(c, m),
                l = d.gb(f),
                lf(b, l) <= a.Hc && (e = !0,
                a.Xq && !k && (c = d.gb(m[0]),
                k = d.gb(m[1]),
                c = kf(l, c),
                b = kf(l, k),
                k = Math.sqrt(Math.min(c, b)),
                k = k <= a.Hc))) && (f = c > b ? m[1] : m[0],
                l = d.gb(f));
            e && (l = [Math.round(l[0]), Math.round(l[1])])
        }
        return {
            dB: e,
            vertex: f,
            IB: l
        }
    }
    h.av = function(a) {
        this.zd(a, !1);
        this.jd(a, !1)
    }
    ;
    h.$q = function(a, b) {
        b = bg(b).H()[0];
        var c;
        var d = 0;
        for (c = b.length - 1; d < c; ++d) {
            var e = b.slice(d, d + 2);
            var f = {
                feature: a,
                na: e
            };
            this.za.Pa(Ta(e), f)
        }
    }
    ;
    h.er = function(a, b) {
        var c = b.Ja;
        for (b = 0; b < c.length; ++b) {
            var d = this.vh[c[b].D()];
            d && d.call(this, a, c[b])
        }
    }
    ;
    h.dl = function(a, b) {
        b = b.H();
        var c;
        var d = 0;
        for (c = b.length - 1; d < c; ++d) {
            var e = b.slice(d, d + 2);
            var f = {
                feature: a,
                na: e
            };
            this.za.Pa(Ta(e), f)
        }
    }
    ;
    h.fr = function(a, b) {
        b = b.H();
        var c, d;
        var e = 0;
        for (d = b.length; e < d; ++e) {
            var f = b[e];
            var g = 0;
            for (c = f.length - 1; g < c; ++g) {
                var k = f.slice(g, g + 2);
                var l = {
                    feature: a,
                    na: k
                };
                this.za.Pa(Ta(k), l)
            }
        }
    }
    ;
    h.gr = function(a, b) {
        var c = b.H(), d;
        var e = 0;
        for (d = c.length; e < d; ++e) {
            var f = c[e];
            f = {
                feature: a,
                na: [f, f]
            };
            this.za.Pa(b.c(), f)
        }
    }
    ;
    h.ir = function(a, b) {
        b = b.H();
        var c, d, e;
        var f = 0;
        for (e = b.length; f < e; ++f) {
            var g = b[f];
            var k = 0;
            for (d = g.length; k < d; ++k) {
                var l = g[k];
                var m = 0;
                for (c = l.length - 1; m < c; ++m) {
                    var n = l.slice(m, m + 2);
                    var p = {
                        feature: a,
                        na: n
                    };
                    this.za.Pa(Ta(n), p)
                }
            }
        }
    }
    ;
    h.jr = function(a, b) {
        var c = b.H();
        a = {
            feature: a,
            na: [c, c]
        };
        this.za.Pa(b.c(), a)
    }
    ;
    h.lr = function(a, b) {
        b = b.H();
        var c, d;
        var e = 0;
        for (d = b.length; e < d; ++e) {
            var f = b[e];
            var g = 0;
            for (c = f.length - 1; g < c; ++g) {
                var k = f.slice(g, g + 2);
                var l = {
                    feature: a,
                    na: k
                };
                this.za.Pa(Ta(k), l)
            }
        }
    }
    ;
    function Mu(a) {
        var b = Pu(this, a.pixel, a.coordinate, a.map);
        b.dB && (a.coordinate = b.vertex.slice(0, 2),
        a.pixel = b.IB);
        return Eg.call(this, a)
    }
    function Nu() {
        var a = Ab(this.Tm);
        a.length && (a.forEach(this.av, this),
        this.Tm = {});
        return !1
    }
    function Ou(a, b) {
        return mf(this.Mp, a.na) - mf(this.Mp, b.na)
    }
    ;function Qu(a) {
        Dg.call(this, {
            handleDownEvent: Ru,
            handleDragEvent: Su,
            handleMoveEvent: Tu,
            handleUpEvent: Uu
        });
        a = a ? a : {};
        this.ne = null;
        this.Ca = void 0 !== a.features ? a.features : null;
        if (a.layers)
            if ("function" === typeof a.layers)
                var b = a.layers;
            else {
                var c = a.layers;
                b = function(a) {
                    return ra(c, a)
                }
            }
        else
            b = of;
        this.ym = b;
        this.Tf = a.hitTolerance ? a.hitTolerance : 0;
        this.Zj = null;
        y(this, bd("active"), this.Qx, this)
    }
    v(Qu, Dg);
    function Ru(a) {
        this.Zj = Vu(this, a.pixel, a.map);
        if (!this.ne && this.Zj) {
            this.ne = a.coordinate;
            Tu.call(this, a);
            var b = this.Ca || new C([this.Zj]);
            this.dispatchEvent(new Wu("translatestart",b,a.coordinate));
            return !0
        }
        return !1
    }
    function Uu(a) {
        if (this.ne) {
            this.ne = null;
            Tu.call(this, a);
            var b = this.Ca || new C([this.Zj]);
            this.dispatchEvent(new Wu("translateend",b,a.coordinate));
            return !0
        }
        return !1
    }
    function Su(a) {
        if (this.ne) {
            a = a.coordinate;
            var b = a[0] - this.ne[0]
              , c = a[1] - this.ne[1]
              , d = this.Ca || new C([this.Zj]);
            d.forEach(function(a) {
                var d = a.I();
                d.translate(b, c);
                a.Ab(d)
            });
            this.ne = a;
            this.dispatchEvent(new Wu("translating",d,a))
        }
    }
    function Tu(a) {
        var b = a.map.Sa;
        Vu(this, a.pixel, a.map) ? (b.classList.remove(this.ne ? "ol-grab" : "ol-grabbing"),
        b.classList.add(this.ne ? "ol-grabbing" : "ol-grab")) : b.classList.remove("ol-grab", "ol-grabbing")
    }
    function Vu(a, b, c) {
        return c.wj(b, function(a) {
            if (!this.Ca || ra(this.Ca.ie(), a))
                return a
        }
        .bind(a), {
            layerFilter: a.ym,
            hitTolerance: a.Tf
        })
    }
    h = Qu.prototype;
    h.$o = function() {
        return this.Tf
    }
    ;
    h.wq = function(a) {
        this.Tf = a
    }
    ;
    h.setMap = function(a) {
        var b = this.B();
        Dg.prototype.setMap.call(this, a);
        this.Yk(b)
    }
    ;
    h.Qx = function() {
        this.Yk(null)
    }
    ;
    h.Yk = function(a) {
        var b = this.B()
          , c = this.Va();
        b && c || (b = b || a) && b.Sa.classList.remove("ol-grab", "ol-grabbing")
    }
    ;
    function Wu(a, b, c) {
        Wc.call(this, a);
        this.features = b;
        this.coordinate = c
    }
    v(Wu, Wc);
    function W(a) {
        a = a ? a : {};
        var b = yb({}, a);
        delete b.gradient;
        delete b.radius;
        delete b.blur;
        delete b.shadow;
        delete b.weight;
        T.call(this, b);
        this.Zl = null;
        this.Gu = void 0 !== a.shadow ? a.shadow : 250;
        this.Nr = void 0;
        this.Dq = null;
        y(this, bd(Xu), this.$x, this);
        this.wu(a.gradient ? a.gradient : Yu);
        this.qu(void 0 !== a.blur ? a.blur : 15);
        this.mh(void 0 !== a.radius ? a.radius : 8);
        y(this, bd(Zu), this.mp, this);
        y(this, bd($u), this.mp, this);
        this.mp();
        var c = a.weight ? a.weight : "weight";
        var d = "string" === typeof c ? function(a) {
            return a.get(c)
        }
        : c;
        this.Gb(function(a) {
            a = d(a);
            a = void 0 !== a ? Ia(a, 0, 1) : 1;
            var b = 255 * a | 0
              , c = this.Dq[b];
            c || (c = [new Qk({
                image: new Sn({
                    opacity: a,
                    src: this.Nr
                })
            })],
            this.Dq[b] = c);
            return c
        }
        .bind(this));
        this.set(yt, null);
        y(this, "render", this.sy, this)
    }
    v(W, T);
    var Yu = ["#00f", "#0ff", "#0f0", "#ff0", "#f00"];
    h = W.prototype;
    h.As = function() {
        return this.get(Zu)
    }
    ;
    h.Is = function() {
        return this.get(Xu)
    }
    ;
    h.wc = function() {
        return this.get($u)
    }
    ;
    h.$x = function() {
        for (var a = this.Is(), b = pd(1, 256), c = b.createLinearGradient(0, 0, 1, 256), d = 1 / (a.length - 1), e = 0, f = a.length; e < f; ++e)
            c.addColorStop(e * d, a[e]);
        b.fillStyle = c;
        b.fillRect(0, 0, 1, 256);
        this.Zl = b.getImageData(0, 0, 1, 256).data
    }
    ;
    h.mp = function() {
        var a = this.wc()
          , b = this.As()
          , c = a + b + 1
          , d = 2 * c;
        d = pd(d, d);
        d.shadowOffsetX = d.shadowOffsetY = this.Gu;
        d.shadowBlur = b;
        d.shadowColor = "#000";
        d.beginPath();
        b = c - this.Gu;
        d.arc(b, b, a, 0, 2 * Math.PI, !0);
        d.fill();
        this.Nr = d.canvas.toDataURL();
        this.Dq = Array(256);
        this.a()
    }
    ;
    h.sy = function(a) {
        a = a.context;
        var b = a.canvas;
        b = a.getImageData(0, 0, b.width, b.height);
        var c = b.data, d, e;
        var f = 0;
        for (d = c.length; f < d; f += 4)
            if (e = 4 * c[f + 3])
                c[f] = this.Zl[e],
                c[f + 1] = this.Zl[e + 1],
                c[f + 2] = this.Zl[e + 2];
        a.putImageData(b, 0, 0)
    }
    ;
    h.qu = function(a) {
        this.set(Zu, a)
    }
    ;
    h.wu = function(a) {
        this.set(Xu, a)
    }
    ;
    h.mh = function(a) {
        this.set($u, a)
    }
    ;
    var Zu = "blur"
      , Xu = "gradient"
      , $u = "radius";
    function av(a) {
        rt.call(this, a);
        this.wo = Ah();
        this.Ld = null
    }
    v(av, rt);
    av.prototype.Ch = function(a, b, c) {
        this.Rc("precompose", c, a, void 0);
        var d = this.N();
        if (d) {
            var e = b.extent
              , f = void 0 !== e && !ab(e, a.extent) && vb(e, a.extent);
            f && this.clip(c, a, e);
            e = this.pm;
            var g = c.globalAlpha;
            c.globalAlpha = b.opacity;
            c.drawImage(d, 0, 0, +d.width, +d.height, Math.round(e[4]), Math.round(e[5]), Math.round(d.width * e[0]), Math.round(d.height * e[3]));
            c.globalAlpha = g;
            f && c.restore()
        }
        this.Wm(c, a, b)
    }
    ;
    av.prototype.Ta = function(a, b, c, d, e) {
        var f = this.ka();
        return f.Y().Ta(a, b.viewState.resolution, b.viewState.rotation, c, b.qh, function(a) {
            return d.call(e, a, f)
        })
    }
    ;
    av.prototype.Ko = function(a, b, c, d) {
        if (this.N()) {
            if (this.ka().Y().Ta !== Ba)
                return rt.prototype.Ko.apply(this, arguments);
            var e = Fh(this.wo, a.slice());
            hf(e, b.viewState.resolution / this.gh);
            this.Ld || (this.Ld = pd(1, 1));
            this.Ld.clearRect(0, 0, 1, 1);
            this.Ld.drawImage(this.N(), e[0], e[1], 1, 1, 0, 0, 1, 1);
            e = this.Ld.getImageData(0, 0, 1, 1).data;
            if (0 < e[3])
                return c.call(d, this.ka(), e)
        }
    }
    ;
    function bv(a) {
        av.call(this, a);
        this.s = null;
        this.pm = Ah()
    }
    v(bv, av);
    bv.prototype.N = function() {
        return this.s ? this.s.N() : null
    }
    ;
    bv.prototype.ue = function(a, b) {
        var c = a.pixelRatio
          , d = a.size
          , e = a.viewState
          , f = e.center
          , g = e.resolution
          , k = this.ka().Y()
          , l = a.Dd
          , m = a.extent;
        void 0 !== b.extent && (m = ub(m, b.extent));
        l[0] || l[1] || pb(m) || (b = k.N(m, g, c, e.projection)) && lt(this, b) && (this.s = b);
        if (this.s) {
            b = this.s;
            l = b.c();
            m = b.O();
            e = b.Wa;
            var n = c * m / (g * e);
            l = Jh(this.pm, c * d[0] / 2, c * d[1] / 2, n, n, 0, e * (l[0] - f[0]) / m, e * (f[1] - l[3]) / m);
            Jh(this.wo, c * d[0] / 2 - l[4], c * d[1] / 2 - l[5], c / g, -c / g, 0, -f[0], -f[1]);
            nt(a.attributions, b.Nb);
            ot(a, k);
            this.gh = g * c / e
        }
        return !!this.s
    }
    ;
    function cv(a, b, c, d) {
        var e = qc(c, b, a);
        c = dc(b, d, c);
        b = b.Mg();
        void 0 !== b && (c *= b);
        b = a.Mg();
        void 0 !== b && (c /= b);
        b = a.c();
        if (!b || Za(b, e))
            a = dc(a, c, e) / c,
            isFinite(a) && 0 < a && (c /= a);
        return c
    }
    function dv(a, b, c, d) {
        a = c - a;
        b = d - b;
        var e = Math.sqrt(a * a + b * b);
        return [Math.round(c + a / e), Math.round(d + b / e)]
    }
    function ev(a, b, c, d, e, f, g, k, l, m, n) {
        var p = pd(Math.round(c * a), Math.round(c * b));
        if (0 === l.length)
            return p.canvas;
        p.scale(c, c);
        var q = Ua();
        l.forEach(function(a) {
            ib(q, a.extent)
        });
        var t = pd(Math.round(c * qb(q) / d), Math.round(c * rb(q) / d))
          , u = c / d;
        l.forEach(function(a) {
            t.drawImage(a.image, m, m, a.image.width - 2 * m, a.image.height - 2 * m, (a.extent[0] - q[0]) * u, -(a.extent[3] - q[3]) * u, qb(a.extent) * u, rb(a.extent) * u)
        });
        var x = nb(g);
        k.og.forEach(function(a) {
            var b = a.source
              , e = a.target
              , g = b[1][0]
              , k = b[1][1]
              , l = b[2][0]
              , m = b[2][1];
            a = (e[0][0] - x[0]) / f;
            var n = -(e[0][1] - x[1]) / f
              , u = (e[1][0] - x[0]) / f
              , B = -(e[1][1] - x[1]) / f
              , Pb = (e[2][0] - x[0]) / f
              , Jb = -(e[2][1] - x[1]) / f;
            e = b[0][0];
            b = b[0][1];
            g -= e;
            k -= b;
            l -= e;
            m -= b;
            a: {
                g = [[g, k, 0, 0, u - a], [l, m, 0, 0, Pb - a], [0, 0, g, k, B - n], [0, 0, l, m, Jb - n]];
                k = g.length;
                for (l = 0; l < k; l++) {
                    m = l;
                    for (var Ca = Math.abs(g[l][l]), Zb = l + 1; Zb < k; Zb++) {
                        var yc = Math.abs(g[Zb][l]);
                        yc > Ca && (Ca = yc,
                        m = Zb)
                    }
                    if (0 === Ca) {
                        g = null;
                        break a
                    }
                    Ca = g[m];
                    g[m] = g[l];
                    g[l] = Ca;
                    for (m = l + 1; m < k; m++)
                        for (Ca = -g[m][l] / g[l][l],
                        Zb = l; Zb < k + 1; Zb++)
                            g[m][Zb] = l == Zb ? 0 : g[m][Zb] + Ca * g[l][Zb]
                }
                l = Array(k);
                for (m = k - 1; 0 <= m; m--)
                    for (l[m] = g[m][k] / g[m][m],
                    Ca = m - 1; 0 <= Ca; Ca--)
                        g[Ca][k] -= g[Ca][m] * l[m];
                g = l
            }
            g && (p.save(),
            p.beginPath(),
            l = (a + u + Pb) / 3,
            m = (n + B + Jb) / 3,
            k = dv(l, m, a, n),
            u = dv(l, m, u, B),
            Pb = dv(l, m, Pb, Jb),
            p.moveTo(u[0], u[1]),
            p.lineTo(k[0], k[1]),
            p.lineTo(Pb[0], Pb[1]),
            p.clip(),
            p.transform(g[0], g[2], g[1], g[3], a, n),
            p.translate(q[0] - e, q[3] - b),
            p.scale(d / c, -d / c),
            p.drawImage(t.canvas, 0, 0),
            p.restore())
        });
        n && (p.save(),
        p.strokeStyle = "black",
        p.lineWidth = 1,
        k.og.forEach(function(a) {
            var b = a.target;
            a = (b[0][0] - x[0]) / f;
            var c = -(b[0][1] - x[1]) / f
              , d = (b[1][0] - x[0]) / f
              , e = -(b[1][1] - x[1]) / f
              , g = (b[2][0] - x[0]) / f;
            b = -(b[2][1] - x[1]) / f;
            p.beginPath();
            p.moveTo(d, e);
            p.lineTo(a, c);
            p.lineTo(g, b);
            p.closePath();
            p.stroke()
        }),
        p.restore());
        return p.canvas
    }
    ;function fv(a, b, c, d, e) {
        this.lg = a;
        this.Hi = b;
        var f = {}
          , g = oc(this.Hi, this.lg);
        this.uf = function(a) {
            var b = a[0] + "/" + a[1];
            f[b] || (f[b] = g(a));
            return f[b]
        }
        ;
        this.Nm = d;
        this.Aw = e * e;
        this.og = [];
        this.mv = !1;
        this.mw = this.lg.Bf && !!d && !!this.lg.c() && qb(d) == qb(this.lg.c());
        this.$d = this.lg.c() ? qb(this.lg.c()) : null;
        this.Qu = this.Hi.c() ? qb(this.Hi.c()) : null;
        a = nb(c);
        b = mb(c);
        d = lb(c);
        c = kb(c);
        e = this.uf(a);
        var k = this.uf(b)
          , l = this.uf(d)
          , m = this.uf(c);
        gv(this, a, b, d, c, e, k, l, m, 10);
        if (this.mv) {
            var n = Infinity;
            this.og.forEach(function(a) {
                n = Math.min(n, a.source[0][0], a.source[1][0], a.source[2][0])
            });
            this.og.forEach(function(a) {
                if (Math.max(a.source[0][0], a.source[1][0], a.source[2][0]) - n > this.$d / 2) {
                    var b = [[a.source[0][0], a.source[0][1]], [a.source[1][0], a.source[1][1]], [a.source[2][0], a.source[2][1]]];
                    b[0][0] - n > this.$d / 2 && (b[0][0] -= this.$d);
                    b[1][0] - n > this.$d / 2 && (b[1][0] -= this.$d);
                    b[2][0] - n > this.$d / 2 && (b[2][0] -= this.$d);
                    Math.max(b[0][0], b[1][0], b[2][0]) - Math.min(b[0][0], b[1][0], b[2][0]) < this.$d / 2 && (a.source = b)
                }
            }, this)
        }
        f = {}
    }
    function gv(a, b, c, d, e, f, g, k, l, m) {
        var n = Ta([f, g, k, l])
          , p = a.$d ? qb(n) / a.$d : null
          , q = a.$d
          , t = a.lg.Bf && .5 < p && 1 > p
          , u = !1;
        if (0 < m) {
            if (a.Hi.Pg && a.Qu) {
                var x = Ta([b, c, d, e]);
                u |= .25 < qb(x) / a.Qu
            }
            !t && a.lg.Pg && p && (u |= .25 < p)
        }
        if (u || !a.Nm || vb(n, a.Nm)) {
            if (!(u || isFinite(f[0]) && isFinite(f[1]) && isFinite(g[0]) && isFinite(g[1]) && isFinite(k[0]) && isFinite(k[1]) && isFinite(l[0]) && isFinite(l[1])))
                if (0 < m)
                    u = !0;
                else
                    return;
            if (0 < m && (u || (n = a.uf([(b[0] + d[0]) / 2, (b[1] + d[1]) / 2]),
            q = t ? (Oa(f[0], q) + Oa(k[0], q)) / 2 - Oa(n[0], q) : (f[0] + k[0]) / 2 - n[0],
            n = (f[1] + k[1]) / 2 - n[1],
            u = q * q + n * n > a.Aw),
            u)) {
                Math.abs(b[0] - d[0]) <= Math.abs(b[1] - d[1]) ? (t = [(c[0] + d[0]) / 2, (c[1] + d[1]) / 2],
                q = a.uf(t),
                n = [(e[0] + b[0]) / 2, (e[1] + b[1]) / 2],
                p = a.uf(n),
                gv(a, b, c, t, n, f, g, q, p, m - 1),
                gv(a, n, t, d, e, p, q, k, l, m - 1)) : (t = [(b[0] + c[0]) / 2, (b[1] + c[1]) / 2],
                q = a.uf(t),
                n = [(d[0] + e[0]) / 2, (d[1] + e[1]) / 2],
                p = a.uf(n),
                gv(a, b, t, n, e, f, q, p, l, m - 1),
                gv(a, t, c, d, n, q, g, k, p, m - 1));
                return
            }
            if (t) {
                if (!a.mw)
                    return;
                a.mv = !0
            }
            a.og.push({
                source: [f, k, l],
                target: [b, d, e]
            });
            a.og.push({
                source: [f, g, k],
                target: [b, c, d]
            })
        }
    }
    function hv(a) {
        var b = Ua();
        a.og.forEach(function(a) {
            a = a.source;
            Va(b, a[0]);
            Va(b, a[1]);
            Va(b, a[2])
        });
        return b
    }
    ;function iv(a, b, c, d, e, f) {
        this.Hi = b;
        this.Nm = a.c();
        var g = b.c()
          , k = g ? ub(c, g) : c;
        g = cv(a, b, sb(k), d);
        this.Mi = new fv(a,b,k,this.Nm,.5 * g);
        this.Gq = d;
        this.Fq = c;
        a = hv(this.Mi);
        this.Ju = (this.Ad = f(a, g, e)) ? this.Ad.Wa : 1;
        this.Kk = this.J = null;
        e = 2;
        f = [];
        this.Ad && (e = 0,
        f = this.Ad.Nb);
        vs.call(this, c, d, this.Ju, e, f)
    }
    v(iv, vs);
    h = iv.prototype;
    h.la = function() {
        1 == this.state && (Mc(this.Kk),
        this.Kk = null);
        vs.prototype.la.call(this)
    }
    ;
    h.N = function() {
        return this.J
    }
    ;
    h.M = function() {
        return this.Hi
    }
    ;
    h.Ck = function() {
        var a = this.Ad.getState();
        2 == a && (this.J = ev(qb(this.Fq) / this.Gq, rb(this.Fq) / this.Gq, this.Ju, this.Ad.O(), 0, this.Gq, this.Fq, this.Mi, [{
            extent: this.Ad.c(),
            image: this.Ad.N()
        }], 0));
        this.state = a;
        this.a()
    }
    ;
    h.load = function() {
        if (0 == this.state) {
            this.state = 1;
            this.a();
            var a = this.Ad.getState();
            2 == a || 3 == a ? this.Ck() : (this.Kk = y(this.Ad, "change", function() {
                var a = this.Ad.getState();
                if (2 == a || 3 == a)
                    Mc(this.Kk),
                    this.Kk = null,
                    this.Ck()
            }, this),
            this.Ad.load())
        }
    }
    ;
    function jv(a) {
        Ht.call(this, {
            attributions: a.attributions,
            extent: a.extent,
            logo: a.logo,
            projection: a.projection,
            state: a.state
        });
        this.zb = void 0 !== a.resolutions ? a.resolutions : null;
        this.jf = null;
        this.lu = 0
    }
    v(jv, Ht);
    jv.prototype.Jd = function() {
        return this.zb
    }
    ;
    function kv(a, b) {
        a.zb && (b = a.zb[sa(a.zb, b, 0)]);
        return b
    }
    jv.prototype.N = function(a, b, c, d) {
        var e = this.M();
        if (e && d && !nc(e, d)) {
            if (this.jf) {
                if (this.lu == this.Z && nc(this.jf.M(), d) && this.jf.O() == b && hb(this.jf.c(), a))
                    return this.jf;
                Vc(this.jf);
                this.jf = null
            }
            this.jf = new iv(e,d,a,b,c,function(a, b, c) {
                return this.Jg(a, b, c, e)
            }
            .bind(this));
            this.lu = this.Z;
            return this.jf
        }
        e && (d = e);
        return this.Jg(a, b, c, d)
    }
    ;
    jv.prototype.bi = function(a) {
        a = a.target;
        switch (a.getState()) {
        case 1:
            this.dispatchEvent(new lv(mv,a));
            break;
        case 2:
            this.dispatchEvent(new lv(nv,a));
            break;
        case 3:
            this.dispatchEvent(new lv(ov,a))
        }
    }
    ;
    function pv(a, b) {
        a.N().src = b
    }
    function lv(a, b) {
        Wc.call(this, a);
        this.image = b
    }
    v(lv, Wc);
    var mv = "imageloadstart"
      , nv = "imageloadend"
      , ov = "imageloaderror";
    function qv(a) {
        jv.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: a.projection,
            resolutions: a.resolutions,
            state: a.state
        });
        this.ow = a.canvasFunction;
        this.J = null;
        this.bb = 0;
        this.Sd = void 0 !== a.ratio ? a.ratio : 1.5
    }
    v(qv, jv);
    qv.prototype.Jg = function(a, b, c, d) {
        b = kv(this, b);
        var e = this.J;
        if (e && this.bb == this.Z && e.O() == b && e.Wa == c && ab(e.c(), a))
            return e;
        a = a.slice();
        wb(a, this.Sd);
        (d = this.ow(a, b, c, [qb(a) / b * c, rb(a) / b * c], d)) && (e = new xs(a,b,c,this.Nb,d));
        this.J = e;
        this.bb = this.Z;
        return e
    }
    ;
    function rv(a) {
        this.da = a.source;
        this.qb = Ah();
        this.aj = pd();
        this.Al = [0, 0];
        this.dd = void 0 == a.renderBuffer ? 100 : a.renderBuffer;
        this.yb = null;
        qv.call(this, {
            attributions: a.attributions,
            canvasFunction: this.nw.bind(this),
            logo: a.logo,
            projection: a.projection,
            ratio: a.ratio,
            resolutions: a.resolutions,
            state: this.da.getState()
        });
        this.Lc = null;
        this.Ce = void 0;
        this.Gb(a.style);
        y(this.da, "change", this.lp, this)
    }
    v(rv, qv);
    h = rv.prototype;
    h.nw = function(a, b, c, d, e) {
        var f = new ct(.5 * b / c,a,b,this.da.ri,this.dd);
        this.da.loadFeatures(a, b, e);
        var g = !1;
        this.da.forEachFeatureInExtent(a, function(a) {
            var d;
            if (!(d = g)) {
                var e;
                (d = a.Xb()) ? e = d.call(a, b) : this.Ce && (e = this.Ce(a, b));
                if (e) {
                    var k, p = !1;
                    Array.isArray(e) || (e = [e]);
                    d = 0;
                    for (k = e.length; d < k; ++d)
                        p = ut(f, a, e[d], tt(b, c), this.jp, this) || p;
                    d = p
                } else
                    d = !1
            }
            g = d
        }, this);
        f.finish();
        if (g)
            return null;
        this.Al[0] != d[0] || this.Al[1] != d[1] ? (this.aj.canvas.width = d[0],
        this.aj.canvas.height = d[1],
        this.Al[0] = d[0],
        this.Al[1] = d[1]) : this.aj.clearRect(0, 0, d[0], d[1]);
        a = sv(this, sb(a), b, c, d);
        f.jb(this.aj, c, a, 0, {});
        this.yb = f;
        return this.aj.canvas
    }
    ;
    h.Ta = function(a, b, c, d, e, f) {
        if (this.yb) {
            var g = {};
            return this.yb.Ta(a, b, 0, d, e, function(a) {
                var b = w(a).toString();
                if (!(b in g))
                    return g[b] = !0,
                    f(a)
            })
        }
    }
    ;
    h.Y = function() {
        return this.da
    }
    ;
    h.Ye = function() {
        return this.Lc
    }
    ;
    h.Xb = function() {
        return this.Ce
    }
    ;
    function sv(a, b, c, d, e) {
        c = d / c;
        return Jh(a.qb, e[0] / 2, e[1] / 2, c, -c, 0, -b[0], -b[1])
    }
    h.jp = function() {
        this.a()
    }
    ;
    h.lp = function() {
        this.Fb(this.da.getState())
    }
    ;
    h.Gb = function(a) {
        this.Lc = void 0 !== a ? a : Uk;
        this.Ce = a ? Sk(this.Lc) : void 0;
        this.a()
    }
    ;
    function tv(a, b) {
        Et.call(this, a, b);
        this.km = this.Ld = this.s = null
    }
    v(tv, Et);
    function uv(a, b) {
        b = b.N();
        return Li(a.ud.sa, b)
    }
    tv.prototype.Ta = function(a, b, c, d, e) {
        var f = this.ka();
        return f.Y().Ta(a, b.viewState.resolution, b.viewState.rotation, c, b.qh, function(a) {
            return d.call(e, a, f)
        })
    }
    ;
    tv.prototype.ue = function(a, b) {
        var c = this.ud.sa
          , d = a.pixelRatio
          , e = a.viewState
          , f = e.center
          , g = e.resolution
          , k = e.rotation
          , l = this.s
          , m = this.Cd
          , n = this.ka().Y()
          , p = a.Dd
          , q = a.extent;
        void 0 !== b.extent && (q = ub(q, b.extent));
        p[0] || p[1] || pb(q) || (b = n.N(q, g, d, e.projection)) && lt(this, b) && (l = b,
        m = uv(this, b),
        this.Cd && a.Rd.push(function(a, b) {
            a.isContextLost() || a.deleteTexture(b)
        }
        .bind(null, c, this.Cd)));
        l && (c = this.ud.getContext().J,
        vv(this, c.width, c.height, d, f, g, k, l.c()),
        this.km = null,
        d = this.yn,
        Bh(d),
        Hh(d, 1, -1),
        Ih(d, 0, -1),
        this.s = l,
        this.Cd = m,
        nt(a.attributions, l.Nb),
        ot(a, n));
        return !!l
    }
    ;
    function vv(a, b, c, d, e, f, g, k) {
        b *= f;
        c *= f;
        a = a.Sp;
        Bh(a);
        Hh(a, 2 * d / b, 2 * d / c);
        Gh(a, -g);
        Ih(a, k[0] - e[0], k[1] - e[1]);
        Hh(a, (k[2] - k[0]) / 2, (k[3] - k[1]) / 2);
        Ih(a, 1, 1)
    }
    tv.prototype.af = function(a, b) {
        return void 0 !== this.Ta(a, b, 0, of, this)
    }
    ;
    tv.prototype.Mf = function(a, b, c, d) {
        if (this.s && this.s.N())
            if (this.ka().Y()instanceof rv) {
                var e = Fh(b.ti, a.slice());
                if (this.Ta(e, b, 0, of, this))
                    return c.call(d, this.ka(), null)
            } else {
                e = [this.s.N().width, this.s.N().height];
                if (!this.km) {
                    var f = b.size;
                    b = Ah();
                    Ih(b, -1, -1);
                    Hh(b, 2 / f[0], 2 / f[1]);
                    Ih(b, 0, f[1]);
                    Hh(b, 1, -1);
                    f = Kh(this.Sp.slice());
                    var g = Ah();
                    Ih(g, 0, e[1]);
                    Hh(g, 1, -1);
                    Hh(g, e[0] / 2, e[1] / 2);
                    Ih(g, 1, 1);
                    Dh(g, f);
                    Dh(g, b);
                    this.km = g
                }
                a = Fh(this.km, a.slice());
                if (!(0 > a[0] || a[0] > e[0] || 0 > a[1] || a[1] > e[1]) && (this.Ld || (this.Ld = pd(1, 1)),
                this.Ld.clearRect(0, 0, 1, 1),
                this.Ld.drawImage(this.s.N(), a[0], a[1], 1, 1, 0, 0, 1, 1),
                e = this.Ld.getImageData(0, 0, 1, 1).data,
                0 < e[3]))
                    return c.call(d, this.ka(), e)
            }
    }
    ;
    function wv(a) {
        vh.call(this, a ? a : {})
    }
    v(wv, vh);
    wv.prototype.dj = function(a) {
        var b = null
          , c = a.D();
        "canvas" === c ? b = new bv(this) : "webgl" === c && (b = new tv(a,this));
        return b
    }
    ;
    function xv(a) {
        av.call(this, a);
        this.context = null === this.context ? null : pd();
        this.Td = null;
        this.hh = [];
        this.Wk = Ua();
        this.oB = new Ga(0,0,0,0);
        this.pm = Ah();
        this.nv = 0
    }
    v(xv, av);
    function yv(a, b) {
        b = b.getState();
        a = a.ka().Zh();
        return 2 == b || 4 == b || 3 == b && !a
    }
    xv.prototype.ue = function(a, b) {
        var c = a.pixelRatio
          , d = a.size
          , e = a.viewState
          , f = e.projection
          , g = e.resolution;
        e = e.center;
        var k = this.ka()
          , l = k.Y()
          , m = l.Z
          , n = l.Cb(f)
          , p = n.Pf(g, this.nv)
          , q = n.O(p)
          , t = Math.round(g / q) || 1
          , u = a.extent;
        void 0 !== b.extent && (u = ub(u, b.extent));
        if (pb(u))
            return !1;
        var x = n.Qj(u, q);
        var B = n.ic(p);
        var z = n.O(p)
          , E = Sa(n.Zb(p), n.Li);
        B = cb(B[0] + x.ba * E[0] * z, B[1] + x.ca * E[1] * z, B[0] + (x.ea + 1) * E[0] * z, B[1] + (x.fa + 1) * E[1] * z, void 0);
        z = l.Og(c);
        E = {};
        E[p] = {};
        var G = this.xo(l, f, E), ea = this.Wk, V = this.oB, O = !1, ca, va;
        for (ca = x.ba; ca <= x.ea; ++ca)
            for (va = x.ca; va <= x.fa; ++va) {
                var A = l.ua(p, ca, va, c, f);
                3 == A.getState() && (k.Zh() ? 0 < k.Th() && (O = !0) : A.Fb(2));
                yv(this, A) || (A = zs(A));
                yv(this, A) ? 2 == A.getState() && (E[p][A.ta.toString()] = A,
                O || -1 != this.hh.indexOf(A) || (O = !0)) : Ac(n, A.ta, G, V, ea) || (A = Bc(n, A.ta, V, ea)) && G(p + 1, A)
            }
        ca = a.Dd;
        ca = ca[0] || ca[1];
        if (!(this.gh && 16 < Date.now() - a.time && ca || !O && this.Td && ab(this.Td, u) && this.fn == m && t == this.Qt && (ca || q * c / z * t == this.gh))) {
            if (ca = this.context)
                va = l.Pj(p, c, f),
                A = Math.round(x.Sb() * va[0] / t),
                va = Math.round((x.fa - x.ca + 1) * va[1] / t),
                O = ca.canvas,
                O.width != A || O.height != va ? (this.Qt = t,
                O.width = A,
                O.height = va) : (ca.clearRect(0, 0, A, va),
                t = this.Qt);
            this.hh.length = 0;
            O = Object.keys(E).map(Number);
            O.sort(qa);
            var Pb;
            V = 0;
            for (Pb = O.length; V < Pb; ++V) {
                ca = O[V];
                G = l.Pj(ca, c, f);
                A = n.O(ca);
                var Jb = A / q;
                var Ca = z * l.Wo(f);
                var Zb = E[ca];
                for (var yc in Zb) {
                    A = Zb[yc];
                    va = n.Oa(A.ta, ea);
                    ca = (va[0] - B[0]) / q * z / t;
                    va = (B[3] - va[3]) / q * z / t;
                    var ce = G[0] * Jb / t;
                    var de = G[1] * Jb / t;
                    this.Co(A, a, b, ca, va, ce, de, Ca);
                    this.hh.push(A)
                }
            }
            this.fn = m;
            this.gh = q * c / z * t;
            this.Td = B
        }
        b = this.gh / g;
        b = Jh(this.pm, c * d[0] / 2, c * d[1] / 2, b, b, 0, (this.Td[0] - e[0]) / this.gh * c, (e[1] - this.Td[3]) / this.gh * c);
        Jh(this.wo, c * d[0] / 2 - b[4], c * d[1] / 2 - b[5], c / g, -c / g, 0, -e[0], -e[1]);
        pt(a.Qi, l, p, x);
        qt(a, l, n, c, f, u, p, k.Th());
        mt(a, l);
        ot(a, l);
        return 0 < this.hh.length
    }
    ;
    xv.prototype.Co = function(a, b, c, d, e, f, g, k) {
        this.ka().Y().cp(b.viewState.projection) || this.context.clearRect(d, e, f, g);
        (a = a.N(this.ka())) && this.context.drawImage(a, k, k, a.width - 2 * k, a.height - 2 * k, d, e, f, g)
    }
    ;
    xv.prototype.N = function() {
        var a = this.context;
        return a ? a.canvas : null
    }
    ;
    function zv() {
        this.da = "precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n"
    }
    v(zv, ii);
    var Av = new zv;
    function Bv() {
        this.da = "varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n"
    }
    v(Bv, ji);
    var Cv = new Bv;
    function Dv(a, b) {
        this.Uq = a.getUniformLocation(b, "u_texture");
        this.zB = a.getUniformLocation(b, "u_tileOffset");
        this.lb = a.getAttribLocation(b, "a_position");
        this.Le = a.getAttribLocation(b, "a_texCoord")
    }
    ;function Ev(a, b) {
        Et.call(this, a, b);
        this.Ow = Av;
        this.JB = Cv;
        this.ef = null;
        this.gu = new xi([0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0]);
        this.kq = this.gn = null;
        this.bb = -1;
        this.Li = [0, 0]
    }
    v(Ev, Et);
    h = Ev.prototype;
    h.la = function() {
        this.ud.getContext().deleteBuffer(this.gu);
        Et.prototype.la.call(this)
    }
    ;
    h.xo = function(a, b, c) {
        var d = this.ud;
        return function(e, f) {
            return jt(a, b, e, f, function(a) {
                var b = ek(d.Oc, a.getKey());
                b && (c[e] || (c[e] = {}),
                c[e][a.ta.toString()] = a);
                return b
            })
        }
    }
    ;
    h.Tg = function() {
        Et.prototype.Tg.call(this);
        this.ef = null
    }
    ;
    h.ue = function(a, b, c) {
        var d = this.ud
          , e = c.sa
          , f = a.viewState
          , g = f.projection
          , k = this.ka()
          , l = k.Y()
          , m = l.Cb(g)
          , n = m.Pf(f.resolution)
          , p = m.O(n)
          , q = l.Pj(n, a.pixelRatio, g)
          , t = q[0] / Sa(m.Zb(n), this.Li)[0]
          , u = p / t
          , x = l.Og(t) * l.Wo(g)
          , B = f.center
          , z = a.extent
          , E = m.Qj(z, p);
        if (this.gn && this.gn.hs(E) && this.bb == l.Z)
            u = this.kq;
        else {
            var G = E.Ga()
              , ea = Ka(Math.max(G[0] * q[0], G[1] * q[1]));
            G = u * ea;
            var V = m.ic(n)
              , O = V[0] + E.ba * q[0] * u;
            u = V[1] + E.ca * q[1] * u;
            u = [O, u, O + G, u + G];
            this.bindFramebuffer(a, ea);
            e.viewport(0, 0, ea, ea);
            e.clearColor(0, 0, 0, 0);
            e.clear(16384);
            e.disable(3042);
            ea = Ai(c, this.Ow, this.JB);
            c.useProgram(ea);
            this.ef || (this.ef = new Dv(e,ea));
            c.bindBuffer(34962, this.gu);
            e.enableVertexAttribArray(this.ef.lb);
            e.vertexAttribPointer(this.ef.lb, 2, 5126, !1, 16, 0);
            e.enableVertexAttribArray(this.ef.Le);
            e.vertexAttribPointer(this.ef.Le, 2, 5126, !1, 16, 8);
            e.uniform1i(this.ef.Uq, 0);
            c = {};
            c[n] = {};
            var ca = this.xo(l, g, c)
              , va = k.Zh();
            ea = !0;
            O = Ua();
            var A = new Ga(0,0,0,0), Pb, Jb;
            for (Pb = E.ba; Pb <= E.ea; ++Pb)
                for (Jb = E.ca; Jb <= E.fa; ++Jb) {
                    V = l.ua(n, Pb, Jb, t, g);
                    if (void 0 !== b.extent) {
                        var Ca = m.Oa(V.ta, O);
                        if (!vb(Ca, b.extent))
                            continue
                    }
                    Ca = V.getState();
                    (Ca = 2 == Ca || 4 == Ca || 3 == Ca && !va) || (V = zs(V));
                    Ca = V.getState();
                    if (2 == Ca) {
                        if (ek(d.Oc, V.getKey())) {
                            c[n][V.ta.toString()] = V;
                            continue
                        }
                    } else if (4 == Ca || 3 == Ca && !va)
                        continue;
                    ea = !1;
                    Ca = Ac(m, V.ta, ca, A, O);
                    Ca || (V = Bc(m, V.ta, A, O)) && ca(n + 1, V)
                }
            b = Object.keys(c).map(Number);
            b.sort(qa);
            ca = new Float32Array(4);
            var Zb;
            va = 0;
            for (A = b.length; va < A; ++va)
                for (Zb in Pb = c[b[va]],
                Pb)
                    V = Pb[Zb],
                    Ca = m.Oa(V.ta, O),
                    ca[0] = 2 * (Ca[2] - Ca[0]) / G,
                    ca[1] = 2 * (Ca[3] - Ca[1]) / G,
                    ca[2] = 2 * (Ca[0] - u[0]) / G - 1,
                    ca[3] = 2 * (Ca[1] - u[1]) / G - 1,
                    e.uniform4fv(this.ef.zB, ca),
                    gk(d, V, q, x * t),
                    e.drawArrays(5, 0, 4);
            ea ? (this.gn = E,
            this.kq = u,
            this.bb = l.Z) : (this.kq = this.gn = null,
            this.bb = -1,
            a.rb = !0)
        }
        pt(a.Qi, l, n, E);
        var yc = d.Vk;
        qt(a, l, m, t, g, z, n, k.Th(), function(a) {
            2 != a.getState() || ek(d.Oc, a.getKey()) || yc.zp(a.getKey()) || yc.enqueue([a, m.Oj(a.ta), m.O(a.ta[0]), q, x * t])
        }, this);
        mt(a, l);
        ot(a, l);
        e = this.yn;
        Bh(e);
        Ih(e, (Math.round(B[0] / p) * p - u[0]) / (u[2] - u[0]), (Math.round(B[1] / p) * p - u[1]) / (u[3] - u[1]));
        0 !== f.rotation && Gh(e, f.rotation);
        Hh(e, a.size[0] * f.resolution / (u[2] - u[0]), a.size[1] * f.resolution / (u[3] - u[1]));
        Ih(e, -.5, -.5);
        return !0
    }
    ;
    h.Mf = function(a, b, c, d) {
        if (this.Mh) {
            a = Fh(this.yn, [a[0] / b.size[0], (b.size[1] - a[1]) / b.size[1]].slice());
            a = [a[0] * this.Nh, a[1] * this.Nh];
            b = this.ud.getContext().sa;
            b.bindFramebuffer(b.FRAMEBUFFER, this.Mh);
            var e = new Uint8Array(4);
            b.readPixels(a[0], a[1], 1, 1, b.RGBA, b.UNSIGNED_BYTE, e);
            if (0 < e[3])
                return c.call(d, this.ka(), e)
        }
    }
    ;
    function Fv(a) {
        a = a ? a : {};
        var b = yb({}, a);
        delete b.preload;
        delete b.useInterimTilesOnError;
        vh.call(this, b);
        this.Gk(void 0 !== a.preload ? a.preload : 0);
        this.Hk(void 0 !== a.useInterimTilesOnError ? a.useInterimTilesOnError : !0)
    }
    v(Fv, vh);
    h = Fv.prototype;
    h.dj = function(a) {
        var b = null
          , c = a.D();
        "canvas" === c ? b = new xv(this) : "webgl" === c && (b = new Ev(a,this));
        return b
    }
    ;
    h.Th = function() {
        return this.get("preload")
    }
    ;
    h.Gk = function(a) {
        this.set("preload", a)
    }
    ;
    h.Zh = function() {
        return this.get("useInterimTilesOnError")
    }
    ;
    h.Hk = function(a) {
        this.set("useInterimTilesOnError", a)
    }
    ;
    function Gv(a) {
        this.context = null;
        xv.call(this, a);
        this.rc = !1;
        this.Mq = Ah();
        this.nv = "vector" == a.en ? 1 : 0
    }
    v(Gv, xv);
    var Hv = {
        image: ["Polygon", "Circle", "LineString", "Image", "Text"],
        hybrid: ["Polygon", "LineString"]
    }
      , Iv = {
        image: ["Default"],
        hybrid: ["Image", "Text", "Default"],
        vector: fi
    };
    h = Gv.prototype;
    h.ue = function(a, b) {
        var c = this.ka()
          , d = c.Z;
        this.CA != d && (this.hh.length = 0,
        c = c.en,
        this.context || "vector" == c || (this.context = pd()),
        this.context && "vector" == c && (this.context = null));
        this.CA = d;
        return xv.prototype.ue.apply(this, arguments)
    }
    ;
    h.Co = function(a, b) {
        var c = a
          , d = b
          , e = this.ka()
          , f = d.pixelRatio;
        d = d.viewState.projection;
        var g = e.Z
          , k = e.get(yt) || null
          , l = Jv(c, e);
        if (l.oj || l.fn != g || l.lq != k) {
            var m = e.Y()
              , n = m.tileGrid
              , p = m.Cb(d)
              , q = p.O(c.ta[0]);
            p = p.Oa(c.Zq);
            for (var t = 0, u = c.gc.length; t < u; ++t) {
                var x = c.ua(c.gc[t]);
                l.oj = !1;
                var B = x.ta
                  , z = x.M()
                  , E = n.O(x.ta[0])
                  , G = n.Oa(B)
                  , ea = ub(p, G);
                if ("tile-pixels" == z.pd()) {
                    var V = B = Kv(m, x);
                    E = Jh(this.Mq, 0, 0, 1 / E * V, -1 / E * V, 0, -G[0], -G[3]);
                    E = Fh(E, [ea[0], ea[3]]).concat(Fh(E, [ea[2], ea[1]]))
                } else if (B = q,
                E = ea,
                !nc(d, z)) {
                    var O = !0;
                    x.lf(d)
                }
                l.oj = !1;
                E = new ct(0,E,B,m.ri,e.dd);
                B = tt(B, f);
                ea = x.getFeatures();
                k && k !== l.lq && ea.sort(k);
                G = 0;
                for (V = ea.length; G < V; ++G) {
                    var ca = ea[G];
                    O && ca.I().transform(z, d);
                    var va = void 0
                      , A = ca.Xb();
                    A ? va = A.call(ca, q) : (A = e.Xb()) && (va = A(ca, q));
                    va && (Array.isArray(va) || (va = [va]),
                    va = this.yk(ca, B, va, E),
                    this.rc = this.rc || va,
                    l.oj = l.oj || va)
                }
                E.finish();
                z = c.ta.toString();
                x.oq[w(e) + "," + z] = E
            }
            l.fn = g;
            l.lq = k
        }
        if (this.context) {
            m = b;
            e = this.ka();
            O = Jv(c, e);
            d = e.Z;
            if ((f = Hv[e.en]) && O.mq !== d)
                for (O.mq = d,
                n = c.Zq,
                p = n[0],
                O = m.pixelRatio,
                d = e.Y(),
                g = d.tileGrid,
                q = d.Cb(m.viewState.projection),
                k = q.O(p),
                l = c.getContext(e),
                m = d.Pj(p, O, m.viewState.projection),
                l.canvas.width = m[0],
                l.canvas.height = m[1],
                m = q.Oa(n),
                n = 0,
                q = c.gc.length; n < q; ++n)
                    p = c.ua(c.gc[n]),
                    t = Kv(d, p),
                    z = p.ta,
                    x = O / k,
                    u = Bh(this.Mq),
                    "tile-pixels" == p.M().pd() ? (x = g.Oa(z, this.Wk),
                    z = g.O(z[0]),
                    E = O / t * z / k,
                    Hh(u, E, E),
                    Ih(u, Math.round((x[0] - m[0]) / z * t), Math.round((m[3] - x[3]) / z * t))) : (Hh(u, x, -x),
                    Ih(u, -m[0], -m[3])),
                    Lv(p, e, c.ta.toString()).jb(l, O, u, 0, {}, f, !0);
            xv.prototype.Co.apply(this, arguments)
        }
    }
    ;
    h.Ta = function(a, b, c, d, e) {
        var f = b.viewState.resolution
          , g = b.viewState.rotation;
        c = void 0 == c ? 0 : c;
        var k = this.ka()
          , l = {}
          , m = this.hh
          , n = k.Y();
        b = n.Cb(b.viewState.projection);
        var p = n.tileGrid, q;
        var t = 0;
        for (q = m.length; t < q; ++t) {
            var u = m[t];
            var x = u.ta;
            var B = b.Oa(x, this.Wk);
            var z = Wa(B, c * f, z);
            if (Za(z, a)) {
                B = 0;
                for (var E = u.gc.length; B < E; ++B) {
                    var G = u.ua(u.gc[B]);
                    if ("tile-pixels" === G.M().pd()) {
                        var ea = G.ta;
                        f = p.Oa(ea, this.Wk);
                        var V = nb(f);
                        f = Kv(n, G);
                        ea = p.O(ea[0]);
                        var O = ea / f;
                        V = [(a[0] - V[0]) / O, (V[1] - a[1]) / O];
                        ea = b.O(x[0]) / ea;
                        f *= ea
                    } else
                        V = a;
                    G = Lv(G, k, u.ta.toString());
                    var ca = ca || G.Ta(V, f, g, c, {}, function(a) {
                        var b = w(a).toString();
                        if (!(b in l))
                            return l[b] = !0,
                            d.call(e, a, k)
                    })
                }
            }
        }
        return ca
    }
    ;
    function Kv(a, b) {
        return qb(b.c()) / Sa(a.tileGrid.Zb(b.ta[0]))[0]
    }
    h.Sf = function() {
        kt(this)
    }
    ;
    h.Wm = function(a, b, c) {
        var d = this.ka()
          , e = d.Y()
          , f = d.en
          , g = Iv[f]
          , k = b.pixelRatio
          , l = b.viewState.rotation
          , m = b.size
          , n = Math.round(k * m[0] / 2);
        m = Math.round(k * m[1] / 2);
        for (var p = this.hh, q = e.tileGrid, t = e.Cb(b.viewState.projection), u = [], x = [], B = p.length - 1; 0 <= B; --B) {
            var z = p[B];
            if (5 != z.getState())
                for (var E = z.ta, G = t.Oa(E)[0] - t.Oa(z.Zq)[0], ea = 0, V = z.gc.length; ea < V; ++ea) {
                    var O = z.ua(z.gc[ea]), ca = Kv(e, O), va = Lv(O, d, E.toString()), A;
                    if (!(A = "vector" == f))
                        a: {
                            A = void 0;
                            for (A in va.cb)
                                for (var Pb = va.cb[A], Jb = 0, Ca = g.length; Jb < Ca; ++Jb)
                                    if (g[Jb]in Pb) {
                                        A = !0;
                                        break a
                                    }
                            A = !1
                        }
                    if (A) {
                        A = O.ta[0];
                        Pb = q.O(A);
                        Jb = O;
                        O = b;
                        if ("tile-pixels" == Jb.M().pd()) {
                            Ca = this.ka().Y();
                            var Zb = Ca.tileGrid
                              , yc = Jb.ta;
                            Jb = Zb.O(yc[0]) / Kv(Ca, Jb);
                            Ca = O.viewState;
                            var ce = O.pixelRatio
                              , de = Ca.resolution / ce;
                            yc = Zb.Oa(yc, this.Wk);
                            Zb = Ca.center;
                            yc = nb(yc);
                            O = O.size;
                            O = Jh(this.Mq, Math.round(ce * O[0] / 2), Math.round(ce * O[1] / 2), Jb / de, Jb / de, Ca.rotation, (yc[0] - Zb[0]) / Jb, (Zb[1] - yc[1]) / Jb)
                        } else
                            O = this.Nf(O, 0);
                        Ih(O, G * ca / Pb, 0);
                        ca = gt(va, O);
                        a.save();
                        a.globalAlpha = c.opacity;
                        Uh(a, -l, n, m);
                        Pb = 0;
                        for (Jb = u.length; Pb < Jb; ++Pb)
                            Ca = u[Pb],
                            A < x[Pb] && (a.beginPath(),
                            a.moveTo(ca[0], ca[1]),
                            a.lineTo(ca[2], ca[3]),
                            a.lineTo(ca[4], ca[5]),
                            a.lineTo(ca[6], ca[7]),
                            a.moveTo(Ca[6], Ca[7]),
                            a.lineTo(Ca[4], Ca[5]),
                            a.lineTo(Ca[2], Ca[3]),
                            a.lineTo(Ca[0], Ca[1]),
                            a.clip());
                        va.jb(a, k, O, l, {}, g);
                        a.restore();
                        u.push(ca);
                        x.push(A)
                    }
                }
        }
        xv.prototype.Wm.apply(this, arguments)
    }
    ;
    h.yk = function(a, b, c, d) {
        if (!c)
            return !1;
        var e = !1;
        if (Array.isArray(c))
            for (var f = 0, g = c.length; f < g; ++f)
                e = ut(d, a, c[f], b, this.Sf, this) || e;
        else
            e = ut(d, a, c, b, this.Sf, this) || e;
        return e
    }
    ;
    function Mv(a) {
        a = a ? a : {};
        var b = yb({}, a);
        delete b.preload;
        delete b.useInterimTilesOnError;
        T.call(this, b);
        this.Gk(a.preload ? a.preload : 0);
        this.Hk(a.useInterimTilesOnError ? a.useInterimTilesOnError : !0);
        Fa(void 0 == a.renderMode || "image" == a.renderMode || "hybrid" == a.renderMode || "vector" == a.renderMode, 28);
        this.en = a.renderMode || "hybrid"
    }
    v(Mv, T);
    h = Mv.prototype;
    h.dj = function(a) {
        var b = null;
        "canvas" === a.D() && (b = new Gv(this));
        return b
    }
    ;
    h.Th = function() {
        return this.get("preload")
    }
    ;
    h.Zh = function() {
        return this.get("useInterimTilesOnError")
    }
    ;
    h.Gk = function(a) {
        this.set("preload", a)
    }
    ;
    h.Hk = function(a) {
        this.set("useInterimTilesOnError", a)
    }
    ;
    function Nv(a, b, c, d) {
        function e() {
            delete window[g];
            f.parentNode.removeChild(f)
        }
        var f = document.createElement("script")
          , g = "olc_" + w(b);
        f.async = !0;
        f.src = a + (-1 == a.indexOf("?") ? "?" : "&") + (d || "callback") + "=" + g;
        var k = setTimeout(function() {
            e();
            c && c()
        }, 1E4);
        window[g] = function(a) {
            clearTimeout(k);
            e();
            b(a)
        }
        ;
        document.getElementsByTagName("head")[0].appendChild(f)
    }
    ;function Ov(a, b, c, d, e, f, g, k, l, m, n) {
        ys.call(this, e, 0);
        this.zA = void 0 !== n ? n : !1;
        this.Wa = g;
        this.Sj = k;
        this.J = null;
        this.vn = b;
        this.xn = d;
        this.Un = f ? f : e;
        this.Bd = [];
        this.Fi = null;
        this.wn = 0;
        f = d.Oa(this.Un);
        k = this.xn.c();
        e = this.vn.c();
        f = k ? ub(f, k) : f;
        if (0 === ob(f))
            this.state = 4;
        else if ((k = a.c()) && (e = e ? ub(e, k) : k),
        d = d.O(this.Un[0]),
        d = cv(a, c, sb(f), d),
        !isFinite(d) || 0 >= d)
            this.state = 4;
        else if (this.Mi = new fv(a,c,f,e,d * (void 0 !== m ? m : .5)),
        0 === this.Mi.og.length)
            this.state = 4;
        else if (this.wn = b.Pf(d),
        c = hv(this.Mi),
        e && (a.Bf ? (c[1] = Ia(c[1], e[1], e[3]),
        c[3] = Ia(c[3], e[1], e[3])) : c = ub(c, e)),
        ob(c)) {
            a = b.xc(c, this.wn);
            for (b = a.ba; b <= a.ea; b++)
                for (c = a.ca; c <= a.fa; c++)
                    (m = l(this.wn, b, c, g)) && this.Bd.push(m);
            0 === this.Bd.length && (this.state = 4)
        } else
            this.state = 4
    }
    v(Ov, ys);
    Ov.prototype.la = function() {
        1 == this.state && (this.Fi.forEach(Mc),
        this.Fi = null);
        ys.prototype.la.call(this)
    }
    ;
    Ov.prototype.N = function() {
        return this.J
    }
    ;
    Ov.prototype.Ck = function() {
        var a = [];
        this.Bd.forEach(function(b) {
            b && 2 == b.getState() && a.push({
                extent: this.vn.Oa(b.ta),
                image: b.N()
            })
        }, this);
        this.Bd.length = 0;
        if (0 === a.length)
            this.state = 3;
        else {
            var b = this.Un[0]
              , c = this.xn.Zb(b)
              , d = "number" === typeof c ? c : c[0];
            c = "number" === typeof c ? c : c[1];
            b = this.xn.O(b);
            var e = this.vn.O(this.wn)
              , f = this.xn.Oa(this.Un);
            this.J = ev(d, c, this.Wa, e, this.vn.c(), b, f, this.Mi, a, this.Sj, this.zA);
            this.state = 2
        }
        this.a()
    }
    ;
    Ov.prototype.load = function() {
        if (0 == this.state) {
            this.state = 1;
            this.a();
            var a = 0;
            this.Fi = [];
            this.Bd.forEach(function(b) {
                var c = b.getState();
                if (0 == c || 1 == c) {
                    a++;
                    var d = y(b, "change", function() {
                        var c = b.getState();
                        if (2 == c || 3 == c || 4 == c)
                            Mc(d),
                            a--,
                            0 === a && (this.Fi.forEach(Mc),
                            this.Fi = null,
                            this.Ck())
                    }, this);
                    this.Fi.push(d)
                }
            }, this);
            this.Bd.forEach(function(a) {
                0 == a.getState() && a.load()
            });
            0 === a && setTimeout(this.Ck.bind(this), 0)
        }
    }
    ;
    function Pv(a, b) {
        var c = /\{z\}/g
          , d = /\{x\}/g
          , e = /\{y\}/g
          , f = /\{-y\}/g;
        return function(g) {
            if (g)
                return a.replace(c, g[0].toString()).replace(d, g[1].toString()).replace(e, function() {
                    return (-g[2] - 1).toString()
                }).replace(f, function() {
                    var a = b.Oh ? b.Oh[g[0]] : null;
                    Fa(a, 55);
                    return (a.fa - a.ca + 1 + g[2]).toString()
                })
        }
    }
    function Qv(a, b) {
        for (var c = a.length, d = Array(c), e = 0; e < c; ++e)
            d[e] = Pv(a[e], b);
        return Rv(d)
    }
    function Rv(a) {
        return 1 === a.length ? a[0] : function(b, c, d) {
            if (b)
                return a[Oa((b[1] << b[0]) + b[2], a.length)](b, c, d)
        }
    }
    function Sv() {}
    function Tv(a) {
        var b = []
          , c = /\{([a-z])-([a-z])\}/.exec(a);
        if (c) {
            var d = c[2].charCodeAt(0), e;
            for (e = c[1].charCodeAt(0); e <= d; ++e)
                b.push(a.replace(c[0], String.fromCharCode(e)));
            return b
        }
        if (c = c = /\{(\d+)-(\d+)\}/.exec(a)) {
            d = parseInt(c[2], 10);
            for (e = parseInt(c[1], 10); e <= d; e++)
                b.push(a.replace(c[0], e.toString()));
            return b
        }
        b.push(a);
        return b
    }
    ;function Uv(a) {
        dk.call(this);
        this.Xs = void 0 !== a ? a : 2048
    }
    v(Uv, dk);
    Uv.prototype.Bg = function() {
        return this.Bj() > this.Xs
    }
    ;
    Uv.prototype.Jh = function(a) {
        for (var b, c; this.Bg() && !(b = this.bd.rg,
        c = b.ta[0].toString(),
        c in a && a[c].contains(b.ta)); )
            Vc(this.pop())
    }
    ;
    function Vv(a) {
        Ht.call(this, {
            attributions: a.attributions,
            extent: a.extent,
            logo: a.logo,
            projection: a.projection,
            state: a.state,
            wrapX: a.wrapX
        });
        this.yz = void 0 !== a.opaque ? a.opaque : !1;
        this.mB = void 0 !== a.tilePixelRatio ? a.tilePixelRatio : 1;
        this.tileGrid = void 0 !== a.tileGrid ? a.tileGrid : null;
        this.Ra = new Uv(a.cacheSize);
        this.tf = [0, 0];
        this.Vf = ""
    }
    v(Vv, Ht);
    h = Vv.prototype;
    h.Bg = function() {
        return this.Ra.Bg()
    }
    ;
    h.Jh = function(a, b) {
        (a = this.Mj(a)) && a.Jh(b)
    }
    ;
    function jt(a, b, c, d, e) {
        b = a.Mj(b);
        if (!b)
            return !1;
        for (var f = !0, g, k, l = d.ba; l <= d.ea; ++l)
            for (var m = d.ca; m <= d.fa; ++m)
                g = a.je(c, l, m),
                k = !1,
                ek(b, g) && (g = b.get(g),
                (k = 2 === g.getState()) && (k = !1 !== e(g))),
                k || (f = !1);
        return f
    }
    h.Wo = function() {
        return 0
    }
    ;
    h.getKey = function() {
        return this.Vf
    }
    ;
    function Wv(a, b) {
        a.Vf !== b && (a.Vf = b,
        a.a())
    }
    h.je = function(a, b, c) {
        return a + "/" + b + "/" + c
    }
    ;
    h.cp = function() {
        return this.yz
    }
    ;
    h.Jd = function() {
        return this.tileGrid.Jd()
    }
    ;
    h.Yb = function() {
        return this.tileGrid
    }
    ;
    h.Cb = function(a) {
        return this.tileGrid ? this.tileGrid : Dc(a)
    }
    ;
    h.Mj = function(a) {
        var b = this.M();
        return b && !nc(b, a) ? null : this.Ra
    }
    ;
    h.Og = function() {
        return this.mB
    }
    ;
    h.Pj = function(a, b, c) {
        c = this.Cb(c);
        b = this.Og(b);
        a = Sa(c.Zb(a), this.tf);
        return 1 == b ? a : Ra(a, b, this.tf)
    }
    ;
    function Xv(a, b, c) {
        var d = void 0 !== c ? c : a.M();
        c = a.Cb(d);
        if (a.Tn && d.Pg) {
            var e = b;
            b = e[0];
            a = c.Oj(e);
            d = Hc(d);
            Za(d, a) ? b = e : (e = qb(d),
            a[0] += e * Math.ceil((d[0] - a[0]) / e),
            b = c.ip(a, b))
        }
        e = b[0];
        d = b[1];
        a = b[2];
        if (c.Ng() > e || e > c.Ij())
            c = !1;
        else {
            var f = c.c();
            c = (c = f ? c.xc(f, e) : c.Oh ? c.Oh[e] : null) ? c.de(d, a) : !0
        }
        return c ? b : null
    }
    h.refresh = function() {
        this.Ra.clear();
        this.a()
    }
    ;
    h.Wq = Ba;
    function Yv(a, b) {
        Wc.call(this, a);
        this.tile = b
    }
    v(Yv, Wc);
    function Zv(a) {
        Vv.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            extent: a.extent,
            logo: a.logo,
            opaque: a.opaque,
            projection: a.projection,
            state: a.state,
            tileGrid: a.tileGrid,
            tilePixelRatio: a.tilePixelRatio,
            wrapX: a.wrapX
        });
        this.tileLoadFunction = a.tileLoadFunction;
        this.tileUrlFunction = this.Eg ? this.Eg.bind(this) : Sv;
        this.urls = null;
        a.urls ? this.dc(a.urls) : a.url && this.Hb(a.url);
        a.tileUrlFunction && this.cc(a.tileUrlFunction)
    }
    v(Zv, Vv);
    h = Zv.prototype;
    h.Tc = function() {
        return this.tileLoadFunction
    }
    ;
    h.Uc = function() {
        return this.tileUrlFunction
    }
    ;
    h.Vc = function() {
        return this.urls
    }
    ;
    h.Uj = function(a) {
        a = a.target;
        switch (a.getState()) {
        case 1:
            this.dispatchEvent(new Yv("tileloadstart",a));
            break;
        case 2:
            this.dispatchEvent(new Yv("tileloadend",a));
            break;
        case 3:
            this.dispatchEvent(new Yv("tileloaderror",a))
        }
    }
    ;
    h.ed = function(a) {
        this.Ra.clear();
        this.tileLoadFunction = a;
        this.a()
    }
    ;
    h.cc = function(a, b) {
        this.tileUrlFunction = a;
        "undefined" !== typeof b ? Wv(this, b) : this.a()
    }
    ;
    h.Hb = function(a) {
        var b = this.urls = Tv(a);
        this.cc(this.Eg ? this.Eg.bind(this) : Qv(b, this.tileGrid), a)
    }
    ;
    h.dc = function(a) {
        this.urls = a;
        var b = a.join("\n");
        this.cc(this.Eg ? this.Eg.bind(this) : Qv(a, this.tileGrid), b)
    }
    ;
    h.Wq = function(a, b, c) {
        a = this.je(a, b, c);
        ek(this.Ra, a) && this.Ra.get(a)
    }
    ;
    function X(a) {
        Zv.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            extent: a.extent,
            logo: a.logo,
            opaque: a.opaque,
            projection: a.projection,
            state: a.state,
            tileGrid: a.tileGrid,
            tileLoadFunction: a.tileLoadFunction ? a.tileLoadFunction : $v,
            tilePixelRatio: a.tilePixelRatio,
            tileUrlFunction: a.tileUrlFunction,
            url: a.url,
            urls: a.urls,
            wrapX: a.wrapX
        });
        this.crossOrigin = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.tileClass = void 0 !== a.tileClass ? a.tileClass : Bs;
        this.sf = {};
        this.Uk = {};
        this.EA = a.reprojectionErrorThreshold;
        this.jq = !1
    }
    v(X, Zv);
    h = X.prototype;
    h.Bg = function() {
        if (this.Ra.Bg())
            return !0;
        for (var a in this.sf)
            if (this.sf[a].Bg())
                return !0;
        return !1
    }
    ;
    h.Jh = function(a, b) {
        a = this.Mj(a);
        this.Ra.Jh(this.Ra == a ? b : {});
        for (var c in this.sf) {
            var d = this.sf[c];
            d.Jh(d == a ? b : {})
        }
    }
    ;
    h.Wo = function(a) {
        return this.M() && a && !nc(this.M(), a) ? 0 : this.Xo()
    }
    ;
    h.Xo = function() {
        return 0
    }
    ;
    h.cp = function(a) {
        return this.M() && a && !nc(this.M(), a) ? !1 : Zv.prototype.cp.call(this, a)
    }
    ;
    h.Cb = function(a) {
        var b = this.M();
        return !this.tileGrid || b && !nc(b, a) ? (b = w(a).toString(),
        b in this.Uk || (this.Uk[b] = Dc(a)),
        this.Uk[b]) : this.tileGrid
    }
    ;
    h.Mj = function(a) {
        var b = this.M();
        if (!b || nc(b, a))
            return this.Ra;
        a = w(a).toString();
        a in this.sf || (this.sf[a] = new Uv(this.Ra.Xs));
        return this.sf[a]
    }
    ;
    function aw(a, b, c, d, e, f, g) {
        b = [b, c, d];
        e = (c = Xv(a, b, f)) ? a.tileUrlFunction(c, e, f) : void 0;
        e = new a.tileClass(b,void 0 !== e ? 0 : 4,void 0 !== e ? e : "",a.crossOrigin,a.tileLoadFunction);
        e.key = g;
        y(e, "change", a.Uj, a);
        return e
    }
    h.ua = function(a, b, c, d, e) {
        if (this.M() && e && !nc(this.M(), e)) {
            var f = this.Mj(e);
            c = [a, b, c];
            var g;
            a = this.je.apply(this, c);
            ek(f, a) && (g = f.get(a));
            b = this.getKey();
            if (g && g.key == b)
                return g;
            var k = this.M()
              , l = this.Cb(k)
              , m = this.Cb(e)
              , n = Xv(this, c, e);
            d = new Ov(k,l,e,m,c,n,this.Og(d),this.Xo(),function(a, b, c, d) {
                return bw(this, a, b, c, d, k)
            }
            .bind(this),this.EA,this.jq);
            d.key = b;
            g ? (d.Tb = g,
            As(d),
            f.replace(a, d)) : f.set(a, d);
            return d
        }
        return bw(this, a, b, c, d, e)
    }
    ;
    function bw(a, b, c, d, e, f) {
        var g = a.je(b, c, d)
          , k = a.getKey();
        if (ek(a.Ra, g)) {
            var l = a.Ra.get(g);
            if (l.key != k) {
                var m = l;
                l = aw(a, b, c, d, e, f, k);
                0 == m.getState() ? l.Tb = m.Tb : l.Tb = m;
                As(l);
                a.Ra.replace(g, l)
            }
        } else
            l = aw(a, b, c, d, e, f, k),
            a.Ra.set(g, l);
        return l
    }
    h.Vd = function(a) {
        if (this.jq != a) {
            this.jq = a;
            for (var b in this.sf)
                this.sf[b].clear();
            this.a()
        }
    }
    ;
    h.Xd = function(a, b) {
        if (a = ec(a))
            a = w(a).toString(),
            a in this.Uk || (this.Uk[a] = b)
    }
    ;
    function $v(a, b) {
        a.N().src = b
    }
    ;function cw(a) {
        this.rd = void 0 !== a.hidpi ? a.hidpi : !1;
        X.call(this, {
            cacheSize: a.cacheSize,
            crossOrigin: "anonymous",
            opaque: !0,
            projection: ec("EPSG:3857"),
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            state: "loading",
            tileLoadFunction: a.tileLoadFunction,
            tilePixelRatio: this.rd ? 2 : 1,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        });
        this.sw = void 0 !== a.culture ? a.culture : "en-us";
        this.zt = void 0 !== a.maxZoom ? a.maxZoom : -1;
        this.Fr = a.key;
        this.dt = a.imagerySet;
        Nv("https://dev.virtualearth.net/REST/v1/Imagery/Metadata/" + this.dt + "?uriScheme=https&include=ImageryProviders&key=" + this.Fr, this.ay.bind(this), void 0, "jsonp")
    }
    v(cw, X);
    var dw = new Ic({
        html: '<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html">Terms of Use</a>'
    });
    cw.prototype.Xw = function() {
        return this.Fr
    }
    ;
    cw.prototype.jx = function() {
        return this.dt
    }
    ;
    cw.prototype.ay = function(a) {
        if (200 != a.rC || "OK" != a.sC || "ValidCredentials" != a.eC || 1 != a.pu.length || 1 != a.pu[0].FA.length)
            this.Fb("error");
        else {
            var b = a.fC;
            -1 == b.indexOf("https") && (b = b.replace("http", "https"));
            var c = a.pu[0].FA[0]
              , d = -1 == this.zt ? c.PB : this.zt;
            a = this.M();
            a = Hc(a);
            var e = Fc({
                extent: a,
                minZoom: c.QB,
                maxZoom: d,
                tileSize: (c.imageWidth == c.imageHeight ? c.imageWidth : [c.imageWidth, c.imageHeight]) / (this.rd ? 2 : 1)
            });
            this.tileGrid = e;
            var f = this.sw
              , g = this.rd;
            this.tileUrlFunction = Rv(c.nC.map(function(a) {
                var b = [0, 0, 0]
                  , d = c.mC.replace("{subdomain}", a).replace("{culture}", f);
                return function(a) {
                    if (a)
                        return tc(a[0], a[1], -a[2] - 1, b),
                        a = d,
                        g && (a += "&dpi=d1&device=mobile"),
                        a.replace("{quadkey}", uc(b))
                }
            }));
            if (c.Iy) {
                var k = fc(ec("EPSG:4326"), this.M());
                a = c.Iy.map(function(a) {
                    var b = a.attribution
                      , c = {};
                    a.iC.forEach(function(a) {
                        var b = a.QB
                          , f = Math.min(a.PB, d);
                        a = a.bbox;
                        a = xb([a[1], a[0], a[3], a[2]], k);
                        var g;
                        for (g = b; g <= f; ++g) {
                            var l = g.toString();
                            b = e.xc(a, g);
                            l in c ? c[l].push(b) : c[l] = [b]
                        }
                    });
                    return new Ic({
                        html: b,
                        An: c
                    })
                });
                a.push(dw);
                this.xa(a)
            }
            this.Fp = b;
            this.Fb("ready")
        }
    }
    ;
    function ew(a) {
        a = a || {};
        var b = void 0 !== a.projection ? a.projection : "EPSG:3857"
          , c = void 0 !== a.tileGrid ? a.tileGrid : Fc({
            extent: Hc(b),
            maxZoom: a.maxZoom,
            minZoom: a.minZoom,
            tileSize: a.tileSize
        });
        X.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            opaque: a.opaque,
            projection: b,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileGrid: c,
            tileLoadFunction: a.tileLoadFunction,
            tilePixelRatio: a.tilePixelRatio,
            tileUrlFunction: a.tileUrlFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        })
    }
    v(ew, X);
    function fw(a) {
        this.zr = a.account;
        this.tt = a.map || "";
        this.cj = a.config || {};
        this.Iq = {};
        ew.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            maxZoom: void 0 !== a.maxZoom ? a.maxZoom : 18,
            minZoom: a.minZoom,
            projection: a.projection,
            state: "loading",
            wrapX: a.wrapX
        });
        gw(this)
    }
    v(fw, ew);
    h = fw.prototype;
    h.$w = function() {
        return this.cj
    }
    ;
    h.CB = function(a) {
        yb(this.cj, a);
        gw(this)
    }
    ;
    h.JA = function(a) {
        this.cj = a || {};
        gw(this)
    }
    ;
    function gw(a) {
        var b = JSON.stringify(a.cj);
        if (a.Iq[b])
            hw(a, a.Iq[b]);
        else {
            var c = "https://" + a.zr + ".cartodb.com/api/v1/map";
            a.tt && (c += "/named/" + a.tt);
            var d = new XMLHttpRequest;
            d.addEventListener("load", a.cy.bind(a, b));
            d.addEventListener("error", a.by.bind(a));
            d.open("POST", c);
            d.setRequestHeader("Content-type", "application/json");
            d.send(JSON.stringify(a.cj))
        }
    }
    h.cy = function(a, b) {
        b = b.target;
        if (!b.status || 200 <= b.status && 300 > b.status) {
            try {
                var c = JSON.parse(b.responseText)
            } catch (d) {
                this.Fb("error");
                return
            }
            hw(this, c);
            this.Iq[a] = c;
            this.Fb("ready")
        } else
            this.Fb("error")
    }
    ;
    h.by = function() {
        this.Fb("error")
    }
    ;
    function hw(a, b) {
        a.Hb("https://" + b.gC.kC + "/" + a.zr + "/api/v1/map/" + b.oC + "/{z}/{x}/{y}.png")
    }
    ;function Y(a) {
        U.call(this, {
            attributions: a.attributions,
            extent: a.extent,
            logo: a.logo,
            projection: a.projection,
            wrapX: a.wrapX
        });
        this.resolution = void 0;
        this.distance = void 0 !== a.distance ? a.distance : 20;
        this.features = [];
        this.geometryFunction = a.geometryFunction || function(a) {
            a = a.I();
            Fa(a instanceof D, 10);
            return a
        }
        ;
        this.source = a.source;
        this.source.g("change", Y.prototype.refresh, this)
    }
    v(Y, U);
    h = Y.prototype;
    h.So = function() {
        return this.distance
    }
    ;
    h.Y = function() {
        return this.source
    }
    ;
    h.loadFeatures = function(a, b, c) {
        this.source.loadFeatures(a, b, c);
        b !== this.resolution && (this.clear(),
        this.resolution = b,
        this.cluster(),
        this.vg(this.features))
    }
    ;
    h.KA = function(a) {
        this.distance = a;
        this.refresh()
    }
    ;
    h.refresh = function() {
        this.clear();
        this.cluster();
        this.vg(this.features);
        U.prototype.refresh.call(this)
    }
    ;
    h.cluster = function() {
        if (void 0 !== this.resolution) {
            this.features.length = 0;
            for (var a = Ua(), b = this.distance * this.resolution, c = this.source.getFeatures(), d = {}, e = 0, f = c.length; e < f; e++) {
                var g = c[e];
                w(g).toString()in d || !(g = this.geometryFunction(g)) || (g = g.H(),
                eb(g, a),
                Wa(a, b, a),
                g = this.source.Uo(a),
                g = g.filter(function(a) {
                    a = w(a).toString();
                    return a in d ? !1 : d[a] = !0
                }),
                this.features.push(this.createCluster(g)))
            }
        }
    }
    ;
    h.createCluster = function(a) {
        for (var b = [0, 0], c = a.length - 1; 0 <= c; --c) {
            var d = this.geometryFunction(a[c]);
            d ? af(b, d.H()) : a.splice(c, 1)
        }
        hf(b, 1 / a.length);
        b = new Wk(new D(b));
        b.set("features", a);
        return b
    }
    ;
    function iw(a, b) {
        var c = [];
        Object.keys(b).forEach(function(a) {
            null !== b[a] && void 0 !== b[a] && c.push(a + "=" + encodeURIComponent(b[a]))
        });
        var d = c.join("&");
        a = a.replace(/[?&]$/, "");
        a = -1 === a.indexOf("?") ? a + "?" : a + "&";
        return a + d
    }
    ;function jw(a) {
        a = a || {};
        jv.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: a.projection,
            resolutions: a.resolutions
        });
        this.Df = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.rd = void 0 !== a.hidpi ? a.hidpi : !0;
        this.eb = a.url;
        this.Wc = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : pv;
        this.wa = a.params || {};
        this.s = null;
        this.yc = [0, 0];
        this.bb = 0;
        this.Sd = void 0 !== a.ratio ? a.ratio : 1.5
    }
    v(jw, jv);
    h = jw.prototype;
    h.Ve = function() {
        return this.wa
    }
    ;
    h.Jg = function(a, b, c, d) {
        if (void 0 === this.eb)
            return null;
        b = kv(this, b);
        c = this.rd ? c : 1;
        var e = this.s;
        if (e && this.bb == this.Z && e.O() == b && e.Wa == c && ab(e.c(), a))
            return e;
        e = {
            F: "image",
            FORMAT: "PNG32",
            TRANSPARENT: !0
        };
        yb(e, this.wa);
        a = a.slice();
        var f = (a[0] + a[2]) / 2
          , g = (a[1] + a[3]) / 2;
        if (1 != this.Sd) {
            var k = this.Sd * qb(a) / 2
              , l = this.Sd * rb(a) / 2;
            a[0] = f - k;
            a[1] = g - l;
            a[2] = f + k;
            a[3] = g + l
        }
        k = b / c;
        l = Math.ceil(qb(a) / k);
        var m = Math.ceil(rb(a) / k);
        a[0] = f - k * l / 2;
        a[2] = f + k * l / 2;
        a[1] = g - k * m / 2;
        a[3] = g + k * m / 2;
        this.yc[0] = l;
        this.yc[1] = m;
        d = this.Xe(a, this.yc, c, d, e);
        this.s = new ws(a,b,c,this.Nb,d,this.Df,this.Wc);
        this.bb = this.Z;
        y(this.s, "change", this.bi, this);
        return this.s
    }
    ;
    h.Fj = function() {
        return this.Wc
    }
    ;
    h.Xe = function(a, b, c, d, e) {
        d = d.qc.split(":").pop();
        e.SIZE = b[0] + "," + b[1];
        e.BBOX = a.join(",");
        e.BBOXSR = d;
        e.IMAGESR = d;
        e.DPI = Math.round(90 * c);
        a = this.eb;
        b = a.replace(/MapServer\/?$/, "MapServer/export").replace(/ImageServer\/?$/, "ImageServer/exportImage");
        b == a && Fa(!1, 50);
        return iw(b, e)
    }
    ;
    h.Of = function() {
        return this.eb
    }
    ;
    h.Fk = function(a) {
        this.s = null;
        this.Wc = a;
        this.a()
    }
    ;
    h.Hb = function(a) {
        a != this.eb && (this.eb = a,
        this.s = null,
        this.a())
    }
    ;
    h.vf = function(a) {
        yb(this.wa, a);
        this.s = null;
        this.a()
    }
    ;
    function kw(a) {
        jv.call(this, {
            projection: a.projection,
            resolutions: a.resolutions
        });
        this.Df = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.cs = void 0 !== a.displayDpi ? a.displayDpi : 96;
        this.wa = a.params || {};
        this.eb = a.url;
        this.Wc = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : pv;
        this.rd = void 0 !== a.hidpi ? a.hidpi : !0;
        this.Om = void 0 !== a.metersPerUnit ? a.metersPerUnit : 1;
        this.Sd = void 0 !== a.ratio ? a.ratio : 1;
        this.GB = void 0 !== a.useOverlay ? a.useOverlay : !1;
        this.s = null;
        this.bb = 0
    }
    v(kw, jv);
    h = kw.prototype;
    h.Ve = function() {
        return this.wa
    }
    ;
    h.Jg = function(a, b, c, d) {
        b = kv(this, b);
        c = this.rd ? c : 1;
        var e = this.s;
        if (e && this.bb == this.Z && e.O() == b && e.Wa == c && ab(e.c(), a))
            return e;
        1 != this.Sd && (a = a.slice(),
        wb(a, this.Sd));
        e = [qb(a) / b * c, rb(a) / b * c];
        void 0 !== this.eb ? (d = this.Of(this.eb, this.wa, a, e, d),
        e = new ws(a,b,c,this.Nb,d,this.Df,this.Wc),
        y(e, "change", this.bi, this)) : e = null;
        this.s = e;
        this.bb = this.Z;
        return e
    }
    ;
    h.Fj = function() {
        return this.Wc
    }
    ;
    h.vf = function(a) {
        yb(this.wa, a);
        this.a()
    }
    ;
    h.Of = function(a, b, c, d) {
        var e = sb(c)
          , f = this.Om
          , g = qb(c);
        c = rb(c);
        var k = d[0]
          , l = d[1]
          , m = .0254 / this.cs;
        d = {
            OPERATION: this.GB ? "GETDYNAMICMAPOVERLAYIMAGE" : "GETMAPIMAGE",
            VERSION: "2.0.0",
            LOCALE: "en",
            CLIENTAGENT: "ol.source.ImageMapGuide source",
            CLIP: "1",
            SETDISPLAYDPI: this.cs,
            SETDISPLAYWIDTH: Math.round(d[0]),
            SETDISPLAYHEIGHT: Math.round(d[1]),
            SETVIEWSCALE: l * g > k * c ? g * f / (k * m) : c * f / (l * m),
            SETVIEWCENTERX: e[0],
            SETVIEWCENTERY: e[1]
        };
        yb(d, b);
        return iw(a, d)
    }
    ;
    h.Fk = function(a) {
        this.s = null;
        this.Wc = a;
        this.a()
    }
    ;
    function lw(a) {
        var b = a.imageExtent
          , c = void 0 !== a.crossOrigin ? a.crossOrigin : null
          , d = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : pv;
        jv.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: ec(a.projection)
        });
        this.s = new ws(b,void 0,1,this.Nb,a.url,c,d);
        this.yc = a.imageSize ? a.imageSize : null;
        y(this.s, "change", this.bi, this)
    }
    v(lw, jv);
    lw.prototype.Jg = function(a) {
        return vb(a, this.s.c()) ? this.s : null
    }
    ;
    lw.prototype.bi = function(a) {
        if (2 == this.s.getState()) {
            var b = this.s.c()
              , c = this.s.N();
            if (this.yc) {
                var d = this.yc[0];
                var e = this.yc[1]
            } else
                d = c.width,
                e = c.height;
            b = Math.ceil(qb(b) / (rb(b) / e));
            if (b != d) {
                b = pd(b, e);
                var f = b.canvas;
                b.drawImage(c, 0, 0, d, e, 0, 0, f.width, f.height);
                this.s.xq(f)
            }
        }
        jv.prototype.bi.call(this, a)
    }
    ;
    function mw(a) {
        a = a || {};
        jv.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: a.projection,
            resolutions: a.resolutions
        });
        this.Df = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.eb = a.url;
        this.Wc = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : pv;
        this.wa = a.params || {};
        this.Ge = !0;
        nw(this);
        this.Ai = a.serverType;
        this.rd = void 0 !== a.hidpi ? a.hidpi : !0;
        this.s = null;
        this.yc = [0, 0];
        this.bb = 0;
        this.Sd = void 0 !== a.ratio ? a.ratio : 1.5
    }
    v(mw, jv);
    var ow = [101, 101];
    h = mw.prototype;
    h.Vo = function(a, b, c, d) {
        if (void 0 !== this.eb) {
            var e = tb(a, b, 0, ow)
              , f = {
                SERVICE: "WMS",
                VERSION: "1.3.0",
                REQUEST: "GetFeatureInfo",
                FORMAT: "image/png",
                TRANSPARENT: !0,
                QUERY_LAYERS: this.wa.LAYERS
            };
            yb(f, this.wa, d);
            d = Math.floor((e[3] - a[1]) / b);
            f[this.Ge ? "I" : "X"] = Math.floor((a[0] - e[0]) / b);
            f[this.Ge ? "J" : "Y"] = d;
            return this.Xe(e, ow, 1, ec(c), f)
        }
    }
    ;
    h.Ve = function() {
        return this.wa
    }
    ;
    h.Jg = function(a, b, c, d) {
        if (void 0 === this.eb)
            return null;
        b = kv(this, b);
        1 == c || this.rd && void 0 !== this.Ai || (c = 1);
        var e = b / c
          , f = sb(a)
          , g = tb(f, e, 0, [Math.ceil(qb(a) / e), Math.ceil(rb(a) / e)]);
        a = tb(f, e, 0, [Math.ceil(this.Sd * qb(a) / e), Math.ceil(this.Sd * rb(a) / e)]);
        if ((f = this.s) && this.bb == this.Z && f.O() == b && f.Wa == c && ab(f.c(), g))
            return f;
        g = {
            SERVICE: "WMS",
            VERSION: "1.3.0",
            REQUEST: "GetMap",
            FORMAT: "image/png",
            TRANSPARENT: !0
        };
        yb(g, this.wa);
        this.yc[0] = Math.round(qb(a) / e);
        this.yc[1] = Math.round(rb(a) / e);
        d = this.Xe(a, this.yc, c, d, g);
        this.s = new ws(a,b,c,this.Nb,d,this.Df,this.Wc);
        this.bb = this.Z;
        y(this.s, "change", this.bi, this);
        return this.s
    }
    ;
    h.Fj = function() {
        return this.Wc
    }
    ;
    h.Xe = function(a, b, c, d, e) {
        Fa(void 0 !== this.eb, 9);
        e[this.Ge ? "CRS" : "SRS"] = d.qc;
        "STYLES"in this.wa || (e.STYLES = "");
        if (1 != c)
            switch (this.Ai) {
            case "geoserver":
                c = 90 * c + .5 | 0;
                e.FORMAT_OPTIONS = "FORMAT_OPTIONS"in e ? e.FORMAT_OPTIONS + (";dpi:" + c) : "dpi:" + c;
                break;
            case "mapserver":
                e.MAP_RESOLUTION = 90 * c;
                break;
            case "carmentaserver":
            case "qgis":
                e.DPI = 90 * c;
                break;
            default:
                Fa(!1, 8)
            }
        e.WIDTH = b[0];
        e.HEIGHT = b[1];
        b = d.be;
        e.BBOX = (this.Ge && "ne" == b.substr(0, 2) ? [a[1], a[0], a[3], a[2]] : a).join(",");
        return iw(this.eb, e)
    }
    ;
    h.Of = function() {
        return this.eb
    }
    ;
    h.Fk = function(a) {
        this.s = null;
        this.Wc = a;
        this.a()
    }
    ;
    h.Hb = function(a) {
        a != this.eb && (this.eb = a,
        this.s = null,
        this.a())
    }
    ;
    h.vf = function(a) {
        yb(this.wa, a);
        nw(this);
        this.s = null;
        this.a()
    }
    ;
    function nw(a) {
        a: {
            var b = ("" + (a.wa.VERSION || "1.3.0")).split(".");
            for (var c = ["1", "3"], d = 0; d < Math.max(b.length, c.length); d++) {
                var e = parseInt(b[d] || "0", 10)
                  , f = parseInt(c[d] || "0", 10);
                if (e > f) {
                    b = 1;
                    break a
                }
                if (f > e) {
                    b = -1;
                    break a
                }
            }
            b = 0
        }
        a.Ge = 0 <= b
    }
    ;function pw(a) {
        a = a || {};
        ew.call(this, {
            attributions: void 0 !== a.attributions ? a.attributions : [qw],
            cacheSize: a.cacheSize,
            crossOrigin: void 0 !== a.crossOrigin ? a.crossOrigin : "anonymous",
            opaque: void 0 !== a.opaque ? a.opaque : !0,
            maxZoom: void 0 !== a.maxZoom ? a.maxZoom : 19,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileLoadFunction: a.tileLoadFunction,
            url: void 0 !== a.url ? a.url : "https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",
            wrapX: a.wrapX
        })
    }
    v(pw, ew);
    var qw = new Ic({
        html: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.'
    });
    vj.Um = {};
    vj.Um.Yn = function() {}
    ;
    (function(a) {
        function b(a, b, c) {
            if (g)
                return new ImageData(a,b,c);
            b = k.createImageData(b, c);
            b.data.set(a);
            return b
        }
        function c(a) {
            var b = !0;
            try {
                new ImageData(10,10)
            } catch (n) {
                b = !1
            }
            return function(c) {
                var d = c.buffers
                  , e = c.meta
                  , f = c.width
                  , g = c.height
                  , k = d.length
                  , l = d[0].byteLength;
                if (c.imageOps) {
                    l = Array(k);
                    for (c = 0; c < k; ++c) {
                        var m = c;
                        var n = new Uint8ClampedArray(d[c]);
                        var G = f
                          , ea = g;
                        n = b ? new ImageData(n,G,ea) : {
                            data: n,
                            width: G,
                            height: ea
                        };
                        l[m] = n
                    }
                    f = a(l, e).data
                } else {
                    f = new Uint8ClampedArray(l);
                    g = Array(k);
                    m = Array(k);
                    for (c = 0; c < k; ++c)
                        g[c] = new Uint8ClampedArray(d[c]),
                        m[c] = [0, 0, 0, 0];
                    for (d = 0; d < l; d += 4) {
                        for (c = 0; c < k; ++c)
                            n = g[c],
                            m[c][0] = n[d],
                            m[c][1] = n[d + 1],
                            m[c][2] = n[d + 2],
                            m[c][3] = n[d + 3];
                        c = a(m, e);
                        f[d] = c[0];
                        f[d + 1] = c[1];
                        f[d + 2] = c[2];
                        f[d + 3] = c[3]
                    }
                }
                return f.buffer
            }
        }
        function d(a, b) {
            var d = Object.keys(a.lib || {}).map(function(b) {
                return "var " + b + " = " + a.lib[b].toString() + ";"
            }).concat(["var __minion__ = (" + c.toString() + ")(", a.operation.toString(), ");", 'self.addEventListener("message", function(event) {', "  var buffer = __minion__(event.data);", "  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);", "});"]);
            d = URL.createObjectURL(new Blob(d,{
                type: "text/javascript"
            }));
            d = new Worker(d);
            d.addEventListener("message", b);
            return d
        }
        function e(a, b) {
            var d = c(a.operation);
            return {
                postMessage: function(a) {
                    setTimeout(function() {
                        b({
                            data: {
                                buffer: d(a),
                                meta: a.meta
                            }
                        })
                    }, 0)
                }
            }
        }
        function f(a) {
            this.bo = !!a.Hy;
            var b = 0 === a.threads ? 0 : this.bo ? 1 : a.threads || 1;
            var c = [];
            if (b)
                for (var f = 0; f < b; ++f)
                    c[f] = d(a, this.xr.bind(this, f));
            else
                c[0] = e(a, this.xr.bind(this, 0));
            this.sl = c;
            this.Wi = [];
            this.Uv = a.Wz || Infinity;
            this.ql = 0;
            this.wh = {};
            this.co = null
        }
        var g = !0;
        try {
            new ImageData(10,10)
        } catch (l) {
            g = !1
        }
        var k = document.createElement("canvas").getContext("2d");
        f.prototype.Tz = function(a, b, c) {
            this.Sv({
                inputs: a,
                Bt: b,
                callback: c
            });
            this.ur()
        }
        ;
        f.prototype.Sv = function(a) {
            for (this.Wi.push(a); this.Wi.length > this.Uv; )
                this.Wi.shift().callback(null, null)
        }
        ;
        f.prototype.ur = function() {
            if (0 === this.ql && 0 < this.Wi.length) {
                var a = this.co = this.Wi.shift()
                  , b = a.inputs[0].width
                  , c = a.inputs[0].height
                  , d = a.inputs.map(function(a) {
                    return a.data.buffer
                })
                  , e = this.sl.length;
                this.ql = e;
                if (1 === e)
                    this.sl[0].postMessage({
                        buffers: d,
                        meta: a.Bt,
                        imageOps: this.bo,
                        width: b,
                        height: c
                    }, d);
                else
                    for (var f = 4 * Math.ceil(a.inputs[0].data.length / 4 / e), g = 0; g < e; ++g) {
                        for (var k = g * f, B = [], z = 0, E = d.length; z < E; ++z)
                            B.push(d[g].slice(k, k + f));
                        this.sl[g].postMessage({
                            buffers: B,
                            meta: a.Bt,
                            imageOps: this.bo,
                            width: b,
                            height: c
                        }, B)
                    }
            }
        }
        ;
        f.prototype.xr = function(a, b) {
            this.cC || (this.wh[a] = b.data,
            --this.ql,
            0 === this.ql && this.Vv())
        }
        ;
        f.prototype.Vv = function() {
            var a = this.co
              , c = this.sl.length;
            if (1 === c) {
                var d = new Uint8ClampedArray(this.wh[0].buffer);
                var e = this.wh[0].meta
            } else {
                var f = a.inputs[0].data.length;
                d = new Uint8ClampedArray(f);
                e = Array(f);
                f = 4 * Math.ceil(f / 4 / c);
                for (var g = 0; g < c; ++g) {
                    var k = g * f;
                    d.set(new Uint8ClampedArray(this.wh[g].buffer), k);
                    e[g] = this.wh[g].meta
                }
            }
            this.co = null;
            this.wh = {};
            a.callback(null, b(d, a.inputs[0].width, a.inputs[0].height), e);
            this.ur()
        }
        ;
        a["default"] = {
            Yn: f
        };
        a.Yn = f
    }
    )(vj.Um = vj.Um || {});
    function rw(a) {
        this.lv = null;
        this.zz = void 0 !== a.operationType ? a.operationType : "pixel";
        this.kB = void 0 !== a.threads ? a.threads : 1;
        this.ih = sw(a.sources);
        for (var b = 0, c = this.ih.length; b < c; ++b)
            y(this.ih[b], "change", this.a, this);
        this.zn = new Te(function() {
            return 1
        }
        ,this.a.bind(this));
        b = tw(this.ih);
        c = {};
        for (var d = 0, e = b.length; d < e; ++d)
            c[w(b[d].layer)] = b[d];
        this.hf = null;
        this.Da = {
            rb: !1,
            attributions: {},
            Dg: Ah(),
            extent: null,
            focus: null,
            index: 0,
            ak: c,
            Od: b,
            ah: {},
            pixelRatio: 1,
            ti: Ah(),
            Rd: [],
            size: [0, 0],
            qh: {},
            tileQueue: this.zn,
            time: Date.now(),
            Qi: {},
            viewState: {
                rotation: 0
            },
            Dd: [],
            wantedTiles: {}
        };
        jv.call(this, {});
        void 0 !== a.operation && this.Bu(a.operation, a.lib)
    }
    v(rw, jv);
    rw.prototype.Bu = function(a, b) {
        this.lv = new vj.Um.Yn({
            operation: a,
            Hy: "image" === this.zz,
            Wz: 1,
            lib: b,
            threads: this.kB
        });
        this.a()
    }
    ;
    rw.prototype.N = function(a, b, c, d) {
        c = !0;
        for (var e, f = 0, g = this.ih.length; f < g; ++f)
            if (e = this.ih[f].ka().Y(),
            "ready" !== e.getState()) {
                c = !1;
                break
            }
        if (!c)
            return null;
        c = yb({}, this.Da);
        c.viewState = yb({}, c.viewState);
        e = sb(a);
        c.extent = a.slice();
        c.focus = e;
        c.size[0] = Math.round(qb(a) / b);
        c.size[1] = Math.round(rb(a) / b);
        f = c.viewState;
        f.center = e;
        f.projection = d;
        f.resolution = b;
        this.qq = c;
        this.hf && (d = this.hf.O(),
        e = this.hf.c(),
        b === d && hb(a, e) || (this.hf = null));
        if (!this.hf || this.Z !== this.bb)
            a: {
                a = this.qq;
                d = this.ih.length;
                b = Array(d);
                for (e = 0; e < d; ++e) {
                    f = this.ih[e];
                    g = a;
                    var k = a.Od[e];
                    if (f.ue(g, k)) {
                        var l = g.size[0]
                          , m = g.size[1];
                        if (uw) {
                            var n = uw.canvas;
                            n.width !== l || n.height !== m ? uw = pd(l, m) : uw.clearRect(0, 0, l, m)
                        } else
                            uw = pd(l, m);
                        f.Ch(g, k, uw);
                        f = uw.getImageData(0, 0, l, m)
                    } else
                        f = null;
                    if (f)
                        b[e] = f;
                    else
                        break a
                }
                d = {};
                this.dispatchEvent(new vw(ww,a,d));
                this.lv.Tz(b, d, this.xz.bind(this, a))
            }
        c.tileQueue.Ep(16, 16);
        return this.hf
    }
    ;
    rw.prototype.xz = function(a, b, c, d) {
        if (!b && c) {
            b = a.extent;
            var e = a.viewState.resolution;
            if (e === this.qq.viewState.resolution && hb(b, this.qq.extent)) {
                if (this.hf)
                    var f = this.hf.N().getContext("2d");
                else
                    f = pd(Math.round(qb(b) / e), Math.round(rb(b) / e)),
                    this.hf = new xs(b,e,1,this.Nb,f.canvas);
                f.putImageData(c, 0, 0);
                this.a();
                this.bb = this.Z;
                this.dispatchEvent(new vw(xw,a,d))
            }
        }
    }
    ;
    var uw = null;
    function tw(a) {
        return a.map(function(a) {
            return sh(a.ka())
        })
    }
    function sw(a) {
        for (var b = a.length, c = Array(b), d = 0; d < b; ++d) {
            var e = d
              , f = a[d]
              , g = null;
            f instanceof Vv ? (f = new Fv({
                source: f
            }),
            g = new xv(f)) : f instanceof jv && (f = new wv({
                source: f
            }),
            g = new bv(f));
            c[e] = g
        }
        return c
    }
    function vw(a, b, c) {
        Wc.call(this, a);
        this.extent = b.extent;
        this.resolution = b.viewState.resolution / b.pixelRatio;
        this.data = c
    }
    v(vw, Wc);
    rw.prototype.Jg = function() {
        return null
    }
    ;
    var ww = "beforeoperations"
      , xw = "afteroperations";
    function yw(a) {
        var b = a.layer.indexOf("-");
        b = zw[-1 == b ? a.layer : a.layer.slice(0, b)];
        var c = Aw[a.layer];
        ew.call(this, {
            attributions: Bw,
            cacheSize: a.cacheSize,
            crossOrigin: "anonymous",
            maxZoom: void 0 != a.maxZoom ? a.maxZoom : b.maxZoom,
            minZoom: void 0 != a.minZoom ? a.minZoom : b.minZoom,
            opaque: c.opaque,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileLoadFunction: a.tileLoadFunction,
            url: void 0 !== a.url ? a.url : "https://stamen-tiles-{a-d}.a.ssl.fastly.net/" + a.layer + "/{z}/{x}/{y}." + c.Hd,
            wrapX: a.wrapX
        })
    }
    v(yw, ew);
    var Bw = [new Ic({
        html: 'Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.'
    }), qw]
      , Aw = {
        terrain: {
            Hd: "jpg",
            opaque: !0
        },
        "terrain-background": {
            Hd: "jpg",
            opaque: !0
        },
        "terrain-labels": {
            Hd: "png",
            opaque: !1
        },
        "terrain-lines": {
            Hd: "png",
            opaque: !1
        },
        "toner-background": {
            Hd: "png",
            opaque: !0
        },
        toner: {
            Hd: "png",
            opaque: !0
        },
        "toner-hybrid": {
            Hd: "png",
            opaque: !1
        },
        "toner-labels": {
            Hd: "png",
            opaque: !1
        },
        "toner-lines": {
            Hd: "png",
            opaque: !1
        },
        "toner-lite": {
            Hd: "png",
            opaque: !0
        },
        watercolor: {
            Hd: "jpg",
            opaque: !0
        }
    }
      , zw = {
        terrain: {
            minZoom: 4,
            maxZoom: 18
        },
        toner: {
            minZoom: 0,
            maxZoom: 20
        },
        watercolor: {
            minZoom: 1,
            maxZoom: 16
        }
    };
    function Cw(a) {
        a = a || {};
        X.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileGrid: a.tileGrid,
            tileLoadFunction: a.tileLoadFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        });
        this.wa = a.params || {};
        this.En = Ua();
        Wv(this, this.Gj())
    }
    v(Cw, X);
    h = Cw.prototype;
    h.Gj = function() {
        var a = 0, b = [], c;
        for (c in this.wa)
            b[a++] = c + "-" + this.wa[c];
        return b.join("/")
    }
    ;
    h.Ve = function() {
        return this.wa
    }
    ;
    h.Xe = function(a, b, c, d, e, f) {
        var g = this.urls;
        if (g)
            return e = e.qc.split(":").pop(),
            f.SIZE = b[0] + "," + b[1],
            f.BBOX = c.join(","),
            f.BBOXSR = e,
            f.IMAGESR = e,
            f.DPI = Math.round(f.DPI ? f.DPI * d : 90 * d),
            a = (1 == g.length ? g[0] : g[Oa((a[1] << a[0]) + a[2], g.length)]).replace(/MapServer\/?$/, "MapServer/export").replace(/ImageServer\/?$/, "ImageServer/exportImage"),
            iw(a, f)
    }
    ;
    h.Og = function(a) {
        return a
    }
    ;
    h.Eg = function(a, b, c) {
        var d = this.tileGrid;
        d || (d = this.Cb(c));
        if (!(d.Jd().length <= a[0])) {
            var e = d.Oa(a, this.En);
            d = Sa(d.Zb(a[0]), this.tf);
            1 != b && (d = Ra(d, b, this.tf));
            var f = {
                F: "image",
                FORMAT: "PNG32",
                TRANSPARENT: !0
            };
            yb(f, this.wa);
            return this.Xe(a, d, e, b, c, f)
        }
    }
    ;
    h.vf = function(a) {
        yb(this.wa, a);
        Wv(this, this.Gj())
    }
    ;
    function Dw(a) {
        Vv.call(this, {
            opaque: !1,
            projection: a.projection,
            tileGrid: a.tileGrid,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        })
    }
    v(Dw, Vv);
    Dw.prototype.ua = function(a, b, c) {
        var d = this.je(a, b, c);
        if (ek(this.Ra, d))
            return this.Ra.get(d);
        var e = Sa(this.tileGrid.Zb(a));
        a = [a, b, c];
        b = (b = Xv(this, a)) ? Xv(this, b).toString() : "";
        e = new Ew(a,e,b);
        this.Ra.set(d, e);
        return e
    }
    ;
    function Ew(a, b, c) {
        ys.call(this, a, 2);
        this.Ii = b;
        this.S = c;
        this.J = null
    }
    v(Ew, ys);
    Ew.prototype.N = function() {
        if (this.J)
            return this.J;
        var a = this.Ii
          , b = pd(a[0], a[1]);
        b.strokeStyle = "black";
        b.strokeRect(.5, .5, a[0] + .5, a[1] + .5);
        b.fillStyle = "black";
        b.textAlign = "center";
        b.textBaseline = "middle";
        b.font = "24px sans-serif";
        b.fillText(this.S, a[0] / 2, a[1] / 2);
        return this.J = b.canvas
    }
    ;
    Ew.prototype.load = function() {}
    ;
    function Fw(a) {
        this.Uu = null;
        X.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            projection: ec("EPSG:3857"),
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            state: "loading",
            tileLoadFunction: a.tileLoadFunction,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        });
        if (a.url)
            if (a.jsonp)
                Nv(a.url, this.Rg.bind(this), this.Ze.bind(this));
            else {
                var b = new XMLHttpRequest;
                b.addEventListener("load", this.nk.bind(this));
                b.addEventListener("error", this.mk.bind(this));
                b.open("GET", a.url);
                b.send()
            }
        else
            a.tileJSON ? this.Rg(a.tileJSON) : Fa(!1, 51)
    }
    v(Fw, X);
    h = Fw.prototype;
    h.nk = function(a) {
        a = a.target;
        if (!a.status || 200 <= a.status && 300 > a.status) {
            try {
                var b = JSON.parse(a.responseText)
            } catch (c) {
                this.Ze();
                return
            }
            this.Rg(b)
        } else
            this.Ze()
    }
    ;
    h.mk = function() {
        this.Ze()
    }
    ;
    h.Kx = function() {
        return this.Uu
    }
    ;
    h.Rg = function(a) {
        var b = ec("EPSG:4326")
          , c = this.M();
        if (void 0 !== a.bounds) {
            var d = fc(b, c);
            var e = xb(a.bounds, d)
        }
        var f = a.minzoom || 0;
        d = a.maxzoom || 22;
        this.tileGrid = c = Fc({
            extent: Hc(c),
            maxZoom: d,
            minZoom: f
        });
        this.tileUrlFunction = Qv(a.tiles, c);
        if (void 0 !== a.attribution && !this.Nb) {
            b = void 0 !== e ? e : b.c();
            e = {};
            for (var g; f <= d; ++f)
                g = f.toString(),
                e[g] = [c.xc(b, f)];
            this.xa([new Ic({
                html: a.attribution,
                An: e
            })])
        }
        this.Uu = a;
        this.Fb("ready")
    }
    ;
    h.Ze = function() {
        this.Fb("error")
    }
    ;
    function Gw(a) {
        Vv.call(this, {
            projection: ec("EPSG:3857"),
            state: "loading"
        });
        this.Op = void 0 !== a.preemptive ? a.preemptive : !0;
        this.Vu = Sv;
        this.Ru = void 0;
        this.tm = a.jsonp || !1;
        if (a.url)
            if (this.tm)
                Nv(a.url, this.Rg.bind(this), this.Ze.bind(this));
            else {
                var b = new XMLHttpRequest;
                b.addEventListener("load", this.nk.bind(this));
                b.addEventListener("error", this.mk.bind(this));
                b.open("GET", a.url);
                b.send()
            }
        else
            a.tileJSON ? this.Rg(a.tileJSON) : Fa(!1, 51)
    }
    v(Gw, Vv);
    h = Gw.prototype;
    h.nk = function(a) {
        a = a.target;
        if (!a.status || 200 <= a.status && 300 > a.status) {
            try {
                var b = JSON.parse(a.responseText)
            } catch (c) {
                this.Ze();
                return
            }
            this.Rg(b)
        } else
            this.Ze()
    }
    ;
    h.mk = function() {
        this.Ze()
    }
    ;
    h.Hx = function() {
        return this.Ru
    }
    ;
    h.Jw = function(a, b, c, d, e) {
        this.tileGrid ? (b = this.tileGrid.Xl(a, b),
        Hw(this.ua(b[0], b[1], b[2], 1, this.M()), a, c, d, e)) : !0 === e ? setTimeout(function() {
            c.call(d, null)
        }, 0) : c.call(d, null)
    }
    ;
    h.Ze = function() {
        this.Fb("error")
    }
    ;
    h.Rg = function(a) {
        var b = ec("EPSG:4326")
          , c = this.M();
        if (void 0 !== a.bounds) {
            var d = fc(b, c);
            var e = xb(a.bounds, d)
        }
        var f = a.minzoom || 0;
        d = a.maxzoom || 22;
        this.tileGrid = c = Fc({
            extent: Hc(c),
            maxZoom: d,
            minZoom: f
        });
        this.Ru = a.template;
        var g = a.grids;
        if (g) {
            this.Vu = Qv(g, c);
            if (void 0 !== a.attribution) {
                b = void 0 !== e ? e : b.c();
                for (e = {}; f <= d; ++f)
                    g = f.toString(),
                    e[g] = [c.xc(b, f)];
                this.xa([new Ic({
                    html: a.attribution,
                    An: e
                })])
            }
            this.Fb("ready")
        } else
            this.Fb("error")
    }
    ;
    h.ua = function(a, b, c, d, e) {
        var f = this.je(a, b, c);
        if (ek(this.Ra, f))
            return this.Ra.get(f);
        a = [a, b, c];
        b = Xv(this, a, e);
        d = this.Vu(b, d, e);
        d = new Iw(a,void 0 !== d ? 0 : 4,void 0 !== d ? d : "",this.tileGrid.Oa(a),this.Op,this.tm);
        this.Ra.set(f, d);
        return d
    }
    ;
    h.Wq = function(a, b, c) {
        a = this.je(a, b, c);
        ek(this.Ra, a) && this.Ra.get(a)
    }
    ;
    function Iw(a, b, c, d, e, f) {
        ys.call(this, a, b);
        this.gd = c;
        this.V = d;
        this.Op = e;
        this.Fl = this.gi = this.$l = null;
        this.tm = f
    }
    v(Iw, ys);
    h = Iw.prototype;
    h.N = function() {
        return null
    }
    ;
    h.getData = function(a) {
        if (!this.$l || !this.gi)
            return null;
        var b = this.$l[Math.floor((1 - (a[1] - this.V[1]) / (this.V[3] - this.V[1])) * this.$l.length)];
        if ("string" !== typeof b)
            return null;
        a = b.charCodeAt(Math.floor((a[0] - this.V[0]) / (this.V[2] - this.V[0]) * b.length));
        93 <= a && a--;
        35 <= a && a--;
        a -= 32;
        b = null;
        a in this.gi && (a = this.gi[a],
        b = this.Fl && a in this.Fl ? this.Fl[a] : a);
        return b
    }
    ;
    function Hw(a, b, c, d, e) {
        0 == a.state && !0 === e ? (Rc(a, "change", function() {
            c.call(d, this.getData(b))
        }, a),
        Jw(a)) : !0 === e ? setTimeout(function() {
            c.call(d, this.getData(b))
        }
        .bind(a), 0) : c.call(d, a.getData(b))
    }
    h.getKey = function() {
        return this.gd
    }
    ;
    h.am = function() {
        this.state = 3;
        this.a()
    }
    ;
    h.fm = function(a) {
        this.$l = a.grid;
        this.gi = a.keys;
        this.Fl = a.data;
        this.state = 4;
        this.a()
    }
    ;
    function Jw(a) {
        if (0 == a.state)
            if (a.state = 1,
            a.tm)
                Nv(a.gd, a.fm.bind(a), a.am.bind(a));
            else {
                var b = new XMLHttpRequest;
                b.addEventListener("load", a.nk.bind(a));
                b.addEventListener("error", a.mk.bind(a));
                b.open("GET", a.gd);
                b.send()
            }
    }
    h.nk = function(a) {
        a = a.target;
        if (!a.status || 200 <= a.status && 300 > a.status) {
            try {
                var b = JSON.parse(a.responseText)
            } catch (c) {
                this.am();
                return
            }
            this.fm(b)
        } else
            this.am()
    }
    ;
    h.mk = function() {
        this.am()
    }
    ;
    h.load = function() {
        this.Op && Jw(this)
    }
    ;
    function Kw(a) {
        a = a || {};
        var b = a.params || {};
        X.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            opaque: !("TRANSPARENT"in b ? b.TRANSPARENT : 1),
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileClass: a.tileClass,
            tileGrid: a.tileGrid,
            tileLoadFunction: a.tileLoadFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        });
        this.Sj = void 0 !== a.gutter ? a.gutter : 0;
        this.wa = b;
        this.Ge = !0;
        this.Ai = a.serverType;
        this.rd = void 0 !== a.hidpi ? a.hidpi : !0;
        this.Xr = "";
        Lw(this);
        this.En = Ua();
        nw(this);
        Wv(this, this.Gj())
    }
    v(Kw, X);
    h = Kw.prototype;
    h.Vo = function(a, b, c, d) {
        c = ec(c);
        var e = this.tileGrid;
        e || (e = this.Cb(c));
        b = e.Xl(a, b);
        if (!(e.Jd().length <= b[0])) {
            var f = e.O(b[0])
              , g = e.Oa(b, this.En);
            e = Sa(e.Zb(b[0]), this.tf);
            var k = this.Sj;
            0 !== k && (e = Qa(e, k, this.tf),
            g = Wa(g, f * k, g));
            k = {
                SERVICE: "WMS",
                VERSION: "1.3.0",
                REQUEST: "GetFeatureInfo",
                FORMAT: "image/png",
                TRANSPARENT: !0,
                QUERY_LAYERS: this.wa.LAYERS
            };
            yb(k, this.wa, d);
            d = Math.floor((g[3] - a[1]) / f);
            k[this.Ge ? "I" : "X"] = Math.floor((a[0] - g[0]) / f);
            k[this.Ge ? "J" : "Y"] = d;
            return this.Xe(b, e, g, 1, c, k)
        }
    }
    ;
    h.Xo = function() {
        return this.Sj
    }
    ;
    h.je = function(a, b, c) {
        return this.Xr + X.prototype.je.call(this, a, b, c)
    }
    ;
    h.Ve = function() {
        return this.wa
    }
    ;
    h.Xe = function(a, b, c, d, e, f) {
        var g = this.urls;
        if (g) {
            f.WIDTH = b[0];
            f.HEIGHT = b[1];
            f[this.Ge ? "CRS" : "SRS"] = e.qc;
            "STYLES"in this.wa || (f.STYLES = "");
            if (1 != d)
                switch (this.Ai) {
                case "geoserver":
                    b = 90 * d + .5 | 0;
                    f.FORMAT_OPTIONS = "FORMAT_OPTIONS"in f ? f.FORMAT_OPTIONS + (";dpi:" + b) : "dpi:" + b;
                    break;
                case "mapserver":
                    f.MAP_RESOLUTION = 90 * d;
                    break;
                case "carmentaserver":
                case "qgis":
                    f.DPI = 90 * d;
                    break;
                default:
                    Fa(!1, 52)
                }
            e = e.be;
            this.Ge && "ne" == e.substr(0, 2) && (e = c[0],
            c[0] = c[1],
            c[1] = e,
            e = c[2],
            c[2] = c[3],
            c[3] = e);
            f.BBOX = c.join(",");
            return iw(1 == g.length ? g[0] : g[Oa((a[1] << a[0]) + a[2], g.length)], f)
        }
    }
    ;
    h.Og = function(a) {
        return this.rd && void 0 !== this.Ai ? a : 1
    }
    ;
    function Lw(a) {
        var b = 0
          , c = [];
        if (a.urls) {
            var d;
            var e = 0;
            for (d = a.urls.length; e < d; ++e)
                c[b++] = a.urls[e]
        }
        a.Xr = c.join("#")
    }
    h.Gj = function() {
        var a = 0, b = [], c;
        for (c in this.wa)
            b[a++] = c + "-" + this.wa[c];
        return b.join("/")
    }
    ;
    h.Eg = function(a, b, c) {
        var d = this.tileGrid;
        d || (d = this.Cb(c));
        if (!(d.Jd().length <= a[0])) {
            1 == b || this.rd && void 0 !== this.Ai || (b = 1);
            var e = d.O(a[0])
              , f = d.Oa(a, this.En);
            d = Sa(d.Zb(a[0]), this.tf);
            var g = this.Sj;
            0 !== g && (d = Qa(d, g, this.tf),
            f = Wa(f, e * g, f));
            1 != b && (d = Ra(d, b, this.tf));
            e = {
                SERVICE: "WMS",
                VERSION: "1.3.0",
                REQUEST: "GetMap",
                FORMAT: "image/png",
                TRANSPARENT: !0
            };
            yb(e, this.wa);
            return this.Xe(a, d, f, b, c, e)
        }
    }
    ;
    h.dc = function(a) {
        X.prototype.dc.call(this, a);
        Lw(this)
    }
    ;
    h.vf = function(a) {
        yb(this.wa, a);
        Lw(this);
        nw(this);
        Wv(this, this.Gj())
    }
    ;
    function Mw(a, b, c, d, e, f, g, k, l, m, n, p, q, t) {
        ys.call(this, a, b);
        this.$ = {};
        this.pq = {};
        this.Bd = m;
        this.gc = [];
        this.gd = c;
        this.Zq = f;
        this.Em = [];
        this.Cq = [];
        if (f) {
            var u = l.Oa(f)
              , x = l.O(a[0]);
            k.Lo(u, k.Pf(x), function(a) {
                var b = ub(u, k.Oa(a));
                if (.5 <= qb(b) / x && .5 <= rb(b) / x) {
                    b = a.toString();
                    var c = m[b];
                    c || (c = g(a, n, p),
                    c = m[b] = new q(a,void 0 == c ? 4 : 0,void 0 == c ? "" : c,d,e),
                    this.Cq.push(y(c, "change", t)));
                    c.vo++;
                    this.gc.push(b)
                }
            }
            .bind(this))
        }
    }
    v(Mw, ys);
    h = Mw.prototype;
    h.la = function() {
        for (var a = 0, b = this.gc.length; a < b; ++a) {
            var c = this.gc[a]
              , d = this.ua(c);
            d.vo--;
            0 == d.vo && (delete this.Bd[c],
            Vc(d))
        }
        this.gc.length = 0;
        this.Bd = null;
        1 == this.state && (this.Em.forEach(Mc),
        this.Em.length = 0);
        this.Tb && Vc(this.Tb);
        this.state = 5;
        this.a();
        this.Cq.forEach(Mc);
        this.Cq.length = 0;
        ys.prototype.la.call(this)
    }
    ;
    h.getContext = function(a) {
        a = w(a).toString();
        a in this.$ || (this.$[a] = pd());
        return this.$[a]
    }
    ;
    h.N = function(a) {
        return -1 == Jv(this, a).mq ? null : this.getContext(a).canvas
    }
    ;
    function Jv(a, b) {
        b = w(b).toString();
        b in a.pq || (a.pq[b] = {
            oj: !1,
            lq: null,
            fn: -1,
            mq: -1
        });
        return a.pq[b]
    }
    h.getKey = function() {
        return this.gc.join("/") + "/" + this.gd
    }
    ;
    h.ua = function(a) {
        return this.Bd[a]
    }
    ;
    h.load = function() {
        var a = 0;
        0 == this.state && this.Fb(1);
        1 == this.state && this.gc.forEach(function(b) {
            var c = this.ua(b);
            0 == c.state && (c.yq(this.Xf),
            c.load());
            if (1 == c.state) {
                var d = y(c, "change", function() {
                    var b = c.getState();
                    if (2 == b || 3 == b) {
                        --a;
                        Mc(d);
                        b = this.Em;
                        var f = b.indexOf(d);
                        -1 < f && b.splice(f, 1);
                        0 == a && this.rs()
                    }
                }
                .bind(this));
                this.Em.push(d);
                ++a
            }
        }
        .bind(this));
        0 == a && setTimeout(this.rs.bind(this), 0)
    }
    ;
    h.rs = function() {
        for (var a = !1, b = this.gc.length, c, d = b - 1; 0 <= d; --d)
            c = this.ua(this.gc[d]).getState(),
            2 != c && (3 == c && (a = !0),
            --b);
        this.Fb(0 < b ? 2 : a ? 3 : 4)
    }
    ;
    function Nw(a, b) {
        a.yq(rl(b, a.Id, a.wz.bind(a), a.vz.bind(a)))
    }
    ;function Ow(a, b, c, d, e) {
        ys.call(this, a, b);
        this.vo = 0;
        this.V = null;
        this.Id = d;
        this.Ca = null;
        this.oq = {};
        this.Kq = e;
        this.eb = c
    }
    v(Ow, ys);
    h = Ow.prototype;
    h.la = function() {
        this.Ca = null;
        this.oq = {};
        this.state = 5;
        this.a();
        ys.prototype.la.call(this)
    }
    ;
    h.c = function() {
        return this.V || Pw
    }
    ;
    h.Qh = function() {
        return this.Id
    }
    ;
    h.getFeatures = function() {
        return this.Ca
    }
    ;
    h.getKey = function() {
        return this.eb
    }
    ;
    h.M = function() {
        return this.Ic
    }
    ;
    function Lv(a, b, c) {
        return a.oq[w(b) + "," + c]
    }
    h.load = function() {
        0 == this.state && (this.Fb(1),
        this.Kq(this, this.eb),
        this.Xf(null, NaN, null))
    }
    ;
    h.wz = function(a, b, c) {
        this.lf(b);
        this.tu(a);
        this.Eb(c)
    }
    ;
    h.vz = function() {
        this.Fb(3)
    }
    ;
    h.Eb = function(a) {
        this.V = a
    }
    ;
    h.tu = function(a) {
        this.Ca = a;
        this.Fb(2)
    }
    ;
    h.lf = function(a) {
        this.Ic = a
    }
    ;
    h.yq = function(a) {
        this.Xf = a
    }
    ;
    var Pw = [0, 0, 4096, 4096];
    function Qw(a) {
        var b = a.projection || "EPSG:3857"
          , c = a.extent || Hc(b)
          , d = a.tileGrid || Fc({
            extent: c,
            maxZoom: a.maxZoom || 22,
            minZoom: a.minZoom,
            tileSize: a.tileSize || 512
        });
        Zv.call(this, {
            attributions: a.attributions,
            cacheSize: void 0 !== a.cacheSize ? a.cacheSize : 128,
            extent: c,
            logo: a.logo,
            opaque: !1,
            projection: b,
            state: a.state,
            tileGrid: d,
            tileLoadFunction: a.tileLoadFunction ? a.tileLoadFunction : Nw,
            tileUrlFunction: a.tileUrlFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 === a.wrapX ? !0 : a.wrapX
        });
        this.Id = a.format ? a.format : null;
        this.Bd = {};
        this.ri = void 0 == a.overlaps ? !0 : a.overlaps;
        this.tileClass = a.tileClass ? a.tileClass : Ow;
        this.Tu = {};
        this.tileGrid || (this.tileGrid = this.Cb(ec(a.projection || "EPSG:3857")))
    }
    v(Qw, Zv);
    Qw.prototype.ua = function(a, b, c, d, e) {
        var f = this.je(a, b, c);
        if (ek(this.Ra, f))
            return this.Ra.get(f);
        a = [a, b, c];
        c = (b = Xv(this, a, e)) ? this.tileUrlFunction(b, d, e) : void 0;
        d = new Mw(a,void 0 !== c ? 0 : 4,void 0 !== c ? c : "",this.Id,this.tileLoadFunction,b,this.tileUrlFunction,this.tileGrid,this.Cb(e),this.Bd,d,e,this.tileClass,this.Uj.bind(this));
        this.Ra.set(f, d);
        return d
    }
    ;
    Qw.prototype.Cb = function(a) {
        var b = a.qc
          , c = this.Tu[b];
        c || (c = this.tileGrid,
        c = this.Tu[b] = Ec(a, void 0, c ? c.Zb(c.Ng()) : void 0));
        return c
    }
    ;
    Qw.prototype.Og = function(a) {
        return a
    }
    ;
    Qw.prototype.Pj = function(a, b, c) {
        a = Sa(this.Cb(c).Zb(a));
        return [Math.round(a[0] * b), Math.round(a[1] * b)]
    }
    ;
    function Rw(a) {
        this.ut = a.matrixIds;
        vc.call(this, {
            extent: a.extent,
            origin: a.origin,
            origins: a.origins,
            resolutions: a.resolutions,
            tileSize: a.tileSize,
            tileSizes: a.tileSizes,
            sizes: a.sizes
        })
    }
    v(Rw, vc);
    Rw.prototype.tx = function() {
        return this.ut
    }
    ;
    function Sw(a, b, c) {
        var d = []
          , e = []
          , f = []
          , g = []
          , k = []
          , l = void 0 !== c ? c : [];
        c = ec(a.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/, "$1:$3"));
        var m = c.Mg()
          , n = "ne" == c.be.substr(0, 2);
        a.TileMatrix.sort(function(a, b) {
            return b.ScaleDenominator - a.ScaleDenominator
        });
        a.TileMatrix.forEach(function(a) {
            if (0 < l.length ? ua(l, function(b) {
                return a.Identifier == b.TileMatrix
            }) : 1) {
                e.push(a.Identifier);
                var b = 2.8E-4 * a.ScaleDenominator / m
                  , c = a.TileWidth
                  , p = a.TileHeight;
                n ? f.push([a.TopLeftCorner[1], a.TopLeftCorner[0]]) : f.push(a.TopLeftCorner);
                d.push(b);
                g.push(c == p ? c : [c, p]);
                k.push([a.MatrixWidth, -a.MatrixHeight])
            }
        });
        return new Rw({
            extent: b,
            origins: f,
            resolutions: d,
            matrixIds: e,
            tileSizes: g,
            sizes: k
        })
    }
    ;function Z(a) {
        function b(a) {
            a = "KVP" == d ? iw(a, f) : a.replace(/\{(\w+?)\}/g, function(a, b) {
                return b.toLowerCase()in f ? f[b.toLowerCase()] : a
            });
            return function(b) {
                if (b) {
                    var c = {
                        TileMatrix: e.ut[b[0]],
                        TileCol: b[1],
                        TileRow: -b[2] - 1
                    };
                    yb(c, g);
                    b = a;
                    return b = "KVP" == d ? iw(b, c) : b.replace(/\{(\w+?)\}/g, function(a, b) {
                        return c[b]
                    })
                }
            }
        }
        this.ev = void 0 !== a.version ? a.version : "1.0.0";
        this.Id = void 0 !== a.format ? a.format : "image/jpeg";
        this.mj = void 0 !== a.dimensions ? a.dimensions : {};
        this.Bm = a.layer;
        this.vt = a.matrixSet;
        this.Lc = a.style;
        var c = a.urls;
        void 0 === c && void 0 !== a.url && (c = Tv(a.url));
        var d = this.mu = void 0 !== a.requestEncoding ? a.requestEncoding : "KVP"
          , e = a.tileGrid
          , f = {
            layer: this.Bm,
            style: this.Lc,
            tilematrixset: this.vt
        };
        "KVP" == d && yb(f, {
            Service: "WMTS",
            Request: "GetTile",
            Version: this.ev,
            Format: this.Id
        });
        var g = this.mj
          , k = c && 0 < c.length ? Rv(c.map(b)) : Sv;
        X.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileClass: a.tileClass,
            tileGrid: e,
            tileLoadFunction: a.tileLoadFunction,
            tilePixelRatio: a.tilePixelRatio,
            tileUrlFunction: k,
            urls: c,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !1
        });
        Wv(this, Tw(this))
    }
    v(Z, X);
    h = Z.prototype;
    h.bx = function() {
        return this.mj
    }
    ;
    h.Qh = function() {
        return this.Id
    }
    ;
    h.ka = function() {
        return this.Bm
    }
    ;
    h.ux = function() {
        return this.vt
    }
    ;
    h.Fx = function() {
        return this.mu
    }
    ;
    h.Ye = function() {
        return this.Lc
    }
    ;
    h.Mx = function() {
        return this.ev
    }
    ;
    function Tw(a) {
        var b = 0, c = [], d;
        for (d in a.mj)
            c[b++] = d + "-" + a.mj[d];
        return c.join("/")
    }
    h.DB = function(a) {
        yb(this.mj, a);
        Wv(this, Tw(this))
    }
    ;
    function Uw(a) {
        a = a || {};
        var b = a.size
          , c = b[0]
          , d = b[1]
          , e = []
          , f = 256;
        switch (void 0 !== a.tierSizeCalculation ? a.tierSizeCalculation : Vw) {
        case Vw:
            for (; c > f || d > f; )
                e.push([Math.ceil(c / f), Math.ceil(d / f)]),
                f += f;
            break;
        case Ww:
            for (; c > f || d > f; )
                e.push([Math.ceil(c / f), Math.ceil(d / f)]),
                c >>= 1,
                d >>= 1;
            break;
        default:
            Fa(!1, 53)
        }
        e.push([1, 1]);
        e.reverse();
        f = [1];
        var g = [0];
        d = 1;
        for (c = e.length; d < c; d++)
            f.push(1 << d),
            g.push(e[d - 1][0] * e[d - 1][1] + g[d - 1]);
        f.reverse();
        b = [0, -b[1], b[0], 0];
        b = new vc({
            extent: b,
            origin: nb(b),
            resolutions: f
        });
        (f = a.url) && -1 == f.indexOf("{TileGroup}") && (f += "{TileGroup}/{z}-{x}-{y}.jpg");
        f = Tv(f);
        f = Rv(f.map(function(a) {
            return function(b) {
                if (b) {
                    var c = b[0]
                      , d = b[1];
                    b = -b[2] - 1;
                    var f = {
                        z: c,
                        x: d,
                        y: b,
                        TileGroup: "TileGroup" + ((d + b * e[c][0] + g[c]) / 256 | 0)
                    };
                    return a.replace(/\{(\w+?)\}/g, function(a, b) {
                        return f[b]
                    })
                }
            }
        }));
        X.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileClass: Xw,
            tileGrid: b,
            tileUrlFunction: f
        })
    }
    v(Uw, X);
    function Xw(a, b, c, d, e) {
        Bs.call(this, a, b, c, d, e);
        this.Wn = null
    }
    v(Xw, Bs);
    Xw.prototype.N = function() {
        if (this.Wn)
            return this.Wn;
        var a = Bs.prototype.N.call(this);
        if (2 == this.state) {
            if (256 == a.width && 256 == a.height)
                return this.Wn = a;
            var b = pd(256, 256);
            b.drawImage(a, 0, 0);
            return this.Wn = b.canvas
        }
        return a
    }
    ;
    var Vw = "default"
      , Ww = "truncated";
    Ea.prototype.code = Ea.prototype.code;
    r("ol.Attribution", Ic);
    Ic.prototype.getHTML = Ic.prototype.ix;
    r("ol.Collection", C);
    C.prototype.clear = C.prototype.clear;
    C.prototype.extend = C.prototype.extend;
    C.prototype.forEach = C.prototype.forEach;
    C.prototype.getArray = C.prototype.ie;
    C.prototype.item = C.prototype.item;
    C.prototype.getLength = C.prototype.Wb;
    C.prototype.insertAt = C.prototype.sm;
    C.prototype.pop = C.prototype.pop;
    C.prototype.push = C.prototype.push;
    C.prototype.remove = C.prototype.remove;
    C.prototype.removeAt = C.prototype.gq;
    C.prototype.setAt = C.prototype.IA;
    hd.prototype.element = hd.prototype.element;
    r("ol.color.asArray", kd);
    r("ol.color.asString", md);
    r("ol.colorlike.asColorLike", od);
    r("ol.control.defaults", Cd);
    r("ol.coordinate.add", af);
    r("ol.coordinate.createStringXY", function(a) {
        return function(b) {
            return nf(b, a)
        }
    });
    r("ol.coordinate.format", ef);
    r("ol.coordinate.rotate", gf);
    r("ol.coordinate.toStringHDMS", function(a, b) {
        return a ? df("NS", a[1], b) + " " + df("EW", a[0], b) : ""
    });
    r("ol.coordinate.toStringXY", nf);
    r("ol.DeviceOrientation", Gk);
    Gk.prototype.getAlpha = Gk.prototype.Uw;
    Gk.prototype.getBeta = Gk.prototype.Yw;
    Gk.prototype.getGamma = Gk.prototype.fx;
    Gk.prototype.getHeading = Gk.prototype.Yo;
    Gk.prototype.getTracking = Gk.prototype.Rj;
    Gk.prototype.setTracking = Gk.prototype.hg;
    r("ol.easing.easeIn", vd);
    r("ol.easing.easeOut", wd);
    r("ol.easing.inAndOut", xd);
    r("ol.easing.linear", yd);
    r("ol.easing.upAndDown", function(a) {
        return .5 > a ? xd(2 * a) : 1 - xd(2 * (a - .5))
    });
    r("ol.extent.boundingExtent", Ta);
    r("ol.extent.buffer", Wa);
    r("ol.extent.containsCoordinate", Za);
    r("ol.extent.containsExtent", ab);
    r("ol.extent.containsXY", $a);
    r("ol.extent.createEmpty", Ua);
    r("ol.extent.equals", hb);
    r("ol.extent.extend", ib);
    r("ol.extent.getArea", ob);
    r("ol.extent.getBottomLeft", kb);
    r("ol.extent.getBottomRight", lb);
    r("ol.extent.getCenter", sb);
    r("ol.extent.getHeight", rb);
    r("ol.extent.getIntersection", ub);
    r("ol.extent.getSize", function(a) {
        return [a[2] - a[0], a[3] - a[1]]
    });
    r("ol.extent.getTopLeft", nb);
    r("ol.extent.getTopRight", mb);
    r("ol.extent.getWidth", qb);
    r("ol.extent.intersects", vb);
    r("ol.extent.isEmpty", pb);
    r("ol.extent.applyTransform", xb);
    r("ol.Feature", Wk);
    Wk.prototype.clone = Wk.prototype.clone;
    Wk.prototype.getGeometry = Wk.prototype.I;
    Wk.prototype.getId = Wk.prototype.Ej;
    Wk.prototype.getGeometryName = Wk.prototype.hx;
    Wk.prototype.getStyle = Wk.prototype.Ye;
    Wk.prototype.getStyleFunction = Wk.prototype.Xb;
    Wk.prototype.setGeometry = Wk.prototype.Ab;
    Wk.prototype.setStyle = Wk.prototype.Gb;
    Wk.prototype.setId = Wk.prototype.kf;
    Wk.prototype.setGeometryName = Wk.prototype.lh;
    r("ol.featureloader.loadFeaturesXhr", rl);
    r("ol.featureloader.xhr", sl);
    r("ol.Geolocation", ks);
    ks.prototype.getAccuracy = ks.prototype.Sw;
    ks.prototype.getAccuracyGeometry = ks.prototype.Tw;
    ks.prototype.getAltitude = ks.prototype.Vw;
    ks.prototype.getAltitudeAccuracy = ks.prototype.Ww;
    ks.prototype.getHeading = ks.prototype.Yo;
    ks.prototype.getPosition = ks.prototype.Ul;
    ks.prototype.getProjection = ks.prototype.M;
    ks.prototype.getSpeed = ks.prototype.Gx;
    ks.prototype.getTracking = ks.prototype.Rj;
    ks.prototype.getTrackingOptions = ks.prototype.Qs;
    ks.prototype.setProjection = ks.prototype.lf;
    ks.prototype.setTracking = ks.prototype.hg;
    ks.prototype.setTrackingOptions = ks.prototype.Eu;
    r("ol.Graticule", qs);
    qs.prototype.getMap = qs.prototype.B;
    qs.prototype.getMeridians = qs.prototype.vx;
    qs.prototype.getParallels = qs.prototype.Cx;
    qs.prototype.setMap = qs.prototype.setMap;
    r("ol.has.DEVICE_PIXEL_RATIO", Xd);
    r("ol.has.CANVAS", Zd);
    r("ol.has.DEVICE_ORIENTATION", $d);
    r("ol.has.GEOLOCATION", ae);
    r("ol.has.TOUCH", be);
    r("ol.has.WEBGL", Rd);
    ws.prototype.getImage = ws.prototype.N;
    ws.prototype.load = ws.prototype.load;
    Bs.prototype.getImage = Bs.prototype.N;
    r("ol.inherits", v);
    r("ol.interaction.defaults", qh);
    r("ol.Kinetic", ng);
    r("ol.loadingstrategy.all", Gt);
    r("ol.loadingstrategy.bbox", function(a) {
        return [a]
    });
    r("ol.loadingstrategy.tile", function(a) {
        return function(b, c) {
            c = a.Pf(c);
            b = a.xc(b, c);
            var d = [];
            c = [c, 0, 0];
            for (c[1] = b.ba; c[1] <= b.ea; ++c[1])
                for (c[2] = b.ca; c[2] <= b.fa; ++c[2])
                    d.push(a.Oa(c));
            return d
        }
    });
    r("ol.Map", I);
    I.prototype.addControl = I.prototype.aw;
    I.prototype.addInteraction = I.prototype.bw;
    I.prototype.addLayer = I.prototype.Br;
    I.prototype.addOverlay = I.prototype.Cr;
    I.prototype.forEachFeatureAtPixel = I.prototype.wj;
    I.prototype.getFeaturesAtPixel = I.prototype.cx;
    I.prototype.forEachLayerAtPixel = I.prototype.Mf;
    I.prototype.hasFeatureAtPixel = I.prototype.Dy;
    I.prototype.getEventCoordinate = I.prototype.To;
    I.prototype.getEventPixel = I.prototype.Sl;
    I.prototype.getTarget = I.prototype.fp;
    I.prototype.getTargetElement = I.prototype.Yh;
    I.prototype.getCoordinateFromPixel = I.prototype.Jb;
    I.prototype.getFrameState = I.prototype.ex;
    I.prototype.uid = I.prototype.uid;
    I.prototype.getControls = I.prototype.ax;
    I.prototype.getOverlays = I.prototype.Ax;
    I.prototype.getOverlayById = I.prototype.zx;
    I.prototype.getInteractions = I.prototype.lx;
    I.prototype.getLayerGroup = I.prototype.Lg;
    I.prototype.getLayers = I.prototype.Te;
    I.prototype.getPixelFromCoordinate = I.prototype.gb;
    I.prototype.getSize = I.prototype.Ga;
    I.prototype.getView = I.prototype.R;
    I.prototype.getViewport = I.prototype.Nx;
    I.prototype.renderSync = I.prototype.BA;
    I.prototype.render = I.prototype.render;
    I.prototype.removeControl = I.prototype.tA;
    I.prototype.removeInteraction = I.prototype.uA;
    I.prototype.removeLayer = I.prototype.wA;
    I.prototype.removeOverlay = I.prototype.xA;
    I.prototype.setLayerGroup = I.prototype.xu;
    I.prototype.setSize = I.prototype.zq;
    I.prototype.setTarget = I.prototype.ac;
    I.prototype.setView = I.prototype.WA;
    I.prototype.updateSize = I.prototype.Pi;
    Od.prototype.originalEvent = Od.prototype.originalEvent;
    Od.prototype.pixel = Od.prototype.pixel;
    Od.prototype.coordinate = Od.prototype.coordinate;
    Od.prototype.dragging = Od.prototype.dragging;
    Nd.prototype.map = Nd.prototype.map;
    Nd.prototype.frameState = Nd.prototype.frameState;
    r("ol.Object", $c);
    $c.prototype.get = $c.prototype.get;
    $c.prototype.getKeys = $c.prototype.v;
    $c.prototype.getProperties = $c.prototype.l;
    $c.prototype.set = $c.prototype.set;
    $c.prototype.setProperties = $c.prototype.f;
    $c.prototype.unset = $c.prototype.A;
    dd.prototype.key = dd.prototype.key;
    dd.prototype.oldValue = dd.prototype.oldValue;
    r("ol.Observable", Zc);
    r("ol.Observable.unByKey", function(a) {
        if (Array.isArray(a))
            for (var b = 0, c = a.length; b < c; ++b)
                Mc(a[b]);
        else
            Mc(a)
    });
    Zc.prototype.changed = Zc.prototype.a;
    Zc.prototype.dispatchEvent = Zc.prototype.dispatchEvent;
    Zc.prototype.getRevision = Zc.prototype.o;
    Zc.prototype.on = Zc.prototype.g;
    Zc.prototype.once = Zc.prototype.once;
    Zc.prototype.un = Zc.prototype.j;
    r("ol.Overlay", kk);
    kk.prototype.getElement = kk.prototype.Cj;
    kk.prototype.getId = kk.prototype.Ej;
    kk.prototype.getMap = kk.prototype.B;
    kk.prototype.getOffset = kk.prototype.Ks;
    kk.prototype.getPosition = kk.prototype.Ul;
    kk.prototype.getPositioning = kk.prototype.Ms;
    kk.prototype.setElement = kk.prototype.su;
    kk.prototype.setMap = kk.prototype.setMap;
    kk.prototype.setOffset = kk.prototype.yu;
    kk.prototype.setPosition = kk.prototype.setPosition;
    kk.prototype.setPositioning = kk.prototype.Cu;
    r("ol.proj.METERS_PER_UNIT", Ib);
    r("ol.proj.setProj4", function(a) {
        Kb = a
    });
    r("ol.proj.getPointResolution", dc);
    r("ol.proj.addEquivalentProjections", gc);
    r("ol.proj.addProjection", hc);
    r("ol.proj.addCoordinateTransforms", lc);
    r("ol.proj.fromLonLat", function(a, b) {
        return qc(a, "EPSG:4326", void 0 !== b ? b : "EPSG:3857")
    });
    r("ol.proj.toLonLat", function(a, b) {
        return qc(a, void 0 !== b ? b : "EPSG:3857", "EPSG:4326")
    });
    r("ol.proj.get", ec);
    r("ol.proj.equivalent", nc);
    r("ol.proj.getTransform", oc);
    r("ol.proj.transform", qc);
    r("ol.proj.transformExtent", rc);
    r("ol.render.toContext", function(a, b) {
        var c = a.canvas
          , d = b ? b : {};
        b = d.pixelRatio || Xd;
        if (d = d.size)
            c.width = d[0] * b,
            c.height = d[1] * b,
            c.style.width = d[0] + "px",
            c.style.height = d[1] + "px";
        c = [0, 0, c.width, c.height];
        d = Hh(Ah(), b, b);
        return new Wh(a,b,c,d,0)
    });
    r("ol.size.toSize", Sa);
    r("ol.Sphere", Cb);
    Cb.prototype.geodesicArea = Cb.prototype.Rw;
    Cb.prototype.haversineDistance = Cb.prototype.pp;
    r("ol.Sphere.getLength", Fb);
    r("ol.Sphere.getArea", Hb);
    ys.prototype.getKey = ys.prototype.getKey;
    ys.prototype.getTileCoord = ys.prototype.Nj;
    ys.prototype.getState = ys.prototype.getState;
    ys.prototype.load = ys.prototype.load;
    r("ol.tilegrid.createXYZ", Fc);
    Te.prototype.enqueue = Te.prototype.enqueue;
    Te.prototype.loadMoreTiles = Te.prototype.Ep;
    Ga.prototype.getValues = Ga.prototype.Rs;
    Ow.prototype.getFormat = Ow.prototype.Qh;
    Ow.prototype.getFeatures = Ow.prototype.getFeatures;
    Ow.prototype.getProjection = Ow.prototype.M;
    Ow.prototype.setExtent = Ow.prototype.Eb;
    Ow.prototype.setFeatures = Ow.prototype.tu;
    Ow.prototype.setProjection = Ow.prototype.lf;
    Ow.prototype.setLoader = Ow.prototype.yq;
    r("ol.View", H);
    H.prototype.animate = H.prototype.rb;
    H.prototype.getAnimating = H.prototype.Ig;
    H.prototype.getInteracting = H.prototype.kx;
    H.prototype.cancelAnimations = H.prototype.Bh;
    H.prototype.constrainCenter = H.prototype.Cg;
    H.prototype.constrainResolution = H.prototype.constrainResolution;
    H.prototype.constrainRotation = H.prototype.constrainRotation;
    H.prototype.getCenter = H.prototype.Fa;
    H.prototype.calculateExtent = H.prototype.Ah;
    H.prototype.getMaxResolution = H.prototype.uc;
    H.prototype.getMinResolution = H.prototype.vc;
    H.prototype.getMaxZoom = H.prototype.Ij;
    H.prototype.setMaxZoom = H.prototype.QA;
    H.prototype.getMinZoom = H.prototype.Ng;
    H.prototype.setMinZoom = H.prototype.RA;
    H.prototype.getProjection = H.prototype.M;
    H.prototype.getResolution = H.prototype.O;
    H.prototype.getResolutions = H.prototype.Jd;
    H.prototype.getResolutionForExtent = H.prototype.Vl;
    H.prototype.getRotation = H.prototype.ma;
    H.prototype.getZoom = H.prototype.Ss;
    H.prototype.getZoomForResolution = H.prototype.Yl;
    H.prototype.getResolutionForZoom = H.prototype.Ps;
    H.prototype.fit = H.prototype.Io;
    H.prototype.centerOn = H.prototype.pw;
    H.prototype.rotate = H.prototype.rotate;
    H.prototype.setCenter = H.prototype.Jc;
    H.prototype.setResolution = H.prototype.nh;
    H.prototype.setRotation = H.prototype.Wd;
    H.prototype.setZoom = H.prototype.ZA;
    r("ol.xml.getAllTextContent", $k);
    r("ol.xml.parse", dl);
    Gi.prototype.getGL = Gi.prototype.Hs;
    Gi.prototype.useProgram = Gi.prototype.useProgram;
    r("ol.tilegrid.TileGrid", vc);
    vc.prototype.forEachTileCoord = vc.prototype.Lo;
    vc.prototype.getMaxZoom = vc.prototype.Ij;
    vc.prototype.getMinZoom = vc.prototype.Ng;
    vc.prototype.getOrigin = vc.prototype.ic;
    vc.prototype.getResolution = vc.prototype.O;
    vc.prototype.getResolutions = vc.prototype.Jd;
    vc.prototype.getTileRangeForExtentAndResolution = vc.prototype.Qj;
    vc.prototype.getTileRangeForExtentAndZ = vc.prototype.xc;
    vc.prototype.getTileCoordCenter = vc.prototype.Oj;
    vc.prototype.getTileCoordExtent = vc.prototype.Oa;
    vc.prototype.getTileCoordForCoordAndResolution = vc.prototype.Xl;
    vc.prototype.getTileCoordForCoordAndZ = vc.prototype.ip;
    vc.prototype.getTileSize = vc.prototype.Zb;
    vc.prototype.getZForResolution = vc.prototype.Pf;
    r("ol.tilegrid.WMTS", Rw);
    Rw.prototype.getMatrixIds = Rw.prototype.tx;
    r("ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet", Sw);
    r("ol.style.AtlasManager", Rj);
    r("ol.style.Circle", Ok);
    Ok.prototype.setRadius = Ok.prototype.mh;
    r("ol.style.Fill", Pk);
    Pk.prototype.clone = Pk.prototype.clone;
    Pk.prototype.getColor = Pk.prototype.Aj;
    Pk.prototype.setColor = Pk.prototype.vq;
    r("ol.style.Icon", Sn);
    Sn.prototype.clone = Sn.prototype.clone;
    Sn.prototype.getAnchor = Sn.prototype.Hg;
    Sn.prototype.getColor = Sn.prototype.Aj;
    Sn.prototype.getImage = Sn.prototype.N;
    Sn.prototype.getOrigin = Sn.prototype.ic;
    Sn.prototype.getSrc = Sn.prototype.Lj;
    Sn.prototype.getSize = Sn.prototype.Ga;
    Sn.prototype.load = Sn.prototype.load;
    r("ol.style.Image", Mk);
    Mk.prototype.getOpacity = Mk.prototype.tb;
    Mk.prototype.getRotateWithView = Mk.prototype.Uh;
    Mk.prototype.getRotation = Mk.prototype.ma;
    Mk.prototype.getScale = Mk.prototype.Vh;
    Mk.prototype.getSnapToPixel = Mk.prototype.Wl;
    Mk.prototype.setOpacity = Mk.prototype.oc;
    Mk.prototype.setRotation = Mk.prototype.Wd;
    Mk.prototype.setScale = Mk.prototype.mf;
    r("ol.style.RegularShape", Nk);
    Nk.prototype.clone = Nk.prototype.clone;
    Nk.prototype.getAnchor = Nk.prototype.Hg;
    Nk.prototype.getAngle = Nk.prototype.No;
    Nk.prototype.getFill = Nk.prototype.Ph;
    Nk.prototype.getImage = Nk.prototype.N;
    Nk.prototype.getOrigin = Nk.prototype.ic;
    Nk.prototype.getPoints = Nk.prototype.We;
    Nk.prototype.getRadius = Nk.prototype.wc;
    Nk.prototype.getRadius2 = Nk.prototype.Ns;
    Nk.prototype.getSize = Nk.prototype.Ga;
    Nk.prototype.getStroke = Nk.prototype.Xh;
    r("ol.style.Stroke", nj);
    nj.prototype.clone = nj.prototype.clone;
    nj.prototype.getColor = nj.prototype.Aj;
    nj.prototype.getLineCap = nj.prototype.ox;
    nj.prototype.getLineDash = nj.prototype.getLineDash;
    nj.prototype.getLineDashOffset = nj.prototype.px;
    nj.prototype.getLineJoin = nj.prototype.qx;
    nj.prototype.getMiterLimit = nj.prototype.wx;
    nj.prototype.getWidth = nj.prototype.Sb;
    nj.prototype.setColor = nj.prototype.vq;
    nj.prototype.setLineCap = nj.prototype.NA;
    nj.prototype.setLineDash = nj.prototype.setLineDash;
    nj.prototype.setLineDashOffset = nj.prototype.OA;
    nj.prototype.setLineJoin = nj.prototype.PA;
    nj.prototype.setMiterLimit = nj.prototype.SA;
    nj.prototype.setWidth = nj.prototype.XA;
    r("ol.style.Style", Qk);
    Qk.prototype.clone = Qk.prototype.clone;
    Qk.prototype.getRenderer = Qk.prototype.Os;
    Qk.prototype.setRenderer = Qk.prototype.UA;
    Qk.prototype.getGeometry = Qk.prototype.I;
    Qk.prototype.getGeometryFunction = Qk.prototype.gx;
    Qk.prototype.getFill = Qk.prototype.Ph;
    Qk.prototype.setFill = Qk.prototype.ln;
    Qk.prototype.getImage = Qk.prototype.N;
    Qk.prototype.setImage = Qk.prototype.xq;
    Qk.prototype.getStroke = Qk.prototype.Xh;
    Qk.prototype.setStroke = Qk.prototype.nn;
    Qk.prototype.getText = Qk.prototype.gp;
    Qk.prototype.setText = Qk.prototype.Bi;
    Qk.prototype.getZIndex = Qk.prototype.La;
    Qk.prototype.setGeometry = Qk.prototype.Ab;
    Qk.prototype.setZIndex = Qk.prototype.Ae;
    r("ol.style.Text", Tn);
    Tn.prototype.clone = Tn.prototype.clone;
    Tn.prototype.getFont = Tn.prototype.dx;
    Tn.prototype.getOffsetX = Tn.prototype.xx;
    Tn.prototype.getOffsetY = Tn.prototype.yx;
    Tn.prototype.getFill = Tn.prototype.Ph;
    Tn.prototype.getRotateWithView = Tn.prototype.Uh;
    Tn.prototype.getRotation = Tn.prototype.ma;
    Tn.prototype.getScale = Tn.prototype.Vh;
    Tn.prototype.getStroke = Tn.prototype.Xh;
    Tn.prototype.getText = Tn.prototype.gp;
    Tn.prototype.getTextAlign = Tn.prototype.Ix;
    Tn.prototype.getTextBaseline = Tn.prototype.Jx;
    Tn.prototype.setFont = Tn.prototype.uu;
    Tn.prototype.setOffsetX = Tn.prototype.zu;
    Tn.prototype.setOffsetY = Tn.prototype.Au;
    Tn.prototype.setFill = Tn.prototype.ln;
    Tn.prototype.setRotation = Tn.prototype.Wd;
    Tn.prototype.setScale = Tn.prototype.mf;
    Tn.prototype.setStroke = Tn.prototype.nn;
    Tn.prototype.setText = Tn.prototype.Bi;
    Tn.prototype.setTextAlign = Tn.prototype.Du;
    Tn.prototype.setTextBaseline = Tn.prototype.VA;
    Oe.prototype.isKeyQueued = Oe.prototype.zp;
    r("ol.source.BingMaps", cw);
    r("ol.source.BingMaps.TOS_ATTRIBUTION", dw);
    cw.prototype.getApiKey = cw.prototype.Xw;
    cw.prototype.getImagerySet = cw.prototype.jx;
    r("ol.source.CartoDB", fw);
    fw.prototype.getConfig = fw.prototype.$w;
    fw.prototype.updateConfig = fw.prototype.CB;
    fw.prototype.setConfig = fw.prototype.JA;
    r("ol.source.Cluster", Y);
    Y.prototype.getDistance = Y.prototype.So;
    Y.prototype.getSource = Y.prototype.Y;
    Y.prototype.setDistance = Y.prototype.KA;
    r("ol.source.Image", jv);
    lv.prototype.image = lv.prototype.image;
    r("ol.source.ImageArcGISRest", jw);
    jw.prototype.getParams = jw.prototype.Ve;
    jw.prototype.getImageLoadFunction = jw.prototype.Fj;
    jw.prototype.getUrl = jw.prototype.Of;
    jw.prototype.setImageLoadFunction = jw.prototype.Fk;
    jw.prototype.setUrl = jw.prototype.Hb;
    jw.prototype.updateParams = jw.prototype.vf;
    r("ol.source.ImageCanvas", qv);
    r("ol.source.ImageMapGuide", kw);
    kw.prototype.getParams = kw.prototype.Ve;
    kw.prototype.getImageLoadFunction = kw.prototype.Fj;
    kw.prototype.updateParams = kw.prototype.vf;
    kw.prototype.setImageLoadFunction = kw.prototype.Fk;
    r("ol.source.ImageStatic", lw);
    r("ol.source.ImageVector", rv);
    rv.prototype.getSource = rv.prototype.Y;
    rv.prototype.getStyle = rv.prototype.Ye;
    rv.prototype.getStyleFunction = rv.prototype.Xb;
    rv.prototype.setStyle = rv.prototype.Gb;
    r("ol.source.ImageWMS", mw);
    mw.prototype.getGetFeatureInfoUrl = mw.prototype.Vo;
    mw.prototype.getParams = mw.prototype.Ve;
    mw.prototype.getImageLoadFunction = mw.prototype.Fj;
    mw.prototype.getUrl = mw.prototype.Of;
    mw.prototype.setImageLoadFunction = mw.prototype.Fk;
    mw.prototype.setUrl = mw.prototype.Hb;
    mw.prototype.updateParams = mw.prototype.vf;
    r("ol.source.OSM", pw);
    r("ol.source.OSM.ATTRIBUTION", qw);
    r("ol.source.Raster", rw);
    rw.prototype.setOperation = rw.prototype.Bu;
    vw.prototype.extent = vw.prototype.extent;
    vw.prototype.resolution = vw.prototype.resolution;
    vw.prototype.data = vw.prototype.data;
    r("ol.source.Source", Ht);
    Ht.prototype.getAttributions = Ht.prototype.Ea;
    Ht.prototype.getLogo = Ht.prototype.Ka;
    Ht.prototype.getProjection = Ht.prototype.M;
    Ht.prototype.getState = Ht.prototype.getState;
    Ht.prototype.refresh = Ht.prototype.refresh;
    Ht.prototype.setAttributions = Ht.prototype.xa;
    r("ol.source.Stamen", yw);
    r("ol.source.Tile", Vv);
    Vv.prototype.getTile = Vv.prototype.ua;
    Vv.prototype.getTileGrid = Vv.prototype.Yb;
    Yv.prototype.tile = Yv.prototype.tile;
    r("ol.source.TileArcGISRest", Cw);
    Cw.prototype.getParams = Cw.prototype.Ve;
    Cw.prototype.updateParams = Cw.prototype.vf;
    r("ol.source.TileDebug", Dw);
    r("ol.source.TileImage", X);
    X.prototype.setRenderReprojectionEdges = X.prototype.Vd;
    X.prototype.setTileGridForProjection = X.prototype.Xd;
    r("ol.source.TileJSON", Fw);
    Fw.prototype.getTileJSON = Fw.prototype.Kx;
    r("ol.source.TileUTFGrid", Gw);
    Gw.prototype.getTemplate = Gw.prototype.Hx;
    Gw.prototype.forDataAtCoordinateAndResolution = Gw.prototype.Jw;
    r("ol.source.TileWMS", Kw);
    Kw.prototype.getGetFeatureInfoUrl = Kw.prototype.Vo;
    Kw.prototype.getParams = Kw.prototype.Ve;
    Kw.prototype.updateParams = Kw.prototype.vf;
    Zv.prototype.getTileLoadFunction = Zv.prototype.Tc;
    Zv.prototype.getTileUrlFunction = Zv.prototype.Uc;
    Zv.prototype.getUrls = Zv.prototype.Vc;
    Zv.prototype.setTileLoadFunction = Zv.prototype.ed;
    Zv.prototype.setTileUrlFunction = Zv.prototype.cc;
    Zv.prototype.setUrl = Zv.prototype.Hb;
    Zv.prototype.setUrls = Zv.prototype.dc;
    r("ol.source.Vector", U);
    U.prototype.addFeature = U.prototype.jd;
    U.prototype.addFeatures = U.prototype.vg;
    U.prototype.clear = U.prototype.clear;
    U.prototype.forEachFeature = U.prototype.xs;
    U.prototype.forEachFeatureInExtent = U.prototype.forEachFeatureInExtent;
    U.prototype.forEachFeatureIntersectingExtent = U.prototype.ys;
    U.prototype.getFeaturesCollection = U.prototype.Gs;
    U.prototype.getFeatures = U.prototype.getFeatures;
    U.prototype.getFeaturesAtCoordinate = U.prototype.Fs;
    U.prototype.getFeaturesInExtent = U.prototype.Uo;
    U.prototype.getClosestFeatureToCoordinate = U.prototype.Bs;
    U.prototype.getExtent = U.prototype.c;
    U.prototype.getFeatureById = U.prototype.Es;
    U.prototype.getFormat = U.prototype.Qh;
    U.prototype.getUrl = U.prototype.Of;
    U.prototype.removeFeature = U.prototype.zd;
    Nt.prototype.feature = Nt.prototype.feature;
    r("ol.source.VectorTile", Qw);
    r("ol.source.WMTS", Z);
    Z.prototype.getDimensions = Z.prototype.bx;
    Z.prototype.getFormat = Z.prototype.Qh;
    Z.prototype.getLayer = Z.prototype.ka;
    Z.prototype.getMatrixSet = Z.prototype.ux;
    Z.prototype.getRequestEncoding = Z.prototype.Fx;
    Z.prototype.getStyle = Z.prototype.Ye;
    Z.prototype.getVersion = Z.prototype.Mx;
    Z.prototype.updateDimensions = Z.prototype.DB;
    r("ol.source.WMTS.optionsFromCapabilities", function(a, b) {
        var c = ua(a.Contents.Layer, function(a) {
            return a.Identifier == b.layer
        });
        if (null === c)
            return null;
        var d = a.Contents.TileMatrixSet;
        var e = 1 < c.TileMatrixSetLink.length ? "projection"in b ? za(c.TileMatrixSetLink, function(a) {
            var c = ua(d, function(b) {
                return b.Identifier == a.TileMatrixSet
            }).SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/, "$1:$3")
              , e = ec(c)
              , f = ec(b.projection);
            return e && f ? nc(e, f) : c == b.projection
        }) : za(c.TileMatrixSetLink, function(a) {
            return a.TileMatrixSet == b.matrixSet
        }) : 0;
        0 > e && (e = 0);
        var f = c.TileMatrixSetLink[e].TileMatrixSet;
        var g = c.TileMatrixSetLink[e].TileMatrixSetLimits;
        var k = c.Format[0];
        "format"in b && (k = b.format);
        e = za(c.Style, function(a) {
            return "style"in b ? a.Title == b.style : a.isDefault
        });
        0 > e && (e = 0);
        e = c.Style[e].Identifier;
        var l = {};
        "Dimension"in c && c.Dimension.forEach(function(a) {
            var b = a.Identifier
              , c = a.Default;
            void 0 === c && (c = a.Value[0]);
            l[b] = c
        });
        var m = ua(a.Contents.TileMatrixSet, function(a) {
            return a.Identifier == f
        });
        var n = "projection"in b ? ec(b.projection) : ec(m.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/, "$1:$3"));
        var p = c.WGS84BoundingBox;
        if (void 0 !== p) {
            var q = ec("EPSG:4326").c();
            q = p[0] == q[0] && p[2] == q[2];
            var t = rc(p, "EPSG:4326", n);
            (p = n.c()) && (ab(p, t) || (t = void 0))
        }
        g = Sw(m, t, g);
        var u = [];
        m = b.requestEncoding;
        m = void 0 !== m ? m : "";
        if ("OperationsMetadata"in a && "GetTile"in a.OperationsMetadata)
            for (a = a.OperationsMetadata.GetTile.DCP.HTTP.Get,
            t = 0,
            p = a.length; t < p; ++t) {
                var x = ua(a[t].Constraint, function(a) {
                    return "GetEncoding" == a.name
                }).AllowedValues.Value;
                "" === m && (m = x[0]);
                if ("KVP" === m)
                    ra(x, "KVP") && u.push(a[t].href);
                else
                    break
            }
        0 === u.length && (m = "REST",
        c.ResourceURL.forEach(function(a) {
            "tile" === a.resourceType && (k = a.format,
            u.push(a.template))
        }));
        return {
            urls: u,
            layer: b.layer,
            matrixSet: f,
            format: k,
            projection: n,
            requestEncoding: m,
            tileGrid: g,
            style: e,
            dimensions: l,
            wrapX: q,
            crossOrigin: b.crossOrigin
        }
    });
    r("ol.source.XYZ", ew);
    r("ol.source.Zoomify", Uw);
    Qh.prototype.vectorContext = Qh.prototype.vectorContext;
    Qh.prototype.frameState = Qh.prototype.frameState;
    Qh.prototype.context = Qh.prototype.context;
    Qh.prototype.glContext = Qh.prototype.glContext;
    Zp.prototype.get = Zp.prototype.get;
    Zp.prototype.getExtent = Zp.prototype.c;
    Zp.prototype.getId = Zp.prototype.Ej;
    Zp.prototype.getGeometry = Zp.prototype.I;
    Zp.prototype.getProperties = Zp.prototype.l;
    Zp.prototype.getType = Zp.prototype.D;
    r("ol.render.VectorContext", Vh);
    ck.prototype.setStyle = ck.prototype.Gb;
    ck.prototype.drawGeometry = ck.prototype.ld;
    ck.prototype.drawFeature = ck.prototype.Il;
    Wh.prototype.drawCircle = Wh.prototype.Qe;
    Wh.prototype.setStyle = Wh.prototype.Gb;
    Wh.prototype.drawGeometry = Wh.prototype.ld;
    Wh.prototype.drawFeature = Wh.prototype.Il;
    r("ol.proj.common.add", sc);
    r("ol.proj.Projection", Lb);
    Lb.prototype.getCode = Lb.prototype.Zw;
    Lb.prototype.getExtent = Lb.prototype.c;
    Lb.prototype.getUnits = Lb.prototype.pd;
    Lb.prototype.getMetersPerUnit = Lb.prototype.Mg;
    Lb.prototype.getWorldExtent = Lb.prototype.Ox;
    Lb.prototype.isGlobal = Lb.prototype.Oy;
    Lb.prototype.setGlobal = Lb.prototype.MA;
    Lb.prototype.setExtent = Lb.prototype.Eb;
    Lb.prototype.setWorldExtent = Lb.prototype.YA;
    Lb.prototype.setGetPointResolution = Lb.prototype.LA;
    r("ol.proj.Units.METERS_PER_UNIT", Ib);
    r("ol.layer.Base", rh);
    rh.prototype.getExtent = rh.prototype.c;
    rh.prototype.getMaxResolution = rh.prototype.uc;
    rh.prototype.getMinResolution = rh.prototype.vc;
    rh.prototype.getOpacity = rh.prototype.tb;
    rh.prototype.getVisible = rh.prototype.ke;
    rh.prototype.getZIndex = rh.prototype.La;
    rh.prototype.setExtent = rh.prototype.Eb;
    rh.prototype.setMaxResolution = rh.prototype.fg;
    rh.prototype.setMinResolution = rh.prototype.gg;
    rh.prototype.setOpacity = rh.prototype.oc;
    rh.prototype.setVisible = rh.prototype.Yd;
    rh.prototype.setZIndex = rh.prototype.Ae;
    r("ol.layer.Group", th);
    th.prototype.getLayers = th.prototype.Te;
    th.prototype.setLayers = th.prototype.mn;
    r("ol.layer.Heatmap", W);
    W.prototype.getBlur = W.prototype.As;
    W.prototype.getGradient = W.prototype.Is;
    W.prototype.getRadius = W.prototype.wc;
    W.prototype.setBlur = W.prototype.qu;
    W.prototype.setGradient = W.prototype.wu;
    W.prototype.setRadius = W.prototype.mh;
    r("ol.layer.Image", wv);
    wv.prototype.getSource = wv.prototype.Y;
    r("ol.layer.Layer", vh);
    vh.prototype.getSource = vh.prototype.Y;
    vh.prototype.setMap = vh.prototype.setMap;
    vh.prototype.setSource = vh.prototype.oh;
    r("ol.layer.Tile", Fv);
    Fv.prototype.getPreload = Fv.prototype.Th;
    Fv.prototype.getSource = Fv.prototype.Y;
    Fv.prototype.setPreload = Fv.prototype.Gk;
    Fv.prototype.getUseInterimTilesOnError = Fv.prototype.Zh;
    Fv.prototype.setUseInterimTilesOnError = Fv.prototype.Hk;
    r("ol.layer.Vector", T);
    T.prototype.getSource = T.prototype.Y;
    T.prototype.getStyle = T.prototype.Ye;
    T.prototype.getStyleFunction = T.prototype.Xb;
    T.prototype.setStyle = T.prototype.Gb;
    r("ol.layer.VectorTile", Mv);
    Mv.prototype.getPreload = Mv.prototype.Th;
    Mv.prototype.getUseInterimTilesOnError = Mv.prototype.Zh;
    Mv.prototype.setPreload = Mv.prototype.Gk;
    Mv.prototype.setUseInterimTilesOnError = Mv.prototype.Hk;
    Mv.prototype.getSource = Mv.prototype.Y;
    r("ol.interaction.DoubleClickZoom", qg);
    r("ol.interaction.DoubleClickZoom.handleEvent", rg);
    r("ol.interaction.DragAndDrop", Es);
    r("ol.interaction.DragAndDrop.handleEvent", of);
    Hs.prototype.features = Hs.prototype.features;
    Hs.prototype.file = Hs.prototype.file;
    Hs.prototype.projection = Hs.prototype.projection;
    r("ol.interaction.DragBox", Pg);
    Pg.prototype.getGeometry = Pg.prototype.I;
    Ug.prototype.coordinate = Ug.prototype.coordinate;
    Ug.prototype.mapBrowserEvent = Ug.prototype.mapBrowserEvent;
    r("ol.interaction.DragPan", Gg);
    r("ol.interaction.DragRotate", Jg);
    r("ol.interaction.DragRotateAndZoom", Ls);
    r("ol.interaction.DragZoom", Yg);
    r("ol.interaction.Draw", Qt);
    r("ol.interaction.Draw.handleEvent", St);
    Qt.prototype.removeLastPoint = Qt.prototype.vA;
    Qt.prototype.finishDrawing = Qt.prototype.uj;
    Qt.prototype.extend = Qt.prototype.extend;
    r("ol.interaction.Draw.createRegularPolygon", function(a, b) {
        return function(c, d) {
            var e = c[0];
            c = c[1];
            var f = Math.sqrt(kf(e, c));
            d = d ? d : bg(new ls(e), a);
            cg(d, e, f, b ? b : Math.atan((c[1] - e[1]) / (c[0] - e[0])));
            return d
        }
    });
    r("ol.interaction.Draw.createBox", function() {
        return function(a, b) {
            a = Ta(a);
            b = b || new F(null);
            b.pa([[kb(a), lb(a), mb(a), nb(a), kb(a)]]);
            return b
        }
    });
    eu.prototype.feature = eu.prototype.feature;
    r("ol.interaction.Extent", fu);
    fu.prototype.getExtent = fu.prototype.c;
    fu.prototype.setExtent = fu.prototype.Eb;
    qu.prototype.extent = qu.prototype.extent;
    r("ol.interaction.Interaction", og);
    og.prototype.getActive = og.prototype.Va;
    og.prototype.getMap = og.prototype.B;
    og.prototype.setActive = og.prototype.setActive;
    r("ol.interaction.KeyboardPan", Zg);
    r("ol.interaction.KeyboardPan.handleEvent", $g);
    r("ol.interaction.KeyboardZoom", ah);
    r("ol.interaction.KeyboardZoom.handleEvent", bh);
    r("ol.interaction.Modify", ru);
    r("ol.interaction.Modify.handleEvent", uu);
    ru.prototype.removePoint = ru.prototype.fu;
    zu.prototype.features = zu.prototype.features;
    zu.prototype.mapBrowserEvent = zu.prototype.mapBrowserEvent;
    r("ol.interaction.MouseWheelZoom", ch);
    r("ol.interaction.MouseWheelZoom.handleEvent", dh);
    ch.prototype.setMouseAnchor = ch.prototype.TA;
    r("ol.interaction.PinchRotate", gh);
    r("ol.interaction.PinchZoom", mh);
    r("ol.interaction.Pointer", Dg);
    r("ol.interaction.Pointer.handleEvent", Eg);
    r("ol.interaction.Select", Gu);
    Gu.prototype.getFeatures = Gu.prototype.getFeatures;
    Gu.prototype.getHitTolerance = Gu.prototype.$o;
    Gu.prototype.getLayer = Gu.prototype.ka;
    r("ol.interaction.Select.handleEvent", Hu);
    Gu.prototype.setHitTolerance = Gu.prototype.wq;
    Gu.prototype.setMap = Gu.prototype.setMap;
    Ju.prototype.selected = Ju.prototype.selected;
    Ju.prototype.deselected = Ju.prototype.deselected;
    Ju.prototype.mapBrowserEvent = Ju.prototype.mapBrowserEvent;
    r("ol.interaction.Snap", Lu);
    Lu.prototype.addFeature = Lu.prototype.jd;
    Lu.prototype.removeFeature = Lu.prototype.zd;
    r("ol.interaction.Translate", Qu);
    Qu.prototype.getHitTolerance = Qu.prototype.$o;
    Qu.prototype.setHitTolerance = Qu.prototype.wq;
    Wu.prototype.features = Wu.prototype.features;
    Wu.prototype.coordinate = Wu.prototype.coordinate;
    r("ol.geom.Circle", ls);
    ls.prototype.clone = ls.prototype.clone;
    ls.prototype.getCenter = ls.prototype.Fa;
    ls.prototype.getRadius = ls.prototype.wc;
    ls.prototype.getType = ls.prototype.D;
    ls.prototype.intersectsExtent = ls.prototype.Kb;
    ls.prototype.setCenter = ls.prototype.Jc;
    ls.prototype.setCenterAndRadius = ls.prototype.sq;
    ls.prototype.setRadius = ls.prototype.mh;
    ls.prototype.transform = ls.prototype.transform;
    r("ol.geom.Geometry", qf);
    qf.prototype.getClosestPoint = qf.prototype.od;
    qf.prototype.intersectsCoordinate = qf.prototype.Xc;
    qf.prototype.getExtent = qf.prototype.c;
    qf.prototype.rotate = qf.prototype.rotate;
    qf.prototype.scale = qf.prototype.scale;
    qf.prototype.simplify = qf.prototype.Zd;
    qf.prototype.transform = qf.prototype.transform;
    r("ol.geom.GeometryCollection", hm);
    hm.prototype.clone = hm.prototype.clone;
    hm.prototype.getGeometries = hm.prototype.Rh;
    hm.prototype.getType = hm.prototype.D;
    hm.prototype.intersectsExtent = hm.prototype.Kb;
    hm.prototype.setGeometries = hm.prototype.vu;
    hm.prototype.applyTransform = hm.prototype.xg;
    hm.prototype.translate = hm.prototype.translate;
    r("ol.geom.LinearRing", Nf);
    Nf.prototype.clone = Nf.prototype.clone;
    Nf.prototype.getArea = Nf.prototype.yj;
    Nf.prototype.getCoordinates = Nf.prototype.H;
    Nf.prototype.getType = Nf.prototype.D;
    Nf.prototype.setCoordinates = Nf.prototype.pa;
    r("ol.geom.LineString", N);
    N.prototype.appendCoordinate = N.prototype.dw;
    N.prototype.clone = N.prototype.clone;
    N.prototype.forEachSegment = N.prototype.Mw;
    N.prototype.getCoordinateAtM = N.prototype.Ro;
    N.prototype.getCoordinates = N.prototype.H;
    N.prototype.getCoordinateAt = N.prototype.Cs;
    N.prototype.getLength = N.prototype.Wb;
    N.prototype.getType = N.prototype.D;
    N.prototype.intersectsExtent = N.prototype.Kb;
    N.prototype.setCoordinates = N.prototype.pa;
    r("ol.geom.MultiLineString", P);
    P.prototype.appendLineString = P.prototype.ew;
    P.prototype.clone = P.prototype.clone;
    P.prototype.getCoordinateAtM = P.prototype.Ro;
    P.prototype.getCoordinates = P.prototype.H;
    P.prototype.getLineString = P.prototype.rx;
    P.prototype.getLineStrings = P.prototype.Sh;
    P.prototype.getType = P.prototype.D;
    P.prototype.intersectsExtent = P.prototype.Kb;
    P.prototype.setCoordinates = P.prototype.pa;
    r("ol.geom.MultiPoint", Q);
    Q.prototype.appendPoint = Q.prototype.gw;
    Q.prototype.clone = Q.prototype.clone;
    Q.prototype.getCoordinates = Q.prototype.H;
    Q.prototype.getPoint = Q.prototype.Dx;
    Q.prototype.getPoints = Q.prototype.We;
    Q.prototype.getType = Q.prototype.D;
    Q.prototype.intersectsExtent = Q.prototype.Kb;
    Q.prototype.setCoordinates = Q.prototype.pa;
    r("ol.geom.MultiPolygon", R);
    R.prototype.appendPolygon = R.prototype.hw;
    R.prototype.clone = R.prototype.clone;
    R.prototype.getArea = R.prototype.yj;
    R.prototype.getCoordinates = R.prototype.H;
    R.prototype.getInteriorPoints = R.prototype.nx;
    R.prototype.getPolygon = R.prototype.Ex;
    R.prototype.getPolygons = R.prototype.Jj;
    R.prototype.getType = R.prototype.D;
    R.prototype.intersectsExtent = R.prototype.Kb;
    R.prototype.setCoordinates = R.prototype.pa;
    r("ol.geom.Point", D);
    D.prototype.clone = D.prototype.clone;
    D.prototype.getCoordinates = D.prototype.H;
    D.prototype.getType = D.prototype.D;
    D.prototype.intersectsExtent = D.prototype.Kb;
    D.prototype.setCoordinates = D.prototype.pa;
    r("ol.geom.Polygon", F);
    F.prototype.appendLinearRing = F.prototype.fw;
    F.prototype.clone = F.prototype.clone;
    F.prototype.getArea = F.prototype.yj;
    F.prototype.getCoordinates = F.prototype.H;
    F.prototype.getInteriorPoint = F.prototype.mx;
    F.prototype.getLinearRingCount = F.prototype.sx;
    F.prototype.getLinearRing = F.prototype.Js;
    F.prototype.getLinearRings = F.prototype.Hj;
    F.prototype.getType = F.prototype.D;
    F.prototype.intersectsExtent = F.prototype.Kb;
    F.prototype.setCoordinates = F.prototype.pa;
    r("ol.geom.Polygon.circular", $f);
    r("ol.geom.Polygon.fromExtent", ag);
    r("ol.geom.Polygon.fromCircle", bg);
    r("ol.geom.SimpleGeometry", tf);
    tf.prototype.getFirstCoordinate = tf.prototype.Re;
    tf.prototype.getLastCoordinate = tf.prototype.Se;
    tf.prototype.getLayout = tf.prototype.Ue;
    tf.prototype.applyTransform = tf.prototype.xg;
    tf.prototype.translate = tf.prototype.translate;
    r("ol.format.EsriJSON", El);
    El.prototype.readFeature = El.prototype.we;
    El.prototype.readFeatures = El.prototype.pb;
    El.prototype.readGeometry = El.prototype.fh;
    El.prototype.readProjection = El.prototype.mc;
    El.prototype.writeGeometry = El.prototype.uh;
    El.prototype.writeGeometryObject = El.prototype.cl;
    El.prototype.writeFeature = El.prototype.Si;
    El.prototype.writeFeatureObject = El.prototype.th;
    El.prototype.writeFeatures = El.prototype.Je;
    El.prototype.writeFeaturesObject = El.prototype.al;
    r("ol.format.Feature", tl);
    r("ol.format.filter.and", fm);
    r("ol.format.filter.or", function(a) {
        var b = [null].concat(Array.prototype.slice.call(arguments));
        return new (Function.prototype.bind.apply(dm, b))
    });
    r("ol.format.filter.not", function(a) {
        return new bm(a)
    });
    r("ol.format.filter.bbox", gm);
    r("ol.format.filter.intersects", function(a, b, c) {
        return new Wl(a,b,c)
    });
    r("ol.format.filter.within", function(a, b, c) {
        return new em(a,b,c)
    });
    r("ol.format.filter.equalTo", function(a, b, c) {
        return new Sl(a,b,c)
    });
    r("ol.format.filter.notEqualTo", function(a, b, c) {
        return new cm(a,b,c)
    });
    r("ol.format.filter.lessThan", function(a, b) {
        return new $l(a,b)
    });
    r("ol.format.filter.lessThanOrEqualTo", function(a, b) {
        return new am(a,b)
    });
    r("ol.format.filter.greaterThan", function(a, b) {
        return new Tl(a,b)
    });
    r("ol.format.filter.greaterThanOrEqualTo", function(a, b) {
        return new Ul(a,b)
    });
    r("ol.format.filter.isNull", function(a) {
        return new Zl(a)
    });
    r("ol.format.filter.between", function(a, b, c) {
        return new Xl(a,b,c)
    });
    r("ol.format.filter.like", function(a, b, c, d, e, f) {
        return new Yl(a,b,c,d,e,f)
    });
    r("ol.format.filter.during", function(a, b, c) {
        return new Ql(a,b,c)
    });
    r("ol.format.GeoJSON", lm);
    lm.prototype.readFeature = lm.prototype.we;
    lm.prototype.readFeatures = lm.prototype.pb;
    lm.prototype.readGeometry = lm.prototype.fh;
    lm.prototype.readProjection = lm.prototype.mc;
    lm.prototype.writeFeature = lm.prototype.Si;
    lm.prototype.writeFeatureObject = lm.prototype.th;
    lm.prototype.writeFeatures = lm.prototype.Je;
    lm.prototype.writeFeaturesObject = lm.prototype.al;
    lm.prototype.writeGeometry = lm.prototype.uh;
    lm.prototype.writeGeometryObject = lm.prototype.cl;
    r("ol.format.GML", Gm);
    Gm.prototype.writeFeatures = Gm.prototype.Je;
    Gm.prototype.writeFeaturesNode = Gm.prototype.Ke;
    r("ol.format.GML2", Pm);
    r("ol.format.GML3", Gm);
    Gm.prototype.writeGeometryNode = Gm.prototype.bl;
    Gm.prototype.writeFeatures = Gm.prototype.Je;
    Gm.prototype.writeFeaturesNode = Gm.prototype.Ke;
    tm.prototype.readFeatures = tm.prototype.pb;
    r("ol.format.GPX", Zm);
    Zm.prototype.readFeature = Zm.prototype.we;
    Zm.prototype.readFeatures = Zm.prototype.pb;
    Zm.prototype.readProjection = Zm.prototype.mc;
    Zm.prototype.writeFeatures = Zm.prototype.Je;
    Zm.prototype.writeFeaturesNode = Zm.prototype.Ke;
    r("ol.format.IGC", Kn);
    Kn.prototype.readFeature = Kn.prototype.we;
    Kn.prototype.readFeatures = Kn.prototype.pb;
    Kn.prototype.readProjection = Kn.prototype.mc;
    r("ol.format.KML", Un);
    Un.prototype.readFeature = Un.prototype.we;
    Un.prototype.readFeatures = Un.prototype.pb;
    Un.prototype.readName = Un.prototype.hA;
    Un.prototype.readNetworkLinks = Un.prototype.iA;
    Un.prototype.readRegion = Un.prototype.lA;
    Un.prototype.readRegionFromNode = Un.prototype.cn;
    Un.prototype.readProjection = Un.prototype.mc;
    Un.prototype.writeFeatures = Un.prototype.Je;
    Un.prototype.writeFeaturesNode = Un.prototype.Ke;
    r("ol.format.MVT", $p);
    $p.prototype.getLastExtent = $p.prototype.ap;
    $p.prototype.readFeatures = $p.prototype.pb;
    $p.prototype.readProjection = $p.prototype.mc;
    $p.prototype.setLayers = $p.prototype.mn;
    r("ol.format.OSMXML", bq);
    bq.prototype.readFeatures = bq.prototype.pb;
    bq.prototype.readProjection = bq.prototype.mc;
    r("ol.format.Polyline", Bq);
    r("ol.format.Polyline.encodeDeltas", Cq);
    r("ol.format.Polyline.decodeDeltas", Eq);
    r("ol.format.Polyline.encodeFloats", Dq);
    r("ol.format.Polyline.decodeFloats", Fq);
    Bq.prototype.readFeature = Bq.prototype.we;
    Bq.prototype.readFeatures = Bq.prototype.pb;
    Bq.prototype.readGeometry = Bq.prototype.fh;
    Bq.prototype.readProjection = Bq.prototype.mc;
    Bq.prototype.writeGeometry = Bq.prototype.uh;
    r("ol.format.TopoJSON", Gq);
    Gq.prototype.readFeatures = Gq.prototype.pb;
    Gq.prototype.readProjection = Gq.prototype.mc;
    r("ol.format.WFS", Mq);
    Mq.prototype.readFeatures = Mq.prototype.pb;
    Mq.prototype.readTransactionResponse = Mq.prototype.pA;
    Mq.prototype.readFeatureCollectionMetadata = Mq.prototype.aA;
    r("ol.format.WFS.writeFilter", function(a) {
        var b = Zk("http://www.opengis.net/ogc", "Filter");
        ql({
            node: b
        }, ar, jl(a.pf), [a], []);
        return b
    });
    Mq.prototype.writeGetFeature = Mq.prototype.LB;
    Mq.prototype.writeTransaction = Mq.prototype.NB;
    Mq.prototype.readProjection = Mq.prototype.mc;
    r("ol.format.WKT", gr);
    gr.prototype.readFeature = gr.prototype.we;
    gr.prototype.readFeatures = gr.prototype.pb;
    gr.prototype.readGeometry = gr.prototype.fh;
    gr.prototype.writeFeature = gr.prototype.Si;
    gr.prototype.writeFeatures = gr.prototype.Je;
    gr.prototype.writeGeometry = gr.prototype.uh;
    r("ol.format.WMSCapabilities", yr);
    yr.prototype.read = yr.prototype.read;
    r("ol.format.WMSGetFeatureInfo", Vr);
    Vr.prototype.readFeatures = Vr.prototype.pb;
    r("ol.format.WMTSCapabilities", Wr);
    Wr.prototype.read = Wr.prototype.read;
    r("ol.format.filter.And", Nl);
    r("ol.format.filter.Bbox", Ol);
    r("ol.format.filter.Comparison", Pl);
    r("ol.format.filter.ComparisonBinary", Rl);
    r("ol.format.filter.During", Ql);
    r("ol.format.filter.EqualTo", Sl);
    r("ol.format.filter.Filter", Ll);
    r("ol.format.filter.GreaterThan", Tl);
    r("ol.format.filter.GreaterThanOrEqualTo", Ul);
    r("ol.format.filter.Intersects", Wl);
    r("ol.format.filter.IsBetween", Xl);
    r("ol.format.filter.IsLike", Yl);
    r("ol.format.filter.IsNull", Zl);
    r("ol.format.filter.LessThan", $l);
    r("ol.format.filter.LessThanOrEqualTo", am);
    r("ol.format.filter.Not", bm);
    r("ol.format.filter.NotEqualTo", cm);
    r("ol.format.filter.Or", dm);
    r("ol.format.filter.Spatial", Vl);
    r("ol.format.filter.Within", em);
    r("ol.events.condition.altKeyOnly", sg);
    r("ol.events.condition.altShiftKeysOnly", tg);
    r("ol.events.condition.always", of);
    r("ol.events.condition.click", function(a) {
        return "click" == a.type
    });
    r("ol.events.condition.never", pf);
    r("ol.events.condition.pointerMove", vg);
    r("ol.events.condition.singleClick", wg);
    r("ol.events.condition.doubleClick", function(a) {
        return "dblclick" == a.type
    });
    r("ol.events.condition.noModifierKeys", xg);
    r("ol.events.condition.platformModifierKeyOnly", function(a) {
        a = a.originalEvent;
        return !a.altKey && (Wd ? a.metaKey : a.ctrlKey) && !a.shiftKey
    });
    r("ol.events.condition.shiftKeyOnly", yg);
    r("ol.events.condition.targetNotEditable", Ag);
    r("ol.events.condition.mouseOnly", Bg);
    r("ol.events.condition.primaryAction", Cg);
    Wc.prototype.type = Wc.prototype.type;
    Wc.prototype.target = Wc.prototype.target;
    Wc.prototype.preventDefault = Wc.prototype.preventDefault;
    Wc.prototype.stopPropagation = Wc.prototype.stopPropagation;
    r("ol.control.Attribution", td);
    r("ol.control.Attribution.render", ud);
    td.prototype.getCollapsible = td.prototype.Qo;
    td.prototype.setCollapsible = td.prototype.uq;
    td.prototype.setCollapsed = td.prototype.tq;
    td.prototype.getCollapsed = td.prototype.Po;
    r("ol.control.Control", sd);
    sd.prototype.getMap = sd.prototype.B;
    sd.prototype.setMap = sd.prototype.setMap;
    sd.prototype.setTarget = sd.prototype.ac;
    r("ol.control.FullScreen", Dd);
    r("ol.control.MousePosition", Id);
    r("ol.control.MousePosition.render", Jd);
    Id.prototype.getCoordinateFormat = Id.prototype.Ds;
    Id.prototype.getProjection = Id.prototype.M;
    Id.prototype.setCoordinateFormat = Id.prototype.ru;
    Id.prototype.setProjection = Id.prototype.lf;
    r("ol.control.OverviewMap", sk);
    r("ol.control.OverviewMap.render", tk);
    sk.prototype.getCollapsible = sk.prototype.Qo;
    sk.prototype.setCollapsible = sk.prototype.uq;
    sk.prototype.setCollapsed = sk.prototype.tq;
    sk.prototype.getCollapsed = sk.prototype.Po;
    sk.prototype.getOverviewMap = sk.prototype.Bx;
    r("ol.control.Rotate", zd);
    r("ol.control.Rotate.render", Ad);
    r("ol.control.ScaleLine", wk);
    wk.prototype.getUnits = wk.prototype.pd;
    r("ol.control.ScaleLine.render", xk);
    wk.prototype.setUnits = wk.prototype.Fu;
    r("ol.control.Zoom", Bd);
    r("ol.control.ZoomSlider", Ak);
    r("ol.control.ZoomSlider.render", Ck);
    r("ol.control.ZoomToExtent", Fk);
    $c.prototype.changed = $c.prototype.a;
    $c.prototype.dispatchEvent = $c.prototype.dispatchEvent;
    $c.prototype.getRevision = $c.prototype.o;
    $c.prototype.on = $c.prototype.g;
    $c.prototype.once = $c.prototype.once;
    $c.prototype.un = $c.prototype.j;
    C.prototype.get = C.prototype.get;
    C.prototype.getKeys = C.prototype.v;
    C.prototype.getProperties = C.prototype.l;
    C.prototype.set = C.prototype.set;
    C.prototype.setProperties = C.prototype.f;
    C.prototype.unset = C.prototype.A;
    C.prototype.changed = C.prototype.a;
    C.prototype.dispatchEvent = C.prototype.dispatchEvent;
    C.prototype.getRevision = C.prototype.o;
    C.prototype.on = C.prototype.g;
    C.prototype.once = C.prototype.once;
    C.prototype.un = C.prototype.j;
    hd.prototype.type = hd.prototype.type;
    hd.prototype.target = hd.prototype.target;
    hd.prototype.preventDefault = hd.prototype.preventDefault;
    hd.prototype.stopPropagation = hd.prototype.stopPropagation;
    Gk.prototype.get = Gk.prototype.get;
    Gk.prototype.getKeys = Gk.prototype.v;
    Gk.prototype.getProperties = Gk.prototype.l;
    Gk.prototype.set = Gk.prototype.set;
    Gk.prototype.setProperties = Gk.prototype.f;
    Gk.prototype.unset = Gk.prototype.A;
    Gk.prototype.changed = Gk.prototype.a;
    Gk.prototype.dispatchEvent = Gk.prototype.dispatchEvent;
    Gk.prototype.getRevision = Gk.prototype.o;
    Gk.prototype.on = Gk.prototype.g;
    Gk.prototype.once = Gk.prototype.once;
    Gk.prototype.un = Gk.prototype.j;
    Wk.prototype.get = Wk.prototype.get;
    Wk.prototype.getKeys = Wk.prototype.v;
    Wk.prototype.getProperties = Wk.prototype.l;
    Wk.prototype.set = Wk.prototype.set;
    Wk.prototype.setProperties = Wk.prototype.f;
    Wk.prototype.unset = Wk.prototype.A;
    Wk.prototype.changed = Wk.prototype.a;
    Wk.prototype.dispatchEvent = Wk.prototype.dispatchEvent;
    Wk.prototype.getRevision = Wk.prototype.o;
    Wk.prototype.on = Wk.prototype.g;
    Wk.prototype.once = Wk.prototype.once;
    Wk.prototype.un = Wk.prototype.j;
    ks.prototype.get = ks.prototype.get;
    ks.prototype.getKeys = ks.prototype.v;
    ks.prototype.getProperties = ks.prototype.l;
    ks.prototype.set = ks.prototype.set;
    ks.prototype.setProperties = ks.prototype.f;
    ks.prototype.unset = ks.prototype.A;
    ks.prototype.changed = ks.prototype.a;
    ks.prototype.dispatchEvent = ks.prototype.dispatchEvent;
    ks.prototype.getRevision = ks.prototype.o;
    ks.prototype.on = ks.prototype.g;
    ks.prototype.once = ks.prototype.once;
    ks.prototype.un = ks.prototype.j;
    Bs.prototype.getKey = Bs.prototype.getKey;
    Bs.prototype.getTileCoord = Bs.prototype.Nj;
    Bs.prototype.getState = Bs.prototype.getState;
    Bs.prototype.load = Bs.prototype.load;
    I.prototype.get = I.prototype.get;
    I.prototype.getKeys = I.prototype.v;
    I.prototype.getProperties = I.prototype.l;
    I.prototype.set = I.prototype.set;
    I.prototype.setProperties = I.prototype.f;
    I.prototype.unset = I.prototype.A;
    I.prototype.changed = I.prototype.a;
    I.prototype.dispatchEvent = I.prototype.dispatchEvent;
    I.prototype.getRevision = I.prototype.o;
    I.prototype.on = I.prototype.g;
    I.prototype.once = I.prototype.once;
    I.prototype.un = I.prototype.j;
    Nd.prototype.type = Nd.prototype.type;
    Nd.prototype.target = Nd.prototype.target;
    Nd.prototype.preventDefault = Nd.prototype.preventDefault;
    Nd.prototype.stopPropagation = Nd.prototype.stopPropagation;
    Od.prototype.map = Od.prototype.map;
    Od.prototype.frameState = Od.prototype.frameState;
    Od.prototype.type = Od.prototype.type;
    Od.prototype.target = Od.prototype.target;
    Od.prototype.preventDefault = Od.prototype.preventDefault;
    Od.prototype.stopPropagation = Od.prototype.stopPropagation;
    le.prototype.originalEvent = le.prototype.originalEvent;
    le.prototype.pixel = le.prototype.pixel;
    le.prototype.coordinate = le.prototype.coordinate;
    le.prototype.dragging = le.prototype.dragging;
    le.prototype.preventDefault = le.prototype.preventDefault;
    le.prototype.stopPropagation = le.prototype.stopPropagation;
    le.prototype.map = le.prototype.map;
    le.prototype.frameState = le.prototype.frameState;
    le.prototype.type = le.prototype.type;
    le.prototype.target = le.prototype.target;
    dd.prototype.type = dd.prototype.type;
    dd.prototype.target = dd.prototype.target;
    dd.prototype.preventDefault = dd.prototype.preventDefault;
    dd.prototype.stopPropagation = dd.prototype.stopPropagation;
    kk.prototype.get = kk.prototype.get;
    kk.prototype.getKeys = kk.prototype.v;
    kk.prototype.getProperties = kk.prototype.l;
    kk.prototype.set = kk.prototype.set;
    kk.prototype.setProperties = kk.prototype.f;
    kk.prototype.unset = kk.prototype.A;
    kk.prototype.changed = kk.prototype.a;
    kk.prototype.dispatchEvent = kk.prototype.dispatchEvent;
    kk.prototype.getRevision = kk.prototype.o;
    kk.prototype.on = kk.prototype.g;
    kk.prototype.once = kk.prototype.once;
    kk.prototype.un = kk.prototype.j;
    Mw.prototype.getKey = Mw.prototype.getKey;
    Mw.prototype.getTileCoord = Mw.prototype.Nj;
    Mw.prototype.getState = Mw.prototype.getState;
    Mw.prototype.load = Mw.prototype.load;
    Ow.prototype.getKey = Ow.prototype.getKey;
    Ow.prototype.getTileCoord = Ow.prototype.Nj;
    Ow.prototype.getState = Ow.prototype.getState;
    Ow.prototype.load = Ow.prototype.load;
    H.prototype.get = H.prototype.get;
    H.prototype.getKeys = H.prototype.v;
    H.prototype.getProperties = H.prototype.l;
    H.prototype.set = H.prototype.set;
    H.prototype.setProperties = H.prototype.f;
    H.prototype.unset = H.prototype.A;
    H.prototype.changed = H.prototype.a;
    H.prototype.dispatchEvent = H.prototype.dispatchEvent;
    H.prototype.getRevision = H.prototype.o;
    H.prototype.on = H.prototype.g;
    H.prototype.once = H.prototype.once;
    H.prototype.un = H.prototype.j;
    Rw.prototype.forEachTileCoord = Rw.prototype.Lo;
    Rw.prototype.getMaxZoom = Rw.prototype.Ij;
    Rw.prototype.getMinZoom = Rw.prototype.Ng;
    Rw.prototype.getOrigin = Rw.prototype.ic;
    Rw.prototype.getResolution = Rw.prototype.O;
    Rw.prototype.getResolutions = Rw.prototype.Jd;
    Rw.prototype.getTileRangeForExtentAndResolution = Rw.prototype.Qj;
    Rw.prototype.getTileRangeForExtentAndZ = Rw.prototype.xc;
    Rw.prototype.getTileCoordCenter = Rw.prototype.Oj;
    Rw.prototype.getTileCoordExtent = Rw.prototype.Oa;
    Rw.prototype.getTileCoordForCoordAndResolution = Rw.prototype.Xl;
    Rw.prototype.getTileCoordForCoordAndZ = Rw.prototype.ip;
    Rw.prototype.getTileSize = Rw.prototype.Zb;
    Rw.prototype.getZForResolution = Rw.prototype.Pf;
    Nk.prototype.getOpacity = Nk.prototype.tb;
    Nk.prototype.getRotateWithView = Nk.prototype.Uh;
    Nk.prototype.getRotation = Nk.prototype.ma;
    Nk.prototype.getScale = Nk.prototype.Vh;
    Nk.prototype.getSnapToPixel = Nk.prototype.Wl;
    Nk.prototype.setOpacity = Nk.prototype.oc;
    Nk.prototype.setRotation = Nk.prototype.Wd;
    Nk.prototype.setScale = Nk.prototype.mf;
    Ok.prototype.clone = Ok.prototype.clone;
    Ok.prototype.getAngle = Ok.prototype.No;
    Ok.prototype.getFill = Ok.prototype.Ph;
    Ok.prototype.getPoints = Ok.prototype.We;
    Ok.prototype.getRadius = Ok.prototype.wc;
    Ok.prototype.getRadius2 = Ok.prototype.Ns;
    Ok.prototype.getStroke = Ok.prototype.Xh;
    Ok.prototype.getOpacity = Ok.prototype.tb;
    Ok.prototype.getRotateWithView = Ok.prototype.Uh;
    Ok.prototype.getRotation = Ok.prototype.ma;
    Ok.prototype.getScale = Ok.prototype.Vh;
    Ok.prototype.getSnapToPixel = Ok.prototype.Wl;
    Ok.prototype.setOpacity = Ok.prototype.oc;
    Ok.prototype.setRotation = Ok.prototype.Wd;
    Ok.prototype.setScale = Ok.prototype.mf;
    Sn.prototype.getOpacity = Sn.prototype.tb;
    Sn.prototype.getRotateWithView = Sn.prototype.Uh;
    Sn.prototype.getRotation = Sn.prototype.ma;
    Sn.prototype.getScale = Sn.prototype.Vh;
    Sn.prototype.getSnapToPixel = Sn.prototype.Wl;
    Sn.prototype.setOpacity = Sn.prototype.oc;
    Sn.prototype.setRotation = Sn.prototype.Wd;
    Sn.prototype.setScale = Sn.prototype.mf;
    Ht.prototype.get = Ht.prototype.get;
    Ht.prototype.getKeys = Ht.prototype.v;
    Ht.prototype.getProperties = Ht.prototype.l;
    Ht.prototype.set = Ht.prototype.set;
    Ht.prototype.setProperties = Ht.prototype.f;
    Ht.prototype.unset = Ht.prototype.A;
    Ht.prototype.changed = Ht.prototype.a;
    Ht.prototype.dispatchEvent = Ht.prototype.dispatchEvent;
    Ht.prototype.getRevision = Ht.prototype.o;
    Ht.prototype.on = Ht.prototype.g;
    Ht.prototype.once = Ht.prototype.once;
    Ht.prototype.un = Ht.prototype.j;
    Vv.prototype.getAttributions = Vv.prototype.Ea;
    Vv.prototype.getLogo = Vv.prototype.Ka;
    Vv.prototype.getProjection = Vv.prototype.M;
    Vv.prototype.getState = Vv.prototype.getState;
    Vv.prototype.refresh = Vv.prototype.refresh;
    Vv.prototype.setAttributions = Vv.prototype.xa;
    Vv.prototype.get = Vv.prototype.get;
    Vv.prototype.getKeys = Vv.prototype.v;
    Vv.prototype.getProperties = Vv.prototype.l;
    Vv.prototype.set = Vv.prototype.set;
    Vv.prototype.setProperties = Vv.prototype.f;
    Vv.prototype.unset = Vv.prototype.A;
    Vv.prototype.changed = Vv.prototype.a;
    Vv.prototype.dispatchEvent = Vv.prototype.dispatchEvent;
    Vv.prototype.getRevision = Vv.prototype.o;
    Vv.prototype.on = Vv.prototype.g;
    Vv.prototype.once = Vv.prototype.once;
    Vv.prototype.un = Vv.prototype.j;
    Zv.prototype.getTile = Zv.prototype.ua;
    Zv.prototype.getTileGrid = Zv.prototype.Yb;
    Zv.prototype.refresh = Zv.prototype.refresh;
    Zv.prototype.getAttributions = Zv.prototype.Ea;
    Zv.prototype.getLogo = Zv.prototype.Ka;
    Zv.prototype.getProjection = Zv.prototype.M;
    Zv.prototype.getState = Zv.prototype.getState;
    Zv.prototype.setAttributions = Zv.prototype.xa;
    Zv.prototype.get = Zv.prototype.get;
    Zv.prototype.getKeys = Zv.prototype.v;
    Zv.prototype.getProperties = Zv.prototype.l;
    Zv.prototype.set = Zv.prototype.set;
    Zv.prototype.setProperties = Zv.prototype.f;
    Zv.prototype.unset = Zv.prototype.A;
    Zv.prototype.changed = Zv.prototype.a;
    Zv.prototype.dispatchEvent = Zv.prototype.dispatchEvent;
    Zv.prototype.getRevision = Zv.prototype.o;
    Zv.prototype.on = Zv.prototype.g;
    Zv.prototype.once = Zv.prototype.once;
    Zv.prototype.un = Zv.prototype.j;
    X.prototype.getTileLoadFunction = X.prototype.Tc;
    X.prototype.getTileUrlFunction = X.prototype.Uc;
    X.prototype.getUrls = X.prototype.Vc;
    X.prototype.setTileLoadFunction = X.prototype.ed;
    X.prototype.setTileUrlFunction = X.prototype.cc;
    X.prototype.setUrl = X.prototype.Hb;
    X.prototype.setUrls = X.prototype.dc;
    X.prototype.getTile = X.prototype.ua;
    X.prototype.getTileGrid = X.prototype.Yb;
    X.prototype.refresh = X.prototype.refresh;
    X.prototype.getAttributions = X.prototype.Ea;
    X.prototype.getLogo = X.prototype.Ka;
    X.prototype.getProjection = X.prototype.M;
    X.prototype.getState = X.prototype.getState;
    X.prototype.setAttributions = X.prototype.xa;
    X.prototype.get = X.prototype.get;
    X.prototype.getKeys = X.prototype.v;
    X.prototype.getProperties = X.prototype.l;
    X.prototype.set = X.prototype.set;
    X.prototype.setProperties = X.prototype.f;
    X.prototype.unset = X.prototype.A;
    X.prototype.changed = X.prototype.a;
    X.prototype.dispatchEvent = X.prototype.dispatchEvent;
    X.prototype.getRevision = X.prototype.o;
    X.prototype.on = X.prototype.g;
    X.prototype.once = X.prototype.once;
    X.prototype.un = X.prototype.j;
    cw.prototype.getTile = cw.prototype.ua;
    cw.prototype.setRenderReprojectionEdges = cw.prototype.Vd;
    cw.prototype.setTileGridForProjection = cw.prototype.Xd;
    cw.prototype.getTileLoadFunction = cw.prototype.Tc;
    cw.prototype.getTileUrlFunction = cw.prototype.Uc;
    cw.prototype.getUrls = cw.prototype.Vc;
    cw.prototype.setTileLoadFunction = cw.prototype.ed;
    cw.prototype.setTileUrlFunction = cw.prototype.cc;
    cw.prototype.setUrl = cw.prototype.Hb;
    cw.prototype.setUrls = cw.prototype.dc;
    cw.prototype.getTileGrid = cw.prototype.Yb;
    cw.prototype.refresh = cw.prototype.refresh;
    cw.prototype.getAttributions = cw.prototype.Ea;
    cw.prototype.getLogo = cw.prototype.Ka;
    cw.prototype.getProjection = cw.prototype.M;
    cw.prototype.getState = cw.prototype.getState;
    cw.prototype.setAttributions = cw.prototype.xa;
    cw.prototype.get = cw.prototype.get;
    cw.prototype.getKeys = cw.prototype.v;
    cw.prototype.getProperties = cw.prototype.l;
    cw.prototype.set = cw.prototype.set;
    cw.prototype.setProperties = cw.prototype.f;
    cw.prototype.unset = cw.prototype.A;
    cw.prototype.changed = cw.prototype.a;
    cw.prototype.dispatchEvent = cw.prototype.dispatchEvent;
    cw.prototype.getRevision = cw.prototype.o;
    cw.prototype.on = cw.prototype.g;
    cw.prototype.once = cw.prototype.once;
    cw.prototype.un = cw.prototype.j;
    ew.prototype.getTile = ew.prototype.ua;
    ew.prototype.setRenderReprojectionEdges = ew.prototype.Vd;
    ew.prototype.setTileGridForProjection = ew.prototype.Xd;
    ew.prototype.getTileLoadFunction = ew.prototype.Tc;
    ew.prototype.getTileUrlFunction = ew.prototype.Uc;
    ew.prototype.getUrls = ew.prototype.Vc;
    ew.prototype.setTileLoadFunction = ew.prototype.ed;
    ew.prototype.setTileUrlFunction = ew.prototype.cc;
    ew.prototype.setUrl = ew.prototype.Hb;
    ew.prototype.setUrls = ew.prototype.dc;
    ew.prototype.getTileGrid = ew.prototype.Yb;
    ew.prototype.refresh = ew.prototype.refresh;
    ew.prototype.getAttributions = ew.prototype.Ea;
    ew.prototype.getLogo = ew.prototype.Ka;
    ew.prototype.getProjection = ew.prototype.M;
    ew.prototype.getState = ew.prototype.getState;
    ew.prototype.setAttributions = ew.prototype.xa;
    ew.prototype.get = ew.prototype.get;
    ew.prototype.getKeys = ew.prototype.v;
    ew.prototype.getProperties = ew.prototype.l;
    ew.prototype.set = ew.prototype.set;
    ew.prototype.setProperties = ew.prototype.f;
    ew.prototype.unset = ew.prototype.A;
    ew.prototype.changed = ew.prototype.a;
    ew.prototype.dispatchEvent = ew.prototype.dispatchEvent;
    ew.prototype.getRevision = ew.prototype.o;
    ew.prototype.on = ew.prototype.g;
    ew.prototype.once = ew.prototype.once;
    ew.prototype.un = ew.prototype.j;
    fw.prototype.getTile = fw.prototype.ua;
    fw.prototype.setRenderReprojectionEdges = fw.prototype.Vd;
    fw.prototype.setTileGridForProjection = fw.prototype.Xd;
    fw.prototype.getTileLoadFunction = fw.prototype.Tc;
    fw.prototype.getTileUrlFunction = fw.prototype.Uc;
    fw.prototype.getUrls = fw.prototype.Vc;
    fw.prototype.setTileLoadFunction = fw.prototype.ed;
    fw.prototype.setTileUrlFunction = fw.prototype.cc;
    fw.prototype.setUrl = fw.prototype.Hb;
    fw.prototype.setUrls = fw.prototype.dc;
    fw.prototype.getTileGrid = fw.prototype.Yb;
    fw.prototype.refresh = fw.prototype.refresh;
    fw.prototype.getAttributions = fw.prototype.Ea;
    fw.prototype.getLogo = fw.prototype.Ka;
    fw.prototype.getProjection = fw.prototype.M;
    fw.prototype.getState = fw.prototype.getState;
    fw.prototype.setAttributions = fw.prototype.xa;
    fw.prototype.get = fw.prototype.get;
    fw.prototype.getKeys = fw.prototype.v;
    fw.prototype.getProperties = fw.prototype.l;
    fw.prototype.set = fw.prototype.set;
    fw.prototype.setProperties = fw.prototype.f;
    fw.prototype.unset = fw.prototype.A;
    fw.prototype.changed = fw.prototype.a;
    fw.prototype.dispatchEvent = fw.prototype.dispatchEvent;
    fw.prototype.getRevision = fw.prototype.o;
    fw.prototype.on = fw.prototype.g;
    fw.prototype.once = fw.prototype.once;
    fw.prototype.un = fw.prototype.j;
    U.prototype.getAttributions = U.prototype.Ea;
    U.prototype.getLogo = U.prototype.Ka;
    U.prototype.getProjection = U.prototype.M;
    U.prototype.getState = U.prototype.getState;
    U.prototype.refresh = U.prototype.refresh;
    U.prototype.setAttributions = U.prototype.xa;
    U.prototype.get = U.prototype.get;
    U.prototype.getKeys = U.prototype.v;
    U.prototype.getProperties = U.prototype.l;
    U.prototype.set = U.prototype.set;
    U.prototype.setProperties = U.prototype.f;
    U.prototype.unset = U.prototype.A;
    U.prototype.changed = U.prototype.a;
    U.prototype.dispatchEvent = U.prototype.dispatchEvent;
    U.prototype.getRevision = U.prototype.o;
    U.prototype.on = U.prototype.g;
    U.prototype.once = U.prototype.once;
    U.prototype.un = U.prototype.j;
    Y.prototype.addFeature = Y.prototype.jd;
    Y.prototype.addFeatures = Y.prototype.vg;
    Y.prototype.clear = Y.prototype.clear;
    Y.prototype.forEachFeature = Y.prototype.xs;
    Y.prototype.forEachFeatureInExtent = Y.prototype.forEachFeatureInExtent;
    Y.prototype.forEachFeatureIntersectingExtent = Y.prototype.ys;
    Y.prototype.getFeaturesCollection = Y.prototype.Gs;
    Y.prototype.getFeatures = Y.prototype.getFeatures;
    Y.prototype.getFeaturesAtCoordinate = Y.prototype.Fs;
    Y.prototype.getFeaturesInExtent = Y.prototype.Uo;
    Y.prototype.getClosestFeatureToCoordinate = Y.prototype.Bs;
    Y.prototype.getExtent = Y.prototype.c;
    Y.prototype.getFeatureById = Y.prototype.Es;
    Y.prototype.getFormat = Y.prototype.Qh;
    Y.prototype.getUrl = Y.prototype.Of;
    Y.prototype.removeFeature = Y.prototype.zd;
    Y.prototype.getAttributions = Y.prototype.Ea;
    Y.prototype.getLogo = Y.prototype.Ka;
    Y.prototype.getProjection = Y.prototype.M;
    Y.prototype.getState = Y.prototype.getState;
    Y.prototype.refresh = Y.prototype.refresh;
    Y.prototype.setAttributions = Y.prototype.xa;
    Y.prototype.get = Y.prototype.get;
    Y.prototype.getKeys = Y.prototype.v;
    Y.prototype.getProperties = Y.prototype.l;
    Y.prototype.set = Y.prototype.set;
    Y.prototype.setProperties = Y.prototype.f;
    Y.prototype.unset = Y.prototype.A;
    Y.prototype.changed = Y.prototype.a;
    Y.prototype.dispatchEvent = Y.prototype.dispatchEvent;
    Y.prototype.getRevision = Y.prototype.o;
    Y.prototype.on = Y.prototype.g;
    Y.prototype.once = Y.prototype.once;
    Y.prototype.un = Y.prototype.j;
    jv.prototype.getAttributions = jv.prototype.Ea;
    jv.prototype.getLogo = jv.prototype.Ka;
    jv.prototype.getProjection = jv.prototype.M;
    jv.prototype.getState = jv.prototype.getState;
    jv.prototype.refresh = jv.prototype.refresh;
    jv.prototype.setAttributions = jv.prototype.xa;
    jv.prototype.get = jv.prototype.get;
    jv.prototype.getKeys = jv.prototype.v;
    jv.prototype.getProperties = jv.prototype.l;
    jv.prototype.set = jv.prototype.set;
    jv.prototype.setProperties = jv.prototype.f;
    jv.prototype.unset = jv.prototype.A;
    jv.prototype.changed = jv.prototype.a;
    jv.prototype.dispatchEvent = jv.prototype.dispatchEvent;
    jv.prototype.getRevision = jv.prototype.o;
    jv.prototype.on = jv.prototype.g;
    jv.prototype.once = jv.prototype.once;
    jv.prototype.un = jv.prototype.j;
    lv.prototype.type = lv.prototype.type;
    lv.prototype.target = lv.prototype.target;
    lv.prototype.preventDefault = lv.prototype.preventDefault;
    lv.prototype.stopPropagation = lv.prototype.stopPropagation;
    jw.prototype.getAttributions = jw.prototype.Ea;
    jw.prototype.getLogo = jw.prototype.Ka;
    jw.prototype.getProjection = jw.prototype.M;
    jw.prototype.getState = jw.prototype.getState;
    jw.prototype.refresh = jw.prototype.refresh;
    jw.prototype.setAttributions = jw.prototype.xa;
    jw.prototype.get = jw.prototype.get;
    jw.prototype.getKeys = jw.prototype.v;
    jw.prototype.getProperties = jw.prototype.l;
    jw.prototype.set = jw.prototype.set;
    jw.prototype.setProperties = jw.prototype.f;
    jw.prototype.unset = jw.prototype.A;
    jw.prototype.changed = jw.prototype.a;
    jw.prototype.dispatchEvent = jw.prototype.dispatchEvent;
    jw.prototype.getRevision = jw.prototype.o;
    jw.prototype.on = jw.prototype.g;
    jw.prototype.once = jw.prototype.once;
    jw.prototype.un = jw.prototype.j;
    qv.prototype.getAttributions = qv.prototype.Ea;
    qv.prototype.getLogo = qv.prototype.Ka;
    qv.prototype.getProjection = qv.prototype.M;
    qv.prototype.getState = qv.prototype.getState;
    qv.prototype.refresh = qv.prototype.refresh;
    qv.prototype.setAttributions = qv.prototype.xa;
    qv.prototype.get = qv.prototype.get;
    qv.prototype.getKeys = qv.prototype.v;
    qv.prototype.getProperties = qv.prototype.l;
    qv.prototype.set = qv.prototype.set;
    qv.prototype.setProperties = qv.prototype.f;
    qv.prototype.unset = qv.prototype.A;
    qv.prototype.changed = qv.prototype.a;
    qv.prototype.dispatchEvent = qv.prototype.dispatchEvent;
    qv.prototype.getRevision = qv.prototype.o;
    qv.prototype.on = qv.prototype.g;
    qv.prototype.once = qv.prototype.once;
    qv.prototype.un = qv.prototype.j;
    kw.prototype.getAttributions = kw.prototype.Ea;
    kw.prototype.getLogo = kw.prototype.Ka;
    kw.prototype.getProjection = kw.prototype.M;
    kw.prototype.getState = kw.prototype.getState;
    kw.prototype.refresh = kw.prototype.refresh;
    kw.prototype.setAttributions = kw.prototype.xa;
    kw.prototype.get = kw.prototype.get;
    kw.prototype.getKeys = kw.prototype.v;
    kw.prototype.getProperties = kw.prototype.l;
    kw.prototype.set = kw.prototype.set;
    kw.prototype.setProperties = kw.prototype.f;
    kw.prototype.unset = kw.prototype.A;
    kw.prototype.changed = kw.prototype.a;
    kw.prototype.dispatchEvent = kw.prototype.dispatchEvent;
    kw.prototype.getRevision = kw.prototype.o;
    kw.prototype.on = kw.prototype.g;
    kw.prototype.once = kw.prototype.once;
    kw.prototype.un = kw.prototype.j;
    lw.prototype.getAttributions = lw.prototype.Ea;
    lw.prototype.getLogo = lw.prototype.Ka;
    lw.prototype.getProjection = lw.prototype.M;
    lw.prototype.getState = lw.prototype.getState;
    lw.prototype.refresh = lw.prototype.refresh;
    lw.prototype.setAttributions = lw.prototype.xa;
    lw.prototype.get = lw.prototype.get;
    lw.prototype.getKeys = lw.prototype.v;
    lw.prototype.getProperties = lw.prototype.l;
    lw.prototype.set = lw.prototype.set;
    lw.prototype.setProperties = lw.prototype.f;
    lw.prototype.unset = lw.prototype.A;
    lw.prototype.changed = lw.prototype.a;
    lw.prototype.dispatchEvent = lw.prototype.dispatchEvent;
    lw.prototype.getRevision = lw.prototype.o;
    lw.prototype.on = lw.prototype.g;
    lw.prototype.once = lw.prototype.once;
    lw.prototype.un = lw.prototype.j;
    rv.prototype.getAttributions = rv.prototype.Ea;
    rv.prototype.getLogo = rv.prototype.Ka;
    rv.prototype.getProjection = rv.prototype.M;
    rv.prototype.getState = rv.prototype.getState;
    rv.prototype.refresh = rv.prototype.refresh;
    rv.prototype.setAttributions = rv.prototype.xa;
    rv.prototype.get = rv.prototype.get;
    rv.prototype.getKeys = rv.prototype.v;
    rv.prototype.getProperties = rv.prototype.l;
    rv.prototype.set = rv.prototype.set;
    rv.prototype.setProperties = rv.prototype.f;
    rv.prototype.unset = rv.prototype.A;
    rv.prototype.changed = rv.prototype.a;
    rv.prototype.dispatchEvent = rv.prototype.dispatchEvent;
    rv.prototype.getRevision = rv.prototype.o;
    rv.prototype.on = rv.prototype.g;
    rv.prototype.once = rv.prototype.once;
    rv.prototype.un = rv.prototype.j;
    mw.prototype.getAttributions = mw.prototype.Ea;
    mw.prototype.getLogo = mw.prototype.Ka;
    mw.prototype.getProjection = mw.prototype.M;
    mw.prototype.getState = mw.prototype.getState;
    mw.prototype.refresh = mw.prototype.refresh;
    mw.prototype.setAttributions = mw.prototype.xa;
    mw.prototype.get = mw.prototype.get;
    mw.prototype.getKeys = mw.prototype.v;
    mw.prototype.getProperties = mw.prototype.l;
    mw.prototype.set = mw.prototype.set;
    mw.prototype.setProperties = mw.prototype.f;
    mw.prototype.unset = mw.prototype.A;
    mw.prototype.changed = mw.prototype.a;
    mw.prototype.dispatchEvent = mw.prototype.dispatchEvent;
    mw.prototype.getRevision = mw.prototype.o;
    mw.prototype.on = mw.prototype.g;
    mw.prototype.once = mw.prototype.once;
    mw.prototype.un = mw.prototype.j;
    pw.prototype.getTile = pw.prototype.ua;
    pw.prototype.setRenderReprojectionEdges = pw.prototype.Vd;
    pw.prototype.setTileGridForProjection = pw.prototype.Xd;
    pw.prototype.getTileLoadFunction = pw.prototype.Tc;
    pw.prototype.getTileUrlFunction = pw.prototype.Uc;
    pw.prototype.getUrls = pw.prototype.Vc;
    pw.prototype.setTileLoadFunction = pw.prototype.ed;
    pw.prototype.setTileUrlFunction = pw.prototype.cc;
    pw.prototype.setUrl = pw.prototype.Hb;
    pw.prototype.setUrls = pw.prototype.dc;
    pw.prototype.getTileGrid = pw.prototype.Yb;
    pw.prototype.refresh = pw.prototype.refresh;
    pw.prototype.getAttributions = pw.prototype.Ea;
    pw.prototype.getLogo = pw.prototype.Ka;
    pw.prototype.getProjection = pw.prototype.M;
    pw.prototype.getState = pw.prototype.getState;
    pw.prototype.setAttributions = pw.prototype.xa;
    pw.prototype.get = pw.prototype.get;
    pw.prototype.getKeys = pw.prototype.v;
    pw.prototype.getProperties = pw.prototype.l;
    pw.prototype.set = pw.prototype.set;
    pw.prototype.setProperties = pw.prototype.f;
    pw.prototype.unset = pw.prototype.A;
    pw.prototype.changed = pw.prototype.a;
    pw.prototype.dispatchEvent = pw.prototype.dispatchEvent;
    pw.prototype.getRevision = pw.prototype.o;
    pw.prototype.on = pw.prototype.g;
    pw.prototype.once = pw.prototype.once;
    pw.prototype.un = pw.prototype.j;
    rw.prototype.getAttributions = rw.prototype.Ea;
    rw.prototype.getLogo = rw.prototype.Ka;
    rw.prototype.getProjection = rw.prototype.M;
    rw.prototype.getState = rw.prototype.getState;
    rw.prototype.refresh = rw.prototype.refresh;
    rw.prototype.setAttributions = rw.prototype.xa;
    rw.prototype.get = rw.prototype.get;
    rw.prototype.getKeys = rw.prototype.v;
    rw.prototype.getProperties = rw.prototype.l;
    rw.prototype.set = rw.prototype.set;
    rw.prototype.setProperties = rw.prototype.f;
    rw.prototype.unset = rw.prototype.A;
    rw.prototype.changed = rw.prototype.a;
    rw.prototype.dispatchEvent = rw.prototype.dispatchEvent;
    rw.prototype.getRevision = rw.prototype.o;
    rw.prototype.on = rw.prototype.g;
    rw.prototype.once = rw.prototype.once;
    rw.prototype.un = rw.prototype.j;
    vw.prototype.type = vw.prototype.type;
    vw.prototype.target = vw.prototype.target;
    vw.prototype.preventDefault = vw.prototype.preventDefault;
    vw.prototype.stopPropagation = vw.prototype.stopPropagation;
    yw.prototype.getTile = yw.prototype.ua;
    yw.prototype.setRenderReprojectionEdges = yw.prototype.Vd;
    yw.prototype.setTileGridForProjection = yw.prototype.Xd;
    yw.prototype.getTileLoadFunction = yw.prototype.Tc;
    yw.prototype.getTileUrlFunction = yw.prototype.Uc;
    yw.prototype.getUrls = yw.prototype.Vc;
    yw.prototype.setTileLoadFunction = yw.prototype.ed;
    yw.prototype.setTileUrlFunction = yw.prototype.cc;
    yw.prototype.setUrl = yw.prototype.Hb;
    yw.prototype.setUrls = yw.prototype.dc;
    yw.prototype.getTileGrid = yw.prototype.Yb;
    yw.prototype.refresh = yw.prototype.refresh;
    yw.prototype.getAttributions = yw.prototype.Ea;
    yw.prototype.getLogo = yw.prototype.Ka;
    yw.prototype.getProjection = yw.prototype.M;
    yw.prototype.getState = yw.prototype.getState;
    yw.prototype.setAttributions = yw.prototype.xa;
    yw.prototype.get = yw.prototype.get;
    yw.prototype.getKeys = yw.prototype.v;
    yw.prototype.getProperties = yw.prototype.l;
    yw.prototype.set = yw.prototype.set;
    yw.prototype.setProperties = yw.prototype.f;
    yw.prototype.unset = yw.prototype.A;
    yw.prototype.changed = yw.prototype.a;
    yw.prototype.dispatchEvent = yw.prototype.dispatchEvent;
    yw.prototype.getRevision = yw.prototype.o;
    yw.prototype.on = yw.prototype.g;
    yw.prototype.once = yw.prototype.once;
    yw.prototype.un = yw.prototype.j;
    Yv.prototype.type = Yv.prototype.type;
    Yv.prototype.target = Yv.prototype.target;
    Yv.prototype.preventDefault = Yv.prototype.preventDefault;
    Yv.prototype.stopPropagation = Yv.prototype.stopPropagation;
    Cw.prototype.getTile = Cw.prototype.ua;
    Cw.prototype.setRenderReprojectionEdges = Cw.prototype.Vd;
    Cw.prototype.setTileGridForProjection = Cw.prototype.Xd;
    Cw.prototype.getTileLoadFunction = Cw.prototype.Tc;
    Cw.prototype.getTileUrlFunction = Cw.prototype.Uc;
    Cw.prototype.getUrls = Cw.prototype.Vc;
    Cw.prototype.setTileLoadFunction = Cw.prototype.ed;
    Cw.prototype.setTileUrlFunction = Cw.prototype.cc;
    Cw.prototype.setUrl = Cw.prototype.Hb;
    Cw.prototype.setUrls = Cw.prototype.dc;
    Cw.prototype.getTileGrid = Cw.prototype.Yb;
    Cw.prototype.refresh = Cw.prototype.refresh;
    Cw.prototype.getAttributions = Cw.prototype.Ea;
    Cw.prototype.getLogo = Cw.prototype.Ka;
    Cw.prototype.getProjection = Cw.prototype.M;
    Cw.prototype.getState = Cw.prototype.getState;
    Cw.prototype.setAttributions = Cw.prototype.xa;
    Cw.prototype.get = Cw.prototype.get;
    Cw.prototype.getKeys = Cw.prototype.v;
    Cw.prototype.getProperties = Cw.prototype.l;
    Cw.prototype.set = Cw.prototype.set;
    Cw.prototype.setProperties = Cw.prototype.f;
    Cw.prototype.unset = Cw.prototype.A;
    Cw.prototype.changed = Cw.prototype.a;
    Cw.prototype.dispatchEvent = Cw.prototype.dispatchEvent;
    Cw.prototype.getRevision = Cw.prototype.o;
    Cw.prototype.on = Cw.prototype.g;
    Cw.prototype.once = Cw.prototype.once;
    Cw.prototype.un = Cw.prototype.j;
    Dw.prototype.getTile = Dw.prototype.ua;
    Dw.prototype.getTileGrid = Dw.prototype.Yb;
    Dw.prototype.refresh = Dw.prototype.refresh;
    Dw.prototype.getAttributions = Dw.prototype.Ea;
    Dw.prototype.getLogo = Dw.prototype.Ka;
    Dw.prototype.getProjection = Dw.prototype.M;
    Dw.prototype.getState = Dw.prototype.getState;
    Dw.prototype.setAttributions = Dw.prototype.xa;
    Dw.prototype.get = Dw.prototype.get;
    Dw.prototype.getKeys = Dw.prototype.v;
    Dw.prototype.getProperties = Dw.prototype.l;
    Dw.prototype.set = Dw.prototype.set;
    Dw.prototype.setProperties = Dw.prototype.f;
    Dw.prototype.unset = Dw.prototype.A;
    Dw.prototype.changed = Dw.prototype.a;
    Dw.prototype.dispatchEvent = Dw.prototype.dispatchEvent;
    Dw.prototype.getRevision = Dw.prototype.o;
    Dw.prototype.on = Dw.prototype.g;
    Dw.prototype.once = Dw.prototype.once;
    Dw.prototype.un = Dw.prototype.j;
    Fw.prototype.getTile = Fw.prototype.ua;
    Fw.prototype.setRenderReprojectionEdges = Fw.prototype.Vd;
    Fw.prototype.setTileGridForProjection = Fw.prototype.Xd;
    Fw.prototype.getTileLoadFunction = Fw.prototype.Tc;
    Fw.prototype.getTileUrlFunction = Fw.prototype.Uc;
    Fw.prototype.getUrls = Fw.prototype.Vc;
    Fw.prototype.setTileLoadFunction = Fw.prototype.ed;
    Fw.prototype.setTileUrlFunction = Fw.prototype.cc;
    Fw.prototype.setUrl = Fw.prototype.Hb;
    Fw.prototype.setUrls = Fw.prototype.dc;
    Fw.prototype.getTileGrid = Fw.prototype.Yb;
    Fw.prototype.refresh = Fw.prototype.refresh;
    Fw.prototype.getAttributions = Fw.prototype.Ea;
    Fw.prototype.getLogo = Fw.prototype.Ka;
    Fw.prototype.getProjection = Fw.prototype.M;
    Fw.prototype.getState = Fw.prototype.getState;
    Fw.prototype.setAttributions = Fw.prototype.xa;
    Fw.prototype.get = Fw.prototype.get;
    Fw.prototype.getKeys = Fw.prototype.v;
    Fw.prototype.getProperties = Fw.prototype.l;
    Fw.prototype.set = Fw.prototype.set;
    Fw.prototype.setProperties = Fw.prototype.f;
    Fw.prototype.unset = Fw.prototype.A;
    Fw.prototype.changed = Fw.prototype.a;
    Fw.prototype.dispatchEvent = Fw.prototype.dispatchEvent;
    Fw.prototype.getRevision = Fw.prototype.o;
    Fw.prototype.on = Fw.prototype.g;
    Fw.prototype.once = Fw.prototype.once;
    Fw.prototype.un = Fw.prototype.j;
    Gw.prototype.getTile = Gw.prototype.ua;
    Gw.prototype.getTileGrid = Gw.prototype.Yb;
    Gw.prototype.refresh = Gw.prototype.refresh;
    Gw.prototype.getAttributions = Gw.prototype.Ea;
    Gw.prototype.getLogo = Gw.prototype.Ka;
    Gw.prototype.getProjection = Gw.prototype.M;
    Gw.prototype.getState = Gw.prototype.getState;
    Gw.prototype.setAttributions = Gw.prototype.xa;
    Gw.prototype.get = Gw.prototype.get;
    Gw.prototype.getKeys = Gw.prototype.v;
    Gw.prototype.getProperties = Gw.prototype.l;
    Gw.prototype.set = Gw.prototype.set;
    Gw.prototype.setProperties = Gw.prototype.f;
    Gw.prototype.unset = Gw.prototype.A;
    Gw.prototype.changed = Gw.prototype.a;
    Gw.prototype.dispatchEvent = Gw.prototype.dispatchEvent;
    Gw.prototype.getRevision = Gw.prototype.o;
    Gw.prototype.on = Gw.prototype.g;
    Gw.prototype.once = Gw.prototype.once;
    Gw.prototype.un = Gw.prototype.j;
    Kw.prototype.getTile = Kw.prototype.ua;
    Kw.prototype.setRenderReprojectionEdges = Kw.prototype.Vd;
    Kw.prototype.setTileGridForProjection = Kw.prototype.Xd;
    Kw.prototype.getTileLoadFunction = Kw.prototype.Tc;
    Kw.prototype.getTileUrlFunction = Kw.prototype.Uc;
    Kw.prototype.getUrls = Kw.prototype.Vc;
    Kw.prototype.setTileLoadFunction = Kw.prototype.ed;
    Kw.prototype.setTileUrlFunction = Kw.prototype.cc;
    Kw.prototype.setUrl = Kw.prototype.Hb;
    Kw.prototype.setUrls = Kw.prototype.dc;
    Kw.prototype.getTileGrid = Kw.prototype.Yb;
    Kw.prototype.refresh = Kw.prototype.refresh;
    Kw.prototype.getAttributions = Kw.prototype.Ea;
    Kw.prototype.getLogo = Kw.prototype.Ka;
    Kw.prototype.getProjection = Kw.prototype.M;
    Kw.prototype.getState = Kw.prototype.getState;
    Kw.prototype.setAttributions = Kw.prototype.xa;
    Kw.prototype.get = Kw.prototype.get;
    Kw.prototype.getKeys = Kw.prototype.v;
    Kw.prototype.getProperties = Kw.prototype.l;
    Kw.prototype.set = Kw.prototype.set;
    Kw.prototype.setProperties = Kw.prototype.f;
    Kw.prototype.unset = Kw.prototype.A;
    Kw.prototype.changed = Kw.prototype.a;
    Kw.prototype.dispatchEvent = Kw.prototype.dispatchEvent;
    Kw.prototype.getRevision = Kw.prototype.o;
    Kw.prototype.on = Kw.prototype.g;
    Kw.prototype.once = Kw.prototype.once;
    Kw.prototype.un = Kw.prototype.j;
    Nt.prototype.type = Nt.prototype.type;
    Nt.prototype.target = Nt.prototype.target;
    Nt.prototype.preventDefault = Nt.prototype.preventDefault;
    Nt.prototype.stopPropagation = Nt.prototype.stopPropagation;
    Qw.prototype.getTileLoadFunction = Qw.prototype.Tc;
    Qw.prototype.getTileUrlFunction = Qw.prototype.Uc;
    Qw.prototype.getUrls = Qw.prototype.Vc;
    Qw.prototype.setTileLoadFunction = Qw.prototype.ed;
    Qw.prototype.setTileUrlFunction = Qw.prototype.cc;
    Qw.prototype.setUrl = Qw.prototype.Hb;
    Qw.prototype.setUrls = Qw.prototype.dc;
    Qw.prototype.getTile = Qw.prototype.ua;
    Qw.prototype.getTileGrid = Qw.prototype.Yb;
    Qw.prototype.refresh = Qw.prototype.refresh;
    Qw.prototype.getAttributions = Qw.prototype.Ea;
    Qw.prototype.getLogo = Qw.prototype.Ka;
    Qw.prototype.getProjection = Qw.prototype.M;
    Qw.prototype.getState = Qw.prototype.getState;
    Qw.prototype.setAttributions = Qw.prototype.xa;
    Qw.prototype.get = Qw.prototype.get;
    Qw.prototype.getKeys = Qw.prototype.v;
    Qw.prototype.getProperties = Qw.prototype.l;
    Qw.prototype.set = Qw.prototype.set;
    Qw.prototype.setProperties = Qw.prototype.f;
    Qw.prototype.unset = Qw.prototype.A;
    Qw.prototype.changed = Qw.prototype.a;
    Qw.prototype.dispatchEvent = Qw.prototype.dispatchEvent;
    Qw.prototype.getRevision = Qw.prototype.o;
    Qw.prototype.on = Qw.prototype.g;
    Qw.prototype.once = Qw.prototype.once;
    Qw.prototype.un = Qw.prototype.j;
    Z.prototype.getTile = Z.prototype.ua;
    Z.prototype.setRenderReprojectionEdges = Z.prototype.Vd;
    Z.prototype.setTileGridForProjection = Z.prototype.Xd;
    Z.prototype.getTileLoadFunction = Z.prototype.Tc;
    Z.prototype.getTileUrlFunction = Z.prototype.Uc;
    Z.prototype.getUrls = Z.prototype.Vc;
    Z.prototype.setTileLoadFunction = Z.prototype.ed;
    Z.prototype.setTileUrlFunction = Z.prototype.cc;
    Z.prototype.setUrl = Z.prototype.Hb;
    Z.prototype.setUrls = Z.prototype.dc;
    Z.prototype.getTileGrid = Z.prototype.Yb;
    Z.prototype.refresh = Z.prototype.refresh;
    Z.prototype.getAttributions = Z.prototype.Ea;
    Z.prototype.getLogo = Z.prototype.Ka;
    Z.prototype.getProjection = Z.prototype.M;
    Z.prototype.getState = Z.prototype.getState;
    Z.prototype.setAttributions = Z.prototype.xa;
    Z.prototype.get = Z.prototype.get;
    Z.prototype.getKeys = Z.prototype.v;
    Z.prototype.getProperties = Z.prototype.l;
    Z.prototype.set = Z.prototype.set;
    Z.prototype.setProperties = Z.prototype.f;
    Z.prototype.unset = Z.prototype.A;
    Z.prototype.changed = Z.prototype.a;
    Z.prototype.dispatchEvent = Z.prototype.dispatchEvent;
    Z.prototype.getRevision = Z.prototype.o;
    Z.prototype.on = Z.prototype.g;
    Z.prototype.once = Z.prototype.once;
    Z.prototype.un = Z.prototype.j;
    Uw.prototype.getTile = Uw.prototype.ua;
    Uw.prototype.setRenderReprojectionEdges = Uw.prototype.Vd;
    Uw.prototype.setTileGridForProjection = Uw.prototype.Xd;
    Uw.prototype.getTileLoadFunction = Uw.prototype.Tc;
    Uw.prototype.getTileUrlFunction = Uw.prototype.Uc;
    Uw.prototype.getUrls = Uw.prototype.Vc;
    Uw.prototype.setTileLoadFunction = Uw.prototype.ed;
    Uw.prototype.setTileUrlFunction = Uw.prototype.cc;
    Uw.prototype.setUrl = Uw.prototype.Hb;
    Uw.prototype.setUrls = Uw.prototype.dc;
    Uw.prototype.getTileGrid = Uw.prototype.Yb;
    Uw.prototype.refresh = Uw.prototype.refresh;
    Uw.prototype.getAttributions = Uw.prototype.Ea;
    Uw.prototype.getLogo = Uw.prototype.Ka;
    Uw.prototype.getProjection = Uw.prototype.M;
    Uw.prototype.getState = Uw.prototype.getState;
    Uw.prototype.setAttributions = Uw.prototype.xa;
    Uw.prototype.get = Uw.prototype.get;
    Uw.prototype.getKeys = Uw.prototype.v;
    Uw.prototype.getProperties = Uw.prototype.l;
    Uw.prototype.set = Uw.prototype.set;
    Uw.prototype.setProperties = Uw.prototype.f;
    Uw.prototype.unset = Uw.prototype.A;
    Uw.prototype.changed = Uw.prototype.a;
    Uw.prototype.dispatchEvent = Uw.prototype.dispatchEvent;
    Uw.prototype.getRevision = Uw.prototype.o;
    Uw.prototype.on = Uw.prototype.g;
    Uw.prototype.once = Uw.prototype.once;
    Uw.prototype.un = Uw.prototype.j;
    Ov.prototype.getKey = Ov.prototype.getKey;
    Ov.prototype.getTileCoord = Ov.prototype.Nj;
    Ov.prototype.getState = Ov.prototype.getState;
    Ov.prototype.load = Ov.prototype.load;
    it.prototype.changed = it.prototype.a;
    it.prototype.dispatchEvent = it.prototype.dispatchEvent;
    it.prototype.getRevision = it.prototype.o;
    it.prototype.on = it.prototype.g;
    it.prototype.once = it.prototype.once;
    it.prototype.un = it.prototype.j;
    Et.prototype.changed = Et.prototype.a;
    Et.prototype.dispatchEvent = Et.prototype.dispatchEvent;
    Et.prototype.getRevision = Et.prototype.o;
    Et.prototype.on = Et.prototype.g;
    Et.prototype.once = Et.prototype.once;
    Et.prototype.un = Et.prototype.j;
    tv.prototype.changed = tv.prototype.a;
    tv.prototype.dispatchEvent = tv.prototype.dispatchEvent;
    tv.prototype.getRevision = tv.prototype.o;
    tv.prototype.on = tv.prototype.g;
    tv.prototype.once = tv.prototype.once;
    tv.prototype.un = tv.prototype.j;
    Ev.prototype.changed = Ev.prototype.a;
    Ev.prototype.dispatchEvent = Ev.prototype.dispatchEvent;
    Ev.prototype.getRevision = Ev.prototype.o;
    Ev.prototype.on = Ev.prototype.g;
    Ev.prototype.once = Ev.prototype.once;
    Ev.prototype.un = Ev.prototype.j;
    Ft.prototype.changed = Ft.prototype.a;
    Ft.prototype.dispatchEvent = Ft.prototype.dispatchEvent;
    Ft.prototype.getRevision = Ft.prototype.o;
    Ft.prototype.on = Ft.prototype.g;
    Ft.prototype.once = Ft.prototype.once;
    Ft.prototype.un = Ft.prototype.j;
    rt.prototype.changed = rt.prototype.a;
    rt.prototype.dispatchEvent = rt.prototype.dispatchEvent;
    rt.prototype.getRevision = rt.prototype.o;
    rt.prototype.on = rt.prototype.g;
    rt.prototype.once = rt.prototype.once;
    rt.prototype.un = rt.prototype.j;
    av.prototype.changed = av.prototype.a;
    av.prototype.dispatchEvent = av.prototype.dispatchEvent;
    av.prototype.getRevision = av.prototype.o;
    av.prototype.on = av.prototype.g;
    av.prototype.once = av.prototype.once;
    av.prototype.un = av.prototype.j;
    bv.prototype.changed = bv.prototype.a;
    bv.prototype.dispatchEvent = bv.prototype.dispatchEvent;
    bv.prototype.getRevision = bv.prototype.o;
    bv.prototype.on = bv.prototype.g;
    bv.prototype.once = bv.prototype.once;
    bv.prototype.un = bv.prototype.j;
    xv.prototype.changed = xv.prototype.a;
    xv.prototype.dispatchEvent = xv.prototype.dispatchEvent;
    xv.prototype.getRevision = xv.prototype.o;
    xv.prototype.on = xv.prototype.g;
    xv.prototype.once = xv.prototype.once;
    xv.prototype.un = xv.prototype.j;
    xt.prototype.changed = xt.prototype.a;
    xt.prototype.dispatchEvent = xt.prototype.dispatchEvent;
    xt.prototype.getRevision = xt.prototype.o;
    xt.prototype.on = xt.prototype.g;
    xt.prototype.once = xt.prototype.once;
    xt.prototype.un = xt.prototype.j;
    Gv.prototype.changed = Gv.prototype.a;
    Gv.prototype.dispatchEvent = Gv.prototype.dispatchEvent;
    Gv.prototype.getRevision = Gv.prototype.o;
    Gv.prototype.on = Gv.prototype.g;
    Gv.prototype.once = Gv.prototype.once;
    Gv.prototype.un = Gv.prototype.j;
    Qh.prototype.type = Qh.prototype.type;
    Qh.prototype.target = Qh.prototype.target;
    Qh.prototype.preventDefault = Qh.prototype.preventDefault;
    Qh.prototype.stopPropagation = Qh.prototype.stopPropagation;
    ve.prototype.type = ve.prototype.type;
    ve.prototype.target = ve.prototype.target;
    ve.prototype.preventDefault = ve.prototype.preventDefault;
    ve.prototype.stopPropagation = ve.prototype.stopPropagation;
    rh.prototype.get = rh.prototype.get;
    rh.prototype.getKeys = rh.prototype.v;
    rh.prototype.getProperties = rh.prototype.l;
    rh.prototype.set = rh.prototype.set;
    rh.prototype.setProperties = rh.prototype.f;
    rh.prototype.unset = rh.prototype.A;
    rh.prototype.changed = rh.prototype.a;
    rh.prototype.dispatchEvent = rh.prototype.dispatchEvent;
    rh.prototype.getRevision = rh.prototype.o;
    rh.prototype.on = rh.prototype.g;
    rh.prototype.once = rh.prototype.once;
    rh.prototype.un = rh.prototype.j;
    th.prototype.getExtent = th.prototype.c;
    th.prototype.getMaxResolution = th.prototype.uc;
    th.prototype.getMinResolution = th.prototype.vc;
    th.prototype.getOpacity = th.prototype.tb;
    th.prototype.getVisible = th.prototype.ke;
    th.prototype.getZIndex = th.prototype.La;
    th.prototype.setExtent = th.prototype.Eb;
    th.prototype.setMaxResolution = th.prototype.fg;
    th.prototype.setMinResolution = th.prototype.gg;
    th.prototype.setOpacity = th.prototype.oc;
    th.prototype.setVisible = th.prototype.Yd;
    th.prototype.setZIndex = th.prototype.Ae;
    th.prototype.get = th.prototype.get;
    th.prototype.getKeys = th.prototype.v;
    th.prototype.getProperties = th.prototype.l;
    th.prototype.set = th.prototype.set;
    th.prototype.setProperties = th.prototype.f;
    th.prototype.unset = th.prototype.A;
    th.prototype.changed = th.prototype.a;
    th.prototype.dispatchEvent = th.prototype.dispatchEvent;
    th.prototype.getRevision = th.prototype.o;
    th.prototype.on = th.prototype.g;
    th.prototype.once = th.prototype.once;
    th.prototype.un = th.prototype.j;
    vh.prototype.getExtent = vh.prototype.c;
    vh.prototype.getMaxResolution = vh.prototype.uc;
    vh.prototype.getMinResolution = vh.prototype.vc;
    vh.prototype.getOpacity = vh.prototype.tb;
    vh.prototype.getVisible = vh.prototype.ke;
    vh.prototype.getZIndex = vh.prototype.La;
    vh.prototype.setExtent = vh.prototype.Eb;
    vh.prototype.setMaxResolution = vh.prototype.fg;
    vh.prototype.setMinResolution = vh.prototype.gg;
    vh.prototype.setOpacity = vh.prototype.oc;
    vh.prototype.setVisible = vh.prototype.Yd;
    vh.prototype.setZIndex = vh.prototype.Ae;
    vh.prototype.get = vh.prototype.get;
    vh.prototype.getKeys = vh.prototype.v;
    vh.prototype.getProperties = vh.prototype.l;
    vh.prototype.set = vh.prototype.set;
    vh.prototype.setProperties = vh.prototype.f;
    vh.prototype.unset = vh.prototype.A;
    vh.prototype.changed = vh.prototype.a;
    vh.prototype.dispatchEvent = vh.prototype.dispatchEvent;
    vh.prototype.getRevision = vh.prototype.o;
    vh.prototype.on = vh.prototype.g;
    vh.prototype.once = vh.prototype.once;
    vh.prototype.un = vh.prototype.j;
    T.prototype.setMap = T.prototype.setMap;
    T.prototype.setSource = T.prototype.oh;
    T.prototype.getExtent = T.prototype.c;
    T.prototype.getMaxResolution = T.prototype.uc;
    T.prototype.getMinResolution = T.prototype.vc;
    T.prototype.getOpacity = T.prototype.tb;
    T.prototype.getVisible = T.prototype.ke;
    T.prototype.getZIndex = T.prototype.La;
    T.prototype.setExtent = T.prototype.Eb;
    T.prototype.setMaxResolution = T.prototype.fg;
    T.prototype.setMinResolution = T.prototype.gg;
    T.prototype.setOpacity = T.prototype.oc;
    T.prototype.setVisible = T.prototype.Yd;
    T.prototype.setZIndex = T.prototype.Ae;
    T.prototype.get = T.prototype.get;
    T.prototype.getKeys = T.prototype.v;
    T.prototype.getProperties = T.prototype.l;
    T.prototype.set = T.prototype.set;
    T.prototype.setProperties = T.prototype.f;
    T.prototype.unset = T.prototype.A;
    T.prototype.changed = T.prototype.a;
    T.prototype.dispatchEvent = T.prototype.dispatchEvent;
    T.prototype.getRevision = T.prototype.o;
    T.prototype.on = T.prototype.g;
    T.prototype.once = T.prototype.once;
    T.prototype.un = T.prototype.j;
    W.prototype.getSource = W.prototype.Y;
    W.prototype.getStyle = W.prototype.Ye;
    W.prototype.getStyleFunction = W.prototype.Xb;
    W.prototype.setStyle = W.prototype.Gb;
    W.prototype.setMap = W.prototype.setMap;
    W.prototype.setSource = W.prototype.oh;
    W.prototype.getExtent = W.prototype.c;
    W.prototype.getMaxResolution = W.prototype.uc;
    W.prototype.getMinResolution = W.prototype.vc;
    W.prototype.getOpacity = W.prototype.tb;
    W.prototype.getVisible = W.prototype.ke;
    W.prototype.getZIndex = W.prototype.La;
    W.prototype.setExtent = W.prototype.Eb;
    W.prototype.setMaxResolution = W.prototype.fg;
    W.prototype.setMinResolution = W.prototype.gg;
    W.prototype.setOpacity = W.prototype.oc;
    W.prototype.setVisible = W.prototype.Yd;
    W.prototype.setZIndex = W.prototype.Ae;
    W.prototype.get = W.prototype.get;
    W.prototype.getKeys = W.prototype.v;
    W.prototype.getProperties = W.prototype.l;
    W.prototype.set = W.prototype.set;
    W.prototype.setProperties = W.prototype.f;
    W.prototype.unset = W.prototype.A;
    W.prototype.changed = W.prototype.a;
    W.prototype.dispatchEvent = W.prototype.dispatchEvent;
    W.prototype.getRevision = W.prototype.o;
    W.prototype.on = W.prototype.g;
    W.prototype.once = W.prototype.once;
    W.prototype.un = W.prototype.j;
    wv.prototype.setMap = wv.prototype.setMap;
    wv.prototype.setSource = wv.prototype.oh;
    wv.prototype.getExtent = wv.prototype.c;
    wv.prototype.getMaxResolution = wv.prototype.uc;
    wv.prototype.getMinResolution = wv.prototype.vc;
    wv.prototype.getOpacity = wv.prototype.tb;
    wv.prototype.getVisible = wv.prototype.ke;
    wv.prototype.getZIndex = wv.prototype.La;
    wv.prototype.setExtent = wv.prototype.Eb;
    wv.prototype.setMaxResolution = wv.prototype.fg;
    wv.prototype.setMinResolution = wv.prototype.gg;
    wv.prototype.setOpacity = wv.prototype.oc;
    wv.prototype.setVisible = wv.prototype.Yd;
    wv.prototype.setZIndex = wv.prototype.Ae;
    wv.prototype.get = wv.prototype.get;
    wv.prototype.getKeys = wv.prototype.v;
    wv.prototype.getProperties = wv.prototype.l;
    wv.prototype.set = wv.prototype.set;
    wv.prototype.setProperties = wv.prototype.f;
    wv.prototype.unset = wv.prototype.A;
    wv.prototype.changed = wv.prototype.a;
    wv.prototype.dispatchEvent = wv.prototype.dispatchEvent;
    wv.prototype.getRevision = wv.prototype.o;
    wv.prototype.on = wv.prototype.g;
    wv.prototype.once = wv.prototype.once;
    wv.prototype.un = wv.prototype.j;
    Fv.prototype.setMap = Fv.prototype.setMap;
    Fv.prototype.setSource = Fv.prototype.oh;
    Fv.prototype.getExtent = Fv.prototype.c;
    Fv.prototype.getMaxResolution = Fv.prototype.uc;
    Fv.prototype.getMinResolution = Fv.prototype.vc;
    Fv.prototype.getOpacity = Fv.prototype.tb;
    Fv.prototype.getVisible = Fv.prototype.ke;
    Fv.prototype.getZIndex = Fv.prototype.La;
    Fv.prototype.setExtent = Fv.prototype.Eb;
    Fv.prototype.setMaxResolution = Fv.prototype.fg;
    Fv.prototype.setMinResolution = Fv.prototype.gg;
    Fv.prototype.setOpacity = Fv.prototype.oc;
    Fv.prototype.setVisible = Fv.prototype.Yd;
    Fv.prototype.setZIndex = Fv.prototype.Ae;
    Fv.prototype.get = Fv.prototype.get;
    Fv.prototype.getKeys = Fv.prototype.v;
    Fv.prototype.getProperties = Fv.prototype.l;
    Fv.prototype.set = Fv.prototype.set;
    Fv.prototype.setProperties = Fv.prototype.f;
    Fv.prototype.unset = Fv.prototype.A;
    Fv.prototype.changed = Fv.prototype.a;
    Fv.prototype.dispatchEvent = Fv.prototype.dispatchEvent;
    Fv.prototype.getRevision = Fv.prototype.o;
    Fv.prototype.on = Fv.prototype.g;
    Fv.prototype.once = Fv.prototype.once;
    Fv.prototype.un = Fv.prototype.j;
    Mv.prototype.getStyle = Mv.prototype.Ye;
    Mv.prototype.getStyleFunction = Mv.prototype.Xb;
    Mv.prototype.setStyle = Mv.prototype.Gb;
    Mv.prototype.setMap = Mv.prototype.setMap;
    Mv.prototype.setSource = Mv.prototype.oh;
    Mv.prototype.getExtent = Mv.prototype.c;
    Mv.prototype.getMaxResolution = Mv.prototype.uc;
    Mv.prototype.getMinResolution = Mv.prototype.vc;
    Mv.prototype.getOpacity = Mv.prototype.tb;
    Mv.prototype.getVisible = Mv.prototype.ke;
    Mv.prototype.getZIndex = Mv.prototype.La;
    Mv.prototype.setExtent = Mv.prototype.Eb;
    Mv.prototype.setMaxResolution = Mv.prototype.fg;
    Mv.prototype.setMinResolution = Mv.prototype.gg;
    Mv.prototype.setOpacity = Mv.prototype.oc;
    Mv.prototype.setVisible = Mv.prototype.Yd;
    Mv.prototype.setZIndex = Mv.prototype.Ae;
    Mv.prototype.get = Mv.prototype.get;
    Mv.prototype.getKeys = Mv.prototype.v;
    Mv.prototype.getProperties = Mv.prototype.l;
    Mv.prototype.set = Mv.prototype.set;
    Mv.prototype.setProperties = Mv.prototype.f;
    Mv.prototype.unset = Mv.prototype.A;
    Mv.prototype.changed = Mv.prototype.a;
    Mv.prototype.dispatchEvent = Mv.prototype.dispatchEvent;
    Mv.prototype.getRevision = Mv.prototype.o;
    Mv.prototype.on = Mv.prototype.g;
    Mv.prototype.once = Mv.prototype.once;
    Mv.prototype.un = Mv.prototype.j;
    og.prototype.get = og.prototype.get;
    og.prototype.getKeys = og.prototype.v;
    og.prototype.getProperties = og.prototype.l;
    og.prototype.set = og.prototype.set;
    og.prototype.setProperties = og.prototype.f;
    og.prototype.unset = og.prototype.A;
    og.prototype.changed = og.prototype.a;
    og.prototype.dispatchEvent = og.prototype.dispatchEvent;
    og.prototype.getRevision = og.prototype.o;
    og.prototype.on = og.prototype.g;
    og.prototype.once = og.prototype.once;
    og.prototype.un = og.prototype.j;
    qg.prototype.getActive = qg.prototype.Va;
    qg.prototype.getMap = qg.prototype.B;
    qg.prototype.setActive = qg.prototype.setActive;
    qg.prototype.get = qg.prototype.get;
    qg.prototype.getKeys = qg.prototype.v;
    qg.prototype.getProperties = qg.prototype.l;
    qg.prototype.set = qg.prototype.set;
    qg.prototype.setProperties = qg.prototype.f;
    qg.prototype.unset = qg.prototype.A;
    qg.prototype.changed = qg.prototype.a;
    qg.prototype.dispatchEvent = qg.prototype.dispatchEvent;
    qg.prototype.getRevision = qg.prototype.o;
    qg.prototype.on = qg.prototype.g;
    qg.prototype.once = qg.prototype.once;
    qg.prototype.un = qg.prototype.j;
    Es.prototype.getActive = Es.prototype.Va;
    Es.prototype.getMap = Es.prototype.B;
    Es.prototype.setActive = Es.prototype.setActive;
    Es.prototype.get = Es.prototype.get;
    Es.prototype.getKeys = Es.prototype.v;
    Es.prototype.getProperties = Es.prototype.l;
    Es.prototype.set = Es.prototype.set;
    Es.prototype.setProperties = Es.prototype.f;
    Es.prototype.unset = Es.prototype.A;
    Es.prototype.changed = Es.prototype.a;
    Es.prototype.dispatchEvent = Es.prototype.dispatchEvent;
    Es.prototype.getRevision = Es.prototype.o;
    Es.prototype.on = Es.prototype.g;
    Es.prototype.once = Es.prototype.once;
    Es.prototype.un = Es.prototype.j;
    Hs.prototype.type = Hs.prototype.type;
    Hs.prototype.target = Hs.prototype.target;
    Hs.prototype.preventDefault = Hs.prototype.preventDefault;
    Hs.prototype.stopPropagation = Hs.prototype.stopPropagation;
    Dg.prototype.getActive = Dg.prototype.Va;
    Dg.prototype.getMap = Dg.prototype.B;
    Dg.prototype.setActive = Dg.prototype.setActive;
    Dg.prototype.get = Dg.prototype.get;
    Dg.prototype.getKeys = Dg.prototype.v;
    Dg.prototype.getProperties = Dg.prototype.l;
    Dg.prototype.set = Dg.prototype.set;
    Dg.prototype.setProperties = Dg.prototype.f;
    Dg.prototype.unset = Dg.prototype.A;
    Dg.prototype.changed = Dg.prototype.a;
    Dg.prototype.dispatchEvent = Dg.prototype.dispatchEvent;
    Dg.prototype.getRevision = Dg.prototype.o;
    Dg.prototype.on = Dg.prototype.g;
    Dg.prototype.once = Dg.prototype.once;
    Dg.prototype.un = Dg.prototype.j;
    Pg.prototype.getActive = Pg.prototype.Va;
    Pg.prototype.getMap = Pg.prototype.B;
    Pg.prototype.setActive = Pg.prototype.setActive;
    Pg.prototype.get = Pg.prototype.get;
    Pg.prototype.getKeys = Pg.prototype.v;
    Pg.prototype.getProperties = Pg.prototype.l;
    Pg.prototype.set = Pg.prototype.set;
    Pg.prototype.setProperties = Pg.prototype.f;
    Pg.prototype.unset = Pg.prototype.A;
    Pg.prototype.changed = Pg.prototype.a;
    Pg.prototype.dispatchEvent = Pg.prototype.dispatchEvent;
    Pg.prototype.getRevision = Pg.prototype.o;
    Pg.prototype.on = Pg.prototype.g;
    Pg.prototype.once = Pg.prototype.once;
    Pg.prototype.un = Pg.prototype.j;
    Ug.prototype.type = Ug.prototype.type;
    Ug.prototype.target = Ug.prototype.target;
    Ug.prototype.preventDefault = Ug.prototype.preventDefault;
    Ug.prototype.stopPropagation = Ug.prototype.stopPropagation;
    Gg.prototype.getActive = Gg.prototype.Va;
    Gg.prototype.getMap = Gg.prototype.B;
    Gg.prototype.setActive = Gg.prototype.setActive;
    Gg.prototype.get = Gg.prototype.get;
    Gg.prototype.getKeys = Gg.prototype.v;
    Gg.prototype.getProperties = Gg.prototype.l;
    Gg.prototype.set = Gg.prototype.set;
    Gg.prototype.setProperties = Gg.prototype.f;
    Gg.prototype.unset = Gg.prototype.A;
    Gg.prototype.changed = Gg.prototype.a;
    Gg.prototype.dispatchEvent = Gg.prototype.dispatchEvent;
    Gg.prototype.getRevision = Gg.prototype.o;
    Gg.prototype.on = Gg.prototype.g;
    Gg.prototype.once = Gg.prototype.once;
    Gg.prototype.un = Gg.prototype.j;
    Jg.prototype.getActive = Jg.prototype.Va;
    Jg.prototype.getMap = Jg.prototype.B;
    Jg.prototype.setActive = Jg.prototype.setActive;
    Jg.prototype.get = Jg.prototype.get;
    Jg.prototype.getKeys = Jg.prototype.v;
    Jg.prototype.getProperties = Jg.prototype.l;
    Jg.prototype.set = Jg.prototype.set;
    Jg.prototype.setProperties = Jg.prototype.f;
    Jg.prototype.unset = Jg.prototype.A;
    Jg.prototype.changed = Jg.prototype.a;
    Jg.prototype.dispatchEvent = Jg.prototype.dispatchEvent;
    Jg.prototype.getRevision = Jg.prototype.o;
    Jg.prototype.on = Jg.prototype.g;
    Jg.prototype.once = Jg.prototype.once;
    Jg.prototype.un = Jg.prototype.j;
    Ls.prototype.getActive = Ls.prototype.Va;
    Ls.prototype.getMap = Ls.prototype.B;
    Ls.prototype.setActive = Ls.prototype.setActive;
    Ls.prototype.get = Ls.prototype.get;
    Ls.prototype.getKeys = Ls.prototype.v;
    Ls.prototype.getProperties = Ls.prototype.l;
    Ls.prototype.set = Ls.prototype.set;
    Ls.prototype.setProperties = Ls.prototype.f;
    Ls.prototype.unset = Ls.prototype.A;
    Ls.prototype.changed = Ls.prototype.a;
    Ls.prototype.dispatchEvent = Ls.prototype.dispatchEvent;
    Ls.prototype.getRevision = Ls.prototype.o;
    Ls.prototype.on = Ls.prototype.g;
    Ls.prototype.once = Ls.prototype.once;
    Ls.prototype.un = Ls.prototype.j;
    Yg.prototype.getGeometry = Yg.prototype.I;
    Yg.prototype.getActive = Yg.prototype.Va;
    Yg.prototype.getMap = Yg.prototype.B;
    Yg.prototype.setActive = Yg.prototype.setActive;
    Yg.prototype.get = Yg.prototype.get;
    Yg.prototype.getKeys = Yg.prototype.v;
    Yg.prototype.getProperties = Yg.prototype.l;
    Yg.prototype.set = Yg.prototype.set;
    Yg.prototype.setProperties = Yg.prototype.f;
    Yg.prototype.unset = Yg.prototype.A;
    Yg.prototype.changed = Yg.prototype.a;
    Yg.prototype.dispatchEvent = Yg.prototype.dispatchEvent;
    Yg.prototype.getRevision = Yg.prototype.o;
    Yg.prototype.on = Yg.prototype.g;
    Yg.prototype.once = Yg.prototype.once;
    Yg.prototype.un = Yg.prototype.j;
    Qt.prototype.getActive = Qt.prototype.Va;
    Qt.prototype.getMap = Qt.prototype.B;
    Qt.prototype.setActive = Qt.prototype.setActive;
    Qt.prototype.get = Qt.prototype.get;
    Qt.prototype.getKeys = Qt.prototype.v;
    Qt.prototype.getProperties = Qt.prototype.l;
    Qt.prototype.set = Qt.prototype.set;
    Qt.prototype.setProperties = Qt.prototype.f;
    Qt.prototype.unset = Qt.prototype.A;
    Qt.prototype.changed = Qt.prototype.a;
    Qt.prototype.dispatchEvent = Qt.prototype.dispatchEvent;
    Qt.prototype.getRevision = Qt.prototype.o;
    Qt.prototype.on = Qt.prototype.g;
    Qt.prototype.once = Qt.prototype.once;
    Qt.prototype.un = Qt.prototype.j;
    eu.prototype.type = eu.prototype.type;
    eu.prototype.target = eu.prototype.target;
    eu.prototype.preventDefault = eu.prototype.preventDefault;
    eu.prototype.stopPropagation = eu.prototype.stopPropagation;
    fu.prototype.getActive = fu.prototype.Va;
    fu.prototype.getMap = fu.prototype.B;
    fu.prototype.setActive = fu.prototype.setActive;
    fu.prototype.get = fu.prototype.get;
    fu.prototype.getKeys = fu.prototype.v;
    fu.prototype.getProperties = fu.prototype.l;
    fu.prototype.set = fu.prototype.set;
    fu.prototype.setProperties = fu.prototype.f;
    fu.prototype.unset = fu.prototype.A;
    fu.prototype.changed = fu.prototype.a;
    fu.prototype.dispatchEvent = fu.prototype.dispatchEvent;
    fu.prototype.getRevision = fu.prototype.o;
    fu.prototype.on = fu.prototype.g;
    fu.prototype.once = fu.prototype.once;
    fu.prototype.un = fu.prototype.j;
    qu.prototype.type = qu.prototype.type;
    qu.prototype.target = qu.prototype.target;
    qu.prototype.preventDefault = qu.prototype.preventDefault;
    qu.prototype.stopPropagation = qu.prototype.stopPropagation;
    Zg.prototype.getActive = Zg.prototype.Va;
    Zg.prototype.getMap = Zg.prototype.B;
    Zg.prototype.setActive = Zg.prototype.setActive;
    Zg.prototype.get = Zg.prototype.get;
    Zg.prototype.getKeys = Zg.prototype.v;
    Zg.prototype.getProperties = Zg.prototype.l;
    Zg.prototype.set = Zg.prototype.set;
    Zg.prototype.setProperties = Zg.prototype.f;
    Zg.prototype.unset = Zg.prototype.A;
    Zg.prototype.changed = Zg.prototype.a;
    Zg.prototype.dispatchEvent = Zg.prototype.dispatchEvent;
    Zg.prototype.getRevision = Zg.prototype.o;
    Zg.prototype.on = Zg.prototype.g;
    Zg.prototype.once = Zg.prototype.once;
    Zg.prototype.un = Zg.prototype.j;
    ah.prototype.getActive = ah.prototype.Va;
    ah.prototype.getMap = ah.prototype.B;
    ah.prototype.setActive = ah.prototype.setActive;
    ah.prototype.get = ah.prototype.get;
    ah.prototype.getKeys = ah.prototype.v;
    ah.prototype.getProperties = ah.prototype.l;
    ah.prototype.set = ah.prototype.set;
    ah.prototype.setProperties = ah.prototype.f;
    ah.prototype.unset = ah.prototype.A;
    ah.prototype.changed = ah.prototype.a;
    ah.prototype.dispatchEvent = ah.prototype.dispatchEvent;
    ah.prototype.getRevision = ah.prototype.o;
    ah.prototype.on = ah.prototype.g;
    ah.prototype.once = ah.prototype.once;
    ah.prototype.un = ah.prototype.j;
    ru.prototype.getActive = ru.prototype.Va;
    ru.prototype.getMap = ru.prototype.B;
    ru.prototype.setActive = ru.prototype.setActive;
    ru.prototype.get = ru.prototype.get;
    ru.prototype.getKeys = ru.prototype.v;
    ru.prototype.getProperties = ru.prototype.l;
    ru.prototype.set = ru.prototype.set;
    ru.prototype.setProperties = ru.prototype.f;
    ru.prototype.unset = ru.prototype.A;
    ru.prototype.changed = ru.prototype.a;
    ru.prototype.dispatchEvent = ru.prototype.dispatchEvent;
    ru.prototype.getRevision = ru.prototype.o;
    ru.prototype.on = ru.prototype.g;
    ru.prototype.once = ru.prototype.once;
    ru.prototype.un = ru.prototype.j;
    zu.prototype.type = zu.prototype.type;
    zu.prototype.target = zu.prototype.target;
    zu.prototype.preventDefault = zu.prototype.preventDefault;
    zu.prototype.stopPropagation = zu.prototype.stopPropagation;
    ch.prototype.getActive = ch.prototype.Va;
    ch.prototype.getMap = ch.prototype.B;
    ch.prototype.setActive = ch.prototype.setActive;
    ch.prototype.get = ch.prototype.get;
    ch.prototype.getKeys = ch.prototype.v;
    ch.prototype.getProperties = ch.prototype.l;
    ch.prototype.set = ch.prototype.set;
    ch.prototype.setProperties = ch.prototype.f;
    ch.prototype.unset = ch.prototype.A;
    ch.prototype.changed = ch.prototype.a;
    ch.prototype.dispatchEvent = ch.prototype.dispatchEvent;
    ch.prototype.getRevision = ch.prototype.o;
    ch.prototype.on = ch.prototype.g;
    ch.prototype.once = ch.prototype.once;
    ch.prototype.un = ch.prototype.j;
    gh.prototype.getActive = gh.prototype.Va;
    gh.prototype.getMap = gh.prototype.B;
    gh.prototype.setActive = gh.prototype.setActive;
    gh.prototype.get = gh.prototype.get;
    gh.prototype.getKeys = gh.prototype.v;
    gh.prototype.getProperties = gh.prototype.l;
    gh.prototype.set = gh.prototype.set;
    gh.prototype.setProperties = gh.prototype.f;
    gh.prototype.unset = gh.prototype.A;
    gh.prototype.changed = gh.prototype.a;
    gh.prototype.dispatchEvent = gh.prototype.dispatchEvent;
    gh.prototype.getRevision = gh.prototype.o;
    gh.prototype.on = gh.prototype.g;
    gh.prototype.once = gh.prototype.once;
    gh.prototype.un = gh.prototype.j;
    mh.prototype.getActive = mh.prototype.Va;
    mh.prototype.getMap = mh.prototype.B;
    mh.prototype.setActive = mh.prototype.setActive;
    mh.prototype.get = mh.prototype.get;
    mh.prototype.getKeys = mh.prototype.v;
    mh.prototype.getProperties = mh.prototype.l;
    mh.prototype.set = mh.prototype.set;
    mh.prototype.setProperties = mh.prototype.f;
    mh.prototype.unset = mh.prototype.A;
    mh.prototype.changed = mh.prototype.a;
    mh.prototype.dispatchEvent = mh.prototype.dispatchEvent;
    mh.prototype.getRevision = mh.prototype.o;
    mh.prototype.on = mh.prototype.g;
    mh.prototype.once = mh.prototype.once;
    mh.prototype.un = mh.prototype.j;
    Gu.prototype.getActive = Gu.prototype.Va;
    Gu.prototype.getMap = Gu.prototype.B;
    Gu.prototype.setActive = Gu.prototype.setActive;
    Gu.prototype.get = Gu.prototype.get;
    Gu.prototype.getKeys = Gu.prototype.v;
    Gu.prototype.getProperties = Gu.prototype.l;
    Gu.prototype.set = Gu.prototype.set;
    Gu.prototype.setProperties = Gu.prototype.f;
    Gu.prototype.unset = Gu.prototype.A;
    Gu.prototype.changed = Gu.prototype.a;
    Gu.prototype.dispatchEvent = Gu.prototype.dispatchEvent;
    Gu.prototype.getRevision = Gu.prototype.o;
    Gu.prototype.on = Gu.prototype.g;
    Gu.prototype.once = Gu.prototype.once;
    Gu.prototype.un = Gu.prototype.j;
    Ju.prototype.type = Ju.prototype.type;
    Ju.prototype.target = Ju.prototype.target;
    Ju.prototype.preventDefault = Ju.prototype.preventDefault;
    Ju.prototype.stopPropagation = Ju.prototype.stopPropagation;
    Lu.prototype.getActive = Lu.prototype.Va;
    Lu.prototype.getMap = Lu.prototype.B;
    Lu.prototype.setActive = Lu.prototype.setActive;
    Lu.prototype.get = Lu.prototype.get;
    Lu.prototype.getKeys = Lu.prototype.v;
    Lu.prototype.getProperties = Lu.prototype.l;
    Lu.prototype.set = Lu.prototype.set;
    Lu.prototype.setProperties = Lu.prototype.f;
    Lu.prototype.unset = Lu.prototype.A;
    Lu.prototype.changed = Lu.prototype.a;
    Lu.prototype.dispatchEvent = Lu.prototype.dispatchEvent;
    Lu.prototype.getRevision = Lu.prototype.o;
    Lu.prototype.on = Lu.prototype.g;
    Lu.prototype.once = Lu.prototype.once;
    Lu.prototype.un = Lu.prototype.j;
    Qu.prototype.getActive = Qu.prototype.Va;
    Qu.prototype.getMap = Qu.prototype.B;
    Qu.prototype.setActive = Qu.prototype.setActive;
    Qu.prototype.get = Qu.prototype.get;
    Qu.prototype.getKeys = Qu.prototype.v;
    Qu.prototype.getProperties = Qu.prototype.l;
    Qu.prototype.set = Qu.prototype.set;
    Qu.prototype.setProperties = Qu.prototype.f;
    Qu.prototype.unset = Qu.prototype.A;
    Qu.prototype.changed = Qu.prototype.a;
    Qu.prototype.dispatchEvent = Qu.prototype.dispatchEvent;
    Qu.prototype.getRevision = Qu.prototype.o;
    Qu.prototype.on = Qu.prototype.g;
    Qu.prototype.once = Qu.prototype.once;
    Qu.prototype.un = Qu.prototype.j;
    Wu.prototype.type = Wu.prototype.type;
    Wu.prototype.target = Wu.prototype.target;
    Wu.prototype.preventDefault = Wu.prototype.preventDefault;
    Wu.prototype.stopPropagation = Wu.prototype.stopPropagation;
    qf.prototype.get = qf.prototype.get;
    qf.prototype.getKeys = qf.prototype.v;
    qf.prototype.getProperties = qf.prototype.l;
    qf.prototype.set = qf.prototype.set;
    qf.prototype.setProperties = qf.prototype.f;
    qf.prototype.unset = qf.prototype.A;
    qf.prototype.changed = qf.prototype.a;
    qf.prototype.dispatchEvent = qf.prototype.dispatchEvent;
    qf.prototype.getRevision = qf.prototype.o;
    qf.prototype.on = qf.prototype.g;
    qf.prototype.once = qf.prototype.once;
    qf.prototype.un = qf.prototype.j;
    tf.prototype.getClosestPoint = tf.prototype.od;
    tf.prototype.intersectsCoordinate = tf.prototype.Xc;
    tf.prototype.getExtent = tf.prototype.c;
    tf.prototype.rotate = tf.prototype.rotate;
    tf.prototype.scale = tf.prototype.scale;
    tf.prototype.simplify = tf.prototype.Zd;
    tf.prototype.transform = tf.prototype.transform;
    tf.prototype.get = tf.prototype.get;
    tf.prototype.getKeys = tf.prototype.v;
    tf.prototype.getProperties = tf.prototype.l;
    tf.prototype.set = tf.prototype.set;
    tf.prototype.setProperties = tf.prototype.f;
    tf.prototype.unset = tf.prototype.A;
    tf.prototype.changed = tf.prototype.a;
    tf.prototype.dispatchEvent = tf.prototype.dispatchEvent;
    tf.prototype.getRevision = tf.prototype.o;
    tf.prototype.on = tf.prototype.g;
    tf.prototype.once = tf.prototype.once;
    tf.prototype.un = tf.prototype.j;
    ls.prototype.getFirstCoordinate = ls.prototype.Re;
    ls.prototype.getLastCoordinate = ls.prototype.Se;
    ls.prototype.getLayout = ls.prototype.Ue;
    ls.prototype.rotate = ls.prototype.rotate;
    ls.prototype.scale = ls.prototype.scale;
    ls.prototype.getClosestPoint = ls.prototype.od;
    ls.prototype.intersectsCoordinate = ls.prototype.Xc;
    ls.prototype.getExtent = ls.prototype.c;
    ls.prototype.simplify = ls.prototype.Zd;
    ls.prototype.get = ls.prototype.get;
    ls.prototype.getKeys = ls.prototype.v;
    ls.prototype.getProperties = ls.prototype.l;
    ls.prototype.set = ls.prototype.set;
    ls.prototype.setProperties = ls.prototype.f;
    ls.prototype.unset = ls.prototype.A;
    ls.prototype.changed = ls.prototype.a;
    ls.prototype.dispatchEvent = ls.prototype.dispatchEvent;
    ls.prototype.getRevision = ls.prototype.o;
    ls.prototype.on = ls.prototype.g;
    ls.prototype.once = ls.prototype.once;
    ls.prototype.un = ls.prototype.j;
    hm.prototype.getClosestPoint = hm.prototype.od;
    hm.prototype.intersectsCoordinate = hm.prototype.Xc;
    hm.prototype.getExtent = hm.prototype.c;
    hm.prototype.rotate = hm.prototype.rotate;
    hm.prototype.scale = hm.prototype.scale;
    hm.prototype.simplify = hm.prototype.Zd;
    hm.prototype.transform = hm.prototype.transform;
    hm.prototype.get = hm.prototype.get;
    hm.prototype.getKeys = hm.prototype.v;
    hm.prototype.getProperties = hm.prototype.l;
    hm.prototype.set = hm.prototype.set;
    hm.prototype.setProperties = hm.prototype.f;
    hm.prototype.unset = hm.prototype.A;
    hm.prototype.changed = hm.prototype.a;
    hm.prototype.dispatchEvent = hm.prototype.dispatchEvent;
    hm.prototype.getRevision = hm.prototype.o;
    hm.prototype.on = hm.prototype.g;
    hm.prototype.once = hm.prototype.once;
    hm.prototype.un = hm.prototype.j;
    Nf.prototype.getFirstCoordinate = Nf.prototype.Re;
    Nf.prototype.getLastCoordinate = Nf.prototype.Se;
    Nf.prototype.getLayout = Nf.prototype.Ue;
    Nf.prototype.rotate = Nf.prototype.rotate;
    Nf.prototype.scale = Nf.prototype.scale;
    Nf.prototype.getClosestPoint = Nf.prototype.od;
    Nf.prototype.intersectsCoordinate = Nf.prototype.Xc;
    Nf.prototype.getExtent = Nf.prototype.c;
    Nf.prototype.simplify = Nf.prototype.Zd;
    Nf.prototype.transform = Nf.prototype.transform;
    Nf.prototype.get = Nf.prototype.get;
    Nf.prototype.getKeys = Nf.prototype.v;
    Nf.prototype.getProperties = Nf.prototype.l;
    Nf.prototype.set = Nf.prototype.set;
    Nf.prototype.setProperties = Nf.prototype.f;
    Nf.prototype.unset = Nf.prototype.A;
    Nf.prototype.changed = Nf.prototype.a;
    Nf.prototype.dispatchEvent = Nf.prototype.dispatchEvent;
    Nf.prototype.getRevision = Nf.prototype.o;
    Nf.prototype.on = Nf.prototype.g;
    Nf.prototype.once = Nf.prototype.once;
    Nf.prototype.un = Nf.prototype.j;
    N.prototype.getFirstCoordinate = N.prototype.Re;
    N.prototype.getLastCoordinate = N.prototype.Se;
    N.prototype.getLayout = N.prototype.Ue;
    N.prototype.rotate = N.prototype.rotate;
    N.prototype.scale = N.prototype.scale;
    N.prototype.getClosestPoint = N.prototype.od;
    N.prototype.intersectsCoordinate = N.prototype.Xc;
    N.prototype.getExtent = N.prototype.c;
    N.prototype.simplify = N.prototype.Zd;
    N.prototype.transform = N.prototype.transform;
    N.prototype.get = N.prototype.get;
    N.prototype.getKeys = N.prototype.v;
    N.prototype.getProperties = N.prototype.l;
    N.prototype.set = N.prototype.set;
    N.prototype.setProperties = N.prototype.f;
    N.prototype.unset = N.prototype.A;
    N.prototype.changed = N.prototype.a;
    N.prototype.dispatchEvent = N.prototype.dispatchEvent;
    N.prototype.getRevision = N.prototype.o;
    N.prototype.on = N.prototype.g;
    N.prototype.once = N.prototype.once;
    N.prototype.un = N.prototype.j;
    P.prototype.getFirstCoordinate = P.prototype.Re;
    P.prototype.getLastCoordinate = P.prototype.Se;
    P.prototype.getLayout = P.prototype.Ue;
    P.prototype.rotate = P.prototype.rotate;
    P.prototype.scale = P.prototype.scale;
    P.prototype.getClosestPoint = P.prototype.od;
    P.prototype.intersectsCoordinate = P.prototype.Xc;
    P.prototype.getExtent = P.prototype.c;
    P.prototype.simplify = P.prototype.Zd;
    P.prototype.transform = P.prototype.transform;
    P.prototype.get = P.prototype.get;
    P.prototype.getKeys = P.prototype.v;
    P.prototype.getProperties = P.prototype.l;
    P.prototype.set = P.prototype.set;
    P.prototype.setProperties = P.prototype.f;
    P.prototype.unset = P.prototype.A;
    P.prototype.changed = P.prototype.a;
    P.prototype.dispatchEvent = P.prototype.dispatchEvent;
    P.prototype.getRevision = P.prototype.o;
    P.prototype.on = P.prototype.g;
    P.prototype.once = P.prototype.once;
    P.prototype.un = P.prototype.j;
    Q.prototype.getFirstCoordinate = Q.prototype.Re;
    Q.prototype.getLastCoordinate = Q.prototype.Se;
    Q.prototype.getLayout = Q.prototype.Ue;
    Q.prototype.rotate = Q.prototype.rotate;
    Q.prototype.scale = Q.prototype.scale;
    Q.prototype.getClosestPoint = Q.prototype.od;
    Q.prototype.intersectsCoordinate = Q.prototype.Xc;
    Q.prototype.getExtent = Q.prototype.c;
    Q.prototype.simplify = Q.prototype.Zd;
    Q.prototype.transform = Q.prototype.transform;
    Q.prototype.get = Q.prototype.get;
    Q.prototype.getKeys = Q.prototype.v;
    Q.prototype.getProperties = Q.prototype.l;
    Q.prototype.set = Q.prototype.set;
    Q.prototype.setProperties = Q.prototype.f;
    Q.prototype.unset = Q.prototype.A;
    Q.prototype.changed = Q.prototype.a;
    Q.prototype.dispatchEvent = Q.prototype.dispatchEvent;
    Q.prototype.getRevision = Q.prototype.o;
    Q.prototype.on = Q.prototype.g;
    Q.prototype.once = Q.prototype.once;
    Q.prototype.un = Q.prototype.j;
    R.prototype.getFirstCoordinate = R.prototype.Re;
    R.prototype.getLastCoordinate = R.prototype.Se;
    R.prototype.getLayout = R.prototype.Ue;
    R.prototype.rotate = R.prototype.rotate;
    R.prototype.scale = R.prototype.scale;
    R.prototype.getClosestPoint = R.prototype.od;
    R.prototype.intersectsCoordinate = R.prototype.Xc;
    R.prototype.getExtent = R.prototype.c;
    R.prototype.simplify = R.prototype.Zd;
    R.prototype.transform = R.prototype.transform;
    R.prototype.get = R.prototype.get;
    R.prototype.getKeys = R.prototype.v;
    R.prototype.getProperties = R.prototype.l;
    R.prototype.set = R.prototype.set;
    R.prototype.setProperties = R.prototype.f;
    R.prototype.unset = R.prototype.A;
    R.prototype.changed = R.prototype.a;
    R.prototype.dispatchEvent = R.prototype.dispatchEvent;
    R.prototype.getRevision = R.prototype.o;
    R.prototype.on = R.prototype.g;
    R.prototype.once = R.prototype.once;
    R.prototype.un = R.prototype.j;
    D.prototype.getFirstCoordinate = D.prototype.Re;
    D.prototype.getLastCoordinate = D.prototype.Se;
    D.prototype.getLayout = D.prototype.Ue;
    D.prototype.rotate = D.prototype.rotate;
    D.prototype.scale = D.prototype.scale;
    D.prototype.getClosestPoint = D.prototype.od;
    D.prototype.intersectsCoordinate = D.prototype.Xc;
    D.prototype.getExtent = D.prototype.c;
    D.prototype.simplify = D.prototype.Zd;
    D.prototype.transform = D.prototype.transform;
    D.prototype.get = D.prototype.get;
    D.prototype.getKeys = D.prototype.v;
    D.prototype.getProperties = D.prototype.l;
    D.prototype.set = D.prototype.set;
    D.prototype.setProperties = D.prototype.f;
    D.prototype.unset = D.prototype.A;
    D.prototype.changed = D.prototype.a;
    D.prototype.dispatchEvent = D.prototype.dispatchEvent;
    D.prototype.getRevision = D.prototype.o;
    D.prototype.on = D.prototype.g;
    D.prototype.once = D.prototype.once;
    D.prototype.un = D.prototype.j;
    F.prototype.getFirstCoordinate = F.prototype.Re;
    F.prototype.getLastCoordinate = F.prototype.Se;
    F.prototype.getLayout = F.prototype.Ue;
    F.prototype.rotate = F.prototype.rotate;
    F.prototype.scale = F.prototype.scale;
    F.prototype.getClosestPoint = F.prototype.od;
    F.prototype.intersectsCoordinate = F.prototype.Xc;
    F.prototype.getExtent = F.prototype.c;
    F.prototype.simplify = F.prototype.Zd;
    F.prototype.transform = F.prototype.transform;
    F.prototype.get = F.prototype.get;
    F.prototype.getKeys = F.prototype.v;
    F.prototype.getProperties = F.prototype.l;
    F.prototype.set = F.prototype.set;
    F.prototype.setProperties = F.prototype.f;
    F.prototype.unset = F.prototype.A;
    F.prototype.changed = F.prototype.a;
    F.prototype.dispatchEvent = F.prototype.dispatchEvent;
    F.prototype.getRevision = F.prototype.o;
    F.prototype.on = F.prototype.g;
    F.prototype.once = F.prototype.once;
    F.prototype.un = F.prototype.j;
    Gm.prototype.readFeatures = Gm.prototype.pb;
    Pm.prototype.readFeatures = Pm.prototype.pb;
    Gm.prototype.readFeatures = Gm.prototype.pb;
    sd.prototype.get = sd.prototype.get;
    sd.prototype.getKeys = sd.prototype.v;
    sd.prototype.getProperties = sd.prototype.l;
    sd.prototype.set = sd.prototype.set;
    sd.prototype.setProperties = sd.prototype.f;
    sd.prototype.unset = sd.prototype.A;
    sd.prototype.changed = sd.prototype.a;
    sd.prototype.dispatchEvent = sd.prototype.dispatchEvent;
    sd.prototype.getRevision = sd.prototype.o;
    sd.prototype.on = sd.prototype.g;
    sd.prototype.once = sd.prototype.once;
    sd.prototype.un = sd.prototype.j;
    td.prototype.getMap = td.prototype.B;
    td.prototype.setMap = td.prototype.setMap;
    td.prototype.setTarget = td.prototype.ac;
    td.prototype.get = td.prototype.get;
    td.prototype.getKeys = td.prototype.v;
    td.prototype.getProperties = td.prototype.l;
    td.prototype.set = td.prototype.set;
    td.prototype.setProperties = td.prototype.f;
    td.prototype.unset = td.prototype.A;
    td.prototype.changed = td.prototype.a;
    td.prototype.dispatchEvent = td.prototype.dispatchEvent;
    td.prototype.getRevision = td.prototype.o;
    td.prototype.on = td.prototype.g;
    td.prototype.once = td.prototype.once;
    td.prototype.un = td.prototype.j;
    Dd.prototype.getMap = Dd.prototype.B;
    Dd.prototype.setMap = Dd.prototype.setMap;
    Dd.prototype.setTarget = Dd.prototype.ac;
    Dd.prototype.get = Dd.prototype.get;
    Dd.prototype.getKeys = Dd.prototype.v;
    Dd.prototype.getProperties = Dd.prototype.l;
    Dd.prototype.set = Dd.prototype.set;
    Dd.prototype.setProperties = Dd.prototype.f;
    Dd.prototype.unset = Dd.prototype.A;
    Dd.prototype.changed = Dd.prototype.a;
    Dd.prototype.dispatchEvent = Dd.prototype.dispatchEvent;
    Dd.prototype.getRevision = Dd.prototype.o;
    Dd.prototype.on = Dd.prototype.g;
    Dd.prototype.once = Dd.prototype.once;
    Dd.prototype.un = Dd.prototype.j;
    Id.prototype.getMap = Id.prototype.B;
    Id.prototype.setMap = Id.prototype.setMap;
    Id.prototype.setTarget = Id.prototype.ac;
    Id.prototype.get = Id.prototype.get;
    Id.prototype.getKeys = Id.prototype.v;
    Id.prototype.getProperties = Id.prototype.l;
    Id.prototype.set = Id.prototype.set;
    Id.prototype.setProperties = Id.prototype.f;
    Id.prototype.unset = Id.prototype.A;
    Id.prototype.changed = Id.prototype.a;
    Id.prototype.dispatchEvent = Id.prototype.dispatchEvent;
    Id.prototype.getRevision = Id.prototype.o;
    Id.prototype.on = Id.prototype.g;
    Id.prototype.once = Id.prototype.once;
    Id.prototype.un = Id.prototype.j;
    sk.prototype.getMap = sk.prototype.B;
    sk.prototype.setMap = sk.prototype.setMap;
    sk.prototype.setTarget = sk.prototype.ac;
    sk.prototype.get = sk.prototype.get;
    sk.prototype.getKeys = sk.prototype.v;
    sk.prototype.getProperties = sk.prototype.l;
    sk.prototype.set = sk.prototype.set;
    sk.prototype.setProperties = sk.prototype.f;
    sk.prototype.unset = sk.prototype.A;
    sk.prototype.changed = sk.prototype.a;
    sk.prototype.dispatchEvent = sk.prototype.dispatchEvent;
    sk.prototype.getRevision = sk.prototype.o;
    sk.prototype.on = sk.prototype.g;
    sk.prototype.once = sk.prototype.once;
    sk.prototype.un = sk.prototype.j;
    zd.prototype.getMap = zd.prototype.B;
    zd.prototype.setMap = zd.prototype.setMap;
    zd.prototype.setTarget = zd.prototype.ac;
    zd.prototype.get = zd.prototype.get;
    zd.prototype.getKeys = zd.prototype.v;
    zd.prototype.getProperties = zd.prototype.l;
    zd.prototype.set = zd.prototype.set;
    zd.prototype.setProperties = zd.prototype.f;
    zd.prototype.unset = zd.prototype.A;
    zd.prototype.changed = zd.prototype.a;
    zd.prototype.dispatchEvent = zd.prototype.dispatchEvent;
    zd.prototype.getRevision = zd.prototype.o;
    zd.prototype.on = zd.prototype.g;
    zd.prototype.once = zd.prototype.once;
    zd.prototype.un = zd.prototype.j;
    wk.prototype.getMap = wk.prototype.B;
    wk.prototype.setMap = wk.prototype.setMap;
    wk.prototype.setTarget = wk.prototype.ac;
    wk.prototype.get = wk.prototype.get;
    wk.prototype.getKeys = wk.prototype.v;
    wk.prototype.getProperties = wk.prototype.l;
    wk.prototype.set = wk.prototype.set;
    wk.prototype.setProperties = wk.prototype.f;
    wk.prototype.unset = wk.prototype.A;
    wk.prototype.changed = wk.prototype.a;
    wk.prototype.dispatchEvent = wk.prototype.dispatchEvent;
    wk.prototype.getRevision = wk.prototype.o;
    wk.prototype.on = wk.prototype.g;
    wk.prototype.once = wk.prototype.once;
    wk.prototype.un = wk.prototype.j;
    Bd.prototype.getMap = Bd.prototype.B;
    Bd.prototype.setMap = Bd.prototype.setMap;
    Bd.prototype.setTarget = Bd.prototype.ac;
    Bd.prototype.get = Bd.prototype.get;
    Bd.prototype.getKeys = Bd.prototype.v;
    Bd.prototype.getProperties = Bd.prototype.l;
    Bd.prototype.set = Bd.prototype.set;
    Bd.prototype.setProperties = Bd.prototype.f;
    Bd.prototype.unset = Bd.prototype.A;
    Bd.prototype.changed = Bd.prototype.a;
    Bd.prototype.dispatchEvent = Bd.prototype.dispatchEvent;
    Bd.prototype.getRevision = Bd.prototype.o;
    Bd.prototype.on = Bd.prototype.g;
    Bd.prototype.once = Bd.prototype.once;
    Bd.prototype.un = Bd.prototype.j;
    Ak.prototype.getMap = Ak.prototype.B;
    Ak.prototype.setMap = Ak.prototype.setMap;
    Ak.prototype.setTarget = Ak.prototype.ac;
    Ak.prototype.get = Ak.prototype.get;
    Ak.prototype.getKeys = Ak.prototype.v;
    Ak.prototype.getProperties = Ak.prototype.l;
    Ak.prototype.set = Ak.prototype.set;
    Ak.prototype.setProperties = Ak.prototype.f;
    Ak.prototype.unset = Ak.prototype.A;
    Ak.prototype.changed = Ak.prototype.a;
    Ak.prototype.dispatchEvent = Ak.prototype.dispatchEvent;
    Ak.prototype.getRevision = Ak.prototype.o;
    Ak.prototype.on = Ak.prototype.g;
    Ak.prototype.once = Ak.prototype.once;
    Ak.prototype.un = Ak.prototype.j;
    Fk.prototype.getMap = Fk.prototype.B;
    Fk.prototype.setMap = Fk.prototype.setMap;
    Fk.prototype.setTarget = Fk.prototype.ac;
    Fk.prototype.get = Fk.prototype.get;
    Fk.prototype.getKeys = Fk.prototype.v;
    Fk.prototype.getProperties = Fk.prototype.l;
    Fk.prototype.set = Fk.prototype.set;
    Fk.prototype.setProperties = Fk.prototype.f;
    Fk.prototype.unset = Fk.prototype.A;
    Fk.prototype.changed = Fk.prototype.a;
    Fk.prototype.dispatchEvent = Fk.prototype.dispatchEvent;
    Fk.prototype.getRevision = Fk.prototype.o;
    Fk.prototype.on = Fk.prototype.g;
    Fk.prototype.once = Fk.prototype.once;
    Fk.prototype.un = Fk.prototype.j;
    return OPENLAYERS.ol;
}));
(function(FA, ol) {
    FA.Maps = typeof (FA.Maps) !== "undefined" ? FA.Maps : {};
    var TileLoadingManager = function(options) {
        this.progressIndicator = typeof (options.progressIndicator) !== "undefined" && options.progressIndicator ? $('.tile-progress') : null;
        this.progressAnnotation = typeof (options.progressAnnotation) !== "undefined" && options.progressAnnotation ? $('.tile-progress-annotation') : null;
        this.loading = 0;
        this.loaded = 0;
        this._retries = {};
        this._ttl = {};
        this._sumLoadedTime = 0;
        this._loadedCount = 0;
        this._startloading = {};
        this._hiding = null;
        this.visibleWhenLoading(true);
    }
    TileLoadingManager.prototype.registerTileSource = function(olTileSource) {
        var url = olTileSource.getUrls();
        olTileSource.on('tileloadstart', (function(tlManager) {
            return tlManager.addLoading.bind(tlManager, url[0])
        }
        )(this));
        olTileSource.on('tileloadend', (function(tlManager) {
            return tlManager.addLoaded.bind(tlManager, url[0])
        }
        )(this));
        olTileSource.on('tileloaderror', (function(tlManager) {
            return tlManager.addLoaded.bind(tlManager, url[0])
        }
        )(this));
    }
    TileLoadingManager.prototype.addLoading = function(url, e) {
        var key = e.tile.getKey();
        this._ttl[key] = (new Date()).getTime();
        if (this.loading === 0 && this._visible) {
            this.show();
        }
        if (this.loading === 0) {
            this._startloading = (new Date()).getTime();
        }
        ++this.loading;
        this.update(url);
    }
    ;
    TileLoadingManager.prototype.addLoaded = function(url, e) {
        var this_ = this
          , key = e.tile.getKey();
        setTimeout(function() {
            ++this_.loaded;
            this_.update(url);
        }, 100);
        if (e.type === "tileloaderror") {
            var retriesRemaining = typeof (this._retries[key]) === "undefined" ? 3 : this._retries[key];
            if (retriesRemaining > 0) {
                setTimeout((function(tile) {
                    return tile.load.bind(tile);
                }
                )(e.tile), 3000);
                this._retries[key] = --retriesRemaining;
            } else {}
        } else {
            var timeToLoad = (new Date()).getTime() - this._ttl[key];
            this._sumLoadedTime += timeToLoad;
            this._loadedCount += 1;
            delete this._ttl[key];
            delete this._retries[key]
        }
    }
    ;
    TileLoadingManager.prototype.update = function(url) {
        var width = (this.loaded / this.loading * 100).toFixed(1) + '%';
        if (this._loadedCount) {
            var avg = this._sumLoadedTime / this._loadedCount;
            this._loadedCount = 0;
            this._sumLoadedTime = 0;
        }
        if (this._hiding) {
            clearTimeout(this._hiding);
        }
        if (this._visible) {
            $(this.progressIndicator).css('width', width);
        } else {
            this.hide();
        }
        if (this.loading === this.loaded) {
            var nLoaded = this.loaded;
            this.loading = 0;
            this.loaded = 0;
            var this_ = this;
            if (this._visible) {
                this._hiding = setTimeout(function() {
                    this_.hide();
                }, 3000);
            }
        }
    }
    ;
    TileLoadingManager.prototype.visibleWhenLoading = function(visible) {
        this._visible = typeof (this._visible) === "undefined" ? (this.progressIndicator ? true : false) : this._visible;
        if (typeof (visible) !== "undefined") {
            this._visible = visible;
        }
        if (!this._visible) {
            this.hide();
        }
        return this._visible;
    }
    TileLoadingManager.prototype.show = function() {
        $(this.progressIndicator).css('visibility', 'visible');
        $(this.progressAnnotation).css('visibility', 'visible');
    }
    ;
    TileLoadingManager.prototype.hide = function() {
        if (this.loading === this.loaded) {
            $(this.progressIndicator).width(0);
        }
        $(this.progressAnnotation).css('visibility', 'hidden');
        this._hiding = null;
    }
    ;
    FA.Maps.TileLoadingManager = TileLoadingManager;
}
)(FA, ol);
var mapGlobals = mapGlobals || {};
var FAMap = {
    Globals: mapGlobals,
    _instances: {},
    factory: function(target, options) {
        FAMap._instances[target] = new FAMap.Map(target,options);
        var deferred = $.Deferred().resolve(FAMap._instances[target]);
        return deferred.promise();
    },
    getInstance: function(target) {
        if (target in FAMap._instances) {
            var deferred = $.Deferred().resolve(FAMap._instances[target]);
            return deferred.promise();
        } else {
            throw ('Error: No FAMap instance exists for target ' + target);
        }
    }
};
FA.Modules.ConfigHandler = function(map, items) {
    this._FAMap = map;
    this._sourceClasses = {};
    this._sources = {};
    this._items = {};
    this.getSource = function(name) {
        if (!(name in this._sources)) {
            if (name in FA.Modules.Config.Sources) {
                this._sources[name] = new FA.Modules.Config.Sources[name](this._FAMap);
            } else if (name in FA.Modules.Config.MetaSources) {
                this._sources[name] = new FA.Modules.Config.MetaSources[name](this._FAMap,this);
            } else {
                throw ('Error: Unknown ConfigHandler source ' + name);
            }
        }
        return this._sources[name];
    }
    ;
    this.get = function(key) {
        if (!(key in this._items)) {
            throw 'Error: Unknown config item ' + key;
        }
        return this._items[key].get();
    }
    this.init = function(map) {
        var self = this;
        $.each(items, function(name, options) {
            self._items[name] = new FA.Modules.Config.Item(self,name,options);
        });
    }
    this.init.apply(this, arguments);
}
FA.Modules.Config = {};
FA.Modules.Config.Item = function(handler, name, options) {
    this.itemName = name;
    this._allowedSources = options.allowedSources;
    this._handler = handler;
    if ('sourceKey'in options) {
        this.sourceKey = options.sourceKey;
    } else {
        this.sourceKey = name;
    }
    this._deferred = $.Deferred();
    this._value = false;
    this._sources = [];
    this._setValue();
}
;
FA.Modules.Config.Item.prototype.itemName = null;
FA.Modules.Config.Item.prototype._deferred = null;
FA.Modules.Config.Item.prototype._value = false;
FA.Modules.Config.Item.prototype._allowedSources = [];
FA.Modules.Config.Item.prototype._sources = null;
FA.Modules.Config.Item.prototype.get = function() {
    return this._value;
}
FA.Modules.Config.Item.prototype._setValue = function() {
    var result = {
        state: 'final'
    };
    var firstRun = (this._value === false);
    var self = this;
    $.each(this._allowedSources, function() {
        var source = self._handler.getSource(this);
        var sourceVal = source.get(self.sourceKey);
        if (sourceVal === false) {
            return true;
        } else if (sourceVal.state === 'pending') {
            result.state = 'transient';
            if (firstRun) {
                sourceVal.promise.done($.proxy(self._setValue, self));
            }
        } else {
            result.value = sourceVal.value;
            result.source = source.sourceName;
            return false;
        }
    });
    if (!('value'in result)) {
        return false;
    }
    if (result.state == 'transient') {
        result.promise = this._deferred.promise();
    } else {
        this._deferred.resolve(result);
    }
    this._value = result;
}
FA.Modules.Config.Source = function() {
    this._deferred = $.Deferred();
}
;
FA.Modules.Config.Source.prototype.sourceName = null;
FA.Modules.Config.Source.prototype._deferred = null;
FA.Modules.Config.Source.prototype._noValueError = new function() {
    this.name = 'ValueNotFound';
    this.message = 'Unable to find a value matching the provided key';
}
FA.Modules.Config.Source.prototype.isPending = function() {
    return (this._deferred.state() == 'pending');
}
FA.Modules.Config.Source.prototype.finalize = function() {
    this._deferred.resolve();
}
FA.Modules.Config.Source.prototype.get = function(key) {
    if (this._deferred.state() == 'pending') {
        return {
            state: 'pending',
            promise: this._deferred.promise()
        }
    } else {
        try {
            var testVal = this._getValue(key);
        } catch (e) {
            if (e.name === this._noValueError.name) {
                return false;
            } else {
                throw e;
            }
        }
        return {
            state: 'final',
            value: testVal
        };
    }
}
FA.Modules.Config.Source.prototype._getValue = function(key) {
    throw ('Error: FA.Modules.Config.Source._getValue should be implemented in the child class');
}
FA.Modules.Config.Sources = {};
FA.Modules.Config.MetaSource = function(map, handler) {
    this._handler = handler;
    this._onFinalized = function(source) {
        this._finalizedSources.push(source.sourceName);
        if (this._finalizedSources.sort().join() == this._sourceNames.sort().join()) {
            this._onAllFinalized();
        }
    }
    ;
    FA.Modules.Config.Source.apply(this, arguments);
    this._sources = {};
    this._finalizedSources = [];
    $.each(this._sourceNames, $.proxy(function(k, v) {
        var source = handler.getSource(v);
        this._sources[v] = source;
        if (!source.isPending()) {
            this._finalizedSources.push(v);
        } else {
            source._deferred.promise().done($.proxy(function() {
                this._onFinalized(source);
            }, this));
        }
    }, this));
}
;
FA.Modules.Config.MetaSource.prototype = Object.create(FA.Modules.Config.Source.prototype);
FA.Modules.Config.MetaSource.prototype._sourceNames = [];
FA.Modules.Config.MetaSource.prototype._sources = null;
FA.Modules.Config.MetaSource.prototype._finalizedSources = null;
FA.Modules.Config.MetaSource.prototype._onAllFinalized = function() {
    throw ('Error: MetaSource classes must implement _onAllFinalized!');
}
;
FA.Modules.Config.MetaSources = {};
FA.Modules.Config.MetaSources.ArincFeatures = function(map) {
    this.sourceName = 'ArincFeatures';
    this._sourceNames = ['AnimatedFeatures', 'ArincLastPosFeatures'];
    this._values = {};
    this._map = map;
    this._getValue = function(key) {
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    this._onAllFinalized = function() {
        var extents = [];
        $.each(this._sources, function(k, source) {
            var initialViewState = source.get('initialViewState');
            if (initialViewState == false) {
                return true;
            }
            extents.push(initialViewState.value.extent);
        });
        if (extents.length > 0) {
            var finalValue = {};
            if (extents.length === 1) {
                var finalExtent = extents[0];
            } else {
                var finalExtent = extents.pop();
                $.each(extents, function(k, extent) {
                    ol.extent.extend(finalExtent, extent);
                });
            }
            this._values.initialViewState = {
                type: 'fitExtent',
                extent: finalExtent,
                padding: .2
            };
        }
        this.finalize();
    }
    ;
    FA.Modules.Config.MetaSource.apply(this, arguments);
}
;
FA.Modules.Config.MetaSources.ArincFeatures.prototype = Object.create(FA.Modules.Config.MetaSource.prototype);
FA.Modules.Config.Sources.AnimatedFeatures = function(map) {
    this.sourceName = 'AnimatedFeatures';
    this._values = {};
    this._map = map;
    this._getValue = function(key) {
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    FA.Modules.Config.Source.apply(this, arguments);
    if (!('animation'in map.options)) {
        this.finalize();
    } else if ('disableFeatureZoom'in map.options.animation && map.options.animation.disableFeatureZoom) {
        this.finalize();
    } else {
        map.on('animationController.newFlights', $.proxy(function(e, batch) {
            if (!this.isPending()) {
                return;
            }
            var extent = FAMap.Util.getBoundingExtent(this._map, batch);
            if (extent) {
                this._values.initialViewState = {
                    type: 'fitExtent',
                    extent: extent,
                    padding: .2
                };
            }
            this.finalize();
        }, this));
    }
}
;
FA.Modules.Config.Sources.AnimatedFeatures.prototype = Object.create(FA.Modules.Config.Source.prototype);
FA.Modules.Config.Sources.ArincLastPosFeatures = function(map) {
    this.sourceName = 'ArincLastPosFeatures';
    this._values = {};
    this._map = map;
    this._getValue = function(key) {
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    FA.Modules.Config.Source.apply(this, arguments);
    if (!('arinc_lastpos'in map.options.overlays)) {
        this.finalize();
    } else {
        map.on('arinc_lastpos:featuresLoaded', $.proxy(function(e, features) {
            var coords = [];
            $.each(features, function(k, feature) {
                coords.push(feature.getGeometry().getCoordinates());
            });
            if (coords.length > 0) {
                this._values.initialViewState = {
                    type: 'fitExtent',
                    extent: ol.extent.boundingExtent(coords),
                    padding: .2
                };
            }
            this.finalize();
        }, this));
    }
}
FA.Modules.Config.Sources.ArincLastPosFeatures.prototype = Object.create(FA.Modules.Config.Source.prototype);
FA.Modules.Config.Sources.Defaults = function(map) {
    this.sourceName = 'Defaults';
    this._values = {
        baseLayer: 'classic',
        initialViewState: {
            type: 'fitExtent',
            extent: [-13854058.502631625, 3130860.6785608195, -8022830.488812098, 6457400.14953169]
        },
        overlay_basic_radar: {
            visibility: true
        },
        playback: {
            playingState: "paused"
        }
    };
    this._getValue = function(key) {
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    FA.Modules.Config.Source.apply(this, arguments);
    if ('defaultOverrides'in map.options) {
        $.extend(true, this._values, map.options.defaultOverrides);
    }
    this.finalize();
}
FA.Modules.Config.Sources.Defaults.prototype = Object.create(FA.Modules.Config.Source.prototype);
FA.Modules.Config.Sources.Geolocation = function(map) {
    this.sourceName = 'Geolocation';
    this._values = {};
    this._map = map;
    this._getValue = function(key) {
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    FA.Modules.Config.Source.apply(this, arguments);
    if ('geolocation'in navigator) {
        navigator.geolocation.getCurrentPosition($.proxy(function(position) {
            var coord = [position.coords.longitude, position.coords.latitude];
            coord = ol.proj.transform(coord, 'EPSG:4326', 'EPSG:3857');
            this._values.initialViewState = {
                type: 'panZoom',
                center: coord,
                zoom: 8
            };
            this.finalize();
        }, this));
    } else if ('GEOIP'in FAMap.Globals) {
        this._values.initialViewState = {
            type: 'panZoom',
            center: ol.proj.transform(FAMap.Globals.GEOIP, 'EPSG:4326', 'EPSG:3857'),
            zoom: 8
        }
        this.finalize();
    } else {
        this.finalize();
    }
}
FA.Modules.Config.Sources.Geolocation.prototype = Object.create(FA.Modules.Config.Source.prototype);
FA.Modules.Config.Sources.Persistent = function(map) {
    this.sourceName = 'Persistent';
    this._storageKeys = ['LiveLoop', 'ZoomTo', 'BaseLayer', 'OverlayState'];
    this._values = {};
    this._getValue = function(key) {
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    this._getValues = function() {
        var self = this;
        var persistentZoomTo = map.persistentStores['ZoomTo'].get();
        if (persistentZoomTo !== false) {
            this._values.initialViewState = persistentZoomTo;
            this._values.initialViewState.type = 'panZoom';
        }
        var baseLayer = map.persistentStores['BaseLayer'].get();
        if (baseLayer !== false) {
            this._values.baseLayer = baseLayer;
        }
        var overlayState = map.persistentStores['Overlays'].get();
        if (overlayState !== false) {
            $.each(overlayState, function(k, v) {
                var key = 'overlay_' + k;
                self._values[key] = v;
            });
        }
        var liveLoop = map.persistentStores['LiveLoop'].get();
        if (liveLoop !== false) {
            this._values.liveLoop = liveLoop;
        }
    }
    ;
    FA.Modules.Config.Source.apply(this, arguments);
    this._getValues();
    this.finalize();
}
FA.Modules.Config.Sources.Persistent.prototype = Object.create(FA.Modules.Config.Source.prototype);
FA.Modules.Config.Sources.RuntimeOptions = function(map) {
    this.sourceName = 'RuntimeOptions';
    this._values = null;
    this._getValue = function(key) {
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    FA.Modules.Config.Source.apply(this, arguments);
    this._values = map.options;
    this.finalize();
}
FA.Modules.Config.Sources.RuntimeOptions.prototype = Object.create(FA.Modules.Config.Source.prototype);
"use strict"
FA.Modules.Config.Sources.UIComponent = function(map) {
    var _hyphenLowerToUpper = function(match, offset, string) {
        return (match.substring(1)).toUpperCase();
    };
    this.sourceName = 'UIComponent';
    this._values = {};
    this._getValue = function(componentId) {
        if (componentId in this._values) {
            return this._values[componentId];
        } else {
            throw this._noValueError;
        }
    }
    this._getValues = function() {
        var self = this;
        var elements = document.getElementsByClassName("fa-ui-component"), i, j, cId, attrNameCamel, attrs, componentAttrs;
        for (i = elements.length - 1; i >= 0; i--) {
            cId = typeof (elements[i].id) === "undefined" ? null : elements[i].id;
            if (cId) {
                if (typeof (self._values[cId]) === "undefined") {
                    attrs = {};
                    componentAttrs = elements[i].attributes;
                    for (j = componentAttrs.length - 1; j >= 0; j--) {
                        attrNameCamel = (componentAttrs[j].name).replace(/-[a-z]/g, _hyphenLowerToUpper);
                        attrs[attrNameCamel] = componentAttrs[j].value;
                    }
                    self._values[cId] = attrs;
                    self._values[cId].state = "final";
                } else {
                    throw ("FA.Modules.Config.Sources.UIComponenet(_getValues): 'fa-ui-component' has duplicate id:" + elements[i].id);
                }
            } else {
                throw ("FA.Modules.Config.Sources.UIComponent(_getValues): 'fa-ui-component' element must have an id");
            }
        }
    }
    ;
    FA.Modules.Config.Source.apply(this, arguments);
    this._getValues();
    this.finalize();
}
FA.Modules.Config.Sources.UIComponent.prototype = Object.create(FA.Modules.Config.Source.prototype);
FA.Modules.Config.Sources.URL = function() {
    this.sourceName = 'URL';
    this._values = null;
    this._whitelist = ['baseLayer', 'overlays', 'center', 'zoom', ];
    this._getValue = function(key) {
        if (this._values === null) {
            this._loadValues();
        }
        if (key in this._values) {
            return this._values[key];
        } else {
            throw this._noValueError;
        }
    }
    this._loadValues = function() {
        this._values = {};
        var pairs = window.location.search.substring(1).split('&');
        var self = this;
        $.each(pairs, function() {
            var pair = this.split('=');
            var key = pair[0];
            var val = pair[1];
            if (self._whitelist.indexOf(key) != -1) {
                self._values[key] = val;
            }
        });
    }
    FA.Modules.Config.Source.apply(this, arguments);
    this.finalize();
}
FA.Modules.Config.Sources.URL.prototype = Object.create(FA.Modules.Config.Source.prototype);
FAMap.Util = {
    getNow: function() {
        return FADate.getNow();
    },
    refSphere: new ol.Sphere(6378137),
    toRadians: function(angleDegrees) {
        return angleDegrees * Math.PI / 180;
    },
    toDegrees: function(angleRadians) {
        return angleRadians * (180 / Math.PI);
    },
    metersToNmi: function(meters) {
        return meters * 0.000539957;
    },
    getMaxResolutionForProjection: function(proj) {
        if (typeof proj == 'string') {
            proj = ol.proj.get(proj);
            if (proj === false) {
                throw ('Error: Invalid projection specified for getMaxResolutionForProjection');
            }
        }
        return ol.extent.getWidth(proj.getExtent()) / 256;
    },
    getZoomForResolution: function(resolution, projection) {
        if (typeof projection === 'undefined') {
            projection = 'EPSG:3857';
        }
        var maxRes = FAMap.Util.getMaxResolutionForProjection(projection);
        return Math.log(maxRes / resolution) / Math.log(2);
    },
    getCorrectedCoordinate: function(coord, projection) {
        if (typeof projection === 'undefined') {
            projection = 'EPSG:3857';
        }
        if (typeof projection == 'string') {
            projection = ol.proj.get(projection);
        }
        var projExtent = projection.getExtent();
        if (ol.extent.containsCoordinate(projExtent, coord)) {
            return coord;
        }
        var xMin = projExtent[0];
        var xMax = projExtent[2];
        var yMin = projExtent[1];
        var yMax = projExtent[3];
        var cX = coord[0];
        var cY = coord[1];
        if (cX < xMin) {
            var xDelta = Math.floor((xMax - cX) / (xMax - xMin)) * (xMax - xMin);
        } else if (cX > xMax) {
            var xDelta = Math.floor((xMin - cX) / (xMax - xMin)) * (xMax - xMin);
        } else {
            var xDelta = 0;
        }
        cX += xDelta;
        if (cY < yMin) {
            var yDelta = Math.floor((yMax - cY) / (yMax - yMin)) * (yMax - yMin);
        } else if (cY > yMax) {
            var yDelta = Math.floor((yMin - cY) / (yMax - yMin)) * (yMax - yMin);
        } else {
            var yDelta = 0;
        }
        cY += yDelta;
        return [cX, cY];
    },
    isAirportLatLon: function(icao) {
        return /^L\s+/.test(icao);
    },

    /***Get bounding extent for a track or waypoints*/
    getBoundingExtent: function(map, batch) {
        var projExtent = map._olMap.getView().getProjection().getExtent().slice(0);
        projExtent[0] = projExtent[0] * 2;
        projExtent[2] = projExtent[2] * 2;
        var coords = [];
        $.each(batch, function(k, v) {
            var destCorrection = false;
            if (batch.length > 1 && v.flightData.landingTimes.actual !== null) {
                return true;
            }
            if (v.flightData.waypoints !== null) {
                var prevCoord = null;
                $.each(v.flightData.waypoints, function(k1, v1) {
                    if (!destCorrection && prevCoord !== null && Math.abs(v1[0] - prevCoord[0]) > 270) {
                        if (prevCoord[0] < 0) {
                            destCorrection = -360;
                        } else {
                            destCorrection = 360;
                        }
                    }
                    prevCoord = v1.slice(0);
                    var coord = v1.slice(0);
                    if (destCorrection) {
                        ol.coordinate.add(coord, [destCorrection, 0]);
                    }
                    coord = ol.proj.fromLonLat(coord);
                    if (!ol.extent.containsCoordinate(projExtent, coord)) {
                        return true;
                    }
                    coords.push(coord);
                });
            }
            if (batch.length == 1 && v.flightData.track !== null) {
                var prevCoord = null;
                var track = v.flightData.track.slice(0).sort(function(pos1, pos2) {
                    return pos1.timestamp < pos2.timestamp ? -1 : (pos1.timestamp > pos2.timestamp ? 1 : 0);
                });
                $.each(track, function(k1, v1) {
                    if (!destCorrection && prevCoord !== null && Math.abs(v1.coord[0] - prevCoord[0]) > 270) {
                        if (prevCoord[0] < 0) {
                            destCorrection = -360;
                        } else {
                            destCorrection = 360;
                        }
                    }
                    prevCoord = v1.coord.slice(0);
                    var coord = v1.coord.slice(0);
                    if (destCorrection) {
                        ol.coordinate.add(coord, [destCorrection, 0]);
                    }
                    coord = ol.proj.fromLonLat(coord);
                    if (!ol.extent.containsCoordinate(projExtent, coord)) {
                        return true;
                    }
                    coords.push(coord);
                });
            }
            if (v.flightData.origin && v.flightData.origin.coord !== null) {
                var coord = v.flightData.origin.coord;
                coords.push(ol.proj.fromLonLat(coord));
            }
            if (v.flightData.destination && v.flightData.destination.coord !== null) {
                var coord = v.flightData.destination.coord.slice(0);
                if (destCorrection !== false) {
                    coord[0] += destCorrection;
                }
                coords.push(ol.proj.fromLonLat(coord));
            }
        });
        if (coords.length > 0) {
            return ol.extent.boundingExtent(coords);
        } else {
            return null;
        }
    }
};
FAMap.Util.AutoPanZoomController = function(map) {
    this.options = {
        clusterDistance: 300000,
        panDuration: 100,
        zoomDuration: 100,
        interval: 7000
    };
    this.FAMap = map;
    this._sources = [];
    this._source = new ol.source.Vector();
    this._clusterSource = new FAMap.olExtras.Source.ClusterMeters({
        distance: this.options.clusterDistance,
        source: this._source
    });
    this._index = 0;
    this.addSource = function(source) {
        this._sources.push(source);
    }
    ;
    this.reCluster = function() {
        this._source.clear(true);
        var features = [];
        $.each(this._sources, $.proxy(function(ks, source) {
            $.each(source.getFeatures(), function(kf, feature) {
                var geometry = feature.getGeometry();
                if (typeof geometry === 'object' && geometry !== null && Object.getPrototypeOf(geometry) == ol.geom.Point.prototype) {
                    features.push(feature);
                }
            });
        }, this));
        this._source.addFeatures(features);
    }
    ;
    this.autoPan = function() {
        this.reCluster();
        if (this._clusterSource.getFeatures().length == 0) {
            return;
        }
        var clusters = this._clusterSource.getFeatures();
        this._index = (this._index + 1) % (clusters.length + 1);
        var idx = this._index - 1;
        if (idx == -1) {
            var coords = this._source.getFeatures().map(function(feature) {
                return feature.getGeometry().getCoordinates();
            });
        } else {
            var cluster = clusters[idx];
            var coords = cluster.get('features').map(function(feature) {
                return feature.getGeometry().getCoordinates();
            });
        }
        var extent = ol.extent.boundingExtent(coords);
        var size = this.FAMap._olMap.getSize();
        var view = this.FAMap._olMap.getView();
        view.fit(extent, {
            size: size,
            maxZoom: 8,
            easing: ol.easing.linear
        });
    }
    ;
    this.autoPan();
    setInterval($.proxy(this.autoPan, this), this.options.interval);
}
;
FAMap.olExtras = {};
FAMap.olExtras.Control = {};
FAMap.olExtras.Control.Attribution = function() {
    this.getSourceAttributions = function(framestate) {
        var baseClass = this.constructor.prototype;
        var originalAttributions = baseClass.getSourceAttributions.call(this, framestate);
        var attributions = originalAttributions[0];
        var hiddenAttributions = originalAttributions[1];
        var attributionHTML = [];
        $.each(attributions, function(k, v) {
            try {
                var html = v.getHTML();
            } catch (e) {
                return true;
            }
            if (attributionHTML.indexOf(html) == -1) {
                attributionHTML.push(html);
            } else {
                hiddenAttributions[k] = v;
                delete attributions[k];
            }
        });
        return [attributions, hiddenAttributions];
    }
    ;
    ol.control.Attribution.call(this, arguments);
}
;
ol.inherits(FAMap.olExtras.Control.Attribution, ol.control.Attribution);
FAMap.olExtras.Control.Banner = function(map) {
    var self = this;
    var text = map.options.bannerText;
    self.bannerNumber = Number(map.options.bannerNumber);
    self.isHidden = false;
    var $closeButton = $('<div>').addClass('ol-banner-control-close');
    var $content = $('<div>').addClass('ol-banner-control-content');
    var $container = $('<div>').addClass('ol-banner-control').append($closeButton).append($content);
    this.setContent = function(message) {
        $content.html(message);
    }
    ;
    this.hide = function() {
        $container.hide();
    }
    ;
    this.show = function() {
        if (!self.isHidden) {
            $container.show();
        }
    }
    ;
    this.hideIfClosed = function() {
        var closedBefore = false;
        try {
            var closedRecord = JSON.parse(localStorage.getItem('FAMap_Banner'));
            var bannerNumber = Number(closedRecord.bannerNumber) || 0;
            var timestamp = Number(closedRecord.timestamp) || 0;
            var now = Date.now() / 1000;
            var thirtyDays = 30 * 24 * 60 * 60;
            if (self.bannerNumber <= bannerNumber && (now - timestamp) < thirtyDays) {
                closedBefore = true;
            }
        } catch (e) {}
        if (closedBefore) {
            this.isHidden = true;
            this.hide();
        }
    }
    $closeButton.on('click', function() {
        self.hide();
        self.isHidden = true;
        var closedRecord = {
            bannerNumber: self.bannerNumber,
            timestamp: Math.floor(Date.now() / 1000)
        };
        localStorage.setItem('FAMap_Banner', JSON.stringify(closedRecord));
    });
    ol.control.Control.call(this, {
        element: $container[0]
    });
    this.setContent(text);
    this.hideIfClosed();
}
;
ol.inherits(FAMap.olExtras.Control.Banner, ol.control.Control);
var saveAs = saveAs || function(view) {
    "use strict";
    if (typeof navigator !== "undefined" && /MSIE [1-9]\./.test(navigator.userAgent)) {
        return
    }
    var doc = view.document
      , get_URL = function() {
        return view.URL || view.webkitURL || view
    }
      , save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a")
      , can_use_save_link = "download"in save_link
      , click = function(node) {
        var event = new MouseEvent("click");
        node.dispatchEvent(event)
    }
      , is_safari = /Version\/[\d\.]+.*Safari/.test(navigator.userAgent)
      , webkit_req_fs = view.webkitRequestFileSystem
      , req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem
      , throw_outside = function(ex) {
        (view.setImmediate || view.setTimeout)(function() {
            throw ex
        }, 0)
    }
      , force_saveable_type = "application/octet-stream"
      , fs_min_size = 0
      , arbitrary_revoke_timeout = 500
      , revoke = function(file) {
        var revoker = function() {
            if (typeof file === "string") {
                get_URL().revokeObjectURL(file)
            } else {
                file.remove()
            }
        };
        if (view.chrome) {
            revoker()
        } else {
            setTimeout(revoker, arbitrary_revoke_timeout)
        }
    }
      , dispatch = function(filesaver, event_types, event) {
        event_types = [].concat(event_types);
        var i = event_types.length;
        while (i--) {
            var listener = filesaver["on" + event_types[i]];
            if (typeof listener === "function") {
                try {
                    listener.call(filesaver, event || filesaver)
                } catch (ex) {
                    throw_outside(ex)
                }
            }
        }
    }
      , auto_bom = function(blob) {
        if (/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
            return new Blob(["\ufeff", blob],{
                type: blob.type
            })
        }
        return blob
    }
      , FileSaver = function(blob, name, no_auto_bom) {
        if (!no_auto_bom) {
            blob = auto_bom(blob)
        }
        var filesaver = this, type = blob.type, blob_changed = false, object_url, target_view, dispatch_all = function() {
            dispatch(filesaver, "writestart progress write writeend".split(" "))
        }, fs_error = function() {
            if (target_view && is_safari && typeof FileReader !== "undefined") {
                var reader = new FileReader;
                reader.onloadend = function() {
                    var base64Data = reader.result;
                    target_view.location.href = "data:attachment/file" + base64Data.slice(base64Data.search(/[,;]/));
                    filesaver.readyState = filesaver.DONE;
                    dispatch_all()
                }
                ;
                reader.readAsDataURL(blob);
                filesaver.readyState = filesaver.INIT;
                return
            }
            if (blob_changed || !object_url) {
                object_url = get_URL().createObjectURL(blob)
            }
            if (target_view) {
                target_view.location.href = object_url
            } else {
                var new_tab = view.open(object_url, "_blank");
                if (new_tab == undefined && is_safari) {
                    view.location.href = object_url
                }
            }
            filesaver.readyState = filesaver.DONE;
            dispatch_all();
            revoke(object_url)
        }, abortable = function(func) {
            return function() {
                if (filesaver.readyState !== filesaver.DONE) {
                    return func.apply(this, arguments)
                }
            }
        }, create_if_not_found = {
            create: true,
            exclusive: false
        }, slice;
        filesaver.readyState = filesaver.INIT;
        if (!name) {
            name = "download"
        }
        if (can_use_save_link) {
            object_url = get_URL().createObjectURL(blob);
            setTimeout(function() {
                save_link.href = object_url;
                save_link.download = name;
                click(save_link);
                dispatch_all();
                revoke(object_url);
                filesaver.readyState = filesaver.DONE
            });
            return
        }
        if (view.chrome && type && type !== force_saveable_type) {
            slice = blob.slice || blob.webkitSlice;
            blob = slice.call(blob, 0, blob.size, force_saveable_type);
            blob_changed = true
        }
        if (webkit_req_fs && name !== "download") {
            name += ".download"
        }
        if (type === force_saveable_type || webkit_req_fs) {
            target_view = view
        }
        if (!req_fs) {
            fs_error();
            return
        }
        fs_min_size += blob.size;
        req_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {
            fs.root.getDirectory("saved", create_if_not_found, abortable(function(dir) {
                var save = function() {
                    dir.getFile(name, create_if_not_found, abortable(function(file) {
                        file.createWriter(abortable(function(writer) {
                            writer.onwriteend = function(event) {
                                target_view.location.href = file.toURL();
                                filesaver.readyState = filesaver.DONE;
                                dispatch(filesaver, "writeend", event);
                                revoke(file)
                            }
                            ;
                            writer.onerror = function() {
                                var error = writer.error;
                                if (error.code !== error.ABORT_ERR) {
                                    fs_error()
                                }
                            }
                            ;
                            "writestart progress write abort".split(" ").forEach(function(event) {
                                writer["on" + event] = filesaver["on" + event]
                            });
                            writer.write(blob);
                            filesaver.abort = function() {
                                writer.abort();
                                filesaver.readyState = filesaver.DONE
                            }
                            ;
                            filesaver.readyState = filesaver.WRITING
                        }), fs_error)
                    }), fs_error)
                };
                dir.getFile(name, {
                    create: false
                }, abortable(function(file) {
                    file.remove();
                    save()
                }), abortable(function(ex) {
                    if (ex.code === ex.NOT_FOUND_ERR) {
                        save()
                    } else {
                        fs_error()
                    }
                }))
            }), fs_error)
        }), fs_error)
    }
      , FS_proto = FileSaver.prototype
      , saveAs = function(blob, name, no_auto_bom) {
        return new FileSaver(blob,name,no_auto_bom)
    };
    if (typeof navigator !== "undefined" && navigator.msSaveOrOpenBlob) {
        return function(blob, name, no_auto_bom) {
            if (!no_auto_bom) {
                blob = auto_bom(blob)
            }
            return navigator.msSaveOrOpenBlob(blob, name || "download")
        }
    }
    FS_proto.abort = function() {
        var filesaver = this;
        filesaver.readyState = filesaver.DONE;
        dispatch(filesaver, "abort")
    }
    ;
    FS_proto.readyState = FS_proto.INIT = 0;
    FS_proto.WRITING = 1;
    FS_proto.DONE = 2;
    FS_proto.error = FS_proto.onwritestart = FS_proto.onprogress = FS_proto.onwrite = FS_proto.onabort = FS_proto.onerror = FS_proto.onwriteend = null;
    return saveAs
}(typeof self !== "undefined" && self || typeof window !== "undefined" && window || this.content);
if (typeof module !== "undefined" && module.exports) {
    module.exports.saveAs = saveAs
} else if (typeof define !== "undefined" && define !== null && define.amd != null) {
    define([], function() {
        return saveAs
    })
}
FAMap.olExtras.Control.Debugger = function(map) {
    this.FAMap = map;
    var self = this;
    var $debugLink = $('<a>').attr({
        id: 'famapDebugDownload',
        title: 'get debugging data'
    }).on('click', function() {
        var blob = new Blob([JSON.stringify(self.FAMap.debugger.get())],{
            type: 'text/plain;charset=utf-8'
        });
        var now = moment.unix(FAMap.Util.getNow()).utc().toISOString();
        var filename = 'FAMap Dump ' + now + '.json'
        saveAs(blob, filename);
    });
    var $container = $('<div>').addClass('ol-debugger-control').addClass('fa-zoom-light').append($debugLink);
    this.hide = function() {
        $container.hide();
    }
    ;
    this.show = function() {
        $container.show();
    }
    ;
    ol.control.Control.call(this, {
        element: $container[0]
    });
}
;
ol.inherits(FAMap.olExtras.Control.Debugger, ol.control.Control);
FAMap.olExtras.Control.DistanceBearing = function(map) {
    var self = this;
    var $container = $('<div>').addClass('ol-distance-bearing-control');
    map.on('mousemove', function(e) {
        var flight = self.getFlight();
        if (flight && flight.getState() === 'airborne') {
            var position = flight.getPosition();
            if (position === false || position.coord === false) {
                return;
            }
            var coord = position.coord;
            var parentOffset = $(this).parent().offset();
            var x = e.pageX - parentOffset.left;
            var y = e.pageY - parentOffset.top;
            var pixel = [x, y];
            var coordinate = map._olMap.getCoordinateFromPixel(pixel);
            var cursor = ol.proj.transform(coordinate, 'EPSG:3857', 'EPSG:4326');
            var dist = FAMap.Util.refSphere.haversineDistance(coord, cursor);
            dist = dist * 0.000539957;
            dist = Math.round(dist);
            var bearingRad = FAMap.Util.GreatCircle.bearing(coord, cursor);
            var bearingDeg = bearingRad * 180 / Math.PI;
            var bearing = Math.round(bearingDeg).toString();
            if (bearingDeg < 10) {
                bearing = "00" + bearing;
            } else if (bearingDeg < 100) {
                bearing = "0" + bearing;
            }
            $container.html(dist + " nm bearing " + bearing + "&deg;");
        }
    });
    this.getFlight = function() {
        if (!map.isAnimated()) {
            return false;
        }
        var flightNames = Object.keys(map._animationController.activeFlights);
        if (flightNames.length === 1) {
            var flightName = flightNames[0];
            var flight = map._animationController.activeFlights[flightName];
            return flight;
        }
    }
    ;
    this.hide = function() {
        $container.hide();
    }
    ;
    this.show = function() {
        $container.show();
    }
    ;
    ol.control.Control.call(this, {
        element: $container[0]
    });
}
;
ol.inherits(FAMap.olExtras.Control.DistanceBearing, ol.control.Control);
FAMap.olExtras.Control.Expand = function(FAMap) {
    var self = this;
    self.FAMap = FAMap;
    var $expandPanel = $('<a>').addClass('expandPanel').attr('href', '#');
    var $container = $('<div>').addClass('ol-expand-control').addClass('fa-zoom-light').append($expandPanel);
    $container.on('click', function() {
        var windowWidth = screen.width * 2 / 3;
        var windowHeight = screen.height * 2 / 3;
        var windowProperties = 'width=' + windowWidth + ',height=' + windowHeight + ',menubar=no,resizeable=yes,resizable=yes,scrollbars=no' + ',toolbar=no,location=no,status=no,titlebar=no';
        window.open(self.FAMap.options.fullsizeMapUrl, "FlightAwareFullScreenMap", windowProperties);
        return false;
    });
    this.hide = function() {
        $container.hide();
    }
    ;
    this.show = function() {
        $container.show();
    }
    ;
    ol.control.Control.call(this, {
        element: $container[0]
    });
}
;
ol.inherits(FAMap.olExtras.Control.Expand, ol.control.Control);
ol.control.Control.prototype.show = function() {
    $(this.element).show();
}
ol.control.Control.prototype.hide = function() {
    $(this.element).hide();
}
FAMap.olExtras.Control.LayerUI = function(FAMap, controlOptions) {
    var self = this;
    var options = $.extend({
        presentationStyle: "fa-layer-ui-light",
        disableChangeOverlay: false,
        toggleCollapseDirection: "right",
        toggleTrigger: "click"
    }, typeof (controlOptions) !== undefined && controlOptions ? controlOptions : {});
    var target = options.target !== "undefined" ? options.target : null;
    var classModifiers = "";
    if (target) {
        classModifiers = " fa-layer-ui-detached";
    }
    if (options.toggleCollapseDirection === "top") {
        classModifiers += " fa-layer-ui-slide-down";
    }
    self.options = options;
    var $container = $('<div>').addClass('ol-layer-ui' + classModifiers).addClass(options.presentationStyle);
    var element = $container[0];
    ol.control.Control.call(this, {
        element: $container[0],
        target: target
    });
    this.layers = {
        Base: [],
        Overlay: []
    };
    this.sampleTileCoords = {
        z: 9,
        x: 151,
        y: 192,
        my: 319
    };
    this.lazyLoadTriggered = false;
    this.FAMap = FAMap;
    this.overlayGroups = ['weather', 'premiumWeather', 'flights', 'misc'];
    this.defaultOverlayGroup = 'misc';
    this.overlayGroupMarkers = {};
    this._getSampleTileUrl = function(urlTemplate) {
        return urlTemplate.replace('{z}', this.sampleTileCoords.z).replace('{x}', this.sampleTileCoords.x).replace('{y}', this.sampleTileCoords.y).replace('{-y}', this.sampleTileCoords.my);
    }
    ;
    this._addBaseLayer = function(layer) {
        var self = this;
        var urls = [];
        if (layer instanceof ol.layer.Group) {
            layer.getLayers().forEach(function(l) {
                try {
                    urls.push(self._getSampleTileUrl(l.getSource()._url));
                } catch (e) {
                    throw ('Error: Layer ' + l.name + '\'s Source does not include a url spec');
                }
            });
        } else {
            try {
                urls.push(this._getSampleTileUrl(layer.getSource()._url));
            } catch (e) {
                throw ('Error: Layer ' + layer.name + '\'s Source does not include a url spec');
            }
        }
        var $li = $('<li>').html('<div class="title"><span>' + layer.name + '</span></div>').on('click', function() {
            var $li = $(this);
            var layer = $li.data('layer');
            $li.parent().siblings('a.changeOverlay').trigger('click');
            if ("_famap"in layer && layer._famap) {
                this._currentBaseLayer = layer.idx;
                layer._famap.setBaseLayer(layer.idx);
            } else {}
            self.dispatchEvent({
                "type": 'baseLayerClick',
                idx: layer.idx
            });
            return false;
        });
        $li.data('layer', layer).addClass('baseIdx' + layer.idx);
        urls.forEach(function(url) {
            var $img = $('<img>').attr('title', layer.name).data('src', url);
            $li.append($img);
        });
        this.$baseLayerList.append($li);
    }
    ;
    this.disableOverlay = function(layer) {
        layer._uiWasSelected = $(layer.UIElement).hasClass('selected');
        $(layer.UIElement).addClass('disabled');
        if (layer._uiWasSelected) {
            layer.setVisible(false);
        }
    }
    ;
    this.enableOverlay = function(layer) {
        $(layer.UIElement).removeClass('disabled');
        if (layer._uiWasSelected) {
            layer.setVisible(true);
        }
    }
    ;
    this._addOverlay = function(layer) {
        var self = this;
        var $li = $('<li>').html('<div class="layer-toggle"><span class="icon check"></span><span class="title" dir="ltr">' + layer.name + '</span></div>');
        $li.data('layer', layer);
        $('.layer-toggle', $li).on('click', function() {
            var $li = $(this).closest('li');
            if (!$li.hasClass('disabled')) {
                var layer = $li.data('layer');
                layer.setVisible(!(layer.getVisible()));
                self.dispatchEvent({
                    type: 'overlayLayerClick',
                    idx: layer.idx
                });
            }
            return true;
        });
        layer.UIElement = $li;
        var uiGroup = layer.uiGroup || this.defaultOverlayGroup;
        if (this.overlayGroups.indexOf(uiGroup) == -1) {
            throw ('Error: Unknown overlay UI group ' + uiGroup);
        }
        this.overlayGroupMarkers[uiGroup].before($li);
        if ('_uiDef'in layer && layer._uiDef !== null) {
            var $settingsLink = $('<a>').addClass('toggle expand').attr('href', '#').html('<span class="icon"></span>');
            $settingsLink.on('click', function() {
                var $el = $(this)
                  , $li = $($el).closest('li');
                $('div.options', $li).slideToggle();
                if ($el.hasClass('expand')) {
                    if (!$li.hasClass('selected')) {
                        $li.children('.layer-toggle').trigger('click');
                    }
                    $el.removeClass('expand').addClass('collapse');
                } else if ($el.hasClass('collapse')) {
                    $el.removeClass('collapse').addClass('expand');
                }
                return false;
            });
            $('.layer-toggle', $li).append($settingsLink);
            var $settingsForm = $('<form>')
            $.each(layer._uiDef.options, function() {
                var uiDef = this;
                var $container = $('<div>').addClass('uiContainer');
                switch (uiDef.type) {
                case 'checkbox':
                    var $checkbox = $('<input type="checkbox">').attr('name', uiDef.name);
                    $checkbox.prop('checked', uiDef.defaultVal);
                    $container.append($checkbox);
                    break;
                }
                if ('label'in uiDef) {
                    $container.append($('<label>').html(uiDef.label));
                }
                switch (uiDef.type) {
                case 'select':
                    var $select = $('<select>').attr('name', uiDef.name);
                    $.each(uiDef.values, function(k, v) {
                        var $option = $('<option>').attr('value', v);
                        if (typeof k == 'number') {
                            $option.html(v);
                        } else {
                            $option.html(k);
                        }
                        $select.append($option);
                    });
                    $select.val(uiDef.defaultVal);
                    $container.append($select);
                    break;
                case 'text':
                    var $errorMsg = $('<div>').addClass('validateError').html(uiDef.validateErrorText).hide();
                    var $textInput = $('<input>').attr({
                        type: 'text',
                        name: uiDef.name,
                        autocomplete: 'off'
                    }).on('input', function() {
                        var $el = $(this);
                        $el.removeClass('error');
                        $errorMsg.hide();
                        if ('validate'in uiDef && !uiDef.validate($el.val())) {
                            $el.addClass('error');
                            $errorMsg.show();
                        } else {
                            $el.trigger('change');
                        }
                    }).val(this.defaultVal);
                    $container.append($textInput);
                    $container.append($errorMsg);
                    break;
                case 'checkbox':
                    break;
                case 'button':
                    var $button = $('<button>').html(uiDef.text).on('click', function() {
                        uiDef.onClick.call(layer)
                    });
                    $container.append($button);
                    break;
                default:
                    throw ('Error: Unknown UI option type ' + uiDef.type);
                    break;
                }
                $settingsForm.append($container);
            });
            $settingsForm.on('change', 'input,select,checkbox', function(e) {
                layer._uiDef.onUiChange.call(layer, $settingsForm);
            });
            layer.on('change:uiUpdated', function(e) {
                layer._uiDef.onUiUpdateRequired.call(layer, $settingsForm);
            });
            var $settingsDiv = $('<div>').addClass('options').append($settingsForm);
            $li.append($settingsDiv);
            if (typeof (layer.get('uiUpdated')) !== "undefined") {
                layer._uiDef.onUiUpdateRequired.call(layer, $settingsForm);
            }
        }
    }
    ;
    this.removeOverlay = function(layer) {
        var removed = false;
        this.$overlayList.children('li').each(function(k, v) {
            var $li = $(v);
            if ($li.data('layer') == layer) {
                $li.remove();
                removed = true;
            }
        });
    }
    ;
    this.hide = function() {
        $container.hide();
    }
    ;
    this.show = function() {
        $container.show();
    }
    ;
    this.updateMenuVisibility = function(toggleCollapse) {
        var self = this;
        var animateTo = {};
        var collapseDirection = self.options.toggleCollapseDirection;
        var $el = this.$uiToggle;
        var isCollapsed = $el.hasClass("expand");
        if (collapseDirection === "top") {
            var ov = $(".overlays", self.$uiActual);
            self._slideDist = $(".baseLayers", self.$uiActual).filter(":visible").outerHeight() + $(".overlays", self.$uiActual).filter(":visible").outerHeight();
        } else if (collapseDirection === "right") {
            self._slideDist = self.$uiActual.outerWidth();
        }
        if (typeof (self._slideMargin) === "undefined" && $el.hasClass('expand')) {
            if (collapseDirection === "top") {
                self._slideMargin = parseInt(self.$uiActual.css('border-top-width')) + parseInt(self.$uiActual.css('border-bottom-width'));
            } else if (collapseDirection === "right") {
                self._slideMargin = self._slideDist + parseInt(self.$uiActual.css('right'));
            }
        }
        if ((isCollapsed && toggleCollapse) || (!isCollapsed && !toggleCollapse)) {
            if (collapseDirection === "right") {
                animateTo[collapseDirection] = "0px";
                self.$uiActual.animate(animateTo, 500, null).removeClass('collapsed');
                $el.animate({
                    right: self._slideDist + "px"
                }, 500, function() {
                    if (toggleCollapse) {
                        $(this).removeClass('expand').addClass('collapse');
                    }
                });
            } else if (collapseDirection === "top") {
                self.$uiActual.css("visibility", "visible");
                self._collapsedHeight = $container.outerHeight();
                $container.animate({
                    height: self._slideDist + self._slideMargin + "px"
                }, 100, function() {
                    self.$uiActual.removeClass('collapsed');
                    if (toggleCollapse) {
                        $el.removeClass('expand').addClass('collapse');
                    }
                });
            }
        } else if ((!isCollapsed && toggleCollapse) || (isCollapsed && !toggleCollapse)) {
            if (collapseDirection === "right") {
                animateTo[collapseDirection] = -(self._slideDist - self._slideMargin) + "px";
                self.$uiActual.animate(animateTo, 500, function() {
                    self.$uiActual.addClass('collapsed');
                });
                $el.animate({
                    right: self._slideMargin + "px"
                }, 500, function() {
                    if (toggleCollapse) {
                        $(this).removeClass('collapse').addClass('expand');
                    }
                });
            } else if (collapseDirection === "top") {
                $container.animate({
                    height: self._collapsedHeight + "px"
                }, 100, function() {
                    self.$uiActual.css("visibility", "hidden").addClass('collapsed');
                    if (toggleCollapse) {
                        $el.removeClass('collapse').addClass('expand');
                    }
                });
            }
        }
    }
    ;
    this.$uiToggle = $('<a>').addClass('uiToggle expand').attr('href', '#').on('click', (function($layerUI) {
        return function() {
            $layerUI.updateMenuVisibility(true);
            return false;
        }
        ;
    }
    )(this));
    $container.append(this.$uiToggle);
    this.$uiActual = $('<div>').addClass('ui collapsed');
    this.$uiActual.on('wheel', function(e) {
        e.originalEvent.noZoom = true;
    });
    this.$baseLayerSwitcher = $('<div>').addClass('baseLayers');
    this.$baseLayerSwitcher.append($('<div>').addClass('header').html('Base Layer'));
    this.$baseLayerList = $('<ul>').addClass('picker');
    this.$baseLayerSwitcher.append(this.$baseLayerList);
    self.debounceTimer = null;
    if (!this.options.disableChangeOverlay) {
        var changeOverlay = $('<a>').addClass('changeOverlay').attr('href', '#').html('<div>Click to change</div>').on('click', function() {
            var $el = $(this);
            var $ul = $el.siblings('ul');
            if ($el.is(':visible')) {
                $el.hide();
                $ul.children(':not(.selected)').slideDown(400, function() {
                    if (self.debounceTimer) {
                        clearTimeout(self.debounceTimer);
                    }
                    self.debounceTimer = setTimeout(self.update.bind(self), 10);
                });
            } else {
                $ul.children(':not(.selected)').slideUp(400, function() {
                    $el.show();
                    if (self.debounceTimer) {
                        clearTimeout(self.debounceTimer);
                    }
                    self.debounceTimer = setTimeout(self.update.bind(self), 10);
                });
            }
            return false;
        });
        this.$baseLayerSwitcher.append(changeOverlay);
    }
    this.$uiActual.append(this.$baseLayerSwitcher);
    this.$overlaySwitcher = $('<div>').addClass('overlays');
    this.$overlaySwitcher.append($('<div>').addClass('header').html('Overlays'));
    this.$overlayList = $('<ul>').addClass('picker');
    $.each(this.overlayGroups, function() {
        var $liMarker = $('<li>').addClass('groupMarker ' + this);
        self.$overlayList.append($liMarker);
        self.overlayGroupMarkers[this] = $liMarker;
    });
    this.$overlaySwitcher.append(this.$overlayList);
    this.$uiActual.append(this.$overlaySwitcher);
    var onLayerChangeVisible = (function(layerSwitcher) {
        return function(e) {
            layerSwitcher.updateDebounced();
        }
        ;
    }
    )(this);
    this.addFAMapLayer = function(layer) {
        layer.on("change:visible", onLayerChangeVisible);
        if ("isOverlay"in layer && layer.isOverlay) {
            if (!('excludeFromUi'in layer) || !layer.excludeFromUi) {
                this._addOverlay(layer);
            }
        } else {
            this._addBaseLayer(layer);
        }
        this.updateDebounced();
    }
    ;
    this.removeFAMapLayer = function(layer) {
        layer.un("change:visible", onLayerChangeVisible);
        if ("isOverlay"in layer && layer.isOverlay) {
            if (!('excludeFromUi'in layer) || !layer.excludeFromUi) {
                this.removeOverlay(layer);
            }
        } else {}
        this.updateDebounced();
    }
    ;
    this.setMap = function(olMap) {
        var currentMap = this.getMap();
        if (currentMap) {
            console.warn("Can't set LayerUI OLMap again.");
            return;
        }
        ol.control.Control.prototype.setMap.apply(this, arguments);
        layerCollection = olMap.getLayers();
        layerCollection.forEach(this.addFAMapLayer, this);
        layerCollection.on("add", (function(layerSwitcher) {
            return function(e) {
                layerSwitcher.addFAMapLayer(e.element);
            }
            ;
        }
        )(this));
        layerCollection.on("remove", (function(layerSwitcher) {
            return function(e) {
                layerSwitcher.removeFAMapLayer(e.element);
            }
            ;
        }
        )(this));
    }
    ;
    this.update = function() {
        var $liList = $("li", this.$baseLayerList);
        var len = $liList.length, layer;
        var $changeOverlay = $("a.changeOverlay", this.$baseLayerSwitcher)
          , changeOverlayDisplayed = $($changeOverlay).css("display") === "block";
        if (len) {
            this.$baseLayerSwitcher.show();
        } else {
            this.$baseLayerSwitcher.hide();
        }
        for (var i = 0; i < len; i++) {
            layer = $($liList[i]).data('layer');
            if (layer.getVisible() || !changeOverlayDisplayed) {
                $($liList[i]).show();
                if (layer.getVisible()) {
                    $($liList[i]).addClass('selected');
                    if (changeOverlayDisplayed) {
                        var title = $("div.title", $($liList[i]));
                        var header = $(".header", $(".baseLayers", self.$uiActual));
                        var newHeight = $($liList[i]).height() - $(title).outerHeight();
                        $changeOverlay.css("height", newHeight + "px").css("top", $(header).outerHeight() + $(title).outerHeight() + "px");
                        var divH = $("div", $changeOverlay).height();
                        $("div", $changeOverlay).css("padding", Math.floor((newHeight - divH) / 2) + "px 0");
                    }
                }
                $('img', $liList[i]).each(function() {
                    var $img = $(this);
                    if (typeof $img.attr('src') == 'undefined') {
                        $img.attr('src', $img.data('src'));
                    }
                });
            } else {
                $($liList[i]).removeClass('selected').hide();
            }
        }
        $liList = $("li", this.$overlayList).not(".groupMarker");
        var len = $liList.length;
        if (len) {
            this.$overlaySwitcher.show();
        } else {
            this.$overlaySwitcher.hide();
        }
        for (var i = 0; i < len; i++) {
            layer = $($liList[i]).data('layer');
            if (layer.getVisible()) {
                $($liList[i]).addClass('selected');
            } else {
                $($liList[i]).removeClass('selected');
            }
        }
        this.updateMenuVisibility(false);
    }
    ;
    this.updateDebounced = FA.Lib.Common.debounce(this.update.bind(this), 50);
    $container.append(this.$uiActual);
}
;
ol.inherits(FAMap.olExtras.Control.LayerUI, ol.control.Control);
(function(FA, $, ol) {
    var LiveLoop = function(options) {
        var i, overlay = null, loopButtons = "";
        var loopSkin = 'fa-loop-light';
        if (typeof (options.frameBuffer) !== "object") {
            console.warn("error: frameBuffer required for live-loop control.");
            return;
        }
        this._frameBuffer = options.frameBuffer;
        this._frameBuffer.on('live-update', (function(loopControl) {
            return function() {
                loopControl.updateUI(loopControl._frameBuffer.getLoopingState());
            }
            ;
        }
        )(this));
        this._frameBuffer.on('loop-next-frame', (function(loopControl) {
            return function() {
                loopControl.updateLiveLoopProgress();
            }
            ;
        }
        )(this));
        var controlId = typeof (options.containerId) !== "undefined" ? options.containerId : "timeSeriesLiveLoop"
          , requestedButtons = typeof (options.loopButtons) !== "undefined" && options.loopButtons.length ? options.loopButtons : ["ol-loop-back", "ol-loop-play", "ol-loop-progress", "ol-loop-forward"];
        for (i = 0; i < requestedButtons.length; i++) {
            loopButtons += "<button class=\"" + requestedButtons[i] + "\"></button>";
        }
        this.$liveLoop = $("#" + controlId);
        if (!this.$liveLoop.length) {
            $('body').append("<div id=\"" + controlId + "\" class=\"ol-loop-control\"><div class=\"tile-progress\"></div><div class=\"" + loopSkin + " ol-loop-panel\"><div class=\"ol-loop-icon ol-loop-weather\"><div class=\"tile-progress-annotation ol-loop-icon ol-loop-loading\"></div></div> " + loopButtons + "</div><div class=\"ol-loop-alert\"></div><div class=\"tile-progress-annotation\"></div></div>");
            this.$liveLoop = $("#" + controlId);
        }
        this._frameBuffer.on('preload-complete', function() {
            $('.ol-playback-weather', this.$liveLoop).css("visibility", "visible");
        });
        this._frameBuffer.on('preloading', function() {
            $('.ol-playback-weather', this.$liveLoop).css("visibility", "hidden");
        });
        ol.control.Control.call(this, {
            "element": this.$liveLoop[0]
        });
        try {
            if (!this.$liveLoop.length) {
                throw new FA.Modules.Error("DOM element: '" + controlId + "' not found");
            }
            if (!this.$liveLoop.hasClass("ol-loop-control")) {
                throw new FA.Modules.Error("expected class: ol-loop-control, not found");
            }
            for (i = 0; i < requestedButtons.length; i++) {
                $button = $("." + requestedButtons[i], this.$liveLoop);
                if ($button.length != 1) {
                    throw new FA.Modules.Error("expected element with class:" + requestedButtons[i]);
                }
                $button.on('click', this.onClick.bind(this));
            }
            this.$liveLoopProgress = $('.ol-loop-progress', this.$liveLoop);
        } catch (e) {
            console.error("LiveLoop: " + e.message);
            console.error("LiveLoop: control not created.");
            return null;
        }
    };
    ol.inherits(LiveLoop, ol.control.Control);
    LiveLoop.prototype.alertText = function(text) {
        return ($('.ol-loop-alert', this.$liveLoop).html(text));
    }
    LiveLoop.prototype.onClick = function(jqueryEvent) {
        if ($(jqueryEvent.target).hasClass("ol-loop-inactive")) {
            return;
        }
        var classList = $(jqueryEvent.target).attr("class").split(/\s+/);
        for (var i = 0; i < classList.length; i++) {
            if (classList[i] !== "fa") {
                switch (classList[i]) {
                case "ol-loop-play":
                    this._frameBuffer.loop();
                    break;
                case "ol-loop-pause":
                    this._frameBuffer.pause();
                    break;
                case "ol-loop-back":
                    if (this._frameBuffer._frameOffset < this._frameBuffer._maxOffset) {
                        this._frameBuffer.incrementFrame(-1);
                    }
                    break;
                case "ol-loop-forward":
                    if (this._frameBuffer._frameOffset > 0) {
                        this._frameBuffer.incrementFrame(1);
                    }
                    break;
                case "ol-loop-rewind":
                    this._frameBuffer.offsetFrame(this._frameBuffer._maxOffset);
                    break;
                case "ol-loop-end":
                    this._frameBuffer.offsetFrame(0);
                    break;
                }
            }
        }
        this.updateUI(this._frameBuffer.getLoopingState());
    }
    LiveLoop.prototype.show = function() {
        if (this._frameBuffer._maxOffset == 0) {
            return;
        }
        for (var i = 0; i < this._frameBuffer._timeSeriesLayers.length; i++) {
            if (this._frameBuffer._timeSeriesLayers[i].getVisible()) {
                this.$liveLoop.show();
                return;
            }
        }
    }
    ;
    LiveLoop.prototype.hide = function() {
        this.$liveLoop.hide();
    }
    ;
    LiveLoop.prototype.updateUI = function(state) {
        if (this._frameBuffer._timeSeriesLayers.length == 0) {
            return;
        }
        if (state === "looping") {
            $(".ol-loop-play", this.$liveLoop).removeClass("ol-loop-play").addClass("ol-loop-pause");
            $(".ol-loop-rewind", this.$liveLoop).addClass("ol-loop-inactive");
            $(".ol-loop-end", this.$liveLoop).addClass("ol-loop-inactive");
            $(".ol-loop-forward", this.$liveLoop).addClass("ol-loop-inactive");
            $(".ol-loop-back", this.$liveLoop).addClass("ol-loop-inactive");
        } else {
            $(".ol-loop-pause", this.$liveLoop).removeClass("ol-loop-pause").addClass("ol-loop-play");
            $(".ol-loop-rewind", this.$liveLoop).removeClass("ol-loop-inactive");
            $(".ol-loop-end", this.$liveLoop).removeClass("ol-loop-inactive");
            $(".ol-loop-forward", this.$liveLoop).removeClass("ol-loop-inactive");
            $(".ol-loop-back", this.$liveLoop).removeClass("ol-loop-inactive");
            if (this._frameBuffer._frameOffset == 0) {
                $(".ol-loop-forward", this.$liveLoop).addClass("ol-loop-inactive");
                $(".ol-loop-end", this.$liveLoop).addClass("ol-loop-inactive");
            } else if (this._frameBuffer._frameOffset == this._frameBuffer._maxOffset) {
                $(".ol-loop-back", this.$liveLoop).addClass("ol-loop-inactive");
                $(".ol-loop-rewind", this.$liveLoop).addClass("ol-loop-inactive");
            }
        }
        this.updateLiveLoopProgress();
    }
    LiveLoop.prototype.updateLiveLoopProgress = function() {
        var percent = 100 - ((this._frameBuffer._frameOffset / this._frameBuffer._maxOffset) * 100);
        var startTime = ""
          , endTime = "";
        if (this.$liveLoopProgress.length) {
            if (this._frameBuffer._timeSeriesLayers.length) {
                endTime = FADate.displayWeatherTime(moment.unix(this._frameBuffer._timeSeriesLayers[0].getClock(0)), "%l:%M%p");
                startTime = FADate.displayWeatherTime(moment.unix(this._frameBuffer._timeSeriesLayers[0].getClock(this._frameBuffer._maxOffset)), "%l:%M%p");
            }
            if (this.$liveLoopProgress.html() === "") {
                this.$liveLoopProgress.html("<div class=\"ol-progress-indicator-background\" > <div class=\"ol-progress-indicator-foreground\" style=\"height:100%;\"></div></div><table><tr><td>" + startTime + "</td><td>" + endTime + "</td></tr></table>");
            }
            $(".ol-progress-indicator-foreground", this.$liveLoopProgress).css('width', percent + "%");
            $("table td:nth-of-type(1)", this.$liveLoopProgress).html(startTime);
            $("table td:nth-of-type(2)", this.$liveLoopProgress).html(endTime);
        }
    }
    FAMap.olExtras.Control.LiveLoop = LiveLoop;
}
)(FA, $, ol);
FAMap.olExtras.Control.ScaleLine = function() {
    this.scaleLines = [new ol.control.ScaleLine({
        units: 'metric',
        className: 'ol-scale-line-metric'
    }), new ol.control.ScaleLine({
        units: 'us',
        className: 'ol-scale-line-statute'
    })];
}
;
ol.inherits(FAMap.olExtras.Control.ScaleLine, ol.control.Control);
FAMap.olExtras.Control.ScaleLine.prototype.setMap = function(map) {
    var args = arguments;
    this.scaleLines.forEach(function(control) {
        control.setMap.apply(control, args);
    });
}
;
FAMap.olExtras.Control.ZoomTo = function(FAMap) {
    var self = this;
    this.FAMap = FAMap;
    var _panPixelDelta = 128;
    var _panDuration = 100;
    var _zoomDuration = 100;
    var $zoomPanel = $('<div>').addClass('zoomPanel');
    $.each(['in', 'out'], function() {
        var dir = String(this);
        var $link = $('<a>').addClass(dir).attr({
            'href': "#",
            'title': 'zoom ' + dir
        }).data('zoomDirection', dir).on('click', function() {
            var map = self.getMap();
            var view = map.getView();
            switch ($(this).data('zoomDirection')) {
            case 'in':
                var zoomDelta = 1;
                break;
            case 'out':
                var zoomDelta = -1;
                break;
            default:
                return false;
                break;
            }
            var zoom = view.getZoom();
            view.animate({
                zoom: zoom + zoomDelta,
                duration: _zoomDuration,
                easing: ol.easing.linear
            }, function(animationCompleted) {
                if (animationCompleted) {
                    FAMap.trigger("interaction.zoom");
                }
            });
            return false;
        });
        $zoomPanel.append($link);
    });
    var $autoLink = $('<a>').addClass('auto').attr({
        'href': "#",
        'title': 'zoom to fit map contents'
    }).on('click', function() {
        var viewState = self.FAMap._configHandler.get('defaultViewState');
        if ('value'in viewState) {
            viewState = viewState.value;
        } else {
            return false;
        }
        if ('_animationController'in self.FAMap && 'activeFlights'in self.FAMap._animationController) {
            var flights = self.FAMap._animationController.activeFlights;
            var boundingExtent = viewState.extent;
            $.each(flights, function(k, v) {
                if (v.extent) {
                    ol.extent.extend(boundingExtent, v.extent);
                }
            });
            viewState.extent = boundingExtent;
        }
        self.FAMap.setViewState(viewState, function(animationCompleted) {
            if (animationCompleted) {
                FAMap.trigger("interaction.zoom");
                FAMap.trigger("interaction.pan");
            }
        });
        return false;
    });
    $zoomPanel.append($autoLink);
    var $container = $('<div>').addClass('ol-panzoom-control').addClass('fa-zoom-light').append($zoomPanel);
    this.hide = function() {
        $container.hide();
    }
    ;
    this.show = function() {
        $container.show();
    }
    ;
    ol.control.Control.call(this, {
        element: $container[0]
    });
}
;
ol.inherits(FAMap.olExtras.Control.ZoomTo, ol.control.Control);
FAMap.olExtras.Interaction = {};
FAMap.olExtras.Interaction.FeatureMouseEvents = function(FAMap) {
    this.FAMap = FAMap;
    this._hoveredFeatures = [];
    this._hoveredFeatureLayers = [];
    this.handleEvent = function(e) {
        if (ol.events.condition.pointerMove(e)) {
            if (!this._handleMouseMove(e)) {
                return false;
            }
        }
        if (ol.events.condition.click(e)) {
            if (!this._handleClick(e)) {
                return false;
            }
        }
        return true;
    }
    ;
    this._handleMouseMove = function(e) {
        e.FAMap = this.FAMap;
        var map = e.map;
        var newHoveredFeatures = [];
        var newHoveredFeatureLayers = [];
        map.forEachFeatureAtPixel(e.pixel, (function(feature, layer) {
            if ('eventHandlers'in layer && 'mouseMove'in layer.eventHandlers) {
                layer.eventHandlers.mouseMove.call(layer, e, feature);
            }
            var idx = this._hoveredFeatures.indexOf(feature);
            if (idx == -1) {
                if ('eventHandlers'in layer && 'mouseIn'in layer.eventHandlers) {
                    layer.eventHandlers.mouseIn.call(layer, e, feature);
                }
            } else {
                this._hoveredFeatures.splice(idx, 1);
                this._hoveredFeatureLayers.splice(idx, 1);
            }
            newHoveredFeatures.push(feature);
            newHoveredFeatureLayers.push(layer);
        }
        ).bind(this), this);
        $.each(this._hoveredFeatures, $.proxy(function(k, feature) {
            var layer = this._hoveredFeatureLayers[k];
            if ('eventHandlers'in layer && 'mouseOut'in layer.eventHandlers) {
                layer.eventHandlers.mouseOut.call(layer, e, feature);
            }
        }, this));
        this._hoveredFeatures = newHoveredFeatures;
        this._hoveredFeatureLayers = newHoveredFeatureLayers;
        return true;
    }
    ;
    this._handleClick = function(e) {
        e.FAMap = this.FAMap;
        var map = e.map;
        map.forEachFeatureAtPixel(e.pixel, function(feature, layer) {
            if ('eventHandlers'in layer && 'click'in layer.eventHandlers) {
                layer.eventHandlers.click.call(layer, e, feature);
            }
        }, this);
        return true;
    }
    ;
    ol.interaction.Interaction.call(this, {
        handleEvent: this.handleEvent
    });
}
;
ol.inherits(FAMap.olExtras.Interaction.FeatureMouseEvents, ol.interaction.Interaction);
FAMap.olExtras.Layer = {};
FAMap.olExtras.Layer.Dedupe = function(options) {
    this.childLayers = options.childLayers;
    this._source = new FAMap.olExtras.Source.Dedupe(options.childLayers.slice());
    this.addChildLayer = function(layer) {
        var insertPoint = this.childLayers.indexOf(layer.idx);
        if (insertPoint > -1) {
            this.childLayers[insertPoint] = layer;
            this._source.addSource(layer.idx, layer.getSource(), layer.getVisible());
            this._setChildVisible(layer.idx, layer.getVisible());
            layer.on('change:visible', $.proxy(function() {
                this._source.setActive(layer.idx, layer.getVisible());
                this._setChildVisible(layer.idx, layer.getVisible());
            }, this));
            layer.setStyle(null);
            layer.setStyle = function() {}
            layer.getSource().on('addfeature', function(e) {
                e.feature.dedupeLayer = layer;
            });
            $.each(layer.getSource().getFeatures(), function(k, feature) {
                feature.dedupeLayer = layer;
            });
        }
    }
    ;
    this._setChildVisible = function(idx, visible) {
        var vis = this.get('visibleChildren');
        if (vis === undefined) {
            vis = [];
        }
        var splicePoint = vis.indexOf(idx);
        if (visible) {
            if (splicePoint > -1) {
                vis.splice(splicePoint, 1);
            }
        } else {
            if (splicePoint == -1) {
                vis.push(idx);
            }
        }
        this.set('visibleChildren', vis);
    }
    ;
    options.source = this._source;
    ol.layer.Vector.call(this, options);
    var skipped = false;
    if ('childLayers'in options) {
        $.each(options.childLayers, $.proxy(function(k, idx) {
            var insertPoint = this.childLayers.indexOf(idx);
            if (idx in options.FAMap._overlays) {
                this.addChildLayer(options.FAMap._overlays[idx]);
            } else {
                skipped = true;
            }
        }, this));
    } else {
        throw ('Error: Dedupe layer must have childLayers passed with options!');
    }
    if (skipped) {
        options.FAMap.on('overlayAdded', $.proxy(function(e, layer) {
            this.addChildLayer(layer);
        }, this));
    }
    this.setVisible(true);
    this.eventHandlers = {
        refire: function(type, e, feature, _this) {
            if ('dedupeLayer'in feature) {
                var layer = feature.dedupeLayer;
                if (type in layer.eventHandlers) {
                    e.dedupeLayer = _this;
                    layer.eventHandlers[type].call(layer, e, feature);
                }
            }
        },
        mouseIn: function(e, feature) {
            this.eventHandlers.refire('mouseIn', e, feature, this);
        },
        mouseOut: function(e, feature) {
            this.eventHandlers.refire('mouseOut', e, feature, this);
        },
        click: function(e, feature) {
            this.eventHandlers.refire('click', e, feature, this);
        }
    };
}
;
ol.inherits(FAMap.olExtras.Layer.Dedupe, ol.layer.Vector);
FAMap.olExtras.Layer.MultiSource = {};
var classNames = ['Image', 'Tile', 'Vector'];
$.each(classNames, function() {
    var className = this;
    FAMap.olExtras.Layer.MultiSource[className] = function(options) {
        this.FAMap = options.FAMap;
        this._sources = options.sources;
        ol.layer[className].call(this, options);
        if ('defaultSourceKey'in options) {
            this.setSourceByKey(options.defaultSourceKey);
        }
    }
    ;
    ol.inherits(FAMap.olExtras.Layer.MultiSource[className], ol.layer[className]);
    FAMap.olExtras.Layer.MultiSource[className].prototype.getSourceByKey = function(sourceKey) {
        if (!(sourceKey in this._sources)) {
            throw ('Error: Unknown source ' + sourceKey);
        }
        if (Object.getPrototypeOf(this._sources[sourceKey]) === Object.prototype) {
            var sourceDef = this._sources[sourceKey];
            var sourceOpts = sourceDef.sourceOpts;
            sourceOpts.FAMap = this.FAMap;
            this._sources[sourceKey] = new sourceDef.sourceClass(sourceOpts);
            this._sources[sourceKey].key = sourceKey;
        }
        return this._sources[sourceKey];
    }
    ;
    FAMap.olExtras.Layer.MultiSource[className].prototype.setSourceByKey = function(sourceKey, notify) {
        this.setSource(this.getSourceByKey(sourceKey));
        this.set('uiUpdated', new Date().getTime());
        if (typeof notify !== 'undefined' && notify) {
            this.FAMap.trigger('interaction.layerSourceChanged', [this.idx, sourceKey]);
        }
    }
    ;
});
(function(FAMap) {
    var parentClass = FAMap.olExtras.Layer.MultiSource.Tile;
    var TimeSeries = function(options) {
        var sourceClass = typeof (options.sourceClass) !== "undefined" ? options.sourceClass : null;
        var sourceOpts = typeof (options.sourceOpts) !== "undefined" ? options.sourceOpts : null;
        if (!sourceClass || !sourceOpts) {
            throw ("TimeSeries: sourceClass and sourceOpts must be supplied");
        }
        this.FAMap = options.FAMap;
        this.analytics = typeof (options.analytics) !== "undefined" ? options.analytics : null;
        var now = FAMap.Util.getNow();
        this._preloadInProgress = 0;
        this._enqueuedCnt = 0;
        this._roundClock = function(clock) {
            return clock - (clock % this._framePeriod);
        }
        this._frameOffset = function(i) {
            var offset = this._newestFrame - i;
            if (offset < 0) {
                offset = this._nFrames + offset;
            }
            return (offset);
        }
        this._normalizeFrameIndex = function(i) {
            if (i >= this._nFrames) {
                i = i % this._nFrames;
            }
            if (i < 0) {
                i = this._nFrames + (i % this._nFrames);
            }
            return i;
        }
        ;
        this._getSourceKeyFromOffset = function(offset) {
            var numOffset = Number(offset);
            if (numOffset >= this._nFrames) {
                numOffset = this._nFrames - 1;
            }
            return (this._normalizeFrameIndex(this._newestFrame - numOffset));
        }
        ;
        if (FAMap.Globals.ANIMATED_WEATHER_ENABLED === "disabled") {
            this.nFrames(1);
        } else {
            this.nFrames(typeof (options.timeSeriesNFrames) !== "undefined" ? options.timeSeriesNFrames : 1);
        }
        this._framePeriod = typeof (options.framePeriod) !== "undefined" ? options.framePeriod : 300;
        this._stopAt = this._roundClock(typeof (options.timeSeriesStopAt) !== "undefined" ? options.timeSeriesStopAt : now);
        this._incrementTimeout = null;
        var frameClock = this._stopAt;
        var cloneOpts;
        var isSingleFlight = this.FAMap._animationController && this.FAMap._animationController._options.singleFlight;
        options.defaultSourceKey = "0";
        options.sources = {};
        for (f = this._newestFrame; f >= 0; f--) {
            cloneOpts = $.extend(true, {}, sourceOpts);
            cloneOpts.params.CLOCK = frameClock;
            options.sources[f.toString()] = {
                "sourceClass": sourceClass,
                "sourceOpts": cloneOpts
            };
            frameClock -= this._framePeriod;
        }
        parentClass.call(this, options);
        this.set('faType', 'WxTimeSeries');
        this.reportTilesToLoad = function(event) {
            if (this.getVisible() === true) {
                willLoadCount = this.computeTilesPerFrame(event);
                if (this.analytics && willLoadCount) {
                    this.analytics.logEvent("loading tiles", "layer visible", willLoadCount);
                }
            }
        }
        ;
        this.computeTilesPerFrame = function(event) {
            var view = this.FAMap._olMap.getView()
              , extent = view.calculateExtent(this.FAMap._olMap.getSize())
              , zResolution = view.getResolution()
              , z = view.getZoom()
              , projection = view.getProjection();
            var source = this.getSource();
            var tileGrid = source.getTileGrid();
            var tileRange = tileGrid.getTileRangeForExtentAndResolution(extent, zResolution);
            var tileZ = tileGrid.getZForResolution(zResolution);
            var tileValues = tileRange.getValues();
            var yDim = tileValues[2] - tileValues[0] + 1;
            var xDim = tileValues[3] - tileValues[1] + 1;
            var nTiles = xDim * yDim;
            if (typeof (event) !== "undefined") {
                var projection = view.getProjection()
                  , IDLE = 0
                  , LOADED = 2
                  , ERROR = 3
                  , pixelRatio = 1;
                for (var y = tileValues[0]; y <= tileValues[2]; y++) {
                    for (var x = tileValues[1]; x <= tileValues[3]; x++) {
                        var tile = source.getTile(tileZ, x, y, pixelRatio, projection)
                          , state = tile.getState();
                        if (state === LOADED) {
                            nTiles--;
                        }
                    }
                }
            }
            return nTiles;
        }
        ;
        this.on('change:visible', this.reportTilesToLoad.bind(this));
        this.on('change:source', this.reportTilesToLoad.bind(this));
        this._visibleFrame = this._newestFrame;
        if (this.FAMap._animationController && this.FAMap._animationController._options.singleFlight) {
            this.resetClock = (function(tSeries) {
                return function(overrideCLOCK) {
                    var source = tSeries.getSourceByKey(tSeries._newestFrame.toString());
                    if (typeof (overrideCLOCK) !== "undefined") {
                        if (overrideCLOCK === "now") {
                            overrideCLOCK = FAMap.Util.getNow();
                        }
                        var frameClock = overrideCLOCK;
                        this._loaded = false;
                        this._newestFrame = this._nFrames - 1;
                        for (f = this._newestFrame; f >= 0; f--) {
                            if (typeof (this._sources[f]) === "undefined") {
                                cloneOpts = $.extend(true, {}, sourceOpts);
                                cloneOpts.params.CLOCK = frameClock;
                                options.sources[f.toString()] = {
                                    "sourceClass": sourceClass,
                                    "sourceOpts": cloneOpts
                                };
                            }
                            source = tSeries.getSourceByKey(f.toString());
                            source.updateClock(frameClock);
                            frameClock -= this._framePeriod;
                        }
                        this._stopAt = this.getClock(0);
                    } else {
                        if (source !== null) {
                            source.updateClock(tSeries._deferredCLOCK);
                        }
                    }
                    if (typeof (this.FAMap._timeSeriesLiveLoop) !== "undefined") {
                        this.FAMap._timeSeriesLiveLoop.updateLiveLoopProgress();
                    }
                }
                ;
            }
            )(this);
        }
        this.setSourceByKey(this._visibleFrame.toString());
        this.endTimeSeriesAt = function(stopClock, showMostRecent) {
            var nextIncrement;
            var now;
            if (typeof (stopClock) === "undefined" || !stopClock) {
                stopClock = FAMap.Util.getNow();
            }
            stopClock = this._roundClock(stopClock);
            while ((stopClock - this._stopAt) >= this._framePeriod) {
                this._newestFrame++;
                if (this._newestFrame >= this._nFrames) {
                    this._newestFrame = 0;
                }
                this._stopAt += this._framePeriod;
                source = this.getSourceByKey(this._newestFrame.toString());
                source.updateClock(this._stopAt);
                this.preloadFrames(this._newestFrame);
            }
            if (showMostRecent) {
                this._visibleFrame = this._newestFrame;
                console.warn("setting recent" + this._visibleFrame);
                this.setSourceByKey(this._visibleFrame.toString());
            }
        }
        ;
        this.step = function(n) {
            if (0) {
                return;
            }
            this._visibleFrame = this._normalizeFrameIndex(this._visibleFrame + Number(n));
            this.setSourceByKey(this._visibleFrame.toString());
            return (this._frameOffset(this._visibleFrame));
        }
        ;
        this.skip = function(offset) {
            this._visibleFrame = this._getSourceKeyFromOffset(offset);
            this.setSourceByKey(this._visibleFrame.toString());
            return (this._frameOffset(this._visibleFrame));
        }
        ;
    }
    ol.inherits(TimeSeries, parentClass);
    TimeSeries.prototype.framePeriod = function(p) {
        this._framePeriod = p;
        return (this._framePeriod);
    }
    ;
    TimeSeries.prototype.nFrames = function(n) {
        if (typeof (n) !== "undefined") {
            this._nFrames = n;
            this._newestFrame = this._nFrames - 1;
        }
        return (this._nFrames);
    }
    ;
    TimeSeries.prototype.preloadFrames = function(offset) {
        if (typeof (this._loaded) === "undefined") {
            this._loaded = false;
        }
        var sourceIndex = this._getSourceKeyFromOffset(offset);
        var view = this.FAMap._olMap.getView()
          , extent = view.calculateExtent(this.FAMap._olMap.getSize())
          , zResolution = view.getResolution()
          , projection = view.getProjection()
          , IDLE = 0
          , LOADED = 2
          , ERROR = 3
          , timeSeries = this
          , loaded = true
          , frameState = this.FAMap._olMap.getFrameState();
        if (typeof (frameState) !== "undefined" && frameState) {
            var getUid = this.FAMap._olMap.uid.bind(this.FAMap._olMap)
              , pixelRatio = frameState.pixelRatio;
            var tileQueue = frameState.tileQueue;
            var nTiles = 0;
            $.each(this._sources, (function(tsLayer) {
                return function(key, value) {
                    if (Number(key) !== sourceIndex) {
                        return;
                    }
                    var source = timeSeries.getSourceByKey(key);
                    tileSourceKey = getUid(source).toString();
                    if (!(tileSourceKey in frameState.wantedTiles)) {
                        frameState.wantedTiles[tileSourceKey] = {};
                    }
                    var wantedTiles = frameState.wantedTiles[tileSourceKey];
                    if (typeof (source.getTileGrid) === "function") {
                        var tileGrid = source.getTileGrid();
                        var tileRange = tileGrid.getTileRangeForExtentAndResolution(extent, zResolution);
                        var tileZ = tileGrid.getZForResolution(zResolution);
                        var tileValues = tileRange.getValues();
                        for (var y = tileValues[0]; y <= tileValues[2]; y++) {
                            for (var x = tileValues[1]; x <= tileValues[3]; x++) {
                                var tile = source.getTile(tileZ, x, y, pixelRatio, projection)
                                  , state = tile.getState();
                                if (state === IDLE) {
                                    wantedTiles[tile.getKey()] = true;
                                    if (!tileQueue.isKeyQueued(tile.getKey())) {
                                        nTiles++;
                                        if (!tsLayer._preloadInProgress) {
                                            tsLayer._preloadInProgress = (new Date()).getTime();
                                        }
                                        tsLayer._enqueuedCnt++
                                        tileQueue.enqueue([tile, tileSourceKey, tileGrid.getTileCoordCenter(tile.getTileCoord()), zResolution]);
                                    }
                                }
                                state = tile.getState();
                                timeSeries._loaded = ((state === LOADED || state === ERROR) && loaded);
                                loaded = timeSeries._loaded;
                            }
                        }
                    }
                }
                ;
            }
            )(this));
        } else {
            console.warn("BAD frameState");
        }
        if (nTiles) {
            tileQueue.loadMoreTiles(16, nTiles);
        }
        if (this._loaded && this._enqueuedCnt > 0) {
            var timeToLoad = (new Date()).getTime() - this._preloadInProgress;
            this._preloadInProgress = 0;
            if (this.analytics && this._enqueuedCnt > 0) {
                this.analytics.logEvent("loading tiles", "animation preload", this._enqueuedCnt);
            }
            this._enqueuedCnt = 0;
        }
        return (this._loaded);
    }
    TimeSeries.prototype.getSourceByKey = function(sourceKey) {
        if (typeof (this._sources[sourceKey]) === "undefined") {
            return null;
        }
        var unregistered = Object.getPrototypeOf(this._sources[sourceKey]) === Object.prototype;
        var source = parentClass.prototype.getSourceByKey.apply(this, arguments);
        if (typeof (this.FAMap._tileLoader) !== "undefined" && unregistered) {
            this.FAMap._tileLoader.registerTileSource(source);
        }
        return source;
    }
    TimeSeries.prototype.getClock = function(offset) {
        var sourceIndex = this._getSourceKeyFromOffset(offset);
        var source = this.getSourceByKey(sourceIndex);
        if (source) {
            var params = this.getSourceByKey(sourceIndex).getParams();
            ;return (params.CLOCK);
        } else {
            return null;
        }
    }
    FAMap.olExtras.Layer.TimeSeries = TimeSeries;
}
)(FAMap);
(function(FAMap) {
    var ToggledVector = function(options) {
        this._toggleFieldName = typeof (options.toggleFieldName) != "undefined" ? options.toggleFieldName : "type";
        if (typeof (options.showing) != "undefined") {
            this._showing = options.showing;
        }
        ol.layer.Vector.call(this, options);
    };
    ol.inherits(ToggledVector, ol.layer.Vector);
    ToggledVector.prototype.getShowing = function() {
        return typeof (this._showing) !== "undefined" ? this._showing : null;
    }
    ;
    ToggledVector.prototype.updateShowing = function(showing, persist) {
        var source = this.getSource(), features = source ? source.getFeatures() : [], fieldVal, styleHide = FAMap.Styles.Feature._util.universalStyleFunction(function(feature) {
            return null;
        });
        this._showing = typeof (showing) !== "undefined" && showing ? showing : this._showing;
        for (var i = 0; i < features.length; i++) {
            fieldVal = features[i].get(this._toggleFieldName);
            fieldVal = fieldVal.replace(" ", "_");
            if (typeof (this._showing) !== "undefined" && !this._showing[fieldVal]) {
                features[i].setStyle(styleHide);
            } else {
                features[i].setStyle(null);
            }
        }
        if (typeof (persist) !== "undefined" && persist && typeof (this.persistShowing) === "function") {
            this.persistShowing.call();
        }
    }
    ;
    FAMap.olExtras.Layer.ToggledVector = ToggledVector;
}
)(FAMap);
FAMap.olExtras.Overlay = {};
FAMap.olExtras.Overlay.DelayPopup = function(position, options) {
    this.createTab = function(options) {
        var requiredOpts = ['code', 'info', 'name', 'weather'];
        requiredOpts.forEach(function(opt) {
            if (!(opt in options)) {
                throw ('Error: No "' + opt + '" passed to DelayPopup Overlay!');
            }
        });
        var $table = $('<table>').addClass('tab-content').data('code', options.code);
        var html = '' + '<tr><th>' + options.name + '</th></tr>' + '<tr><td>' + options.info + '</td></tr>' + '<tr><td>' + options.weather + '</td></tr>' + '<tr><td class="delays-center">' + '<a class="delays-link delays-close-button" href="#">Close</a>&nbsp;&nbsp;' + '<a class="delays-link" href="/live/airport/' + options.code + '" target="_blank">More Info</a>' + '</td></tr>';
        $table.html(html);
        var $control = $('<a>').addClass('tab-control').attr('href', '#').data('content', $table).html(options.code).on('click', function() {
            var $el = $(this);
            $el.siblings('.tab-control.active').removeClass('active');
            $el.addClass('active');
            $el.siblings('.tab-content:visible').hide();
            $el.data('content').show();
            return false;
        });
        return {
            control: $control,
            content: $table
        };
    }
    ;
    var $container = $('<div>').addClass('delays-popup');
    if (options.length == 1) {
        var $content = this.createTab(options[0]).content.removeClass('tab-content');
        $container.append($content);
    } else {
        var $controls = [];
        var $contents = [];
        var $defaultControl = null;
        options.forEach($.proxy(function(opt) {
            var tab = this.createTab(opt);
            $controls.push(tab.control);
            $contents.push(tab.content);
            if ('selected'in opt && opt.selected) {
                $defaultControl = tab.control;
            }
        }, this));
        $controls.forEach(function($control) {
            $container.append($control);
        });
        $contents.forEach(function($content) {
            $container.append($content);
        });
        if ($defaultControl === null) {
            $defaultControl = $controls[0];
        }
        $defaultControl.trigger('click');
    }
    return new ol.Overlay({
        element: $container[0],
        offset: [5, -5],
        position: position,
        positioning: 'bottom-left',
        autoPan: true,
        autoPanAnimation: {
            duration: 250
        }
    });
}
;
FAMap.olExtras.Source = {};
FAMap.olExtras.Source.ADLastPositions = function(options) {
    this.FAMap = options.FAMap;
    this.dedupeFeatureCandidates = {};
    this.dedupedFeatures = {};
    this.modFeatureCandidates = {};
    this.airborneIdents = [];
    ol.source.Vector.call(this, {
        loader: function() {
            var format = new ol.format.GeoJSON();
            var url = 'https://ko.flightaware.com/ajax/arinc_lastpos.rvt';
            var source = this;
            $.getJSON(url, '', function(resp) {
                if (Object.keys(resp).length > 0) {
                    var features = format.readFeatures(resp, {
                        dataProjection: 'EPSG:4326',
                        featureProjection: 'EPSG:3857'
                    });
                    source.addFeatures(features);
                }
                source.set('loaded', true);
            });
        }
    });
    this.on('change:loaded', function() {
        this.FAMap.trigger('arinc_lastpos:featuresLoaded', [this.getFeatures()]);
    });
    this.on('addfeature', function(e) {
        var idents = e.feature.get('idents');
        if (e.feature.get('airportIdent')) {
            $.each(idents, $.proxy(function(k, ident) {
                this.modFeatureCandidates[ident] = e.feature
                if (this.airborneIdents.indexOf(ident) > -1) {
                    var cachedIdents = e.feature.get('cachedIdents') || [];
                    cachedIdents.push(ident);
                    e.feature.set('cachedIdents', cachedIdents);
                    var trimmedIdents = idents.slice();
                    trimmedIdents.splice(k, 1);
                    e.feature.set('idents', trimmedIdents);
                }
            }, this));
        } else {
            var ident = idents[0];
            if (this.airborneIdents.indexOf(ident) == -1) {
                this.dedupeFeatureCandidates[ident] = e.feature;
            } else {
                this.removeFeature(e.feature);
                this.dedupedFeatures[ident] = e.feature;
            }
        }
    });
    this.FAMap.on('animationFlight.stateChange', $.proxy(function(e, flight, state) {
        var ident = flight.fullFlightData.ident
        var identIndex = this.airborneIdents.indexOf(ident);
        if (state == 'airborne') {
            if (identIndex == -1) {
                this.airborneIdents.push(ident);
            }
            if (ident in this.dedupeFeatureCandidates) {
                var feature = this.dedupeFeatureCandidates[ident];
                this.removeFeature(feature);
                this.dedupedFeatures[ident] = feature;
                delete this.dedupeFeatureCandidates[ident];
            }
            if (ident in this.modFeatureCandidates) {
                var feature = this.modFeatureCandidates[ident];
                var idents = feature.get('idents')
                var idx = idents.indexOf(ident);
                var cachedIdents = feature.get('cachedIdents') || [];
                cachedIdents.push(ident);
                feature.set('cachedIdents', cachedIdents);
                idents.splice(idx, 1);
                feature.set('idents', idents);
            }
        } else if (state !== 'airborne') {
            if (identIndex > -1) {
                this.airborneIdents.splice(identIndex, 1);
            }
            if (ident in this.dedupedFeatures) {
                var feature = this.dedupedFeatures[ident];
                this.addFeature(feature);
                this.dedupeFeatureCandidates[ident] = feature;
                delete this.dedupedFeatures[ident];
            }
            if (ident in this.modFeatureCandidates) {
                var feature = this.modFeatureCandidates[ident];
                var idents = feature.get('idents')
                var cachedIdents = feature.get('cachedIdents') || [];
                var idx = cachedIdents.indexOf(ident);
                idents.push(ident);
                feature.set('idents', idents);
                cachedIdents.splice(idx, 1);
                feature.set('cachedIdents', cachedIdents);
            }
        }
    }, this));
}
;
ol.inherits(FAMap.olExtras.Source.ADLastPositions, ol.source.Vector);
FAMap.olExtras.Source.AirSigmets = function(options) {
    this.FAMap = options.FAMap;
    var defaultInterval = 300;
    this.loadingInterval = typeof (options.loadingInterval) !== "undefined" ? options.loadingInterval : defaultInterval;
    this.type = typeof (options.type) !== "undefined" ? options.type : "all";
    this.attributionText = typeof (options.attributionText) !== "undefined" ? options.attributionText : this.type + " data not suitable for flight planning";
    this.loadGeoJSON = function() {
        var format = new ol.format.GeoJSON();
        var url = 'https://ko.flightaware.com/ajax/ignoreuser/sigmet/sigmet_to_geojson.rvt';
        var source = this;
        if (this.type) {
            url += "?type=" + encodeURIComponent(this.type);
        }
        $.getJSON(url, '', function(resp) {
            if (Object.keys(resp).length > 0) {
                var features = format.readFeatures(resp, {
                    dataProjection: 'EPSG:4326',
                    featureProjection: 'EPSG:3857'
                });
                source.clear();
                source.addFeatures(features);
            }
            var now = new Date().getTime();
            source.set('loaded', now);
            source.set('attributions', [new ol.Attribution({
                "html": now
            })]);
        });
    }
    ;
    ol.source.Vector.call(this, {
        'attributions': this.attributionText ? [new ol.Attribution({
            "html": this.attributionText
        })] : []
    });
    this.on('change:loaded', function() {
        this.FAMap.trigger('airsigmet:featuresLoaded:' + this.type, [this.getFeatures()]);
    });
}
;
ol.inherits(FAMap.olExtras.Source.AirSigmets, ol.source.Vector);
FAMap.olExtras.Source.AirSigmets.prototype.updateAirSigmets = function() {
    this.loadGeoJSON();
}
;
FAMap.olExtras.Source.AirSigmets.prototype.live = function(on) {
    this._liveTimeout = typeof (this._liveTimeout) === "undefined" ? null : this._liveTimeout;
    if (this._liveTimeout) {
        clearTimeout(this._liveTimeout);
        this._liveTimeout = null;
    }
    if (on) {
        this.updateAirSigmets();
    }
    if (on && this.loadingInterval !== null) {
        this._liveTimeout = setTimeout((function(asSource) {
            return asSource.live.bind(asSource, true);
        }
        )(this), this.loadingInterval * 1000);
    }
}
;
FAMap.olExtras.Source.AirportsDeclutter = function(options) {
    if (!('url'in options)) {
        throw ('Error: no url passed to AirportDeclutter Source!');
    }
    this._FAMap = options.FAMap;
    this._source = new ol.source.Vector({
        format: new ol.format.GeoJSON(),
        url: options.url
    });
    this._featureSetCache = {};
    this._lastResolution = null;
    this._loaded = false;
    this.dedupeAnimated = true;
    if (typeof options.dedupeAnimated !== 'undefined') {
        this.dedupeAnimated = options.dedupeAnimated;
    }
    this._excludedAirports = options.excludedAirports || [];
    this.loadFeatures = function(extent, resolution, projection) {
        this._loaded = true;
        this._source.loadFeatures(extent, resolution, projection);
        if (resolution !== this._resolution) {
            this._resolution = resolution;
            this._declutter();
        }
    }
    ;
    this._onSourceChange = function() {
        this._declutter();
        this.changed();
    }
    ;
    this._declutter = function() {
        if (this._resolution == this._lastResolution || this._source.getFeatures().length == 0) {
            return;
        } else {
            this._lastResolution = this._resolution;
        }
        this.clear();
        this.addFeatures(this._getReducedFeatureSet());
    }
    ;
    this._getReducedFeatureSet = function() {
        var res = this._resolution;
        if (!(res in this._featureSetCache)) {
            this._featureSetCache[res] = this._generateFeatureSet(res);
        }
        return this._featureSetCache[res];
    }
    ;
    this._generateFeatureSet = function(res) {
        var maxResolution = 9783.93962050256;
        var minResolution = 152.8740565703525;
        var resFactor = maxResolution / res;
        var minZoom = Math.log(1) / Math.log(2) + 1;
        var maxZoom = Math.log(maxResolution / minResolution) / Math.log(2) + 1;
        var currentZoom = Math.log(resFactor) / Math.log(2) + 1;
        score = 1 - 1 / Math.pow(2, maxZoom - currentZoom - 1) + 0.01;
        var featureSet = [];
        $.each(this._source.getFeatures(), $.proxy(function(index, feature) {
            if (feature.get('ops') >= score) {
                var isDupe = false;
                var codes = feature.get('label').split('/').map(function(code) {
                    return code.trim();
                });
                $.each(codes, $.proxy(function(index, code) {
                    if (this._excludedAirports.indexOf(code) !== -1) {
                        isDupe = true;
                    }
                }, this));
                if (!isDupe) {
                    featureSet.push(feature);
                }
            }
        }, this));
        return featureSet;
    }
    ;
    if (options && 'filter'in options && typeof options.filter == 'function') {
        this._filter = options.filter;
    }
    this._source.on('change', $.proxy(this._onSourceChange, this));
    if (this.dedupeAnimated) {
        if (this._FAMap._animationController !== null) {
            var airports = [];
            $.each(this._FAMap._animationController.knownFlights, function(key, flight) {
                airports = airports.concat([flight.origin.icao, flight.destination.icao]);
            });
            this._excludedAirports = this._excludedAirports.concat(airports);
        }
        this._FAMap.on('animationController.newFlights', $.proxy(function(e, batch) {
            var airports = [];
            $.each(batch, function(index, flight) {
                airports = airports.concat([flight.flightData.origin.icao, flight.flightData.destination.icao]);
            });
            this._excludedAirports = this._excludedAirports.concat(airports);
            if (this._loaded) {
                this._featureSetCache = {};
                this.loadFeatures();
            }
        }, this));
    }
    ol.source.Vector.call(this, {});
}
;
ol.inherits(FAMap.olExtras.Source.AirportsDeclutter, ol.source.Vector);
FAMap.olExtras.Source.Animated = function(options) {
    this.FAMap = options.FAMap;
    this._registered = false;
    this.loadFeatures = function() {
        if (!this.registered) {
            this.registered = true;
            this.FAMap._animationController.registerSource(this);
        }
    }
    ;
    if (!('features'in options)) {
        throw ('Error: Animated source must be passed a list of feature sets!');
    } else {
        this.features = options.features;
    }
    if (!('filter'in options)) {
        this.filter = function() {
            return true;
        }
    } else {
        this.filter = options.filter;
    }
    ol.source.Vector.call(this, {});
}
;
ol.inherits(FAMap.olExtras.Source.Animated, ol.source.Vector);
FAMap.olExtras.Source.ClusterMeters = function(options) {
    if (typeof options.source === 'undefined') {
        throw ('Error: no source provided for ClusterMeters Source!');
    }
    if (typeof options.distance === 'undefined') {
        throw ('Error: no distance provided for ClusterMeters Source!');
    } else {
        this.mapDistance = options.distance;
    }
    this.features = [];
    ol.source.Cluster.call(this, {
        source: options.source,
        distance: options.distance
    });
}
;
ol.inherits(FAMap.olExtras.Source.ClusterMeters, ol.source.Cluster);
FAMap.olExtras.Source.ClusterMeters.prototype.cluster = function() {
    this.features.length = 0;
    var mapDistance = this.mapDistance;
    var features = this.getSource().getFeatures();
    var clustered = [];
    for (var i = 0, ii = features.length; i < ii; i++) {
        var feature = features[i];
        if (clustered.indexOf(feature) == -1) {
            var geometry = feature.getGeometry();
            if (typeof geometry !== 'object' || geometry === null || Object.getPrototypeOf(geometry) !== ol.geom.Point.prototype) {
                continue;
            }
            var coordinates = geometry.getCoordinates();
            var extent = [coordinates[0], coordinates[1], coordinates[0], coordinates[1]]
            ol.extent.buffer(extent, mapDistance, extent);
            var neighbors = this.getSource().getFeaturesInExtent(extent);
            neighbors = neighbors.filter(function(neighbor) {
                if (clustered.indexOf(neighbor) == -1) {
                    clustered.push(neighbor);
                    return true;
                } else {
                    return false;
                }
            });
            this.features.push(this.createCluster(neighbors));
        }
    }
}
;
FAMap.olExtras.Source.ClusterMeters.prototype.getFeatures = function() {
    return this.features;
}
;
FAMap.olExtras.Source.DTN = function(options) {
    if (!('params'in options)) {
        throw ('Error: no request params passed to DTN Source!');
    }
    var layerRootNames = options.params.LAYERS.split(',');
    $.each(layerRootNames, function(k, v) {
        var layerRoot = v.replace("_CURRENT", "");
        if (layerRoot !== v) {
            layerRootNames[k] = layerRoot;
        } else {
            layerRootNames[k] = null;
        }
    });
    options.params.layerRootNames = layerRootNames;
    var mapSize = options.FAMap._olMap.getSize();
    var tileSize = Math.min(Math.max.apply(null, mapSize) / 2, 3072);
    var mapExtent = options.FAMap._olMap.getView().calculateExtent(mapSize);
    var origin = ol.extent.getTopLeft(mapExtent);
    var projExtent = ol.proj.get('EPSG:3857').getExtent();
    var startResolution = ol.extent.getWidth(projExtent) / tileSize;
    var resolutions = new Array(16);
    for (var i = 0, ii = resolutions.length; i < ii; ++i) {
        resolutions[i] = startResolution / Math.pow(2, i);
    }
    if ('tvKey'in options.FAMap.options) {
        options.params.key = options.FAMap.options.tvKey;
    }
    var attributionName = 'Premium weather: DTN';
    if (options.FAMap.options.weatherTrial) {
        attributionName += ' (TRIAL)';
    }
    ol.source.TileWMS.call(this, {
        url: 'https://ko.flightaware.com/ajax/dtn_proxy.rvt',
        params: options.params,
        attributions: [new ol.Attribution({
            html: attributionName
        })],
        tileGrid: new ol.tilegrid.createXYZ({
            extent: ol.proj.get('EPSG:3857').getExtent(),
            tileSize: 512
        })
    });
    var _clockToAgeStringRADAR = function(clock) {
        var maxAge = 175;
        var ageString = "_CURRENT";
        var now = FAMap.Util.getNow();
        var age = Math.ceil((now - clock) / 300) * 5;
        if (age > 175) {
            age = maxAge;
        }
        if (age > 5) {
            ageString = '-' + age + 'MIN';
        }
        return (ageString);
    };
    var _clockToAgeString = null;
    if (options.params.LAYERS.search("RADAR") > -1) {
        _clockToAgeString = _clockToAgeStringRADAR;
    }
    this.updateClock = function(clock) {
        if (!_clockToAgeString) {
            return;
        }
        var params = this.getParams();
        var ageString = _clockToAgeString(clock);
        var layerNames = params.LAYERS.split(',');
        $.each(params.layerRootNames, function(k, v) {
            if (v) {
                layerNames[k] = v + ageString;
            }
        });
        params.LAYERS = layerNames.join(',');
        this.updateParams(params);
    }
    ;
    if (typeof (options.params.CLOCK) !== "undefined") {
        this.updateClock(options.params.CLOCK);
    } else {
        this.updateClock(FAMap.Util.getNow());
    }
}
;
ol.inherits(FAMap.olExtras.Source.DTN, ol.source.TileWMS);
FAMap.olExtras.Source.DayNightTerminator = function(options) {
    var twilightWidth = 667918;
    var twilightSteps = 13;
    var points = 288;
    var maxDimension = ol.proj.get('EPSG:3857').getExtent()[3];
    var minDimension = ol.proj.get('EPSG:3857').getExtent()[1];
    this.dayFeatures = [];
    this.nightFeatures = [];
    this._terminatorCurveSetCache = {};
    this._generateTerminatorCurveSet = function(dayOfYear) {
        offsetX = maxDimension;
        var declination = 0.40927971 * Math.sin((2 * Math.PI / 365) * (dayOfYear - 81.5));
        var termFunction = function(lon) {
            var cosFactor = -Math.cos((lon + offsetX) * (Math.PI / maxDimension));
            return (2 * maxDimension / Math.PI) * Math.atan(cosFactor / Math.tan(declination));
        };
        var lonPrimeFunction = function(t) {
            return (maxDimension - minDimension) / points;
        };
        var latPrimeFunction = function(t) {
            var aFactor = 2 * maxDimension / Math.PI;
            var bFactor = offsetX;
            var cFactor = Math.PI / maxDimension;
            var dFactor = Math.tan(declination);
            var cosOperand = ((minDimension + (((maxDimension - minDimension) / points) * t)) + bFactor) * cFactor;
            return (aFactor / (1 + Math.pow((-Math.cos(cosOperand) / dFactor), 2))) * (Math.sin(cosOperand) / dFactor) * (cFactor * (maxDimension - minDimension)) / points;
        };
        var lonParallelFunction = function(dist, t) {
            return (dist * latPrimeFunction(t)) / Math.sqrt(Math.pow(lonPrimeFunction(t), 2) + Math.pow(latPrimeFunction(t), 2));
        }
        var latParallelFunction = function(dist, t) {
            return (dist * lonPrimeFunction(t)) / Math.sqrt(Math.pow(lonPrimeFunction(t), 2) + Math.pow(latPrimeFunction(t), 2));
        }
        var lineCoords = [];
        for (var i = 0; i < twilightSteps; i++) {
            lineCoords.push([]);
        }
        for (var i = 0; i < points; i++) {
            var lon = minDimension + ((maxDimension - minDimension) / points * i);
            var lat = termFunction(lon);
            lineCoords[0].push([lon, lat]);
            var latDeg = ol.proj.toLonLat([lon, lat])[1];
            var latRad = latDeg * Math.PI / 180;
            var baseDist = (twilightWidth / (twilightSteps - 1)) / Math.cos(latRad);
            var steps = (twilightSteps - 1) / 2
            for (var j = 1; j <= steps; j++) {
                var dist = baseDist * j;
                lineCoords[j].push([lon + lonParallelFunction(dist, i), Math.max(lat - latParallelFunction(dist, i), minDimension)]);
                lineCoords[j + steps].push([lon - lonParallelFunction(dist, i), Math.min(lat + latParallelFunction(dist, i), maxDimension)]);
            }
        }
        var dayShimCoord = (declination < 0) ? minDimension : maxDimension;
        var nightShimCoord = (declination < 0) ? maxDimension : minDimension;
        return {
            curves: lineCoords,
            dayShimCoord: dayShimCoord,
            nightShimCoord: nightShimCoord
        };
    }
    ;
    this.getTerminatorCurveSet = function(dayOfYear) {
        if (!(dayOfYear in this._terminatorCurveSetCache)) {
            this._terminatorCurveSetCache[dayOfYear] = this._generateTerminatorCurveSet(dayOfYear);
        }
        return $.extend(true, {}, this._terminatorCurveSetCache[dayOfYear]);
    }
    ;
    this.setClock = function(clock) {
        var now = moment.unix(clock).utc();
        var baseCurveData = this.getTerminatorCurveSet(now.dayOfYear());
        var dayFraction = (now.hour() * 3600 + now.minute() * 60 + now.second()) / 86400;
        var offsetX = dayFraction * 2 * maxDimension;
        offsetX = Math.round(offsetX / ((2 * maxDimension) / points)) * ((2 * maxDimension) / points);
        $.each(baseCurveData.curves, $.proxy(function(k1, curve) {
            $.each(curve, function(k2, coord) {
                curve[k2][0] -= offsetX;
            });
            var count = 0;
            while (true) {
                if (count > curve.length) {
                    break;
                }
                if (curve[0][0] < minDimension) {
                    var coord = curve.shift();
                    coord[0] += (maxDimension - minDimension);
                    curve.push(coord);
                } else {
                    break;
                }
                count++;
            }
            curve.push([curve[0][0] + (maxDimension - minDimension), curve[0][1]]);
            var dayCoords = curve.slice(0);
            dayCoords.push([maxDimension, baseCurveData.dayShimCoord], [minDimension, baseCurveData.dayShimCoord], curve[0]);
            var dayGeometry = new ol.geom.Polygon([dayCoords]);
            this.dayFeatures[k1].setGeometry(dayGeometry);
            var nightCoords = curve.slice(0);
            nightCoords.push([maxDimension, baseCurveData.nightShimCoord], [minDimension, baseCurveData.nightShimCoord], curve[0]);
            var nightGeometry = new ol.geom.Polygon([nightCoords]);
            this.nightFeatures[k1].setGeometry(nightGeometry);
        }, this));
    }
    ;
    for (var i = 0; i < twilightSteps; i++) {
        this.dayFeatures.push(new ol.Feature({
            type: 'day'
        }));
        this.nightFeatures.push(new ol.Feature({
            type: 'night'
        }));
    }
    if (options.FAMap._validTimes !== null) {
        this.setClock(options.FAMap._validTimes.midpoint);
    } else {
        this.setClock(FAMap.Util.getNow());
    }
    options.FAMap.on('validTimesUpdate', $.proxy(function(e, times) {
        this.setClock(times.midpoint);
    }, this));
    ol.source.Vector.call(this, {
        features: [].concat(this.dayFeatures, this.nightFeatures)
    });
}
;
ol.inherits(FAMap.olExtras.Source.DayNightTerminator, ol.source.Vector);
FAMap.olExtras.Source.Dedupe = function(sourceKeys) {
    this._sourceKeys = sourceKeys;
    this._sources = {};
    this.addSource = function(idx, source, active) {
        if (!(idx in this._sources)) {
            this._sources[idx] = {
                source: source,
                active: active
            };
            this.refreshFeatures();
        }
        source.on('change', $.proxy(function() {
            this.refreshFeatures();
        }, this));
    }
    ;
    this.setActive = function(key, val) {
        if (key in this._sources) {
            this._sources[key].active = val;
            this.refreshFeatures();
        }
    }
    ;
    this.refreshFeatures = function() {
        this.clear();
        var features = {};
        var featCount = 0;
        $.each(this._sourceKeys, $.proxy(function(sourceRank, sourceKey) {
            if (!(sourceKey in this._sources)) {
                return true;
            }
            if (!this._sources[sourceKey].active) {
                return true;
            }
            var source = this._sources[sourceKey].source;
            $.each(source.getFeatures(), function(k, feature) {
                if (false) {
                    return true;
                }
                featCount++;
                var precision = 1000;
                var coords = feature.getGeometry().getCoordinates().map(function(a) {
                    return precision * (Math.round(a / precision));
                });
                var gKey = coords.join();
                if ('features'in feature.getProperties()) {
                    var lbl = feature.get('features')[0].get('label');
                } else {
                    var lbl = feature.get('label');
                }
                if (!(gKey in features) || sourceRank < features[gKey].rank) {
                    features[gKey] = {
                        feature: feature,
                        rank: sourceRank
                    };
                }
            });
        }, this));
        var featArr = [];
        $.each(features, function(k, v) {
            featArr.push(v.feature);
        });
        this.addFeatures(featArr);
    }
    ;
    ol.source.Vector.call(this, {});
}
;
ol.inherits(FAMap.olExtras.Source.Dedupe, ol.source.Vector);
FAMap.olExtras.Source.DigitalGlobe = function(options) {
    if (!('key'in options)) {
        throw ('Error: no map key passed to MapBoxSource!');
    }
    if (!('token'in options)) {
        throw ('Error: no access token passed to MapBoxSource!');
    }
    if (!('filetype'in options)) {
        options.filetype = 'png';
    }
    this._url = 'https://earthwatch.digitalglobe.com/earthservice/tmsaccess/tms/1.0.0/' + options.key + '@EPSG:3857@png/{z}/{x}/{-y}.png?connectId=' + options.token;
    this.minZoom = 2;
    this.maxZoom = 20;
    ol.source.XYZ.call(this, {
        url: this._url,
        attributions: [new ol.Attribution({
            html: '<span class="mapbox-attribution">&copy; <a href="http://bit.ly/mapsapiview">DigitalGlobe</a> &copy; <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a></span>'
        })],
        tileGrid: new ol.tilegrid.createXYZ({
            tileSize: 512
        })
    });
}
;
ol.inherits(FAMap.olExtras.Source.DigitalGlobe, ol.source.XYZ);
FAMap.olExtras.Source.FAWx = function(options) {
    this.updateClock = function(clock) {
        var params = this.getParams();
        params.CLOCK = this._roundClock(clock);
        if (params.CLOCK) {
            this.setUrl(this._myUrl);
        }
        this.updateParams(params);
        var attributions = Array.prototype.slice.call(this._optAttributions);
        attributions.push(new ol.Attribution({
            html: 'Weather: ' + this._getReadableClock(options.params.CLOCK)
        }));
        this.setAttributions(attributions);
    }
    ;
    this._getReadableClock = function(clock) {
        return FADate.displayWeatherTime(moment.unix(clock), null, true);
    }
    ;
    this._roundClock = function(clock) {
        return clock - (clock % 300);
    }
    ;
    this._map = options.FAMap;
    if (!('params'in options)) {
        throw ('Error: no request params passed to FA Wx Source!');
    }
    this._map.on('validTimesUpdate', $.proxy(function(e, times) {
        this.updateClock(times.midpoint);
    }, this));
    if (!('CLOCK'in options.params)) {
        if (this._map._validTimes !== null) {
            options.params.CLOCK = this._map._validTimes.midpoint;
        } else {
            options.params.CLOCK = this._roundClock(FAMap.Util.getNow());
        }
    } else {
        options.params.CLOCK = this._roundClock(options.params.CLOCK);
    }
    if ('WEATHER_CDN'in FAMap.Globals) {
        var cdn = '//' + FAMap.Globals.WEATHER_CDN;
    } else {
        var cdn = '';
    }
    this._myUrl = cdn + '/ajax/ignoreall/weather_wms.rvt';
    if ('attributions'in options) {
        this._optAttributions = options.attributions;
    } else {
        this._optAttributions = [];
    }
    var attributions = Array.prototype.slice.call(this._optAttributions);
    attributions.push(new ol.Attribution({
        html: 'Weather: ' + this._getReadableClock(options.params.CLOCK)
    }));
    ol.source.TileWMS.call(this, {
        url: options.params.CLOCK ? this._myUrl : null,
        params: options.params,
        attributions: attributions,
        tileGrid: new ol.tilegrid.createXYZ({
            extent: ol.proj.get('EPSG:3857').getExtent(),
            tileSize: 512
        })
    });
}
;
ol.inherits(FAMap.olExtras.Source.FAWx, ol.source.TileWMS);
FAMap.olExtras.Source.FA_XYZ = function(options) {
    if (!('dirname'in options)) {
        throw ('Error: no dirname passed to FA_XYZSource!');
    }
    if (!('filetype'in options)) {
        throw ('Error: no filetype passed to FA_XYZSource!');
    }
    if (!('attributions'in options)) {
        options.attributions = [];
    }
    options.attributions.unshift(new ol.Attribution({
        html: '<b>&copy; ' + new Date().getFullYear() + ' FlightAware</b>'
    }));
    if ('TILE_CDN'in FAMap.Globals) {
        var cdn = '//' + FAMap.Globals.TILE_CDN;
    } else {
        var cdn = '';
    }
    this._url = cdn + '/images/tilecache/' + options.dirname + '/{z}/{x}/{y}.' + options.filetype;
    this.minZoom = 2;
    this.maxZoom = 10;
    ol.source.XYZ.call(this, {
        url: this._url,
        attributions: options.attributions
    });
}
;
ol.inherits(FAMap.olExtras.Source.FA_XYZ, ol.source.XYZ);
FAMap.olExtras.Source.FIRs = function(options) {
    this.FAMap = options.FAMap;
    this.attributionText = typeof (options.attributionText) !== "undefined" ? options.attributionText : "";
    this.loadGeoJSON = function(firCode) {
        var format = new ol.format.GeoJSON();
        var url = 'https://ko.flightaware.com/ajax/ignoreuser/fir_to_geojson.rvt';
        var source = this;
        if (firCode) {
            url += "?type=" + encodeURIComponent(firCode);
        }
        $.getJSON(url, '', function(resp) {
            if (Object.keys(resp).length > 0) {
                var features = format.readFeatures(resp, {
                    dataProjection: 'EPSG:4326',
                    featureProjection: 'EPSG:3857'
                });
                source.addFeatures(features);
            }
            var now = new Date().getTime();
            source.set('loaded', now);
            source.set('attributions', [new ol.Attribution({
                "html": now
            })]);
        });
    }
    ;
    ol.source.Vector.call(this, {
        'attributions': this.attributionText ? [new ol.Attribution({
            "html": this.attributionText
        })] : []
    });
    this.on('change:loaded', function() {
        this.FAMap.trigger('fir:featuresLoaded:' + this.type, [this.getFeatures()]);
    });
}
;
ol.inherits(FAMap.olExtras.Source.FIRs, ol.source.Vector);
FAMap.olExtras.Source.FIRs.prototype.addFIR = function(firCode) {
    this.loadGeoJSON(firCode);
}
;
FAMap.olExtras.Source.FIRs.prototype.removeFIR = function(firCode) {
    var features = this.getFeatures();
    for (var i = features.length - 1; i >= 0; i--) {
        var code = features[i].get("code");
        if (code === firCode) {
            this.removeFeature(features[i]);
        }
    }
}
;
FAMap.olExtras.Source.FlexEndpoints = function(options) {
    var asource = new FAMap.olExtras.Source.Animated({
        features: ['FlexEndpoints'],
        FAMap: options.FAMap
    });
    this._sortedFeatures = {};
    this._visibleFeatures = {};
    this._loaded = false;
    this.loadFeatures = function(extent, resolution, projection) {
        if (!this._loaded) {
            this._loaded = true;
            asource.loadFeatures(extent, resolution, projection);
        }
    }
    ;
    this.setVisibleFeature = function(airport, feature) {
        if (airport in this._visibleFeatures) {
            this.removeFeature(feature);
        }
        if (feature) {
            this._visibleFeatures[airport] = feature;
            this.addFeature(feature);
        } else {
            delete this._visibleFeatures[airport];
        }
    }
    ;
    this.onAddFeature = function(e) {
        var feature = e.feature;
        var geometry = feature.getGeometry();
        var airport = feature.get('icao');
        if (typeof geometry !== 'object' || geometry === null || Object.getPrototypeOf(geometry) !== ol.geom.Point.prototype) {
            return;
        }
        if (airport in this._sortedFeatures) {
            if (this._sortedFeatures[airport].indexOf(feature) == -1) {
                this._sortedFeatures[airport].push(feature);
            }
        } else {
            this._sortedFeatures[airport] = [feature];
            this.setVisibleFeature(airport, feature);
        }
    }
    ;
    this.onRemoveFeature = function(e) {
        var feature = e.feature;
        var geometry = feature.getGeometry();
        var airport = feature.get('icao');
        if (airport in this._sortedFeatures) {
            var splicePoint = this._sortedFeatures[airport].indexOf(feature);
            if (splicePoint > -1) {
                this._sortedFeatures[airport].splice(splicePoint, 1);
            }
        }
        if (this._visibleFeatures[airport] === feature) {
            var newVisibleFeature = false;
            $.each(this._sortedFeatures, $.proxy(function(k, feat) {
                var geometry = feature.getGeometry();
                if (geometry !== null && typeof geometry == 'object' && Object.getPrototypeOf(geometry) == ol.geom.Point.prototype) {
                    newVisibleFeature = feat;
                    return false;
                }
            }, this));
            this.setVisibleFeature(airport.newVisibleFeature);
        }
    }
    ;
    this.onChangeFeature = function(e) {
        var geometry = e.feature.getGeometry();
        if (geometry !== null && typeof geometry == 'object' && Object.getPrototypeOf(geometry) == ol.geom.Point.prototype) {
            this.onAddFeature(e);
        } else {
            this.onRemoveFeature(e);
        }
    }
    ;
    asource.on('addfeature', $.proxy(this.onAddFeature, this));
    asource.on('removefeature', $.proxy(this.onRemoveFeature, this));
    asource.on('changefeature', $.proxy(this.onChangeFeature, this));
    ol.source.Vector.call(this, {});
}
;
ol.inherits(FAMap.olExtras.Source.FlexEndpoints, ol.source.Vector);
FAMap.olExtras.Source.MDARings = function(options) {
    if (!('center'in options)) {
        throw ('Error: Must pass center point to MDARings source');
    }
    var center = ol.proj.transform(options.center, 'EPSG:4326', 'EPSG:3857');
    var features = [];
    features.push(new ol.Feature(new ol.geom.Point(center)));
    var miles_to_meters = 1609.34;
    var radii = [7 * miles_to_meters, 14 * miles_to_meters, 21 * miles_to_meters];
    $.each(radii, function(k, radius) {
        var coords = [];
        for (var i = 0; i <= Math.PI * 2; i += Math.PI / 90) {
            var cX = Math.cos(i) * radius + center[0];
            var cY = Math.sin(i) * radius + center[1];
            coords.push([cX, cY]);
        }
        features.push(new ol.Feature(new ol.geom.LineString(coords)));
    });
    ol.source.Vector.call(this, {
        features: features
    });
}
;
ol.inherits(FAMap.olExtras.Source.MDARings, ol.source.Vector);
FAMap.olExtras.Source.Mapbox = function(options) {
    if (!('key'in options)) {
        throw ('Error: no map key passed to MapBoxSource!');
    }
    if (!('token'in options)) {
        throw ('Error: no access token passed to MapBoxSource!');
    }
    if (!('filetype'in options)) {
        options.filetype = 'png';
    }
    this._url = '//api.tiles.mapbox.com/v4/' + options.key + '/{z}/{x}/{y}.' + options.filetype + '?access_token=' + options.token;
    if ('version'in options && options.version === 'v1') {
        this._url = '//api.mapbox.com/styles/v1/' + options.username + '/' + options.key + '/tiles/256/{z}/{x}/{y}?access_token=' + options.token;
    }
    this.minZoom = 2;
    this.maxZoom = 19;
    ol.source.XYZ.call(this, {
        url: this._url,
        attributions: [new ol.Attribution({
            html: '<span class="mapbox-attribution">&copy; <a href="http://bit.ly/mapsapiview">DigitalGlobe</a> &copy; <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a></span>'
        })],
        tileGrid: new ol.tilegrid.createXYZ({
            tileSize: 512
        })
    });
}
;
ol.inherits(FAMap.olExtras.Source.Mapbox, ol.source.XYZ);
FAMap.olExtras.Source.RangeRings = function(options) {
    this.FAMap = options.FAMap;
    this.loaded = false;
    this.ringParams = null;
    this.loadFeatures = function() {
        if (this.loaded) {
            return;
        }
        this.loaded = true;
        var params = this.ringParams || {
            center: options.FAMap._olMap.getView().getCenter(),
            count: 3,
            spacing: 7
        };
        this.update(params);
        this.set('updated', new Date().getTime());
    }
    ;
    this.update = function(params, persist) {
        var features = [];
        for (var i = 1; i <= params.count; i++) {
            var geometry = new ol.geom.Circle(params.center,params.spacing * 1852 * i);
            features.push(new ol.Feature(geometry));
        }
        this.clear();
        this.addFeatures(features);
        this.ringParams = params;
        if (typeof persist !== "undefined" && persist) {
            this.set('persisted', new Date().getTime());
        }
    }
    ;
    ol.source.Vector.call(this, {});
}
;
ol.inherits(FAMap.olExtras.Source.RangeRings, ol.source.Vector);
FAMap.olExtras.Source.StaticAirports = function(options) {
    var features = [];
    if (options.airports !== undefined) {
        $.each(options.airports, function(k, airport) {
            var geometry = new ol.geom.Point(airport.coords);
            geometry.transform('EPSG:4326', 'EPSG:3857');
            features.push(new ol.Feature({
                geometry: geometry,
                icao: airport.icao,
                iata: airport.iata,
                isUS: airport.isUS
            }));
        });
    }
    ol.source.Vector.call(this, {
        features: features
    });
}
;
ol.inherits(FAMap.olExtras.Source.StaticAirports, ol.source.Vector);
FAMap.olExtras.Source.TFRs = function(map, options) {
    if (typeof options === 'undefined') {
        options = {};
    }
    var url = 'https://ko.flightaware.com/ajax/ignoreuser/tfrs.rvt';
    var attributionText = 'TFR data not suitable for flight planning'
    if ('times'in options) {
        url += '?start=' + options.times.start + '&end=' + options.times.end;
        if (options.times.end < FAMap.Util.getNow()) {
            attributionText = 'Showing historical TFR data';
        }
    }
    ol.source.Vector.call(this, {
        format: new ol.format.GeoJSON(),
        url: url,
        attributions: [new ol.Attribution({
            html: attributionText
        })]
    });
}
;
ol.inherits(FAMap.olExtras.Source.TFRs, ol.source.Vector);
FAMap.olExtras.Source.VicinityAircraft = function(options) {
    this._FAMap = options.FAMap;
    this._loadedTiles = [];
    this._loadedFlights = {};
    this._excludedFlights = [];
    this._format = new ol.format.GeoJSON();
    this._endpointURL = 'https://ko.flightaware.com/ajax/ignoreall/vicinity_aircraft.rvt?';
    this.setEndpointURL = function(newURL) {
        this._endpointURL = newURL;
    }
    ;
    this.addExclusions = function(flight_ids) {
        flight_ids = flight_ids.map(function(id) {
            return id.split(':')[0];
        });
        Array.prototype.push.apply(this._excludedFlights, flight_ids);
        $.each(flight_ids, $.proxy(function(k, id) {
            if (id in this._loadedFlights) {
                this.removeFeature(this._loadedFlights[id]);
                delete this._loadedFlights[id];
            }
        }, this));
    }
    ;
    this.loadFeatures = function(extent, resolution, projection) {
        var bsView = new ol.View({
            center: this._FAMap.getCorrectedCenter(),
            resolution: resolution
        });
        var extent = bsView.calculateExtent(this._FAMap._olMap.getSize());
        var self = this;
        var offset = 0;
        var delta = 50;
        var tiles = this._getTilesForExtent(extent, projection);
        var keys = Object.keys(tiles).sort(function(a, b) {
            return Number(b) - Number(a);
        });
        $.each(keys, function() {
            var tile = tiles[this];
            var url = self._endpointURL + '&minLon=' + tile[0] + '&minLat=' + tile[1] + '&maxLon=' + tile[2] + '&maxLat=' + tile[3] + '&token=' + mapGlobals.VICINITY_TOKEN;
            var tileSuccess = function(features) {
                var splicePoints = [];
                $.each(features, function(k) {
                    var icon = this.get('icon');
                    if (!(icon in FAMap.olExtras.Style.iconDefs.shapes)) {
                        icon = 'unknown';
                    }
                    var size = FAMap.olExtras.Style.iconDefs.shapes[icon].size;
                    var multiplier = size[0] * size[1];
                    this.set('prominence', (this.get('prominence') * size[0] * size[1]));
                    var flight_id_complete = this.get('flight_id')
                    if (flight_id_complete) {
                        var flight_id = flight_id_complete.split(':')[0];
                        if (!(flight_id in self._loadedFlights) && self._excludedFlights.indexOf(flight_id) == -1) {
                            self._loadedFlights[flight_id] = this;
                        } else {
                            splicePoints.push(k);
                        }
                    }
                });
                splicePoints.sort(function(a, b) {
                    return b - a
                });
                $.each(splicePoints, function() {
                    features.splice(this, 1);
                });
                if (FAMap.Globals.ANIMATE_VICINITY) {
                    $.each(features, function() {
                        this.animationParams = self._getAnimationParams(this);
                    });
                }
                self.addFeatures(features);
            };
            var tileFailure = function() {
                var tileKey = tile.join('|');
                var splicePoint = self._loadedTiles.indexOf(tileKey);
                if (splicePoint > -1) {
                    self._loadedTiles.splice(splicePoint, 1);
                }
            };
            var loader = ol.featureloader.loadFeaturesXhr(url, self._format, tileSuccess, tileFailure);
            setTimeout($.proxy(function() {
                loader.call(this, extent, resolution, projection);
            }, this), offset);
            offset += delta;
        });
    }
    ;
    this._getTilesForExtent = function(extent, projection) {
        var self = this;
        extent = ol.proj.transformExtent(extent, projection, 'EPSG:4326');
        var tiles = {};
        $.each(this._tileGrid, function() {
            var tileKey = this.join('|');
            if (self._loadedTiles.indexOf(tileKey) == -1 && ol.extent.intersects(extent, this)) {
                var extentArea = ol.extent.getArea(this);
                var intersection = ol.extent.getIntersection(extent, this);
                var intersectionArea = ol.extent.getArea(intersection);
                var overlapScore = Math.round(intersectionArea / extentArea * 100);
                while (overlapScore in tiles) {
                    overlapScore++;
                }
                self._loadedTiles.push(tileKey);
                tiles[overlapScore] = this;
            }
        });
        return tiles;
    }
    ;
    this._generateFallbackTileGrid = function() {
        var coordDelta = 30;
        var grid = [];
        for (minX = -180; minX < 180; minX = minX + coordDelta) {
            for (minY = -90; minY < 90; minY = minY + coordDelta) {
                var maxX = minX + coordDelta;
                var maxY = minY + coordDelta;
                grid.push([minX, minY, maxX, maxY]);
            }
        }
        return grid;
    }
    ;
    this._getAnimationParams = function(feature) {
        var gs = feature.get('groundspeed');
        if (typeof gs == 'undefined' || gs == 0) {
            return false;
        }
        var nmiPerSec = gs / 60 / 60
        var msec = nmiPerSec * 1852;
        var radians = FAMap.Util.toRadians(feature.get('direction'));
        var xDelta = Math.sin(radians) * msec;
        var yDelta = Math.cos(radians) * msec;
        var rateFactor = 1 / msec;
        return {
            lastAnimated: Math.ceil(new Date().getTime() / 1000),
            xDelta: xDelta,
            yDelta: yDelta,
            rateFactor: rateFactor
        };
    }
    ;
    this.getStateKey = function() {
        var count = this.getFeatures().length;
        var idKey = Object.keys(this._loadedFlights).join('');
        return count + idKey;
    }
    ;
    if (typeof FAMap.Globals.VICINITY_GRID != 'undefined') {
        this._tileGrid = FAMap.Globals.VICINITY_GRID;
    } else {
        this._tileGrid = this._generateFallbackTileGrid();
    }
    if (this._FAMap._animationController !== null) {
        var ids = Object.keys(this._FAMap._animationController.knownFlights);
        this.addExclusions(ids);
        this._FAMap.on('animationController.newFlights', $.proxy(function(e, batch) {
            var ids = batch.map(function(f) {
                return f.flight_id;
            });
            this.addExclusions(ids)
        }, this));
    }
    ol.source.Vector.call(this, {});
}
;
ol.inherits(FAMap.olExtras.Source.VicinityAircraft, ol.source.Vector);
FAMap.olExtras.Source.VicinityAircraftDeclutter = function(options) {
    this._FAMap = options.FAMap;
    this._source = new FAMap.olExtras.Source.VicinityAircraft(options);
    this._granule = FAMap.Globals.VICINITY_ANIMATION_GRANULE || 2;
    this._baseFeatureLimit = 1200;
    this._cacheKey = null;
    this._featureSetCache = {};
    this._lastResolution = null;
    this._lastFeatureCount = 0;
    this.loadFeatures = function(extent, resolution, projection) {
        this._source.loadFeatures(extent, resolution, projection);
        if (resolution !== this._resolution) {
            this._resolution = resolution;
            this._declutter();
        }
    }
    ;
    this._onSourceChange = function() {
        this._declutter();
        this.changed();
    }
    ;
    this._declutter = function() {
        if (this._resolution == this._lastResolution && this._lastFeatureCount == this._source.getFeatures().length) {
            return;
        } else {
            this._lastResolution = this._resolution;
            this._lastFeatureCount = this._source.getFeatures().length;
        }
        this.clear();
        this.addFeatures(this._getReducedFeatureSet());
        this.setAttributions(this._getAttributions());
    }
    ;
    this._getAttributions = function() {
        var features = this._source.getFeatures().length;
        var reducedFeatures = this.getFeatures().length;
        if (features > reducedFeatures) {
            var hiddenCount = features - reducedFeatures;
            var attributions = [new ol.Attribution({
                html: hiddenCount + ' flights hidden (zoom in to see more)'
            })];
        } else {
            var attributions = [];
        }
        return attributions;
    }
    ;
    this._getReducedFeatureSet = function() {
        if (this._source.getStateKey() != this._cacheKey) {
            this._featureSetCache = {};
            this._cacheKey = this._source.getStateKey();
        }
        var res = this._resolution;
        if (!(res in this._featureSetCache)) {
            this._featureSetCache[res] = this._generateFeatureSet(res);
        }
        return this._featureSetCache[res];
    }
    ;
    this._generateFeatureSet = function(res) {
        var features = this._source.getFeatures();
        var baseResolution = 39135.75848201024;
        var resFactor = baseResolution / res;
        var multiplier = (Math.log(resFactor) / Math.log(2.1)) + 1;
        multiplier = Math.max(multiplier, 1);
        var limit = Math.ceil(this._baseFeatureLimit * multiplier);
        var fuzz = Math.round(limit * (Math.random() * .01));
        limit += fuzz;
        if (limit > features.length) {
            return features;
        }
        features.sort(this._sort);
        return features.slice(0, limit);
    }
    ;
    this._sort = function(a, b) {
        return b.get('prominence') - a.get('prominence');
    }
    ;
    this._animateCallback = function() {
        var self = this;
        var features = this.getFeatures();
        if (features.length == 0) {
            return;
        }
        var center = this._FAMap.getCorrectedCenter();
        var scoredFeatures = {};
        var start = new Date().getTime();
        var animationTime = Math.ceil(start / 1000);
        $.each(features, function(k) {
            var params = this.animationParams;
            if (params === false) {
                return true;
            }
            var timeDelta = animationTime - params.lastAnimated;
            var animationDelta = params.rateFactor * self._resolution;
            var timeScore = Math.round((timeDelta - animationDelta) * 1000);
            if (timeScore < 0) {
                return true;
            }
            this.timeDelta = timeDelta;
            var coords = this.getGeometry().getCoordinates();
            var xDist = coords[0] - center[0];
            var yDist = coords[1] - center[1];
            var distScore = 1 / Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));
            var score = Math.round(timeScore / distScore);
            while (score in scoredFeatures) {
                score++;
            }
            scoredFeatures[score] = this;
        });
        var timeLimit = this._granule * 100;
        $.each(Object.keys(scoredFeatures).sort().reverse(), function() {
            var now = new Date().getTime();
            if ((now - start) > timeLimit) {
                return false;
            }
            var feature = scoredFeatures[this];
            var params = feature.animationParams;
            if (!params) {
                return true;
            }
            var xDelta = params.xDelta * feature.timeDelta;
            var yDelta = params.yDelta * feature.timeDelta;
            var geometry = feature.getGeometry();
            ol.coordinate.add(geometry.getCoordinates(), [xDelta, yDelta])
            geometry.setCoordinates(ol.coordinate.add(geometry.getCoordinates(), [xDelta, yDelta]));
            feature.animationParams.lastAnimated = animationTime;
        });
    }
    ;
    this._source.on('change', $.proxy(this._onSourceChange, this));
    if (FAMap.Globals.ANIMATE_VICINITY) {
        var interval = this._granule * 1000;
        this._animateInterval = setInterval($.proxy(this._animateCallback, this), interval);
    }
    ol.source.Vector.call(this, {});
}
;
ol.inherits(FAMap.olExtras.Source.VicinityAircraftDeclutter, ol.source.Cluster);
FAMap.olExtras.Style = {};
(function iconDefs() {
    var shapes = {
        'airliner': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 26" width="25px" height="26px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>airliner_live</title><g id="Layer_2" data-name="Layer 2"><g id="Airliner"><path class="cls-1" d="M12.51,25.75c-.26,0-.74-.71-.86-1.41l-3.33.86L8,25.29l.08-1.41.11-.07c1.13-.68,2.68-1.64,3.2-2-.37-1.06-.51-3.92-.43-8.52v0L8,13.31C5.37,14.12,1.2,15.39,1,15.5a.5.5,0,0,1-.21,0,.52.52,0,0,1-.49-.45,1,1,0,0,1,.52-1l1.74-.91c1.36-.71,3.22-1.69,4.66-2.43a4,4,0,0,1,0-.52c0-.69,0-1,0-1.14l.25-.13H7.16A1.07,1.07,0,0,1,8.24,7.73,1.12,1.12,0,0,1,9.06,8a1.46,1.46,0,0,1,.26.87L9.08,9h.25c0,.14,0,.31,0,.58l1.52-.84c0-1.48,0-7.06,1.1-8.25a.74.74,0,0,1,1.13,0c1.15,1.19,1.13,6.78,1.1,8.25l1.52.84c0-.32,0-.48,0-.58l.25-.13H15.7A1.46,1.46,0,0,1,16,8a1.11,1.11,0,0,1,.82-.28,1.06,1.06,0,0,1,1.08,1.16V9c0,.19,0,.48,0,1.17a4,4,0,0,1,0,.52c1.75.9,4.4,2.29,5.67,3l.73.38a.9.9,0,0,1,.5,1,.55.55,0,0,1-.5.47h0l-.11,0c-.28-.11-4.81-1.49-7.16-2.2H14.06v0c.09,4.6-.06,7.46-.43,8.52.52.33,2.07,1.29,3.2,2l.11.07L17,25.29l-.33-.09-3.33-.86c-.12.7-.6,1.41-.86,1.41h0Z"/><path class="cls-2" d="M12.51.5C13.93.5,14,7,13.93,8.91c.3.16,1.64.91,2,1.1,0-.6,0-.85,0-1s0-.09,0-.13a1.18,1.18,0,0,1,.19-.7A.88.88,0,0,1,16.78,8h0a.82.82,0,0,1,.83.91s0,.07,0,.13,0,.44,0,1.17a3.21,3.21,0,0,1-.06.66c2.33,1.19,6.51,3.39,6.56,3.42.59.3.4,1,.11,1h-.07c-.37-.14-7.18-2.21-7.18-2.21l-3.18,0c0,.22.22,7.56-.48,8.91,0,0,2,1.26,3.39,2.08l.06.93L13.15,24a2.14,2.14,0,0,1-.64,1.47A2.14,2.14,0,0,1,11.87,24L8.26,25,8.31,24c1.38-.82,3.39-2.08,3.39-2.08-.7-1.35-.48-8.69-.48-8.91L8,13.06S1.17,15.13.86,15.27l-.11,0c-.32,0-.43-.73.14-1S5.13,12,7.46,10.85a3.21,3.21,0,0,1-.06-.66c0-.73,0-1,0-1.17s0-.09,0-.13A.82.82,0,0,1,8.24,8h0a.88.88,0,0,1,.65.21,1.18,1.18,0,0,1,.19.7s0,.07,0,.13,0,.39,0,1c.36-.19,1.71-.94,2-1.1C11.05,7,11.09.5,12.51.5m0-.5a1,1,0,0,0-.74.34c-1.16,1.2-1.2,6.3-1.18,8.28L10,8.93l-.46.25V8.91a1.68,1.68,0,0,0-.33-1.06,1.34,1.34,0,0,0-1-.36,1.31,1.31,0,0,0-1.33,1.4V9h0v0c0,.16,0,.46,0,1.14,0,.13,0,.26,0,.38l-4.5,2.35-1.74.91A1.2,1.2,0,0,0,0,15.15a.77.77,0,0,0,.73.64.74.74,0,0,0,.31-.07c.29-.12,4.35-1.35,7-2.17l2.6,0c-.1,5.54.17,7.46.38,8.2-.64.4-2,1.25-3,1.86l-.22.13,0,.26-.06.93,0,.81.7-.31,3.06-.79c.19.67.63,1.35,1,1.35s.86-.68,1-1.35l3.06.79.7.31,0-.81L17.2,24l0-.26L17,23.6c-1-.61-2.4-1.47-3-1.86.21-.74.48-2.66.38-8.2l2.6,0c2.72.83,6.81,2.07,7.07,2.18a.68.68,0,0,0,.25,0,.79.79,0,0,0,.74-.67,1.15,1.15,0,0,0-.63-1.29l-.71-.37c-1.23-.65-3.78-2-5.53-2.88,0-.12,0-.25,0-.38,0-.67,0-1,0-1.14h0V8.92a1.32,1.32,0,0,0-1.32-1.44,1.35,1.35,0,0,0-1,.36,1.67,1.67,0,0,0-.33,1V9h0v.22L15,8.93l-.57-.32c0-2,0-7.08-1.18-8.28A1,1,0,0,0,12.51,0Z"/></g></g></svg>',
            size: [25, 26]
        },
        'balloon': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 13" width="9px" height="13px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>balloon_live</title><g id="Layer_2" data-name="Layer 2"><g id="Balloon"><path class="cls-1" d="M3.56,12.75a.49.49,0,0,1-.46-.34L2.63,11a.51.51,0,0,1,.07-.44l.1-.1-2-3.68a.48.48,0,0,1-.05-.17,4.39,4.39,0,0,1-.48-2A4.29,4.29,0,0,1,4.5.25,4.29,4.29,0,0,1,8.75,4.58a4.39,4.39,0,0,1-.48,2,.45.45,0,0,1-.05.17l-2,3.68a.44.44,0,0,1,.1.1.51.51,0,0,1,.07.45L5.9,12.41a.49.49,0,0,1-.46.34Zm1.6-2.43L6.1,8.59A4.22,4.22,0,0,1,5,8.88v1.44ZM4,10.32V8.88A4.22,4.22,0,0,1,2.9,8.59l.94,1.73Z"/><path class="cls-2" d="M4.5.51a4,4,0,0,1,4,4.07A4.1,4.1,0,0,1,8,6.5a.24.24,0,0,1,0,.11l-2.16,4h.07a.23.23,0,0,1,.19.1.24.24,0,0,1,0,.22l-.47,1.44a.24.24,0,0,1-.22.16H3.56a.24.24,0,0,1-.22-.16l-.47-1.44a.24.24,0,0,1,0-.22.23.23,0,0,1,.19-.1h.07L1,6.62A.24.24,0,0,1,1,6.5,4.1,4.1,0,0,1,.5,4.58,4,4,0,0,1,4.5.51m.24,10.06H5.3L6.73,8a3.93,3.93,0,0,1-2,.68v1.93m-1,0h.57V8.64a3.93,3.93,0,0,1-2-.68L3.7,10.57M4.5,0A4.55,4.55,0,0,0,0,4.58,4.65,4.65,0,0,0,.49,6.66a.72.72,0,0,0,.07.21l1.92,3.52a.76.76,0,0,0-.09.66l.47,1.44a.74.74,0,0,0,.7.51H5.44a.74.74,0,0,0,.7-.51l.47-1.44a.76.76,0,0,0-.09-.66L8.44,6.86a.72.72,0,0,0,.07-.21A4.65,4.65,0,0,0,9,4.58,4.55,4.55,0,0,0,4.5,0Zm.74,9.1L5.57,9l-.34.62V9.1Zm-1.47.55L3.43,9l.34.07v.55Z"/></g></g></svg>',
            size: [9, 13]
        },
        'cessna': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 13" width="17px" height="13px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>cessna_live</title><g id="Layer_2" data-name="Layer 2"><g id="Cessna"><path class="cls-1" d="M8.51,12.75c-.17,0-2-.27-2.56-.35A.41.41,0,0,1,5.6,12V10.87a.41.41,0,0,1,.32-.4l1.81-.37L7.36,6.64H4.75L.6,6a.41.41,0,0,1-.35-.41V4a.41.41,0,0,1,.38-.41l4.09-.28h2.6v-.4l.25,0-.24-.08c0-.21.1-.76.12-1.06A.9.9,0,0,1,8,.94L8.12.54A.41.41,0,0,1,8.5.25a.4.4,0,0,1,.39.29L9,.95a.91.91,0,0,1,.53.75c0,.33.11,1,.13,1.11v.46h2.57l4.12.28a.41.41,0,0,1,.38.41V5.63A.41.41,0,0,1,16.4,6l-4.1.59H9.64L9.26,10.1l1.81.36a.41.41,0,0,1,.32.4V12a.41.41,0,0,1-.34.41c-.56.08-2.37.35-2.55.35Z"/><path class="cls-2" d="M8.5.5a.15.15,0,0,1,.15.11l.16.52a.68.68,0,0,1,.49.58c0,.34.11,1,.13,1.12a.16.16,0,0,1,0,0v.65h2.83l4.09.28A.16.16,0,0,1,16.5,4V5.63a.16.16,0,0,1-.13.16l-4.1.59H9.41L9,10.3l2,.41a.16.16,0,0,1,.12.16V12a.16.16,0,0,1-.13.16s-2.33.35-2.51.35h0c-.17,0-2.53-.35-2.53-.35A.16.16,0,0,1,5.85,12V10.87A.16.16,0,0,1,6,10.71l2-.41L7.59,6.39H4.73L.63,5.79A.16.16,0,0,1,.5,5.63V4A.16.16,0,0,1,.64,3.8l4.09-.28H7.57V2.87a.21.21,0,0,1,0,0c0-.15.1-.79.13-1.12a.68.68,0,0,1,.49-.58L8.36.61A.16.16,0,0,1,8.5.5m0-.5a.66.66,0,0,0-.62.46l-.1.32a1.13,1.13,0,0,0-.58.9c0,.31-.1.87-.12,1.06a.92.92,0,0,0,0,.14V3H4.75L.61,3.3A.66.66,0,0,0,0,4V5.63a.66.66,0,0,0,.56.65l4.1.59H7.14l.33,3-1.59.32a.66.66,0,0,0-.53.65V12a.66.66,0,0,0,.54.65C7,12.81,8.34,13,8.51,13s1.5-.19,2.58-.35a.66.66,0,0,0,.56-.65V10.87a.66.66,0,0,0-.52-.65L9.54,9.9l.33-3h2.48l4.1-.59A.66.66,0,0,0,17,5.63V4a.66.66,0,0,0-.61-.66L12.3,3H9.93V2.74c0-.11-.09-.74-.12-1.06a1.14,1.14,0,0,0-.57-.9L9.13.46A.65.65,0,0,0,8.5,0Z"/></g></g></svg>',
            size: [17, 13]
        },
        'heavy_2e': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 29" width="28px" height="29px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>heavy_2e_live</title><g id="Layer_2" data-name="Layer 2"><g id="Heavy_2_Eng" data-name="Heavy 2 Eng"><path class="cls-1" d="M9,28.35c0-.16-.17-1,.23-1.36.65-.59,2.82-2.38,3.4-2.86-.51-1.33-.59-5.15-.57-8.22L10,16,.25,19v-.34a1.78,1.78,0,0,1,.82-1.5l7.78-5.07a4.87,4.87,0,0,1-.51-3l0-.22.23,0h2.26l0,.22a8.32,8.32,0,0,1,0,1.81l1.21-.81c0-6.79.18-9.58,1.91-9.87,1.7.14,2,3,2,9.85L17.3,11a8.3,8.3,0,0,1,0-1.8l0-.22h2.51v.24a4.87,4.87,0,0,1-.51,3l7.66,5a1.77,1.77,0,0,1,.8,1.5V19L18,16l-2-.06c0,3.06-.06,6.88-.57,8.21a28.87,28.87,0,0,1,3.5,3A2,2,0,0,1,19,28.34l-.05.31L14.6,26.71c-.14,1.85-.41,1.85-.6,1.85s-.47,0-.6-1.84L9,28.66Z"/><path class="cls-2" d="M14,.5c1.43.13,1.69,3,1.69,9.73l2.06,1.39a5.43,5.43,0,0,1-.24-2.39h2s.26,2.07-.62,3c0,0,7.84,5.12,7.9,5.15a1.54,1.54,0,0,1,.68,1.28l-9.46-3-2.35-.08c0,.23.13,7.12-.62,8.54a34.46,34.46,0,0,1,3.59,3.08,1.86,1.86,0,0,1,.1,1l-4.39-2c-.07,1.16-.21,2-.38,2s-.31-.81-.38-2l-4.4,2s-.17-.84.16-1.13c.74-.67,3.54-3,3.54-3-.75-1.43-.62-8.31-.62-8.54L10,15.73l-9.46,3a1.54,1.54,0,0,1,.68-1.28c.06,0,8-5.24,8-5.24-.88-1-.62-3-.62-3h2a5.43,5.43,0,0,1-.24,2.39l1.91-1.28c0-6.74.17-9.5,1.7-9.76M14,0h-.06C12,.33,11.81,3,11.8,10l-.66.44a9.35,9.35,0,0,0,0-1.33l0-.45h-3v.49A5.4,5.4,0,0,0,8.52,12L.93,17A2.06,2.06,0,0,0,0,18.69v.68l.64-.2L10,16.23l1.77-.06c0,4.05.15,6.7.53,7.88-.73.6-2.67,2.21-3.28,2.76a1.82,1.82,0,0,0-.31,1.59l.12.6.56-.24,3.76-1.67c.14,1.43.39,1.72.82,1.72s.68-.29.82-1.73l3.75,1.67.58.25.11-.62A2.23,2.23,0,0,0,19.09,27a25.35,25.35,0,0,0-3.42-3c.37-1.19.55-3.83.52-7.87l1.77.06,9.39,2.94.64.2v-.68A2,2,0,0,0,27,17l-7.42-4.84A5.45,5.45,0,0,0,20,9.21l0-.45-.45,0H17.06l0,.45a9.35,9.35,0,0,0,0,1.33L16.18,10c0-7.21-.34-9.81-2.14-10Z"/></g></g></svg>',
            size: [28, 29]
        },
        'heavy_4e': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 30" width="28px" height="30px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>heavy_4e_live</title><g id="Layer_2" data-name="Layer 2"><g id="Heavy_4_Eng" data-name="Heavy 4 Eng"><path class="cls-1" d="M14,29.62c-.23,0-.52-.16-.71-1.33L8.82,29.58V28l3.56-3.52c-.41-1.51-.4-7.57-.4-9.11L8.46,16.59,1.27,20.76l-1,1.68,0-.91c0-2.28.23-2.45.3-2.52s.59-.51,3.5-3.09A10.47,10.47,0,0,1,4,13l0-.22.23,0H6.16v.23a11.63,11.63,0,0,1,0,1.26c.74-.68,1.36-1.28,1.69-1.61a9.54,9.54,0,0,1-.16-3.15l0-.22.23-.05H9.87v.23a11.49,11.49,0,0,1,0,1.31l.87-.84c.67-.66,1.06-1,1.27-1.19,0-6.24.53-8.46,2-8.46,1.23,0,2,1.42,2,8.46.21.17.59.53,1.27,1.19l.88.85a11.45,11.45,0,0,1,0-1.32V9.19h2.18v.24a9.53,9.53,0,0,1-.15,3.18c.33.32.95.93,1.69,1.61a11.5,11.5,0,0,1,0-1.27v-.23H24V13a10.49,10.49,0,0,1-.1,3L27.4,19c.09.09.28.26.32,2.54l0,.91-1-1.68L19.5,16.57,16,15.34c0,1.53.07,7.49-.39,9.11L19.18,28v1.61l-4.46-1.29C14.52,29.46,14.23,29.62,14,29.62Z"/><path class="cls-2" d="M14,.49c1.08,0,1.75,1.61,1.75,8.34.27.14,2.06,2,2.73,2.54a9,9,0,0,1-.11-1.94h1.7a9.4,9.4,0,0,1-.19,3.25c.37.37,1.26,1.24,2.3,2.17a9.25,9.25,0,0,1-.1-1.89h1.7A10.3,10.3,0,0,1,23.66,16c1.81,1.61,3.57,3.16,3.6,3.18a11.25,11.25,0,0,1,.22,2.35l-.57-1-7.28-4.22L15.76,15s.15,8-.41,9.52l3.59,3.55v1.18L14.51,28c-.11.85-.3,1.4-.51,1.4s-.4-.55-.51-1.39L9.06,29.26V28.07l3.59-3.55c-.51-1.28-.43-9.52-.43-9.52L8.37,16.36,1.1,20.58l-.57,1a11.25,11.25,0,0,1,.22-2.35S2.53,17.61,4.35,16a10.32,10.32,0,0,1-.12-3h1.7a9.29,9.29,0,0,1-.1,1.88c1-.93,1.93-1.8,2.3-2.17a9.43,9.43,0,0,1-.19-3.24h1.7a9,9,0,0,1-.11,1.93C10.21,10.8,12,9,12.25,8.83c0-6.73.62-8.34,1.75-8.34M14,0c-1.65,0-2.23,2.17-2.24,8.59-.22.19-.57.52-1.19,1.13l-.43.42c0-.4,0-.7,0-.73l0-.46H7.45v.49a10.3,10.3,0,0,0,.12,3.11c-.27.26-.67.65-1.15,1.1,0-.38,0-.67,0-.7l0-.46H3.74v.49a11.18,11.18,0,0,0,.07,2.88L.49,18.76h0l-.06.06c-.14.13-.33.31-.38,2.69l0,1.83.94-1.56.51-.84L8.58,16.8l3.16-1.12a65.92,65.92,0,0,0,.37,8.69L8.72,27.72l-.15.14V30l.65-.28,3.87-1.11c.18.88.46,1.26.9,1.26s.73-.39.91-1.27l3.86,1.12.65.28V27.87l-.15-.14-3.38-3.35a58.1,58.1,0,0,0,.36-8.69l3.16,1.11,7.13,4.14.51.84L28,23.35l0-1.83c0-2.38-.24-2.56-.38-2.69l-.06-.06h0L24.2,15.84A11.19,11.19,0,0,0,24.27,13v-.49H21.61l0,.46s0,.32,0,.7c-.48-.45-.88-.84-1.15-1.1a10.29,10.29,0,0,0,.13-3.1V8.94H17.9l0,.46s0,.33,0,.74l-.44-.43c-.62-.61-1-.94-1.19-1.13C16.23,2.25,15.63,0,14,0Z"/></g></g></svg>',
            size: [28, 30]
        },
        'helicopter': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 18" width="16px" height="18px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>helicopter_live</title><g id="Layer_2" data-name="Layer 2"><g id="Roto"><path class="cls-1" d="M8,17.75c-1.38,0-2.46-.63-2.46-1.43,0-.6.58-1.1,1.49-1.32V12.06A5.27,5.27,0,0,1,6,9.53L1.1,13.6l-.75-1L5.78,8.09c0-.25,0-.51,0-.77a12.28,12.28,0,0,1,.09-1.49L.38,1.24l.7-.89,5,4.2C6.48,3,7.17,2.1,8,2.1s1.52,1,1.91,2.57l5-4.21.75,1L10.1,6.07a12.4,12.4,0,0,1,.06,1.24c0,.22,0,.44,0,.65l5.47,4.59-.7.89L10,9.31a8.44,8.44,0,0,1-.35,1.4,3.83,3.83,0,0,1-.55,1.11L9,12v3c.91.22,1.49.72,1.49,1.32C10.46,17.12,9.38,17.75,8,17.75Z"/><path class="cls-2" d="M1.12.71,6.23,5c.33-1.57,1-2.65,1.73-2.65S9.4,3.48,9.72,5.12L14.87.82l.45.57L9.84,6a12.18,12.18,0,0,1,.08,1.35c0,.26,0,.51,0,.76l5.38,4.51-.39.5L9.82,8.84a8.75,8.75,0,0,1-.41,1.78,3.58,3.58,0,0,1-.52,1l-.18.22V15.2c.87.16,1.49.6,1.49,1.11S9.22,17.5,8,17.5,5.78,17,5.78,16.32s.62-1,1.49-1.11V12A5.26,5.26,0,0,1,6.13,9.07l-5,4.18-.45-.57L6,8.2c0-.29,0-.58,0-.89a12,12,0,0,1,.1-1.59L.73,1.21l.39-.5M1,0,.74.39.35.89,0,1.28l.38.32L5.59,5.94a12.64,12.64,0,0,0-.07,1.38c0,.21,0,.43,0,.66L.38,12.28,0,12.6.31,13l.45.57.31.39.38-.32L5.81,10a5.18,5.18,0,0,0,1,2.18V14.8c-.92.27-1.49.84-1.49,1.51C5.3,17.28,6.46,18,8,18s2.7-.72,2.7-1.68c0-.67-.57-1.24-1.49-1.51V12.07L9.29,12a4.06,4.06,0,0,0,.58-1.18,8,8,0,0,0,.28-1l4.42,3.71.38.32.31-.39.39-.5.31-.39-.38-.32L10.39,7.85c0-.17,0-.35,0-.53,0-.37,0-.75-.05-1.13l5.26-4.4L16,1.47l-.31-.39L15.25.5,14.94.11l-.38.32L10,4.23C9.57,2.73,8.83,1.85,8,1.85s-1.57.83-2,2.27L1.42.32,1,0Z"/></g></g></svg>',
            size: [16, 18]
        },
        'hi_perf': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 21" width="15px" height="21px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>hi_perf_live</title><g id="Layer_2" data-name="Layer 2"><g id="Hi_Perf" data-name="Hi Perf"><path class="cls-1" d="M3.14,20.76v-1.6l2.57-1.7V16.1H.26V12.25H1.61v1.17L5.28,9.9c.14-1.16,1-8.19,2-9.3L7.5.38l.2.22c1,1.12,1.89,8.14,2,9.3l3.67,3.52V12.25h1.35V16.1H9.29v1.35l2.57,1.7v1.6Z"/><path class="cls-2" d="M7.5.76c1,1.12,2,9.26,2,9.26l4.17,4V12.5h.84v3.36H9v1.72l2.57,1.7v1.23H3.4V19.28L6,17.58V15.86H.51V12.5h.84V14l4.17-4s1-8.13,2-9.26M7.5,0,7.11.44C6.11,1.58,5.24,8.09,5,9.79l-3.17,3V12H0v4.34H5.45v1L3.11,18.88,2.89,19v2h9.23V19l-.22-.15L9.55,17.32v-1H15V12H13.14v.82L10,9.79C9.76,8.09,8.89,1.58,7.89.44L7.5,0Z"/></g></g></svg>',
            size: [15, 21]
        },
        'jet_nonswept': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18px" height="18px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>jet_nonswept_live</title><g id="Layer_2" data-name="Layer 2"><g id="Bizjet_Non-Swept" data-name="Bizjet Non-Swept"><path class="cls-1" d="M9,17.09l-3.51.61v-.3c0-.65.11-1,.33-1.09L8.5,15a5.61,5.61,0,0,1-.28-1.32l-.53-.41-.1-.69H7.12l0-.21a7.19,7.19,0,0,1-.15-2.19L.24,9.05V8.84c0-1.1.51-1.15.61-1.15L7.8,7.18V2.88C7.8.64,8.89.3,8.93.28L9,.26l.07,0s1.13.36,1.13,2.6v4.3l7,.51c.09,0,.59.06.59,1.15v.21l-6.69,1.16a7.17,7.17,0,0,1-.15,2.19l0,.21h-.47l-.1.69-.53.41A5.61,5.61,0,0,1,9.5,15l2.74,1.28c.2.07.31.43.31,1.08v.3Z"/><path class="cls-2" d="M9,.53s1,.28,1,2.35V7.41l7.19.53h0s.36,0,.36.9L10.78,10a5,5,0,0,1-.1,2.35H10.2l-.12.8-.54.42a4.88,4.88,0,0,1-.35,1.59l2.95,1.38s.16.06.17.85L9,16.84l-3.31.56c0-.79.17-.85.17-.85l2.95-1.38a4.88,4.88,0,0,1-.35-1.59l-.54-.42-.12-.8H7.32A5,5,0,0,1,7.22,10L.49,8.84c0-.88.33-.9.36-.9h0L8,7.41V2.88C8,.81,9,.53,9,.53M9,0,8.87,0c-.13,0-1.31.45-1.31,2.84V6.94L.82,7.43h0c-.24,0-.82.19-.82,1.4v.43l.41.07,6.26,1.08a8.45,8.45,0,0,0,.18,2l.08.41h.47l.05.37,0,.21.16.12.36.28a5.87,5.87,0,0,0,.22,1.05L5.66,16.09c-.39.15-.45.78-.46,1.31V18l.57-.1L9,17.35l3.23.55.57.1v-.6c0-.53-.06-1.16-.49-1.32L9.79,14.9A5.87,5.87,0,0,0,10,13.85l.36-.28.16-.12,0-.21.05-.37h.47l.08-.41a8.45,8.45,0,0,0,.18-2l6.26-1.08L18,9.27V8.84c0-1.34-.71-1.41-.85-1.41l-6.71-.49V2.88C10.44.49,9.27.08,9.13,0L9,0Z"/></g></g></svg>',
            size: [18, 18]
        },
        'jet_swept': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 24" width="18px" height="24" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>jet_swept_live</title><g id="Layer_2" data-name="Layer 2"><g id="Bizjet_Swept" data-name="Bizjet Swept"><path class="cls-1" d="M9.44,23c-.1.6-.35.6-.44.6s-.34,0-.44-.6l-3,.67V22.6A.54.54,0,0,1,6,22.05l2.38-1.12L8,19.33H6.69l0-.2a8.23,8.23,0,0,1-.14-3.85l.06-.18H7.73V13.19h-2L.26,14.29v-.93c0-.28.07-.46.22-.53l7.25-3.6V3.85A4.47,4.47,0,0,1,8.83.49L9,.34l.17.15a4.47,4.47,0,0,1,1.1,3.36V9.23l7.25,3.6c.14.07.22.25.22.53v.93l-5.51-1.1h-2V15.1h1.17l.06.18a8.24,8.24,0,0,1-.15,3.84l0,.2H10l-.36,1.6,2.43,1.14a.52.52,0,0,1,.35.53v1.08Z"/><path class="cls-2" d="M9,.68a4.25,4.25,0,0,1,1,3.16V9.39l7.4,3.67s.07,0,.07.3V14l-5.2-1H10v2.42h1.24a8,8,0,0,1-.15,3.72H9.79l-.45,2L12,22.3a.28.28,0,0,1,.2.3v.76l-3-.66s0,.66-.21.66-.21-.66-.21-.66l-3,.66V22.6a.28.28,0,0,1,.2-.3l2.62-1.23-.45-2H6.9a8,8,0,0,1-.15-3.72H8V12.93H5.71L.52,14v-.62c0-.26.07-.3.07-.3L8,9.39V3.85A4.25,4.25,0,0,1,9,.68M9,0,8.66.3A4.73,4.73,0,0,0,7.47,3.85V9.07L.36,12.6c-.16.08-.36.28-.36.76V14.6l.62-.12,5.15-1h1.7v1.4H6.36l-.11.36a8.49,8.49,0,0,0,.14,4l.09.4H7.79l.27,1.2-2.21,1a.79.79,0,0,0-.53.78V24l.63-.14,2.42-.54c.12.37.33.55.63.55s.51-.19.63-.55l2.42.54.63.14V22.6a.79.79,0,0,0-.53-.78l-2.21-1,.27-1.2h1.31l.09-.4a8.49,8.49,0,0,0,.14-4l-.11-.36H10.53v-1.4h1.7l5.15,1,.62.12V13.36c0-.48-.2-.68-.36-.76L10.53,9.07V3.85A4.73,4.73,0,0,0,9.34.3L9,0Z"/></g></g></svg>',
            size: [18, 24]
        },
        'twin_large': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 20" width="21px" height="20px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>twin_large_live</title><g id="Layer_2" data-name="Layer 2"><g id="Twinprop_Large" data-name="Twinprop Large"><path class="cls-1" d="M10.1,18.34H7l0-.21c-.08-.54,0-.87.11-1L7.19,17l.2,0,2.35-.33c-.16-.82-.42-2.9-.42-3.14s0-2.71,0-3.51H8c-.12,1.34-.41,1.36-.55,1.37h0c-.19,0-.46,0-.6-1.55L.27,9.52l0-.25c.06-.73.31-.9.45-.93l6-.48a3.65,3.65,0,0,1,.3-2,.45.45,0,0,1,.32-.16h0a.39.39,0,0,1,.3.12A3.67,3.67,0,0,1,8,7.77l1.26-.07c0-.71,0-2.92,0-4.48A3.84,3.84,0,0,1,10.1.4a.4.4,0,0,1,.28-.16h.23A.4.4,0,0,1,10.9.4a3.84,3.84,0,0,1,.87,2.81c0,1.55,0,3.77,0,4.48L13,7.77a3.67,3.67,0,0,1,.29-1.94.38.38,0,0,1,.28-.12.46.46,0,0,1,.34.16,3.66,3.66,0,0,1,.3,2l6,.48c.18,0,.43.21.49.94l0,.25-6.53.3c-.14,1.55-.42,1.55-.59,1.55s-.45,0-.57-1.37H11.74c0,.8,0,3.27,0,3.51s-.26,2.32-.42,3.14l2.38.34h.11l.13.13c.15.18.19.51.11,1l0,.21H10.9l-.4,1Z"/><path class="cls-2" d="M10.61.49a3.28,3.28,0,0,1,.91,2.72c0,1.89,0,4.71,0,4.71l1.76.1s-.1-2.08.32-2.08h0c.52,0,.37,2.13.37,2.13l6.22.49s.21.05.26.71l-6.5.3s-.11,1.54-.36,1.54h0c-.25,0-.34-1.37-.34-1.37l-1.78,0s-.05,3.48-.05,3.76A33,33,0,0,1,11,16.84l2.65.37h0s.26,0,.14.89h-3l-.23.58-.23-.58h-3c-.12-.85.1-.89.14-.89h0L10,16.84a33,33,0,0,1-.47-3.35c0-.28-.05-3.76-.05-3.76l-1.78,0s-.09,1.35-.34,1.37h0C7.14,11.13,7,9.58,7,9.58l-6.5-.3c.05-.66.26-.71.26-.71L7,8.08S6.87,6,7.38,5.95h0c.42,0,.32,2.08.32,2.08l1.76-.1s.06-2.82,0-4.71A3.28,3.28,0,0,1,10.39.49h.23m0-.49h-.23a.65.65,0,0,0-.46.23,4.09,4.09,0,0,0-.94,3C9,4.63,9,6.59,9,7.46l-.76,0a2.91,2.91,0,0,0-.37-1.85.64.64,0,0,0-.46-.2.72.72,0,0,0-.52.24A3.24,3.24,0,0,0,6.5,7.63L.76,8.09H.68C.47,8.15.11,8.36,0,9.25l0,.5.51,0,6.06.28c.14,1.29.41,1.56.81,1.56s.67-.28.8-1.37H9c0,1,0,3,0,3.26s.21,2,.38,2.93l-2.09.3a.61.61,0,0,0-.42.21,1.52,1.52,0,0,0-.17,1.24l.06.42H9.93l.11.26L10.5,20,11,18.86l.11-.26h3.12l.06-.42a1.52,1.52,0,0,0-.17-1.24.61.61,0,0,0-.42-.21l-2.09-.3c.17-1,.38-2.72.38-2.93s0-2.29,0-3.26h.84c.13,1.09.4,1.35.76,1.37h0c.44,0,.71-.27.85-1.56l6.06-.28.51,0,0-.5c-.07-.88-.43-1.1-.64-1.15h-.08L14.5,7.63a3.24,3.24,0,0,0-.37-1.93.7.7,0,0,0-.49-.24h0a.65.65,0,0,0-.48.2,2.91,2.91,0,0,0-.37,1.85l-.76,0c0-.87,0-2.83,0-4.24a4.09,4.09,0,0,0-.94-3A.65.65,0,0,0,10.61,0Z"/></g></g></svg>',
            size: [21, 20]
        },
        'twin_small': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19 16" width="19px" height="16px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>twin_small_live</title><g id="Layer_2" data-name="Layer 2"><g id="Twinprop_Small" data-name="Twinprop Small"><path class="cls-1" d="M9.5,15.75c-.21,0-.34-.17-.41-.51l-2.88.23v-.27c0-.78,0-1.11.28-1.13L9,13.1c-.31-1.86-.55-5-.59-5.55l-.08-.09H6.08L.25,6.54v-1A.43.43,0,0,1,.67,5l3.75-.27L5,4.45V3.53H4.73V2.7a.35.35,0,0,1,.34-.35h.07c.12-.52.26-.83.54-.83s.42.31.53.83h.07a.35.35,0,0,1,.34.35v.83H6.36v1l2-.08C8.42.81,9.09.25,9.49.25s1.09.55,1.12,4.21l2,.08v-1h-.25V2.7a.35.35,0,0,1,.34-.35h.07c.12-.52.26-.83.53-.83s.42.31.54.83h.07a.35.35,0,0,1,.34.35v.83H14v.92l.57.32L18.32,5a.42.42,0,0,1,.43.46v1L13,7.46H10.71l-.08.09c0,.56-.27,3.68-.59,5.55l2.46,1c.28,0,.28.35.28,1.13v.27l-2.88-.23C9.84,15.58,9.71,15.75,9.5,15.75Z"/><path class="cls-2" d="M9.51.5c.08,0,.86.11.86,4.2l2.51.1V3.28h-.26V2.7a.1.1,0,0,1,.09-.1H13c.08-.4.2-.83.33-.83s.26.43.34.83h.27a.1.1,0,0,1,.09.1v.57h-.25V4.6h0l.75.42,3.79.28h0c.06,0,.17,0,.17.22v.82l-5.58.89H10.6l-.21.24s-.26,3.8-.63,5.81l2.71,1.05h0s.06.08.06.88L9.7,15s0,.53-.2.53S9.3,15,9.3,15l-2.84.22c0-.8,0-.88.06-.88h0l2.71-1.05c-.36-2-.63-5.81-.63-5.81L8.4,7.21H6.08L.49,6.33V5.51c0-.19.11-.22.17-.22h0L4.49,5l.75-.42V3.28H5V2.7a.1.1,0,0,1,.09-.1h.27c.08-.4.2-.83.34-.83s.25.43.33.83h.27a.1.1,0,0,1,.09.1v.57H6.12V4.8l2.51-.1c0-4.09.78-4.2.86-4.2h0m0-.5h0c-.22,0-.61.14-.9.89a10.72,10.72,0,0,0-.43,3.33l-1.53.06v-.5h.25V2.7a.6.6,0,0,0-.46-.59c-.11-.42-.3-.85-.73-.85s-.63.43-.73.85a.6.6,0,0,0-.46.59V3.78h.25V4.3l-.4.22L.71,4.79h0A.67.67,0,0,0,0,5.51V6.76l.42.07L6,7.71H8.14c.06.8.27,3.44.55,5.22l-2.23.87H6.31L6.17,14c-.16.16-.2.32-.2,1.24v.54l.53,0,2.41-.19a.6.6,0,0,0,1.19,0l2.41.19.53,0v-.54c0-.76,0-1.33-.47-1.38l-2.24-.87c.28-1.78.49-4.42.55-5.22H13l5.58-.89L19,6.76V5.51a.67.67,0,0,0-.67-.72h-.05l-3.63-.27-.4-.22V3.78h.25V2.7a.6.6,0,0,0-.46-.59c-.11-.42-.3-.85-.73-.85s-.62.43-.73.85a.6.6,0,0,0-.46.59V3.78h.25v.5l-1.53-.06C10.81,1.45,10.37,0,9.53,0h0Z"/></g></g></svg>',
            size: [19, 16]
        },
        'unknown': {
            svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17px" height="17px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:aircraft_color_fill;}.cls-2{fill:aircraft_color_stroke;}</style></defs><title>unknown_live</title><g id="Layer_2" data-name="Layer 2"><g id="Unknown"><path class="cls-1" d="M5.25,16.76c-.92,0-1.33-.46-1.39-.86a1,1,0,0,1,.79-1.11c.25-.08,1.22-.43,2.63-1V10.65h-6c-.68,0-1-.35-1-.66a.81.81,0,0,1,.6-.86C1.14,9,4.8,7,7.28,5.63V3c0-1.11.44-2.71,1.23-2.71S9.77,1.84,9.77,3V5.63C12.22,7,15.87,9,16.14,9.13a.8.8,0,0,1,.61.86c-.05.31-.36.67-1.05.67H9.77v3.19l1.61.59,1,.36a1.05,1.05,0,0,1,.8,1.11c-.07.39-.47.86-1.39.86Z"/><path class="cls-2" d="M8.54.48c.55,0,1,1.36,1,2.47V5.77s6.15,3.45,6.53,3.59c.72.25.61,1.06-.36,1.06H9.53V14c1.44.52,2.5.93,2.76,1,1,.36.85,1.5-.52,1.5H5.25c-1.38,0-1.52-1.14-.52-1.5.26-.08,1.33-.47,2.78-1V10.41H1.29c-1,0-1-.81-.36-1.06.4-.13,6.59-3.59,6.59-3.59V3c0-1.11.44-2.47,1-2.47h0m0-.48h0C7.51,0,7,1.76,7,3V5.49C4.69,6.79,1.11,8.77.77,8.9A1,1,0,0,0,0,10a1.15,1.15,0,0,0,1.27.86H7v2.78c-1.3.49-2.23.82-2.45.89a1.29,1.29,0,0,0-1,1.39c.08.49.56,1.05,1.63,1.05h6.51c1.07,0,1.54-.57,1.63-1.05a1.28,1.28,0,0,0-.94-1.38l-1-.36L10,13.67V10.89h5.7A1.16,1.16,0,0,0,17,10a1,1,0,0,0-.77-1.12C15.9,8.77,12.34,6.79,10,5.49V3c0-1.19-.47-3-1.47-3Z"/></g></g></svg>',
            size: [17, 17]
        }
    }
    if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {
        module.exports = {
            shapes: shapes
        };
    } else {
        FAMap.olExtras.Style.iconDefs = {
            shapes: shapes
        };
    }
}
)();
FAMap.olExtras.Style.Aircraft = function(options) {
    var iconDefs = FAMap.olExtras.Style.iconDefs;
    if (typeof options.shape === 'undefined') {
        throw ('Error: no shape specified for Aircraft style!');
    } else if (!(options.shape in iconDefs.shapes)) {
        options.shape = 'unknown';
    }
    if (typeof options.rotation === 'undefined') {
        throw ('Error: no rotation specified for Aircraft style!');
    }
    if (typeof options.scale === 'undefined') {
        options.scale = 1;
    }
    var shape = iconDefs.shapes[options.shape];
    var svg = shape.svg.replace('aircraft_color_fill', options.color.fillColor).replace('aircraft_color_stroke', options.color.strokeColor);
    var src = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
    var rotation = options.rotation;
    return new ol.style.Icon({
        anchor: [0.5, 0.5],
        anchorXUnits: 'fraction',
        anchorYUnits: 'fraction',
        rotateWithView: false,
        rotation: rotation,
        scale: options.scale,
        src: src,
        imgSize: shape.size
    });
}
FAMap.Util.ConfigPresets = new function() {
    var sourcedItems = {
        liveLoop: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        baseLayer: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        initialViewState: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'AnimatedFeatures', 'Defaults']
        },
        defaultViewState: {
            sourceKey: 'initialViewState',
            allowedSources: ['URL', 'RuntimeOptions', 'AnimatedFeatures', 'Defaults']
        },
        overlay_basic_radar: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_arinc_radar: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_arinc_satellite: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_day_night: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_earthcast_world_wsr: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_rad: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_range_rings: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_ifr_endpoints: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_tfrs: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nat_east: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nat_east_pub: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nat_west: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nat_west_pub: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_aireon_flights: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_live_flights: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nearby_flights: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nearby_airports: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_airport_delays: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_static_airport: {
            allowedSources: ['Defaults']
        },
        overlay_arrivals: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_departures: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_flown_route: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_planned_route: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_aircraft: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_related_airports: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_fleet_onground: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_onground_related_dedupe: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_arinc_lastpos: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_arinc_related_dedupe: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_routes: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_flights: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_gbl_se_turb: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nam_se_turb: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_gbl_se_icing: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_nam_se_icing: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_lightning: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_winds_aloft: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_jetstreams: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_fronts: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_volcanic: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_airmets: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_fir_polygons: {
            allowedSources: ['Defaults']
        },
        overlay_sigmets: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_ir_satellite: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        },
        overlay_se_tropical: {
            allowedSources: ['URL', 'RuntimeOptions', 'Persistent', 'Defaults']
        }
    };
    this.defaultSourcedItems = function() {
        return sourcedItems;
    }
    ;
    this.updateOptionsFromDOM = function($containerElement, options) {
        var element = $containerElement[0], layerTypes = {}, domOptions = {}, len, hyphenLowerToUpper = function(match, offset, string) {
            return (match.substring(1)).toUpperCase();
        };
        domOptions.baseLayers = [];
        domOptions.overlays = [];
        if (element.hasAttributes()) {
            var attrs = element.attributes;
            for (var i = attrs.length - 1; i >= 0; i--) {
                var aName = attrs[i].name;
                optCamel = (aName).replace(/-[a-z]/g, hyphenLowerToUpper);
                options[optCamel] = attrs[i].value;
            }
        }
        layerTypes.baseLayers = element.getElementsByTagName('layer-base');
        layerTypes.overlays = element.getElementsByTagName('layer-overlay');
        for (layer in layerTypes) {
            len = layerTypes[layer].length;
            if (len) {
                newLayers = {};
                for (var i = 0; i < len; i++) {
                    lname = layerTypes[layer][i].getAttribute("layer-name");
                    if (lname !== "" && typeof (options[layer][lname]) !== "undefined") {
                        newLayers[lname] = options[layer][lname];
                    }
                }
                options[layer] = newLayers;
            }
        }
        return options;
    }
    this._getLayerConfig = function(type, items) {
        var self = this;
        var config = {};
        if (items == '*') {
            items = Object.keys(this._defs[type]);
        }
        $.each(items, function() {
            var matches = this.match(/^group\.(.*)$/);
            if (matches !== null && matches[1]in self._defs.groups && type in self._defs.groups[matches[1]]) {
                var itemKeys = self._defs.groups[matches[1]][type];
                var newItems = self._getLayerConfig(type, itemKeys);
            } else if (this in self._defs[type]) {
                var newItems = {};
                newItems[this] = self._defs[type][this]
            } else {
                var newItems = false;
            }
            if (newItems) {
                $.extend(config, newItems);
            }
        });
        return config;
    }
    ;
    this.getBaseLayerConfig = function(items) {
        return this._getLayerConfig('baseLayers', items);
    }
    ;
    this.getOverlayConfig = function(items) {
        return this._getLayerConfig('overlays', items);
    }
    ;
    this.getFullConfig = function(name, extra, postProcessor) {
        var baseLayers = [];
        var overlays = [];
        $.each(extra.groups, function() {
            var groupSpec = 'group.' + this;
            baseLayers.push(groupSpec);
            overlays.push(groupSpec);
        });
        baseLayers.push('group.' + name);
        overlays.push('group.' + name);
        if (extra.weatherTrial) {
            overlays.push('group.premiumWx');
        }
        baseLayers = baseLayers.concat(extra.baseLayers || []);
        overlays = overlays.concat(extra.overlays || []);
        var config = {
            baseLayers: this.getBaseLayerConfig(baseLayers),
            overlays: this.getOverlayConfig(overlays),
            defaultOverrides: {},
            fullConfigArgs: $.makeArray(arguments),
            analytics: "Google",
            sourcedItems: sourcedItems
        };
        if (extra.analytics) {
            config.analytics = extra.analytics;
        }
        if (extra.weatherTrial) {
            config.defaultOverrides.overlay_basic_radar = {
                visibility: false
            };
            config.defaultOverrides.overlay_se_rad = {
                visibility: true
            };
            config.defaultOverrides.overlay_se_lightning = {
                visibility: true
            };
        }
        if ('fullsizeMapUrl'in extra) {
            config.fullsizeMapUrl = extra.fullsizeMapUrl;
        }
        if ('defaultExtent'in extra) {
            config.defaultOverrides.initialViewState = {
                type: 'fitExtent',
                extent: extra.defaultExtent
            };
        }
        if (typeof postProcessor == 'undefined') {
            postProcessor = FAMap.Util.ConfigPresets._postProcessors[name];
        }
        if (typeof postProcessor == 'function') {
            config = postProcessor(extra, config);
        }
        if (!extra.FAS) {
            var radarLayers = ['arinc_radar', 'basic_radar'];
            var found = false;
            $.each(radarLayers, function(k, idx) {
                if (!(idx in config.overlays)) {
                    return true;
                }
                if (found) {
                    delete config.overlays[idx];
                } else {
                    config.overlays[idx].name = 'Weather Radar';
                    found = true;
                }
            });
        }
        if (extra.weatherTrial) {
            config.weatherTrial = extra.weatherTrial;
            if (extra.bannerText && extra.bannerText !== "") {
                config.bannerText = extra.bannerText;
            }
            if (extra.bannerNumber) {
                config.bannerNumber = extra.bannerNumber;
            }
        }
        return config;
    }
}
;
FAMap.Util.ConfigPresets._defs = {};
FAMap.Util.ConfigPresets._defs.baseLayers = {
    classic: {
        name: 'Classic',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: 'classic/mobile.2.0.2',
            filetype: 'png',
            attributions: [new ol.Attribution({
                html: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            })]
        }
    },
    aireon_scope: {
        name: 'Aireon Scope',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: 'aireon_scope/aireon_scope.1.0.0',
            filetype: 'png',
            attributions: [new ol.Attribution({
                html: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            })]
        }
    },
    earthview: {
        name: 'Earth View',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: 'mobileearth',
            filetype: 'jpeg'
        }
    },
    sectional: {
        name: 'Aviation Sectional',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: 'mobilesectional',
            filetype: 'jpeg'
        }
    },
    ifr_high: {
        name: 'IFR High En Route',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: 'mobileifrhigh',
            filetype: 'jpeg'
        }
    },
    ifr_low: {
        name: 'IFR Low En Route',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: 'mobileifrlow',
            filetype: 'jpeg'
        }
    },
    skyvector_vfr: {
        name: 'World VFR',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: '301',
            filetype: 'jpg'
        }
    },
    skyvector_ifr_low: {
        name: 'Low Enroute',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: '302',
            filetype: 'jpg'
        }
    },
    skyvector_ifr_high: {
        name: 'High Enroute',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.FA_XYZ,
        sourceOpts: {
            dirname: '304',
            filetype: 'jpg'
        }
    },
    premium_sat_boundaries: {
        _buildLayer: function() {
            var layer = new ol.layer.Group({
                layers: [new ol.layer.Tile({
                    source: new FAMap.olExtras.Source.DigitalGlobe({
                        key: 'DigitalGlobe:ImageryTileService',
                        token: 'c2fffbe4-4f8b-4bc8-8f46-63f6aa7e95c5'
                    })
                }), new ol.layer.Tile({
                    source: new FAMap.olExtras.Source.Mapbox({
                        key: 'digitalglobe.nakolk5j',
                        token: 'pk.eyJ1IjoiZGlnaXRhbGdsb2JlIiwiYSI6ImNqeGFvN3V2NDE4dDEzeGxtN21ycHR3cjIifQ.Ngz8X_A2Xb-YtRtALaYVWg'
                    })
                })]
            });
            layer.getSource = function() {
                return {
                    minZoom: 2,
                    maxZoom: 20
                }
            }
            layer.minZoom = 2;
            layer.maxZoom = 20;
            layer.name = 'Satellite - with boundaries';
            layer.idx = 'premium_sat_boundaries';
            return layer;
        }
    },
    premium_sat: {
        name: 'Satellite',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.DigitalGlobe,
        sourceOpts: {
            key: 'DigitalGlobe:ImageryTileService',
            token: 'c2fffbe4-4f8b-4bc8-8f46-63f6aa7e95c5'
        }
    },
    premium_terrain: {
        name: 'Terrain',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.DigitalGlobe,
        sourceOpts: {
            key: 'Digitalglobe:TerrainTMSTileService',
            token: 'c2fffbe4-4f8b-4bc8-8f46-63f6aa7e95c5'
        }
    },
    premium_streets: {
        name: 'Streets',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.DigitalGlobe,
        sourceOpts: {
            key: 'Digitalglobe:OSMTMSTileService',
            token: 'c2fffbe4-4f8b-4bc8-8f46-63f6aa7e95c5'
        }
    },
    premium_country_names: {
        name: 'Country Names',
        layerClass: ol.layer.Tile,
        sourceClass: FAMap.olExtras.Source.Mapbox,
        sourceOpts: {
            key: 'digitalglobe.nakolk5j',
            token: 'pk.eyJ1IjoiZGlnaXRhbGdsb2JlIiwiYSI6ImNqeGFvN3V2NDE4dDEzeGxtN21ycHR3cjIifQ.Ngz8X_A2Xb-YtRtALaYVWg'
        }
    }
}
FAMap.Util.ConfigPresets._defs.groups = {
    anonUsers: {
        baseLayers: ['classic', 'earthview'],
        overlays: ['day_night', 'basic_radar', 'tfrs', 'nearby_airports', 'nearby_flights', 'live_flights', 'aireon_flights', 'fir_polygons']
    },
    registeredUsers: {
        baseLayers: ['premium_sat_boundaries', 'premium_sat', 'premium_terrain', 'premium_streets']
    },
    aireonSalesTool: {
        baseLayers: ['classic', 'earthview', 'aireon_scope'],
        overlays: ['aireon_flights', 'nearby_flights', 'fir_polygons']
    },
    earthcastUsers: {
        overlays: ['earthcast_world_wsr']
    },
    premiumUsers: {
        overlays: ['sigmets', 'airmets']
    },
    enterpriseUsers: {
        overlays: ['range_rings']
    },
    skyvector: {
        baseLayers: ['skyvector_vfr', 'skyvector_ifr_low', 'skyvector_ifr_high']
    },
    aviationCharts: {
        baseLayers: ['sectional', 'ifr_high', 'ifr_low']
    },
    arinc: {
        overlays: ['arinc_satellite', 'arinc_radar', 'se_tropical']
    },
    premiumWx: {
        overlays: ['se_rad', 'se_ir_satellite', 'gbl_se_turb', 'nam_se_turb', 'gbl_se_icing', 'nam_se_icing', 'se_lightning', 'se_winds_aloft', 'se_jetstreams', 'se_fronts', 'se_volcanic', 'se_tropical']
    },
    NAT: {
        overlays: ['nat_east', 'nat_west', ]
    },
    NAT_staff: {
        overlays: ['nat_east_pub', 'nat_west_pub']
    },
    onground: {
        overlays: ['fleet_onground', 'onground_related_dedupe']
    },
    airport: {
        overlays: ['static_airport', 'arrivals', 'departures']
    },
    airport_iframe: {
        overlays: ['static_airport', 'arrivals', 'departures']
    },
    delays: {
        overlays: ['basic_radar', 'airport_delays']
    },
    flight: {
        overlays: ['planned_route', 'flown_route', 'aircraft']
    },
    flex: {
        overlays: ['related_airports', 'flights']
    },
    ifr_routes: {
        overlays: ['ifr_endpoints', 'flights']
    },
    country_names: {
        baseLayers: ['premium_country_names']
    },
    jetblue: {
        baseLayers: ['classic'],
        overlays: ['day_night', 'basic_radar']
    },
}
FAMap.Util.ConfigPresets._defs.overlays = {
    basic_radar: {
        name: 'Weather Radar (Basic)',
        layerClass: FAMap.olExtras.Layer.TimeSeries,
        enableTimeSeriesAnimation: true,
        analytics: {
            interface: "FA_Snap"
        },
        layerOpts: {
            opacity: 0.5,
            timeSeriesNFrames: 4,
            framePeriod: 600,
            sourceClass: FAMap.olExtras.Source.FAWx,
            sourceOpts: {
                params: {
                    LAYERS: 'basic_radar'
                }
            }
        },
        uiGroup: 'weather'
    },
    arinc_radar: {
        name: 'Weather Radar (ARINC)',
        layerClass: FAMap.olExtras.Layer.TimeSeries,
        enableTimeSeriesAnimation: true,
        analytics: {
            interface: "FA_Snap"
        },
        layerOpts: {
            opacity: 0.5,
            timeSeriesNFrames: 4,
            framePeriod: 600,
            sourceClass: FAMap.olExtras.Source.FAWx,
            sourceOpts: {
                params: {
                    LAYERS: 'arinc_radar'
                }
            }
        },
        uiGroup: 'weather'
    },
    arinc_satellite: {
        name: 'Satellite IR',
        layerClass: FAMap.olExtras.Layer.TimeSeries,
        enableTimeSeriesAnimation: true,
        layerOpts: {
            opacity: 0.5,
            timeSeriesNFrames: 4,
            framePeriod: 600,
            sourceClass: FAMap.olExtras.Source.FAWx,
            sourceOpts: {
                params: {
                    LAYERS: 'arinc_satellite'
                }
            }
        },
        uiGroup: 'weather'
    },
    day_night: {
        name: 'Sunlit Earth',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.DayNightTerminator,
        uiGroup: 'weather'
    },
    earthcast_world_wsr: {
        name: 'Worldwide Weather',
        layerClass: FAMap.olExtras.Layer.TimeSeries,
        enableTimeSeriesAnimation: true,
        analytics: {
            interface: "FA_Snap"
        },
        layerOpts: {
            opacity: 0.5,
            timeSeriesNFrames: 4,
            framePeriod: 600,
            sourceClass: FAMap.olExtras.Source.FAWx,
            sourceOpts: {
                params: {
                    LAYERS: 'earthcast_world_wsr',
                    DTN: (typeof user === "object") ? (user.dtnGlobal || 0) : 0
                },
                attributions: [new ol.Attribution({
                    html: 'Worldwide weather: ' + (typeof user === "object" && ((user.dtnGlobal || 0) == 1) ? "DTN" : "Earthcast")
                })]
            }
        },
        uiGroup: 'weather'
    },
    se_rad: {
        name: 'Weather Radar (Premium)',
        layerClass: FAMap.olExtras.Layer.TimeSeries,
        enableTimeSeriesAnimation: false,
        analytics: {
            interface: "FA_Snap"
        },
        layerOpts: {
            opacity: 0.5,
            timeSeriesNFrames: 1,
            framePeriod: 600,
            sourceClass: FAMap.olExtras.Source.DTN,
            sourceOpts: {
                params: {
                    LAYERS: 'RADAR_US_CURRENT,RADAR_CN_CURRENT,RADAR_AU_CURRENT,RADAR_EU_CURRENT'
                }
            }
        },
        onBuildLayerComplete: function(layerDef, map) {
            var maxAge = 175;
            var checkAndSetTimes = $.proxy(function(times) {
                if (times === null) {
                    var ageString = '_CURRENT';
                } else {
                    var now = FAMap.Util.getNow();
                    var age = Math.ceil((now - times.midpoint) / 300) * 5;
                    if (age > 175) {
                        if (now - (maxAge * 60) > times.end) {
                            return false;
                        } else {
                            age = maxAge;
                        }
                    }
                    var ageString = '-' + age + 'MIN';
                }
                var params = this.getSource().getParams();
                var layerNames = params.LAYERS.split(',');
                $.each(layerNames, function(k, v) {
                    var layerKey = v.substr(0, 8);
                    layerNames[k] = layerKey + ageString;
                });
                params.LAYERS = layerNames.join(',');
                this.getSource().updateParams(params);
            }, this);
            map.on('validTimesUpdate', function(e, times) {
                checkAndSetTimes(times);
            });
            if (map._validTimes !== null) {
                return checkAndSetTimes(map._validTimes);
            }
        },
        uiGroup: 'premiumWeather'
    },
    se_ir_satellite: {
        name: 'Satellite IR',
        layerClass: ol.layer.Tile,
        layerOpts: {
            opacity: 0.7,
        },
        sourceClass: FAMap.olExtras.Source.DTN,
        sourceOpts: {
            params: {
                LAYERS: 'INFRAREDSAT_N1_CURRENT,INFRAREDSAT_N2_CURRENT,INFRAREDSAT_N3_CURRENT,INFRAREDSAT_N4_CURRENT,INFRAREDSAT_N5_CURRENT,INFRAREDSAT_S1_CURRENT,INFRAREDSAT_S2_CURRENT,INFRAREDSAT_S3_CURRENT,INFRAREDSAT_S4_CURRENT,INFRAREDSAT_S5_CURRENT'
            }
        },
        onBuildLayerComplete: function(layerDef, map) {
            if (map._validTimes !== null) {
                return false;
            }
        },
        uiGroup: 'premiumWeather'
    },
    range_rings: {
        name: 'Range Rings',
        layerClass: ol.layer.Vector,
        layerOpts: {
            ui: {
                options: [{
                    type: 'text',
                    label: 'Spacing (nmi)',
                    name: 'spacing',
                    defaultVal: 7,
                    validate: function(val) {
                        var num = Number(val);
                        return !isNaN(num);
                    },
                    validateErrorText: 'Must be a number'
                }, {
                    type: 'text',
                    label: '# of Rings',
                    name: 'number',
                    defaultVal: 3,
                    validate: function(val) {
                        var num = Number(val);
                        return !isNaN(num) && num < 50;
                    },
                    validateErrorText: 'Must be a number less than 50'
                }, {
                    type: 'text',
                    label: 'Center Lat',
                    name: 'centerLat',
                    defaultVal: 0,
                    validate: function(val) {
                        var num = Number(val);
                        return !isNaN(num) && num >= -90 && num <= 90;
                    },
                    validateErrorText: 'Must be a number between -90 and 90'
                }, {
                    type: 'text',
                    label: 'Center Lon',
                    name: 'centerLon',
                    defaultVal: 0,
                    validate: function(val) {
                        var num = Number(val);
                        return !isNaN(num) && num >= -180 && num <= 180;
                    },
                    validateErrorText: 'Must be a number between -180 and 180'
                }, {
                    type: 'button',
                    text: 'Use current map center',
                    onClick: function() {
                        var source = this.getSource();
                        var params = source.ringParams;
                        params.center = source.FAMap._olMap.getView().getCenter();
                        source.update(params, true);
                        source.set('updated', new Date().getTime());
                    }
                }],
                onUiChange: function($form) {
                    var lon = Number($form.find('[name=centerLon]').val());
                    var lat = Number($form.find('[name=centerLat]').val());
                    var center = ol.proj.fromLonLat([lon, lat]);
                    var params = {
                        center: center,
                        count: Number($form.find('[name=number]').val()),
                        spacing: Number($form.find('[name=spacing]').val())
                    };
                    this.getSource().update(params, true);
                },
                onUiUpdateRequired: function($form) {
                    var params = this.getSource().ringParams;
                    var coord = ol.proj.toLonLat(params.center);
                    var pFactor = 10000
                    var lon = Math.round(coord[0] * pFactor) / pFactor;
                    var lat = Math.round(coord[1] * pFactor) / pFactor;
                    $form.find('[name=centerLon]').val(lon);
                    $form.find('[name=centerLat]').val(lat);
                    $form.find('[name=number]').val(params.count);
                    $form.find('[name=spacing]').val(params.spacing);
                }
            }
        },
        sourceClass: FAMap.olExtras.Source.RangeRings,
        onBuildLayerComplete: function(layerDef, map) {
            var layer = this;
            var source = layer.getSource();
            source.on('change:updated', function() {
                layer.set('uiUpdated', new Date().getTime());
            });
            source.on('change:persisted', function() {
                map.persistentStores.Overlays.setItem(layer.idx + '.ringParams', this.ringParams);
            });
            var overlayState = map._configHandler.get('overlay_' + layer.idx);
            if (overlayState !== false && 'ringParams'in overlayState.value) {
                if (source.loaded) {
                    source.update(overlayState.value.ringParams);
                    source.set('updated', new Date().getTime());
                } else {
                    source.ringParams = overlayState.value.ringParams;
                }
            }
        },
        uiGroup: 'flights'
    },
    tfrs: {
        name: 'TFRs',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.TFRs,
        eventHandlers: {
            mouseIn: function(e, feature) {
                var element = document.createElement('div');
                element.className = 'tfrs-popup';
                element.innerHTML = feature.get('popup');
                feature.popup = new ol.Overlay({
                    element: element
                });
                var extent = feature.getGeometry().getExtent();
                var coordinate = [extent[2], extent[1]];
                feature.popup.setPosition(coordinate);
                if ('tfrPopups'in this) {
                    this.tfrPopups.forEach(function(popup) {
                        e.FAMap._olMap.removeOverlay(popup);
                    });
                    this.tfrPopups.unshift(feature.popup);
                } else {
                    this.tfrPopups = [feature.popup];
                }
                e.FAMap._olMap.addOverlay(feature.popup);
            },
            mouseOut: function(e, feature) {
                e.FAMap._olMap.removeOverlay(feature.popup);
                this.tfrPopups.splice(this.tfrPopups.indexOf(feature.popup), 1);
                if (typeof this.tfrPopups[0] !== 'undefined') {
                    e.FAMap._olMap.addOverlay(this.tfrPopups[0]);
                }
            },
            click: function(e, feature) {
                var url = feature.get('url');
                window.open(url);
            },
            updateTimes: function(times) {
                var source = new FAMap.olExtras.Source.TFRs(null,{
                    times: times
                });
                this.setSource(source);
            }
        },
        onBuildLayerComplete: function(layerDef, map) {
            if (map._validTimes !== null) {
                this.eventHandlers.updateTimes.call(this, map._validTimes);
            }
            map.on('validTimesUpdate', $.proxy(function(e, times) {
                this.eventHandlers.updateTimes.call(this, times);
            }, this));
        },
        uiGroup: 'flights'
    },
    nat_east: {
        name: 'NAT East 01Z-08Z',
        layerClass: ol.layer.Vector,
        sourceClass: ol.source.Vector,
        sourceOpts: {
            format: new ol.format.GeoJSON(),
            url: 'https://ko.flightaware.com/ajax/trackroute.rvt?direction=east&clock='
        },
        uiGroup: 'flights'
    },
    nat_east_pub: {
        name: 'NAT East 01Z-08Z Pub',
        layerClass: ol.layer.Vector,
        sourceClass: ol.source.Vector,
        sourceOpts: {
            format: new ol.format.GeoJSON(),
            url: "https://ko.flightaware.com/ajax/trackroute.rvt?direction=east&type=public&clock="
        },
        uiGroup: 'flights'
    },
    nat_west: {
        name: 'NAT West 1130Z-19Z',
        layerClass: ol.layer.Vector,
        sourceClass: ol.source.Vector,
        sourceOpts: {
            format: new ol.format.GeoJSON(),
            url: 'https://ko.flightaware.com/ajax/trackroute.rvt?direction=west&clock='
        },
        uiGroup: 'flights'
    },
    nat_west_pub: {
        name: 'NAT West 1130Z-19Z Pub',
        layerClass: ol.layer.Vector,
        sourceClass: ol.source.Vector,
        sourceOpts: {
            format: new ol.format.GeoJSON(),
            url: "https://ko.flightaware.com/ajax/trackroute.rvt?direction=west&type=public&clock="
        },
        uiGroup: 'flights'
    },
    fir_polygons: function() {
        return {
            name: "FIRs",
            layerClass: FAMap.olExtras.Layer.ToggledVector,
            layerOpts: {
                toggleFieldName: 'name',
            },
            eventHandlers: {
                mouseMove: function(e, feature) {
                    e.FAMap.inspectInfoPopup.setPosition(e.coordinate[1], e.coordinate[0]);
                    e.FAMap.inspectInfoPopup.showPopup();
                },
                mouseIn: function(e, feature, layer) {
                    var code = feature.get('code'), descrip = feature.get('description'), style = this.getStyle(), shadow = "text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;", color;
                    this._mouseIn = typeof (this._mouseIn) === "undefined" ? [] : this._mouseIn;
                    if (typeof (style) === "function") {
                        style = (style(feature))[0];
                    }
                    if (feature.getGeometry().getType() === "Point") {
                        color = style.getImage().getStroke().getColor();
                    } else {
                        color = style.getStroke().getColor();
                    }
                    e.FAMap.inspectInfoPopup.addContent(feature, "<span style=\"color:" + color + ";" + shadow + "\"> " + descrip + " - " + code + "</span>");
                },
                mouseOut: function(e, feature, layer) {
                    var code = feature.get('code')
                      , descrip = feature.get('description');
                    this._mouseIn = typeof (this._mouseIn) === "undefined" ? [] : this._mouseIn;
                    e.FAMap.inspectInfoPopup.removeContent(feature);
                }
            },
            sourceClass: FAMap.olExtras.Source.FIRs,
            sourceOpts: {
                type: ""
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
                var layer = this
                  , configHandler = layerDef.layerOpts.FAMap._configHandler.get('overlay_' + layer.idx);
                this.persistShowing = (function(toggledLayer, faMap) {
                    return function() {
                        faMap.persistentStores.Overlays.setItem(toggledLayer.idx + ".showing", toggledLayer.getShowing());
                    }
                }
                )(layer, layerDef.layerOpts.FAMap);
                if (typeof (configHandler.value) !== "undefined" && 'showing'in configHandler.value) {
                    layer.updateShowing(configHandler.value.showing, true);
                    layer.set('uiUpdated', new Date().getTime());
                }
                this.on("change:visible", (function(theLayer) {
                    return function() {
                        var isVisible = theLayer.getVisible();
                    }
                }
                )(this));
                layerDef.layerOpts.FAMap.on('fir:featuresLoaded', layer.updateShowing.bind(layer, null, false));
            },
            excludeFromUi: true
        }
    },
    aireon_flights: {
        name: 'Aireon Flights',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.VicinityAircraft,
        eventHandlers: {
            mouseIn: function(e, feature) {
                if ('highlightedFeatures'in this) {
                    $.each(this.highlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                    });
                }
                this.highlightedFeatures = [feature];
                var style = e.FAMap._getOverlayStyle('aireon_flights', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
            },
            mouseOut: function(e, feature) {
                if ('highlightedFeatures'in this) {
                    $.each(this.highlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                    });
                }
            }
        },
        excludeFromUi: true
    },
    live_flights: {
        name: 'Live Flights',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.VicinityAircraftDeclutter,
        eventHandlers: {
            mouseIn: function(e, feature) {
                if ('highlightedFeatures'in this) {
                    $.each(this.highlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                    });
                }
                this.highlightedFeatures = [feature];
                var style = e.FAMap._getOverlayStyle('live_flights', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
            },
            click: function(e, feature) {
                var url = '/live/flight/' + feature.get('ident');
                window.open(url);
            }
        },
        excludeFromUi: true,
        uiGroup: 'flights'
    },
    nearby_flights: {
        name: 'Nearby Flights',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.VicinityAircraftDeclutter,
        eventHandlers: {
            mouseIn: function(e, feature) {
                if ('highlightedFeatures'in this) {
                    $.each(this.highlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                    });
                }
                this.highlightedFeatures = [feature];
                var style = e.FAMap._getOverlayStyle('nearby_flights', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
            },
            click: function(e, feature) {
                var url = '/live/flight/' + feature.get('ident');
                window.open(url);
            }
        },
        uiGroup: 'flights'
    },
    nearby_airports: {
        name: 'Nearby Airports',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.AirportsDeclutter,
        sourceOpts: {
            url: 'https://ko.flightaware.com/ajax/ignoreall/vicinity_airports.rvt'
        },
        eventHandlers: {
            mouseIn: function(e, feature) {
                var style = e.FAMap._getOverlayStyle('nearby_airports', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
            },
            mouseOut: function(e, feature) {
                feature.setStyle(null);
            },
            click: function(e, feature) {
                var url = 'https://ko.flightaware.com/live/airport/' + feature.get('code');
                window.open(url);
            }
        },
        uiGroup: 'flights'
    },
    airport_delays: {
        name: 'Airport Delays',
        layerClass: ol.layer.Vector,
        sourceClass: ol.source.Cluster,
        sourceOpts: function() {
            return {
                source: new ol.source.Vector({
                    format: new ol.format.GeoJSON(),
                    url: 'https://ko.flightaware.com/ajax/ignoreall/airport_delays.rvt'
                }),
                distance: 10
            };
        },
        eventHandlers: {
            mouseIn: function(e, feature) {
                var style = e.FAMap._getOverlayStyle('airport_delays', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
            },
            mouseOut: function(e, feature) {
                feature.setStyle(null);
            },
            click: function(e, feature) {
                var extent = feature.getGeometry().getExtent();
                var coordinate = [extent[2], extent[1]];
                if (typeof e.FAMap._delayPopup !== 'undefined') {
                    e.FAMap._olMap.removeOverlay(e.FAMap._delayPopup);
                }
                var clusterFeatures = feature.get('features');
                var popupOpts = [];
                if (clusterFeatures == undefined) {
                    popoupOpts.push({
                        code: feature.get('label'),
                        name: feature.get('fullName'),
                        info: feature.get('delayInfo'),
                        weather: feature.get('weather')
                    });
                } else if (clusterFeatures.length == 1) {
                    popupOpts.push({
                        code: clusterFeatures[0].get('label'),
                        name: clusterFeatures[0].get('fullName'),
                        info: clusterFeatures[0].get('delayInfo'),
                        weather: clusterFeatures[0].get('weather')
                    });
                } else {
                    $.each(clusterFeatures, function(k, feat) {
                        popupOpts.push({
                            code: feat.get('label'),
                            name: feat.get('fullName'),
                            info: feat.get('delayInfo'),
                            weather: feat.get('weather'),
                            selected: feat === feature.displayFeature
                        });
                    });
                }
                e.FAMap._delayPopup = new FAMap.olExtras.Overlay.DelayPopup(coordinate,popupOpts);
                e.FAMap._olMap.addOverlay(e.FAMap._delayPopup);
                e.FAMap._delayPopup.setPosition(coordinate);
                $(".delays-close-button").on('click', function() {
                    e.FAMap._olMap.removeOverlay(e.FAMap._delayPopup);
                    return false;
                });
            }
        },
        uiGroup: 'flights'
    },
    static_airport: {
        name: 'Airport',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.StaticAirports,
        excludeFromUi: true
    },
    arrivals: {
        name: 'Arrivals',
        layerClass: ol.layer.Vector,
        eventHandlers: {
            mouseIn: function(e, feature) {
                if (feature.get('featureSet') !== 'Plane') {
                    return;
                }
                if ('_airportHighlightedFeatures'in e.FAMap) {
                    $.each(e.FAMap._airportHighlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                        if ('routeFeature'in feature) {
                            feature.routeFeature.setStyle(null);
                        }
                    });
                }
                e.FAMap._airportHighlightedFeatures = [feature];
                var style = e.FAMap._getOverlayStyle('arrivals', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
                if ('routeFeature'in feature) {
                    feature.routeFeature.setStyle(style);
                }
                if (!('_airportMouseOutAttached'in e.FAMap)) {
                    e.FAMap.on('activeStateChange', $.proxy(function(e1, state) {
                        if (state !== 'active' && '_airportHighlightedFeatures'in e.FAMap) {
                            $.each(e.FAMap._airportHighlightedFeatures, function() {
                                var feature = this;
                                feature.setStyle(null);
                                if ('routeFeature'in feature) {
                                    feature.routeFeature.setStyle(null);
                                }
                            });
                            e.FAMap._airportHighlightedFeatures = [];
                        }
                    }, this));
                    this.mouseOutAttached = true;
                }
            },
            click: function(e, feature) {
                if (feature.get('featureSet') !== 'Plane') {
                    return;
                }
                var ident = feature.get('ident');
                var url = '/live/flight/' + ident;
                window.open(url);
            }
        },
        sourceClass: FAMap.olExtras.Source.Animated,
        sourceOpts: {
            features: ['PlaneRoute', 'Trail']
        },
        cycleText: true,
        uiGroup: 'flights'
    },
    departures: {
        name: 'Departures',
        layerClass: ol.layer.Vector,
        eventHandlers: {
            mouseIn: function(e, feature) {
                if (feature.get('featureSet') !== 'Plane') {
                    return;
                }
                if ('_airportHighlightedFeatures'in e.FAMap) {
                    $.each(e.FAMap._airportHighlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                        if ('routeFeature'in feature) {
                            feature.routeFeature.setStyle(null);
                        }
                    });
                }
                e.FAMap._airportHighlightedFeatures = [feature];
                var style = e.FAMap._getOverlayStyle('departures', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
                if ('routeFeature'in feature) {
                    feature.routeFeature.setStyle(style);
                }
                if (!('_airportMouseOutAttached'in e.FAMap)) {
                    e.FAMap.on('activeStateChange', $.proxy(function(e1, state) {
                        if (state !== 'active' && '_airportHighlightedFeatures'in e.FAMap) {
                            $.each(e.FAMap._airportHighlightedFeatures, function() {
                                var feature = this;
                                feature.setStyle(null);
                                if ('routeFeature'in feature) {
                                    feature.routeFeature.setStyle(null);
                                }
                            });
                            e.FAMap._airportHighlightedFeatures = [];
                        }
                    }, this));
                    this.mouseOutAttached = true;
                }
            },
            click: function(e, feature) {
                if (feature.get('featureSet') !== 'Plane') {
                    return;
                }
                var ident = feature.get('ident');
                var url = '/live/flight/' + ident;
                window.open(url);
            }
        },
        sourceClass: FAMap.olExtras.Source.Animated,
        sourceOpts: {
            features: ['PlaneRoute', 'Trail']
        },
        cycleText: true,
        uiGroup: 'flights'
    },
    flown_route: {
        name: 'Flown Route',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.Animated,
        sourceOpts: {
            features: ['Endpoints', 'Track']
        },
        eventHandlers: {
            click: function(e, feature) {
                if (feature.get('featureSet') !== 'Endpoints') {
                    return;
                }
                if (feature.get('icao') === null) {
                    return;
                }
                var url = '/live/airport/' + feature.get('icao');
                window.open(url);
            }
        },
        uiGroup: 'flights'
    },
    planned_route: {
        name: 'Planned Route',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.Animated,
        sourceOpts: {
            features: ['FlightRoute']
        },
        uiGroup: 'flights'
    },
    aircraft: {
        name: 'Aircraft',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.Animated,
        sourceOpts: {
            features: ['Shadow', 'Plane']
        },
        uiGroup: 'flights'
    },
    related_airports: {
        name: 'Related Airports',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.FlexEndpoints,
        eventHandlers: {
            mouseIn: function(e, feature) {
                var style = e.FAMap._getOverlayStyle('related_airports', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
            },
            mouseOut: function(e, feature) {
                feature.setStyle(null);
            },
            click: function(e, feature) {
                var children = feature.get('features');
                if (typeof children !== 'undefined' && children.length > 0) {
                    feature = children[0];
                }
                if (feature.get('icao') === null) {
                    return;
                }
                var url = 'https://ko.flightaware.com/live/airport/' + feature.get('icao');
                window.open(url);
            }
        },
        uiGroup: 'flights'
    },
    fleet_onground: {
        name: 'On Ground',
        layerClass: ol.layer.Vector,
        sourceClass: ol.source.Vector,
        sourceOpts: {
            format: new ol.format.GeoJSON(),
            url: 'https://ko.flightaware.com/ajax/fleet_onground.rvt'
        },
        eventHandlers: {
            mouseIn: function(e, feature) {
                var style = e.FAMap._getOverlayStyle('related_airports', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
            },
            mouseOut: function(e, feature) {
                feature.setStyle(null);
            }
        },
        uiGroup: 'flights'
    },
    onground_related_dedupe: {
        name: 'OR Dedupe',
        layerClass: FAMap.olExtras.Layer.Dedupe,
        layerOpts: {
            childLayers: ['fleet_onground', 'related_airports']
        },
        cycleText: true,
        excludeFromUi: true
    },
    flights: {
        name: 'Flights',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.Animated,
        sourceOpts: {
            features: ['PlaneRoute', 'Trail']
        },
        eventHandlers: {
            mouseIn: function(e, feature) {
                if (feature.get('featureSet') !== 'Plane') {
                    return;
                }
                if ('_airportHighlightedFeatures'in e.FAMap) {
                    $.each(e.FAMap._airportHighlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                        if ('routeFeature'in feature) {
                            feature.routeFeature.setStyle(null);
                        }
                    });
                }
                e.FAMap._airportHighlightedFeatures = [feature];
                var style = e.FAMap._getOverlayStyle('flights', e.FAMap._currentBaseLayerIdx, 'highlight');
                feature.setStyle(style);
                if ('routeFeature'in feature) {
                    feature.routeFeature.setStyle(style);
                }
                if (!('_airportMouseOutAttached'in e.FAMap)) {
                    e.FAMap.on('activeStateChange', $.proxy(function(e1, state) {
                        if (state !== 'active' && '_airportHighlightedFeatures'in e.FAMap) {
                            $.each(e.FAMap._airportHighlightedFeatures, function() {
                                var feature = this;
                                feature.setStyle(null);
                                if ('routeFeature'in feature) {
                                    feature.routeFeature.setStyle(null);
                                }
                            });
                            e.FAMap._airportHighlightedFeatures = [];
                        }
                    }, this));
                    this.mouseOutAttached = true;
                }
            },
            click: function(e, feature) {
                if (feature.get('featureSet') !== 'Plane') {
                    return;
                }
                var ident = feature.get('ident');
                var url = '/live/flight/' + ident;
                window.open(url);
            }
        },
        cycleText: true,
        uiGroup: 'flights'
    },
    arinc_lastpos: {
        name: 'ARINC LP',
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.ADLastPositions,
        eventHandlers: {
            mouseIn: function(e, feature) {
                if ('_ADHighlightedFeatures'in e.FAMap) {
                    $.each(e.FAMap._ADHighlightedFeatures, function() {
                        var feature = this;
                        feature.setStyle(null);
                    });
                }
                e.FAMap._ADHighlightedFeatures = [feature];
                var featureStyle = e.FAMap._getOverlayStyle('arinc_lastpos', e.FAMap._currentBaseLayerIdx);
                feature.setStyle(featureStyle.call(this, feature, null, true)[0]);
                var layerStyle = e.FAMap._getOverlayStyle('arinc_lastpos', e.FAMap._currentBaseLayerIdx, 'unhighlight');
                this.setStyle(layerStyle);
                if ('dedupeLayer'in e) {
                    e.dedupeLayer.setStyle(layerStyle);
                }
            },
            mouseOut: function(e, feature) {
                feature.setStyle(null);
                var layerStyle = e.FAMap._getOverlayStyle('arinc_lastpos', e.FAMap._currentBaseLayerIdx, 'highlight');
                this.setStyle(layerStyle);
                if ('dedupeLayer'in e) {
                    e.dedupeLayer.setStyle(layerStyle);
                }
            }
        },
        excludeFromUi: true
    },
    arinc_related_dedupe: {
        name: 'ADR Dedupe',
        layerClass: FAMap.olExtras.Layer.Dedupe,
        layerOpts: {
            childLayers: ['arinc_lastpos', 'related_airports']
        },
        cycleText: true,
        excludeFromUi: true
    },
    ifr_endpoints: {
        name: "IFR Endpoints",
        layerClass: ol.layer.Vector,
        sourceClass: FAMap.olExtras.Source.StaticAirports,
        excludeFromUi: true
    },
    gbl_se_turb: function() {
        var flightlevels = ['050', '100', '125', '180', '240', '270', '300', '320', '340', '370', '390', '450', '530'];
        var forecastPeriods = {
            'Current': 'CURRENT',
            '3 hr': '03HR',
            '6 hr': '06HR',
            '9 hr': '09HR',
            '12 hr': '12HR',
            '15 hr': '15HR',
            '18 hr': '18HR',
            '21 hr': '21HR',
            '24 hr': '24HR'
        };
        var sourceHash = {};
        $.each(flightlevels, function() {
            var flightlevel = this;
            $.each(forecastPeriods, function() {
                var period = this;
                var wxLayer = 'GBL_TURB_FL' + flightlevel + '_FCST_' + period;
                sourceHash[wxLayer] = {
                    sourceClass: FAMap.olExtras.Source.DTN,
                    sourceOpts: {
                        params: {
                            LAYERS: wxLayer
                        }
                    }
                };
            });
        });
        return {
            name: 'Turbulence (Global)',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 0.7,
                sources: sourceHash,
                defaultSourceKey: 'GBL_TURB_FL300_FCST_CURRENT',
                ui: {
                    options: [{
                        label: 'Flight Level',
                        name: 'flightLevel',
                        type: 'select',
                        values: flightlevels,
                        defaultVal: '300'
                    }, {
                        label: 'Forecast',
                        name: 'forecastPeriod',
                        type: 'select',
                        values: forecastPeriods,
                        defaultVal: 'CURRENT'
                    }],
                    onUiChange: function($form) {
                        var flightlevel = $form.find('[name=flightLevel]').val();
                        var period = $form.find('[name=forecastPeriod]').val();
                        this.setSourceByKey('GBL_TURB_FL' + flightlevel + '_FCST_' + period, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /GBL_TURB_FL(.*?)_FCST_(.*)/g.exec(this.getSource().key);
                        $form.find('[name=flightLevel]').val(matches[1]);
                        $form.find('[name=forecastPeriod]').val(matches[2]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    nam_se_turb: function() {
        var flightlevels = ['050', '100', '125', '180', '240', '270', '300', '320', '340', '370', '390', '450', '530'];
        var forecastPeriods = {
            'Current': 'CURRENT',
            '1 hr': '01HR',
            '2 hr': '02HR',
            '3 hr': '03HR',
            '4 hr': '04HR',
            '5 hr': '05HR',
            '6 hr': '06HR',
            '7 hr': '07HR',
            '8 hr': '08HR',
            '9 hr': '09HR',
            '10 hr': '10HR',
            '11 hr': '11HR',
            '12 hr': '12HR',
            '13 hr': '13HR',
            '14 hr': '14HR',
            '15 hr': '15HR',
            '16 hr': '16HR',
            '17 hr': '17HR'
        };
        var sourceHash = {};
        $.each(flightlevels, function() {
            var flightlevel = this;
            $.each(forecastPeriods, function() {
                var period = this;
                var wxLayer = 'NAM_TURB_FL' + flightlevel + '_FCST_' + period;
                sourceHash[wxLayer] = {
                    sourceClass: FAMap.olExtras.Source.DTN,
                    sourceOpts: {
                        params: {
                            LAYERS: wxLayer
                        }
                    }
                };
            });
        });
        return {
            name: 'Turbulence (N. America)',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 0.7,
                sources: sourceHash,
                defaultSourceKey: 'NAM_TURB_FL300_FCST_CURRENT',
                ui: {
                    options: [{
                        label: 'Flight Level',
                        name: 'flightLevel',
                        type: 'select',
                        values: flightlevels,
                        defaultVal: '300'
                    }, {
                        label: 'Forecast',
                        name: 'forecastPeriod',
                        type: 'select',
                        values: forecastPeriods,
                        defaultVal: 'CURRENT'
                    }],
                    onUiChange: function($form) {
                        var flightlevel = $form.find('[name=flightLevel]').val();
                        var period = $form.find('[name=forecastPeriod]').val();
                        this.setSourceByKey('NAM_TURB_FL' + flightlevel + '_FCST_' + period, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /NAM_TURB_FL(.*?)_FCST_(.*)/g.exec(this.getSource().key);
                        $form.find('[name=flightLevel]').val(matches[1]);
                        $form.find('[name=forecastPeriod]').val(matches[2]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    gbl_se_icing: function() {
        var flightlevels = ['050', '100', '140', '180', '240', '270'];
        var forecastPeriods = {
            '6 hr': '06HR',
            '9 hr': '09HR',
            '12 hr': '12HR',
            '15 hr': '15HR',
            '18 hr': '18HR',
            '21 hr': '21HR',
            '24 hr': '24HR',
            '27 hr': '27HR',
            '30 hr': '30HR',
            '33 hr': '33HR',
            '36 hr': '36HR'
        };
        var acTypes = {
            'Small': 'SMALL',
            'Intermediate': 'INTER',
            'Large': 'LARGE'
        };
        var sourceHash = {};
        $.each(flightlevels, function() {
            var flightlevel = this;
            $.each(forecastPeriods, function() {
                var period = this;
                $.each(acTypes, function() {
                    var type = this;
                    var wxLayer = 'GBL_ICING_' + type + '_FL' + flightlevel + '_FCST_' + period;
                    sourceHash[wxLayer] = {
                        sourceClass: FAMap.olExtras.Source.DTN,
                        sourceOpts: {
                            params: {
                                LAYERS: wxLayer
                            }
                        }
                    };
                });
            });
        });
        return {
            name: 'Icing (Global)',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 0.7,
                sources: sourceHash,
                defaultSourceKey: 'GBL_ICING_INTER_FL180_FCST_06HR',
                ui: {
                    options: [{
                        label: 'Type',
                        name: 'type',
                        type: 'select',
                        values: acTypes,
                        defaultVal: 'INTER'
                    }, {
                        label: 'Flight Level',
                        name: 'flightLevel',
                        type: 'select',
                        values: flightlevels,
                        defaultVal: '180'
                    }, {
                        label: 'Forecast',
                        name: 'forecastPeriod',
                        type: 'select',
                        values: forecastPeriods,
                        defaultVal: '06HR'
                    }],
                    onUiChange: function($form) {
                        var type = $form.find('[name=type]').val();
                        var flightlevel = $form.find('[name=flightLevel]').val();
                        var period = $form.find('[name=forecastPeriod]').val();
                        this.setSourceByKey('GBL_ICING_' + type + '_FL' + flightlevel + '_FCST_' + period, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /GBL_ICING_(.*?)_FL(.*?)_FCST_(.*)/g.exec(this.getSource().key);
                        $form.find('[name=type]').val(matches[1]);
                        $form.find('[name=flightLevel]').val(matches[2]);
                        $form.find('[name=forecastPeriod]').val(matches[3]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    nam_se_icing: function() {
        var flightlevels = ['050', '100', '140', '180', '240', '270'];
        var forecastPeriods = {
            '1 hr': '01HR',
            '2 hr': '02HR',
            '3 hr': '03HR',
            '4 hr': '04HR',
            '5 hr': '05HR',
            '6 hr': '06HR',
            '7 hr': '07HR',
            '8 hr': '08HR',
            '9 hr': '09HR',
            '10 hr': '10HR',
            '11 hr': '11HR',
            '12 hr': '12HR',
            '13 hr': '13HR',
            '14 hr': '14HR',
            '15 hr': '15HR',
            '16 hr': '16HR',
            '17 hr': '17HR',
            '18 hr': '18HR'
        };
        var acTypes = {
            'Small': 'SMALL',
            'Intermediate': 'INTER',
            'Large': 'LARGE'
        };
        var sourceHash = {};
        $.each(flightlevels, function() {
            var flightlevel = this;
            $.each(forecastPeriods, function() {
                var period = this;
                $.each(acTypes, function() {
                    var type = this;
                    var wxLayer = 'NAM_ICING_' + type + '_FL' + flightlevel + '_FCST_' + period;
                    sourceHash[wxLayer] = {
                        sourceClass: FAMap.olExtras.Source.DTN,
                        sourceOpts: {
                            params: {
                                LAYERS: wxLayer
                            }
                        }
                    };
                });
            });
        });
        return {
            name: 'Icing (N. America)',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 0.7,
                sources: sourceHash,
                defaultSourceKey: 'NAM_ICING_INTER_FL180_FCST_06HR',
                ui: {
                    options: [{
                        label: 'Type',
                        name: 'type',
                        type: 'select',
                        values: acTypes,
                        defaultVal: 'INTER'
                    }, {
                        label: 'Flight Level',
                        name: 'flightLevel',
                        type: 'select',
                        values: flightlevels,
                        defaultVal: '180'
                    }, {
                        label: 'Forecast',
                        name: 'forecastPeriod',
                        type: 'select',
                        values: forecastPeriods,
                        defaultVal: '06HR'
                    }],
                    onUiChange: function($form) {
                        var type = $form.find('[name=type]').val();
                        var flightlevel = $form.find('[name=flightLevel]').val();
                        var period = $form.find('[name=forecastPeriod]').val();
                        this.setSourceByKey('NAM_ICING_' + type + '_FL' + flightlevel + '_FCST_' + period, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /NAM_ICING_(.*?)_FL(.*?)_FCST_(.*)/g.exec(this.getSource().key);
                        $form.find('[name=type]').val(matches[1]);
                        $form.find('[name=flightLevel]').val(matches[2]);
                        $form.find('[name=forecastPeriod]').val(matches[3]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    se_lightning: function() {
        var types = {
            'Cloud to Ground': 'CTG',
            'Cloud to Cloud': 'CTC'
        };
        var sourceHash = {};
        $.each(types, function() {
            var type = this;
            var wxLayer = 'LTG' + type + '_5MIN';
            sourceHash[wxLayer] = {
                sourceClass: FAMap.olExtras.Source.DTN,
                sourceOpts: {
                    params: {
                        LAYERS: wxLayer
                    }
                }
            };
        });
        return {
            name: 'Lightning',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 0.7,
                sources: sourceHash,
                defaultSourceKey: 'LTGCTG_5MIN',
                ui: {
                    options: [{
                        label: 'Type',
                        name: 'type',
                        type: 'select',
                        values: types,
                        defaultVal: 'CTG'
                    }],
                    onUiChange: function($form) {
                        var type = $form.find('[name=type]').val();
                        this.setSourceByKey('LTG' + type + '_5MIN', true);
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /LTG(.*?)_5MIN/g.exec(this.getSource().key);
                        $form.find('[name=type]').val(matches[1]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    se_winds_aloft: function() {
        var flightlevels = ['010', '030', '050', '100', '180', '240', '300', '340', '390', '450', '540'];
        var forecastPeriods = {
            '6 hr': '06HR',
            '12 hr': '12HR',
            '18 hr': '18HR',
            '24 hr': '24HR'
        };
        var sourceHash = {};
        $.each(flightlevels, function() {
            var flightlevel = this;
            $.each(forecastPeriods, function() {
                var period = this;
                var wxLayer = 'WINDTEMP_FL' + flightlevel + '_FCST_' + period;
                sourceHash[wxLayer] = {
                    sourceClass: FAMap.olExtras.Source.DTN,
                    sourceOpts: {
                        params: {
                            LAYERS: wxLayer,
                            TRANSPARENT: 'FALSE',
                            BACKGROUND: '0xFFFFFF'
                        }
                    }
                };
            });
        });
        return {
            name: 'Wind/Temp Aloft',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 0.7,
                sources: sourceHash,
                defaultSourceKey: 'WINDTEMP_FL300_FCST_06HR',
                ui: {
                    options: [{
                        label: 'Flight Level',
                        name: 'flightLevel',
                        type: 'select',
                        values: flightlevels,
                        defaultVal: '300'
                    }, {
                        label: 'Forecast',
                        name: 'forecastPeriod',
                        type: 'select',
                        values: forecastPeriods,
                        defaultVal: '06HR'
                    }],
                    onUiChange: function($form) {
                        var flightlevel = $form.find('[name=flightLevel]').val();
                        var period = $form.find('[name=forecastPeriod]').val();
                        this.setSourceByKey('WINDTEMP_FL' + flightlevel + '_FCST_' + period, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /WINDTEMP_FL(.*?)_FCST_(.*)/g.exec(this.getSource().key);
                        $form.find('[name=flightLevel]').val(matches[1]);
                        $form.find('[name=forecastPeriod]').val(matches[2]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    se_jetstreams: function() {
        var forecastPeriods = {
            '6 hr': '06HR',
            '12 hr': '12HR',
            '18 hr': '18HR',
            '24 hr': '24HR'
        };
        var sourceHash = {};
        $.each(forecastPeriods, function() {
            var period = this;
            var wxLayer = 'JETSTREAM_FCST_' + period;
            sourceHash[wxLayer] = {
                sourceClass: FAMap.olExtras.Source.DTN,
                sourceOpts: {
                    params: {
                        LAYERS: wxLayer
                    }
                }
            };
        });
        return {
            name: 'Jetstreams',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 0.7,
                sources: sourceHash,
                defaultSourceKey: 'JETSTREAM_FCST_06HR',
                ui: {
                    options: [{
                        label: 'Forecast',
                        name: 'forecastPeriod',
                        type: 'select',
                        values: forecastPeriods,
                        defaultVal: '06HR'
                    }],
                    onUiChange: function($form) {
                        var period = $form.find('[name=forecastPeriod]').val();
                        this.setSourceByKey('JETSTREAM_FCST_' + period, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /JETSTREAM_FCST_(.*)/g.exec(this.getSource().key);
                        $form.find('[name=forecastPeriod]').val(matches[1]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    se_fronts: function() {
        var forecastPeriods = {
            'Current': 'CURRENT',
            '6 hr': '06HR',
            '12 hr': '12HR',
            '18 hr': '18HR',
            '24 hr': '24HR'
        };
        var sourceHash = {};
        $.each(forecastPeriods, function(k, period) {
            if (period !== 'CURRENT') {
                var wxLayer = 'FRONT_FCST_' + period;
            } else {
                var wxLayer = 'FRONTS_CURRENT';
            }
            sourceHash[wxLayer] = {
                sourceClass: FAMap.olExtras.Source.DTN,
                sourceOpts: {
                    params: {
                        LAYERS: wxLayer
                    }
                }
            };
        });
        return {
            name: 'Fronts',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 1,
                sources: sourceHash,
                defaultSourceKey: 'FRONTS_CURRENT',
                ui: {
                    options: [{
                        label: 'Forecast',
                        name: 'forecastPeriod',
                        type: 'select',
                        values: forecastPeriods,
                        defaultVal: 'CURRENT'
                    }],
                    onUiChange: function($form) {
                        var period = $form.find('[name=forecastPeriod]').val();
                        if (period !== 'CURRENT') {
                            this.setSourceByKey('FRONT_FCST_' + period, true);
                        } else {
                            this.setSourceByKey('FRONTS_CURRENT', true);
                        }
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /FRONT(S*)_(FCST_)*(.*)/g.exec(this.getSource().key);
                        $form.find('[name=forecastPeriod]').val(matches[3]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    se_volcanic: function() {
        var advisoryPeriods = {
            'Current': '',
            '6 hr': '06HR',
            '12 hr': '12HR',
            '18 hr': '18HR'
        };
        var sourceHash = {};
        $.each(advisoryPeriods, function(k, period) {
            if (period !== '') {
                var wxLayer = 'VOLCANIC_ASH_' + period;
            } else {
                var wxLayer = 'VOLCANIC_ASH';
            }
            sourceHash[wxLayer] = {
                sourceClass: FAMap.olExtras.Source.DTN,
                sourceOpts: {
                    params: {
                        LAYERS: wxLayer
                    }
                }
            }
        });
        return {
            name: 'Volcanic Ash',
            layerClass: FAMap.olExtras.Layer.MultiSource.Tile,
            layerOpts: {
                opacity: 1,
                sources: sourceHash,
                defaultSourceKey: 'VOLCANIC_ASH',
                ui: {
                    options: [{
                        label: 'Advisory',
                        name: 'advisoryPeriod',
                        type: 'select',
                        values: advisoryPeriods,
                        defaultVal: ''
                    }],
                    onUiChange: function($form) {
                        var period = $form.find('[name=forecastPeriod]').val();
                        if (period !== '') {
                            this.setSourceByKey('VOLCANIC_ASH_' + period, true);
                        } else {
                            this.setSourceByKey('VOLCANIC_ASH', true);
                        }
                    },
                    onUiUpdateRequired: function($form) {
                        var matches = /VOLCANIC_ASH(.*)/g.exec(this.getSource().key);
                        $form.find('[name=forecastPeriod]').val(matches[1]);
                    }
                }
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
            },
            uiGroup: 'premiumWeather'
        };
    },
    se_tropical: {
        name: 'Tropical Storms',
        layerClass: ol.layer.Tile,
        layerOpts: {
            opacity: 0.7
        },
        sourceClass: FAMap.olExtras.Source.DTN,
        sourceOpts: {
            params: {
                LAYERS: 'TROP_ALL_MODEL_TRACKS_FCST'
            }
        },
        onBuildLayerComplete: function(layerDef, map) {
            if (map._validTimes !== null) {
                return false;
            }
        },
        uiGroup: 'premiumWeather'
    },
    sigmets: function() {
        return {
            name: "SIGMETs",
            layerClass: FAMap.olExtras.Layer.ToggledVector,
            layerOpts: {
                toggleFieldName: 'type',
                ui: {
                    options: [{
                        label: 'Sigmets',
                        name: 'SIGMET',
                        type: 'checkbox',
                        defaultVal: 'true'
                    }, {
                        label: 'Outlook',
                        name: 'OUTLOOK',
                        type: 'checkbox',
                        defaultVal: 'true'
                    }],
                    onUiChange: function($form) {
                        var sigmet = $form.find('[name=SIGMET]').prop("checked");
                        var outlook = $form.find('[name=OUTLOOK]').prop("checked");
                        var showing = {};
                        showing.SIGMET = sigmet;
                        showing.OUTLOOK = outlook;
                        this.updateShowing(showing, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var showing = this.getShowing();
                        $form.find('[name=OUTLOOK]').prop("checked", showing.OUTLOOK);
                        $form.find('[name=SIGMET]').prop("checked", showing.SIGMET);
                    }
                }
            },
            eventHandlers: {
                mouseMove: function(e, feature) {
                    e.FAMap.inspectInfoPopup.setPosition(e.coordinate[1], e.coordinate[0]);
                    e.FAMap.inspectInfoPopup.showPopup();
                },
                mouseIn: function(e, feature, layer) {
                    var type = feature.get('type'), hazard = feature.get('hazard'), style = this.getStyle(), shadow = "text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;", color;
                    this._mouseIn = typeof (this._mouseIn) === "undefined" ? [] : this._mouseIn;
                    if (typeof (style) === "function") {
                        style = (style(feature))[0];
                    }
                    if (feature.getGeometry().getType() === "Point") {
                        color = style.getImage().getStroke().getColor();
                    } else {
                        color = style.getStroke().getColor();
                    }
                    e.FAMap.inspectInfoPopup.addContent(feature, "<span style=\"color:" + color + ";" + shadow + "\"> " + type + ": " + hazard + "</span>");
                },
                mouseOut: function(e, feature, layer) {
                    var type = feature.get('type')
                      , hazard = feature.get('hazard');
                    this._mouseIn = typeof (this._mouseIn) === "undefined" ? [] : this._mouseIn;
                    e.FAMap.inspectInfoPopup.removeContent(feature);
                },
                click: function(e, feature) {}
            },
            sourceClass: FAMap.olExtras.Source.AirSigmets,
            sourceOpts: {
                type: "SIGMET,OUTLOOK"
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
                var layer = this
                  , configHandler = layerDef.layerOpts.FAMap._configHandler.get('overlay_' + layer.idx);
                this.persistShowing = (function(toggledLayer, faMap) {
                    return function() {
                        faMap.persistentStores.Overlays.setItem(toggledLayer.idx + ".showing", toggledLayer.getShowing());
                    }
                }
                )(layer, layerDef.layerOpts.FAMap);
                if (typeof (configHandler.value) !== "undefined" && 'showing'in configHandler.value) {
                    layer.updateShowing(configHandler.value.showing, true);
                    layer.set('uiUpdated', new Date().getTime());
                }
                this.on("change:visible", (function(theLayer) {
                    return function() {
                        var isVisible = theLayer.getVisible();
                        theLayer.getSource().live(isVisible);
                    }
                }
                )(this));
                layerDef.layerOpts.FAMap.on('airsigmet:featuresLoaded:SIGMET,OUTLOOK', layer.updateShowing.bind(layer, null, false));
            },
            uiGroup: 'premiumWeather'
        }
    },
    airmets: function() {
        return {
            name: "AIRMETs",
            layerClass: FAMap.olExtras.Layer.ToggledVector,
            layerOpts: {
                toggleFieldName: 'hazard',
                ui: {
                    options: [{
                        label: 'Icing',
                        name: 'ICE',
                        type: 'checkbox',
                        defaultVal: 'true'
                    }, {
                        label: 'Turbulance',
                        name: 'TURB',
                        type: 'checkbox',
                        defaultVal: 'true'
                    }, {
                        label: 'Mountain Obscuration',
                        name: 'MTN_OBSCN',
                        type: 'checkbox',
                        defaultVal: 'true'
                    }, {
                        label: 'Instrument Flight Rules',
                        name: 'IFR',
                        type: 'checkbox',
                        defaultVal: 'true'
                    }],
                    onUiChange: function($form) {
                        var turb = $form.find('[name=TURB]').prop("checked");
                        var mtn = $form.find('[name=MTN_OBSCN]').prop("checked");
                        var ice = $form.find('[name=ICE]').prop("checked");
                        var ifr = $form.find('[name=IFR]').prop("checked");
                        var showing = {};
                        showing.TURB = turb;
                        showing.MTN_OBSCN = mtn;
                        showing.ICE = ice;
                        showing.IFR = ifr;
                        this.updateShowing(showing, true);
                    },
                    onUiUpdateRequired: function($form) {
                        var showing = this.getShowing();
                        $form.find('[name=TURB]').prop("checked", showing.TURB);
                        $form.find('[name=MTN_OBSCN]').prop("checked", showing.MTN_OBSCN);
                        $form.find('[name=ICE]').prop("checked", showing.ICE);
                        $form.find('[name=IFR]').prop("checked", showing.IFR);
                    }
                }
            },
            eventHandlers: {
                mouseMove: function(e, feature) {
                    e.FAMap.inspectInfoPopup.setPosition(e.coordinate[1], e.coordinate[0]);
                    e.FAMap.inspectInfoPopup.showPopup();
                },
                mouseIn: function(e, feature, layer) {
                    var type = feature.get('type'), hazard = feature.get('hazard'), style = this.getStyle(), shadow = "text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;", color;
                    this._mouseIn = typeof (this._mouseIn) === "undefined" ? [] : this._mouseIn;
                    if (typeof (style) === "function") {
                        style = (style(feature))[0];
                    }
                    if (feature.getGeometry().getType() === "Point") {
                        color = style.getImage().getStroke().getColor();
                    } else {
                        color = style.getStroke().getColor();
                    }
                    e.FAMap.inspectInfoPopup.addContent(feature, "<span style=\"color:" + color + ";" + shadow + "\"> " + type + ": " + hazard + "</span>");
                },
                mouseOut: function(e, feature, layer) {
                    var type = feature.get('type')
                      , hazard = feature.get('hazard');
                    this._mouseIn = typeof (this._mouseIn) === "undefined" ? [] : this._mouseIn;
                    e.FAMap.inspectInfoPopup.removeContent(feature);
                    return true;
                },
                click: function(e, feature) {}
            },
            sourceClass: FAMap.olExtras.Source.AirSigmets,
            sourceOpts: {
                type: "AIRMET"
            },
            onBuildLayerComplete: function(layerDef, map) {
                if (map._validTimes !== null) {
                    return false;
                }
                var layer = this
                  , configHandler = layerDef.layerOpts.FAMap._configHandler.get('overlay_' + layer.idx);
                this.persistShowing = (function(toggledLayer, faMap) {
                    return function() {
                        faMap.persistentStores.Overlays.setItem(toggledLayer.idx + ".showing", toggledLayer.getShowing());
                    }
                }
                )(layer, layerDef.layerOpts.FAMap);
                if (typeof (configHandler.value) !== "undefined" && 'showing'in configHandler.value) {
                    layer.updateShowing(configHandler.value.showing, true);
                    layer.set('uiUpdated', new Date().getTime());
                }
                this.on("change:visible", (function(theLayer) {
                    return function() {
                        var isVisible = theLayer.getVisible();
                        theLayer.getSource().live(isVisible);
                    }
                }
                )(this));
                layerDef.layerOpts.FAMap.on('airsigmet:featuresLoaded:AIRMET', layer.updateShowing.bind(layer, null, false));
            },
            uiGroup: 'premiumWeather'
        }
    }
}
FAMap.Util.ConfigPresets._postProcessors = {
    delays: function(extra, config) {
        config.baseLayer = 'classic';
        config.baseLayers = FAMap.Util.ConfigPresets.getBaseLayerConfig(['classic']);
        config.defaultOverrides.overlay_basic_radar = {
            visibility: true
        };
        if (typeof (config.overlays.basic_rader) !== "undefined") {
            config.overlays.basic_radar.layerOpts.timeSeriesNFrames = 1;
        }
        if (typeof (config.overlays.arinc_rader) !== "undefined") {
            config.overlays.arinc_radar.layerOpts.timeSeriesNFrames = 1;
        }
        if (typeof (config.overlays.se_rad) !== "undefined") {
            config.overlays.se_rad.layerOpts.timeSeriesNFrames = 1;
        }
        config.defaultOverrides.overlay_airport_delays = {
            visibility: true
        };
        if ('controls'in extra && !extra.controls) {
            config.controls = [];
        } else {
            config.controls = ['zoom'];
        }
        if ('center'in extra) {
            var zoom = 4;
            if ('zoom'in extra) {
                zoom = extra.zoom;
            }
            config.defaultOverrides.initialViewState = {
                type: 'panZoom',
                center: ol.proj.transform([extra.center.lon, extra.center.lat], 'EPSG:4326', 'EPSG:3857'),
                zoom: zoom
            }
        }
        config.persistent = {
            ZoomTo: {
                prefix: 'airport_delays_',
                period: -1
            },
            Overlays: {
                prefix: 'airport_delays_',
                period: -1
            },
            BaseLayer: {
                prefix: 'airport_delays_',
                period: -1
            }
        };
        return config;
    },
    nearby: function(extra, config) {
        config.overlays.nearby_flights.excludeFromUi = true;
        config.overlay_nearby_flights = {
            visibility: true
        };
        config.defaultOverrides.overlay_nearby_airports = {
            visibility: true
        };
        config.defaultOverrides.overlay_day_night = {
            visibility: true
        };
        var splicePoint = config.sourcedItems.initialViewState.allowedSources.indexOf('Defaults');
        config.sourcedItems.initialViewState.allowedSources.splice(splicePoint, 0, 'Geolocation');
        splicePoint = config.sourcedItems.defaultViewState.allowedSources.indexOf('Defaults');
        config.sourcedItems.defaultViewState.allowedSources.splice(splicePoint, 0, 'Geolocation');
        return config;
    },
    aireonSMT: function(extra, config) {
        config.baseLayers = FAMap.Util.ConfigPresets.getBaseLayerConfig(['group.aireonSalesTool']);
        config.overlays = FAMap.Util.ConfigPresets.getOverlayConfig(['group.aireonSalesTool']);
        if ('nearby_flights'in config.overlays) {
            delete config.overlays.nearby_flights;
        }
        config.overlay_aireon_flights = {
            visibility: true
        };
        config.defaultOverrides.overlay_nearby_airports = {
            visibility: true
        };
        config.defaultOverrides.overlay_day_night = {
            visibility: true
        };
        config.defaultOverrides.initialViewState = {
            type: 'fitExtent',
            extent: ol.proj.transformExtent([-180, -85, 180, 85], 'EPSG:4326', 'EPSG:3857')
        };
        config.sourcedItems.initialViewState.allowedSources = ['Defaults'];
        config.sourcedItems.defaultViewState.allowedSources = ['Defaults'];
        return config;
    },
    live: function(extra, config) {
        if ('nearby_flights'in config.overlays) {
            delete config.overlays.nearby_flights;
        }
        config.overlay_live_flights = {
            visibility: true
        };
        config.defaultOverrides.overlay_nearby_airports = {
            visibility: true
        };
        config.defaultOverrides.overlay_day_night = {
            visibility: true
        };
        var splicePoint = config.sourcedItems.initialViewState.allowedSources.indexOf('Defaults');
        config.sourcedItems.initialViewState.allowedSources.splice(splicePoint, 0, 'Geolocation');
        splicePoint = config.sourcedItems.defaultViewState.allowedSources.indexOf('Defaults');
        config.sourcedItems.defaultViewState.allowedSources.splice(splicePoint, 0, 'Geolocation');
        return config;
    },
    flight: function(extra, config) {
        config.animation = {
            singleFlight: true
        };
        config.overlays.aircraft.excludeFromUi = true;
        config.overlays.flown_route.excludeFromUi = true;
        config.overlay_aircraft = {
            visibility: true
        };
        config.overlay_flown_route = {
            visibility: true
        };
        config.controls = ['liveLoop', 'layerUI', 'zoom', 'attributions', 'expand', 'scaleLine', 'distanceBearing'];
        if (typeof trackpollBootstrap !== 'undefined') {
            var flight_ids = Object.keys(trackpollBootstrap.flights);
            if (flight_ids.length == 1) {
                var prefix = 'flight_' + (extra.fullwindow ? 'fullwindow_' : '') + flight_ids.pop();
            }
        }
        config.persistent = {
            ZoomTo: {
                prefix: prefix,
                period: 60 * 60 * 24
            }
        };
        config.defaultOverrides.overlay_planned_route = {
            visibility: true
        };
        config.defaultOverrides.overlay_day_night = {
            visibility: true
        };
        return config;
    },
    airport: function(extra, config) {
        config.animation = {
            singleFlight: false,
            disableFeatureZoom: true
        };
        config.persistent = {
            ZoomTo: {
                prefix: 'airport_' + extra.airport,
                period: 60 * 60 * 24
            }
        };
        config.defaultOverrides.overlay_arrivals = {
            visibility: true
        };
        config.defaultOverrides.overlay_departures = {
            visibility: true
        };
        config.defaultOverrides.overlay_static_airport = {
            visibility: true
        };
        config.defaultOverrides.overlay_nearby_flights = {
            visibility: true
        };
        config.defaultOverrides.overlay_day_night = {
            visibility: true
        };
        config.defaultOverrides.initialViewState = {
            type: 'panZoom',
            center: extra.airportCoords,
            projection: 'EPSG:4326',
            zoom: 8
        };
        config.overlays.nearby_airports.sourceOpts.dedupeAnimated = false;
        config.overlays.nearby_airports.sourceOpts.excludedAirports = [extra.airport];
        config.overlays.static_airport.sourceOpts = {
            airports: [{
                iata: extra.iata,
                icao: extra.icao,
                isUS: extra.isUS,
                coords: extra.airportCoords
            }]
        };
        var gaFilter = function(filterVal, flightData) {
            if (filterVal == 0) {
                return true;
            }
            if (filterVal > 0 && flightData.ga) {
                return true;
            }
            if (filterVal < 0 && !flightData.ga) {
                return true;
            }
            return false;
        };
        var baseFilter = function(behavior, list, flightData) {
            if (behavior == 0) {
                return true;
            }
            if (behavior > 0 && list.indexOf(flightData.ident) != -1) {
                return true;
            }
            if (behavior < 0 && list.indexOf(flightData.ident) == -1) {
                return true;
            }
            return false;
        };
        if ('arrivals'in config.overlays) {
            config.overlays.arrivals.sourceOpts.filter = function(flight_id, flightData) {
                if ('gaOnly'in extra) {
                    var gaMatch = gaFilter(extra.gaOnly, flightData);
                } else {
                    var gaMatch = true;
                }
                if ('baseAircraftBehavior'in extra && 'baseAircraftList'in extra) {
                    var baseMatch = baseFilter(extra.baseAircraftBehavior, extra.baseAircraftList, flightData);
                } else {
                    var baseMatch = true;
                }
                var destMatch = (flightData.destination.icao == extra.airport);
                return destMatch && gaMatch && baseMatch;
            }
            ;
        }
        if ('departures'in config.overlays) {
            config.overlays.departures.sourceOpts.filter = function(flight_id, flightData) {
                if ('gaOnly'in extra) {
                    var gaMatch = gaFilter(extra.gaOnly, flightData);
                } else {
                    var gaMatch = true;
                }
                if ('baseAircraftBehavior'in extra && 'baseAircraftList'in extra) {
                    var baseMatch = baseFilter(extra.baseAircraftBehavior, extra.baseAircraftList, flightData);
                } else {
                    var baseMatch = true;
                }
                var origMatch = (flightData.origin.icao == extra.airport);
                return origMatch && gaMatch && baseMatch;
            }
            ;
        }
        return config;
    },
    airport_iframe: function(extra, config) {
        config = FAMap.Util.ConfigPresets._postProcessors.airport(extra, config);
        config.defaultOverrides.baseLayer = 'earthview';
        config.defaultOverrides.overlay_nearby_flights = {
            visibility: false
        };
        return config;
    },
    airport_sectional: function(extra, config) {
        config.controls = ['zoom', 'expand', 'attributions', 'scaleLine'];
        config.baseLayer = 'sectional';
        config.baseLayers = FAMap.Util.ConfigPresets.getBaseLayerConfig(['sectional']);
        config.overlays = {};
        config.persistent = {
            ZoomTo: {
                prefix: 'airport_sectional_' + extra.airport,
                period: 60 * 60 * 24
            }
        };
        config.defaultOverrides.initialViewState = {
            type: 'panZoom',
            center: extra.airportCoords,
            projection: 'EPSG:4326',
            zoom: 12
        };
        return config;
    },
    flex: function(extra, config) {
        config.animation = {
            singleFlight: false
        };
        config.persistent = {
            ZoomTo: {
                prefix: extra.prefix,
                period: 60 * 60 * 24
            }
        };
        config.defaultOverrides.overlay_related_airports = {
            visibility: true
        };
        config.defaultOverrides.overlay_flights = {
            visibility: true
        };
        if ('autoregions'in extra && extra.autoregions) {
            config.overlays.flights.autoregion_enable = true;
        }
        if ('isArinc'in extra && extra.isArinc) {
            $.each(['arinc_lastpos', 'arinc_related_dedupe'], function(k, v) {
                config.overlays[v] = FAMap.Util.ConfigPresets._defs.overlays[v];
            });
            config.defaultOverrides.overlay_arinc_lastpos = {
                visibility: true
            };
            config.onMapReady = function(map) {
                map.on('activeStateChange', function(e, state) {
                    if (state == 'off') {
                        var style = map._getOverlayStyle('arinc_related_dedupe', map._currentBaseLayerIdx);
                    } else {
                        var style = map._getOverlayStyle('arinc_related_dedupe', map._currentBaseLayerIdx, 'highlight');
                    }
                    map._overlays.arinc_related_dedupe.setStyle(style);
                });
            }
            $.each(['initialViewState', 'defaultViewState'], function(k, v) {
                var splicePoint = config.sourcedItems[v].allowedSources.indexOf('AnimatedFeatures');
                config.sourcedItems[v].allowedSources.splice(splicePoint, 1, 'ArincFeatures');
            });
        } else {
            config.defaultOverrides.overlay_day_night = {
                visibility: true
            };
        }
        return config;
    },
    fatv: function(extra, config) {
        if (extra.subType in FAMap.Util.ConfigPresets._postProcessors) {
            $.each(FAMap.Util.ConfigPresets.getBaseLayerConfig(['group.' + extra.subType]), function(k, v) {
                if (!(k in config.baseLayers)) {
                    config.baseLayers[k] = v;
                }
            });
            $.each(FAMap.Util.ConfigPresets.getOverlayConfig(['group.' + extra.subType]), function(k, v) {
                if (!(k in config.overlays)) {
                    config.overlays[k] = v;
                }
            });
            config = FAMap.Util.ConfigPresets._postProcessors[extra.subType](extra, config);
        } else {
            throw ('Error: unknown map type ' + extra.subType);
        }
        if ('tvKey'in extra) {
            config.tvKey = extra.tvKey;
            if ('fleet_onground'in config.overlays) {
                config.overlays.fleet_onground.sourceOpts.url += '?key=' + extra.tvKey;
            }
        }
        config.showControlsInitially = false;
        var prefix = 'FATV_' + extra.tv_id;
        config.persistent = {
            ZoomTo: {
                prefix: prefix
            },
            BaseLayer: {
                prefix: prefix
            },
            Overlays: {
                prefix: prefix
            }
        };
        if ('autoregions'in extra && extra.autoregions) {
            config.overlays.flights.autoregion_enable = true;
        }
        config.defaultOverrides.liveLoop = {
            "loopingState": "paused"
        };
        return config;
    },
    ifr_routes: function(extra, config) {
        config.animation = {
            singleFlight: false,
            disableFeatureZoom: true
        };
        config.persistent = {
            ZoomTo: {
                prefix: 'IFR' + [extra.origin, extra.destination].join(),
                period: 60 * 60 * 24
            }
        };
        config.defaultOverrides.overlay_flights = {
            visibility: true
        }
        config.defaultOverrides.overlay_day_night = {
            visibility: true
        };
        config.defaultOverrides.overlay_ifr_endpoints = {
            visibility: true
        };
        var coords = [ol.proj.fromLonLat(extra.originCoords), ol.proj.fromLonLat(extra.destinationCoords)];
        config.defaultOverrides.initialViewState = {
            type: 'fitExtent',
            extent: ol.extent.boundingExtent(coords)
        };
        config.overlays.nearby_airports.sourceOpts.dedupeAnimated = false;
        config.overlays.nearby_airports.sourceOpts.excludedAirports = [extra.origin, extra.destination];
        config.overlays.ifr_endpoints.sourceOpts = {
            airports: [{
                label: extra.origin,
                coords: extra.originCoords
            }, {
                label: extra.destination,
                coords: extra.destinationCoords
            }]
        };
        return config;
    },
    jetblue: function(extra, config) {
        config.animation = {
            singleFlight: true
        };
        config.baseLayer = 'jetblue';
        config.baseLayers = FAMap.Util.ConfigPresets.getBaseLayerConfig(['classic']);
        config.overlays = FAMap.Util.ConfigPresets.getOverlayConfig(['group.jetblue']);
        config.controls = ['liveLoop', 'zoom', 'attributions', 'scaleLine', 'distanceBearing'];
        $.each(FAMap.Util.ConfigPresets.getOverlayConfig(['group.' + extra.subType]), function(k, v) {
            if (!(k in config.overlays)) {
                config.overlays[k] = v;
            }
        });
        config = FAMap.Util.ConfigPresets._postProcessors['flight'](extra, config);
        config.showControlsInitially = false;
        config.persistent = {
            PanZoom: {
                prefix: 'jetblue',
                period: -1
            },
            Overlays: {
                prefix: 'jetblue',
                period: -1
            },
            BaseLayer: {
                prefix: 'jetblue',
                period: -1
            },
            ZoomTo: {
                prefix: 'jetblue',
                period: -1
            }
        };
        return config;
    }
};
FAMap.Util.Debugger = function(map) {
    this.FAMap = map;
    var options = $.extend({}, this.FAMap.options);
    options.baseLayers = Object.keys(options.baseLayers);
    options.overlays = Object.keys(options.overlays);
    this.debugData = {
        mapOptions: options
    };
    this.set = function(path, value) {
        var currentVal = this.debugData;
        var keyParts = path.split('.');
        var lastPart = keyParts.pop();
        var subVal = currentVal;
        $.each(keyParts, function() {
            if (!(this in subVal)) {
                subVal[this] = {};
            }
            subVal = subVal[this];
        });
        subVal[lastPart] = value;
        this.debugData = currentVal;
    }
    ;
    this.get = function() {
        var data = $.extend({}, this.debugData);
        data.timestamp = FAMap.Util.getNow();
        data.persistent = {};
        $.each(this.FAMap.persistentStores, function(k, obj) {
            data.persistent[k] = obj.get();
        });
        return data;
    }
    ;
}
;
FAMap.Util.GreatCircle = {
    interpolate: function(coords, threshold) {
        var threshold = threshold || 100e3;
        var interpolated = [];
        for (var i = 0; i < coords.length - 1; i++) {
            var c1 = coords[i];
            var c2 = coords[i + 1];
            var dist = FAMap.Util.refSphere.haversineDistance(c1, c2);
            if (dist > threshold) {
                interpolated.push(c1);
                var numDivisions = Math.floor(dist / threshold);
                for (var j = 1; j <= numDivisions; j++) {
                    var interpDist = (j * dist) / numDivisions;
                    var interpCoord = FAMap.Util.refSphere.offset(c1, interpDist, this.bearing(c1, c2));
                    if (interpCoord[0] > 180) {
                        interpCoord[0] -= 360;
                    } else if (interpCoord[0] < -180) {
                        interpCoord[0] += 360;
                    }
                    interpolated.push(interpCoord);
                }
                interpolated.push(c2);
            } else {
                interpolated.push(c1);
                interpolated.push(c2);
            }
        }
        return interpolated;
    },
    bearing: function(c1, c2) {
        try {
            c1 = c1.map(FAMap.Util.toRadians);
            c2 = c2.map(FAMap.Util.toRadians);
        } catch (e) {
            return null;
        }
        var a = Math.cos(c2[1]) * Math.sin(c2[0] - c1[0]);
        var b = Math.cos(c1[1]) * Math.sin(c2[1]) - Math.sin(c1[1]) * Math.cos(c2[1]) * Math.cos(c2[0] - c1[0]);
        var bearing;
        if ((a == 0) && (b == 0)) {
            bearing = 0;
            return bearing;
        }
        if (b == 0) {
            if (a < 0)
                bearing = Math.PI * 3 / 2;
            else
                bearing = Math.PI / 2;
            return bearing;
        }
        var adjust = 0;
        if (b < 0) {
            adjust = Math.PI;
        } else if (a < 0) {
            adjust = 2 * Math.PI;
        }
        bearing = (Math.atan(a / b) + adjust);
        return bearing;
    }
};
FAMap.Util.IDL = {
    lineStringSplit: function(linestring) {
        var multiLineString = new ol.geom.MultiLineString();
        var thisLineString = new ol.geom.LineString([]);
        var prevCoord = null;
        $.each(linestring.getCoordinates(), function(k, coord) {
            if (prevCoord !== null && FAMap.Util.IDL.checkCrossing(prevCoord, coord) !== false) {
                var crossCoords = FAMap.Util.IDL.getCrossingCoords(prevCoord, coord);
                if (crossCoords !== false) {
                    thisLineString.appendCoordinate(crossCoords[0]);
                }
                multiLineString.appendLineString(thisLineString);
                thisLineString = new ol.geom.LineString([]);
                if (crossCoords !== false) {
                    thisLineString.appendCoordinate(crossCoords[1]);
                }
            }
            prevCoord = coord;
            thisLineString.appendCoordinate(coord);
        });
        multiLineString.appendLineString(thisLineString);
        return multiLineString;
    },
    checkCrossing: function(c1, c2) {
        var lonDiff = c1[0] - c2[0];
        if (Math.abs(lonDiff) > 270) {
            return c1[0] / Math.abs(c1[0]);
        } else {
            return false;
        }
    },
    getCrossingCoords: function(c1, c2) {
        if (Math.abs(c1[0] - c2[0]) % 360 == 0) {
            return false;
        }
        var direction = c1[0] / Math.abs(c1[0]);
        var testLon = c1[0] - (direction * 360);
        var ratio = (testLon + (direction * 180)) / (testLon - c2[0]);
        var crossingLat = ((c2[1] - c1[1]) * ratio) + c1[1];
        return [[(direction * 180), crossingLat], [(direction * -180), crossingLat]];
    }
};
FAMap.InteractionShims = {
    toShim: {
        'interaction.zoom': [{
            'className': 'Interaction',
            'functionName': 'zoomWithoutConstraints'
        }],
        'interaction.rotate': [{
            'className': 'Interaction',
            'functionName': 'rotateWithoutConstraints'
        }],
        'interaction.pan': [{
            'className': 'Interaction',
            'functionName': 'pan'
        }, {
            'className': 'DragPan',
            'functionName': 'handleUpEvent_'
        }]
    },
    orig: {},
    mapObjects: [],
    register: function(mapObj) {
        FAMap.InteractionShims.mapObjects.push(mapObj);
    }
};
$.each(FAMap.InteractionShims.toShim, function(event, functionDefs) {
    $.each(functionDefs, function() {
        var fnKey = this.className + '_' + this.functionName;
        var len = FAMap.InteractionShims.orig[fnKey] = ol.interaction[this.className][this.functionName];
        ol.interaction[this.className][this.functionName] = function() {
            var returnVal = FAMap.InteractionShims.orig[fnKey].apply(this, arguments);
            $.each(FAMap.InteractionShims.mapObjects, function() {
                this.trigger(event);
            });
            return returnVal;
        }
        ;
    });
});
if (!('USE_LOCAL_STORAGE'in FAMap.Globals)) {
    FAMap.Globals.USE_LOCAL_STORAGE = FA.Lib.Common.hasLocalStorage;
}
FAMap.Util.PersistentStore = function(options, map) {
    this._map = map;
    this._options = options;
    this._prefix = options.prefix || false;
    this._period = options.period || false;
    this._enabled = FAMap.Globals.USE_LOCAL_STORAGE;
    if ('replayData'in map.options && 'persistent'in map.options.replayData && this.key in map.options.replayData.persistent) {
        this._replayData = map.options.replayData.persistent[this.key];
    } else {
        this._replayData = null;
    }
}
;
FAMap.Util.PersistentStore.prototype.key = null;
FAMap.Util.PersistentStore.prototype.storageKey = 'localStorage';
FAMap.Util.PersistentStore.prototype._getPrefix = function() {
    return this._prefix;
}
;
FAMap.Util.PersistentStore.prototype._getFullName = function() {
    var prefix = this._getPrefix();
    if (prefix !== false) {
        return prefix + '_' + this.key;
    } else {
        return this.key;
    }
}
;
FAMap.Util.PersistentStore.prototype._getDefaultValue = function() {
    throw ('Error: ' + this.key + ' persistent storage item has no default value, but you\'re trying to use it. You\'ll need to explicitly pass a value for this item.');
}
;
FAMap.Util.PersistentStore.prototype.set = function(value) {
    if (!this._enabled) {
        return;
    }
    if (typeof value === 'undefined') {
        var value = this._getDefaultValue();
    }
    var toStore = {
        value: value
    };
    if (this._period !== false) {
        toStore.expiration = FAMap.Util.getNow() + this._period;
    }
    window[this.storageKey][this._getFullName()] = JSON.stringify(toStore);
}
;
FAMap.Util.PersistentStore.prototype.get = function() {
    if (!this._enabled) {
        return false;
    }
    if (this._replayData) {
        return this._replayData;
    }
    var value = window[this.storageKey][this._getFullName()];
    try {
        value = JSON.parse(value);
    } catch (e) {
        delete window[this.storageKey][this._getFullName()];
        return false;
    }
    if (typeof value !== 'object') {
        delete window[this.storageKey][this._getFullName()];
        return false;
    }
    if ('expiration'in value && value.expiration < FAMap.Util.getNow()) {
        delete window[this.storageKey][this._getFullName()];
        return false;
    }
    if ('value'in value) {
        return value.value;
    } else {
        delete window[this.storageKey][this._getFullName()];
        return false;
    }
}
;
FAMap.Util.PersistentStores = {};
FAMap.Util.PersistentStores.BaseLayer = function() {
    this.key = 'BaseLayer';
    FAMap.Util.PersistentStore.apply(this, arguments);
}
;
FAMap.Util.PersistentStores.BaseLayer.prototype = Object.create(FAMap.Util.PersistentStore.prototype);
FAMap.Util.PersistentStores.LiveLoop = function() {
    this.key = 'LiveLoop';
    if (window.parent === window) {
        this.storageKey = 'sessionStorage';
    }
    FAMap.Util.PersistentStore.apply(this, arguments);
}
;
FAMap.Util.PersistentStores.LiveLoop.prototype = Object.create(FAMap.Util.PersistentStore.prototype);
FAMap.Util.PersistentStores.Overlays = function() {
    this.key = 'Overlays';
    this.setItem = function(key, value) {
        var currentVal = this.get();
        if (currentVal === false) {
            var currentVal = {};
            $.each(this._map._configHandler._sources.Defaults._values, function(k, v) {
                if (k.indexOf('overlay_') !== 0) {
                    return true;
                }
                var overlayName = k.replace('overlay_', '');
                currentVal[overlayName] = v;
            });
        }
        var keyParts = key.split('.');
        var lastPart = keyParts.pop();
        var subVal = currentVal;
        $.each(keyParts, function() {
            if (!(this in subVal)) {
                subVal[this] = {};
            }
            subVal = subVal[this];
        });
        subVal[lastPart] = value;
        this.set(currentVal);
    }
    FAMap.Util.PersistentStore.apply(this, arguments);
}
;
FAMap.Util.PersistentStores.Overlays.prototype = Object.create(FAMap.Util.PersistentStore.prototype);
FAMap.Util.PersistentStores.ZoomTo = function() {
    this.key = 'ZoomTo';
    this._getDefaultValue = function() {
        var view = this._map._olMap.getView();
        var ZoomTo = {
            center: this._map.getCorrectedCenter(),
            zoom: view.getZoom()
        };
        return ZoomTo;
    }
    ;
    FAMap.Util.PersistentStore.apply(this, arguments);
}
;
FAMap.Util.PersistentStores.ZoomTo.prototype = Object.create(FAMap.Util.PersistentStore.prototype);
FAMap.Util.Segments = {
    _slopeInterceptCache: {},
    _getSlopeIntercept: function(seg) {
        var key = [seg[0][0], seg[1][0], seg[0][1], seg[1][1]].join('_');
        if (!(key in FAMap.Util.Segments._slopeInterceptCache)) {
            var slope = (seg[1][1] - seg[0][1]) / (seg[1][0] - seg[0][0]);
            var intercept = seg[0][1] - (slope * seg[0][0]);
            FAMap.Util.Segments._slopeInterceptCache[key] = {
                slope: slope,
                intercept: intercept
            };
        }
        return FAMap.Util.Segments._slopeInterceptCache[key];
    },
    getIntersection: function(s1, s2) {
        var xMin1 = Math.min(s1[0][0], s1[1][0]);
        var xMax1 = Math.max(s1[0][0], s1[1][0]);
        var yMin1 = Math.min(s1[0][1], s1[1][1]);
        var yMax1 = Math.max(s1[0][1], s1[1][1]);
        var xMin2 = Math.min(s2[0][0], s2[1][0]);
        var xMax2 = Math.max(s2[0][0], s2[1][0]);
        var yMin2 = Math.min(s2[0][1], s2[1][1]);
        var yMax2 = Math.max(s2[0][1], s2[1][1]);
        if (xMin2 > xMax1 || xMin1 > xMax2 || yMin2 > yMax1 || yMin1 > yMax2) {
            return false;
        }
        var slope1 = FAMap.Util.Segments._getSlopeIntercept(s1).slope;
        var intercept1 = FAMap.Util.Segments._getSlopeIntercept(s1).intercept;
        var slope2 = FAMap.Util.Segments._getSlopeIntercept(s2).slope;
        var intercept2 = FAMap.Util.Segments._getSlopeIntercept(s2).intercept;
        if (slope1 === slope2) {
            return intercept1 === intercept2;
        }
        var xI = (intercept2 - intercept1) / (slope1 - slope2);
        if (xI < xMin1 || xI > xMax1 || xI < xMin2 || xI > xMax2) {
            return false;
        }
        var yI = slope1 * xI + intercept1;
        if (yI < yMin1 || yI > yMax1 || yI < yMin2 || yI > yMax2) {
            return false;
        }
        return [xI, yI];
    },
    getDistance: function(segment, point) {
        var segSlope = FAMap.Util.Segments._getSlopeIntercept(segment).slope;
        var segIntercept = FAMap.Util.Segments._getSlopeIntercept(segment).intercept;
        var lineSlope = (1 / segSlope) * -1;
        var lineIntercept = point[1] - (lineSlope * point[0]);
        var xI = (lineIntercept - segIntercept) / (segSlope - lineSlope);
        var x1 = segment[0][0];
        var x2 = segment[1][0];
        if (xI >= Math.min(x1, x2) && xI <= Math.max(x1, x2)) {
            var yI = segSlope * xI + segIntercept;
            var y1 = segment[0][1];
            var y2 = segment[1][1];
            if (yI >= Math.min(y1, y2) && yI <= Math.max(y1, y2)) {
                var intersection = [xI, yI];
                return FAMap.Util.refSphere.haversineDistance([xI, yI], point);
            }
        }
        var dist1 = FAMap.Util.refSphere.haversineDistance(segment[0], point);
        var dist2 = FAMap.Util.refSphere.haversineDistance(segment[1], point);
        return Math.min(dist1, dist2);
    }
};
FAMap.Util.TextCycler = function(map, options) {
    this.FAMap = map;
    this._fixedCycleInterval = options.fixedCycleInterval || null;
    this._variableCycleOpts = {
        factor: options.variableCycleFactor || 1,
        min: options.minimumCycleDelay || 3
    };
    this._currentGroup = null
    this._cycleGroups = {};
    this._cycleGroupLifetime = 60 * 1;
    this._layers = [];
    this._context = document.createElement('canvas').getContext('2d');
    this._fontHeightCache = {};
    this._textWidthCache = {};
    this._gridCache = {};
    this._getTextStyle = function(feature, layer) {
        var style;
        if (layer.getStyle() !== null) {
            style = layer.getStyle();
        } else if (feature.getStyle() !== null) {
            style = feature.getStyle();
        } else {
            return null;
        }
        if (typeof style == 'function') {
            style = style(feature, this.FAMap._olMap.getView().getResolution(), true)[0];
        } else {
            return null;
        }
        return style.getText();
    }
    ;
    this._getFontHeight = function(font) {
        if (!(font in this._fontHeightCache)) {
            this._context.font = font;
            this._fontHeightCache[font] = this._context.measureText('M').width;
        }
        return this._fontHeightCache[font];
    }
    ;
    this._getTextWidth = function(font, text) {
        var key = [font, text].join();
        if (!(key in this._textWidthCache)) {
            this._context.font = font;
            this._textWidthCache[key] = this._context.measureText(text).width;
        }
        return this._textWidthCache[key];
    }
    ;
    this.getTextDimensions = function(feature, layer) {
        var textStyle = this._getTextStyle(feature, layer);
        if (textStyle !== null) {
            var font = textStyle.getFont();
            var lines = textStyle.getText().split('\n');
            var lc = lines.length;
            var rawHeight = this._getFontHeight(font);
            var textHeight = rawHeight * lc + rawHeight * .5 * (lc - 1);
            var widths = lines.map($.proxy(function(line) {
                return this._getTextWidth(font, line)
            }, this));
            var textWidth = Math.max.apply(this, widths);
            var blockHeight = Math.ceil((textHeight + Math.abs(textStyle.getOffsetY())) * 2);
            var blockWidth = Math.ceil((textWidth + Math.abs(textStyle.getOffsetX())) * 2);
        }
        return {
            textHeight: textHeight,
            textWidth: textWidth,
            blockHeight: blockHeight,
            blockWidth: blockWidth
        };
    }
    ;
    this.addLayer = function(layer) {
        this._layers.push(layer);
        $.each(layer.getSource().getFeatures(), $.proxy(function(k, feature) {
            if (!('getCycleVisibility'in feature)) {
                feature.getCycleVisibility = $.proxy(function(hideOffscreen) {
                    return this.checkVisible(feature, hideOffscreen);
                }, this);
            }
        }, this));
        layer.getSource().on('addfeature', $.proxy(function(e) {
            var feature = e.feature;
            if (!('getCycleVisibility'in feature)) {
                feature.getCycleVisibility = $.proxy(function(hideOffscreen) {
                    return this.checkVisible(feature, hideOffscreen);
                }, this);
            }
            this._cycleGroups = {};
        }, this));
        layer.on('change:visible', $.proxy(function() {
            this._cycleGroups = {};
        }, this));
        layer.on('change:visibleChildren', $.proxy(function() {
            this._cycleGroups = {};
        }, this));
        if (Object.getPrototypeOf(layer.getSource()) !== FAMap.olExtras.Source.Animated.prototype) {
            setInterval(function() {
                layer.setStyle(layer.getStyle());
            }, 1000);
        }
    }
    ;
    this.calculatePixelGrid = function() {
        var maxHeight = 0;
        var maxWidth = 0;
        $.each(this._layers, $.proxy(function(k, layer) {
            $.each(layer.getSource().getFeatures(), $.proxy(function(k, feature) {
                var dims = this.getTextDimensions(feature, layer);
                if (dims.blockHeight > maxHeight) {
                    maxHeight = dims.blockHeight;
                }
                if (dims.blockWidth > maxWidth) {
                    maxWidth = dims.blockWidth;
                }
            }, this));
        }, this));
        return {
            x: maxWidth,
            y: maxHeight
        };
    }
    ;
    this.getPixelGrid = function() {
        if (!('pixel'in this._gridCache)) {
            this._gridCache.pixel = this.calculatePixelGrid();
        }
        return this._gridCache.pixel;
    }
    ;
    this.getLonLatGrid = function(resolution) {
        if (typeof resolution === 'undefined') {
            resolution = this.FAMap._olMap.getView().getResolution();
        }
        if (!(resolution in this._gridCache)) {
            var pixelGrid = this.getPixelGrid();
            this._gridCache[resolution] = {
                lat: pixelGrid.x * resolution,
                lon: pixelGrid.y * resolution
            };
        }
        return this._gridCache[resolution];
    }
    ;
    this._generateCycleGroups = function(resolution) {
        if (typeof resolution === 'undefined') {
            resolution = this.FAMap._olMap.getView().getResolution();
        }
        var grid = this.getLonLatGrid(resolution);
        var featureMap = [];
        $.each(this._layers, $.proxy(function(k, layer) {
            var map = layer.getSource().getFeatures().filter($.proxy(function(feature) {
                var geometry = feature.getGeometry();
                if (typeof geometry !== 'object' || geometry === null) {
                    return false;
                } else if (Object.getPrototypeOf(geometry) !== ol.geom.Point.prototype) {
                    return false;
                } else if (this._getTextStyle(feature, layer) == null) {
                    return false;
                } else {
                    return true;
                }
            }, this)).map(function(feature) {
                feature.textCollisions = [];
                feature.cycleGroups = [];
                return {
                    feature: feature,
                    layer: layer
                };
            });
            Array.prototype.push.apply(featureMap, map);
        }, this));
        var neverObscured = featureMap.map(function(item) {
            return item.feature;
        });
        if (neverObscured.length == 0) {
            return [];
        }
        var sometimesObscured = [];
        while (true) {
            var item1 = featureMap.pop();
            if (typeof item1 == 'undefined') {
                break;
            }
            var coord1 = item1.feature.getGeometry().getCoordinates();
            var cell1 = {
                x: Math.floor(Math.floor(coord1[0]) / Math.floor(grid.lon)),
                y: Math.floor(Math.floor(coord1[1]) / Math.floor(grid.lat))
            };
            var collisionCount = 0;
            $.each(featureMap, $.proxy(function(k, item2) {
                var coord2 = item2.feature.getGeometry().getCoordinates();
                var cell2 = {
                    x: Math.floor(Math.floor(coord2[0]) / Math.floor(grid.lon)),
                    y: Math.floor(Math.floor(coord2[1]) / Math.floor(grid.lat))
                };
                if (Math.abs(cell1.x - cell2.x) > 1 || Math.abs(cell1.y - cell2.y) > 1) {
                    return true;
                }
                if (typeof extent1 === 'undefined') {
                    var dims1 = this.getTextDimensions(item1.feature, item1.layer);
                    var center1 = item1.feature.getGeometry().getCoordinates();
                    var extent1 = [center1[0] - (dims1.blockWidth / 2 * resolution), center1[1] - (dims1.blockHeight / 2 * resolution), center1[0] + (dims1.blockWidth / 2 * resolution), center1[1] + (dims1.blockHeight / 2 * resolution)];
                }
                var dims2 = this.getTextDimensions(item2.feature, item2.layer);
                var center2 = item2.feature.getGeometry().getCoordinates();
                var extent2 = [center2[0] - (dims2.blockWidth / 2 * resolution), center2[1] - (dims2.blockHeight / 2 * resolution), center2[0] + (dims2.blockWidth / 2 * resolution), center2[1] + (dims2.blockHeight / 2 * resolution)];
                if (!ol.extent.intersects(extent1, extent2)) {
                    return true;
                }
                collisionCount++;
                if (item1.feature.textCollisions.indexOf(item2.feature) == -1) {
                    item1.feature.textCollisions.push(item2.feature);
                }
                if (item2.feature.textCollisions.indexOf(item1.feature) == -1) {
                    item2.feature.textCollisions.push(item1.feature);
                }
                $.each([item1, item2], function(k, item) {
                    var idx = neverObscured.indexOf(item.feature);
                    if (idx !== -1) {
                        neverObscured.splice(idx, 1);
                        sometimesObscured.push(item.feature);
                    }
                });
            }, this));
        }
        if (sometimesObscured.length == 0) {
            return [neverObscured];
        }
        var cycleGroups = [];
        var trialGroup = sometimesObscured;
        trialGroup.sort(function(a, b) {
            return b.textCollisions.length - a.textCollisions.length;
        });
        while (true) {
            var deferGroup = [];
            var feature1 = trialGroup.shift();
            var collisions = feature1.textCollisions;
            var okGroup = [feature1];
            $.each(trialGroup, function(k, feature2) {
                if (collisions.indexOf(feature2) != -1) {
                    deferGroup.push(feature2);
                } else {
                    okGroup.push(feature2);
                    Array.prototype.push.apply(collisions, feature2.textCollisions);
                }
            });
            Array.prototype.push.apply(okGroup, neverObscured);
            cycleGroups.push(okGroup);
            if (deferGroup.length == 0) {
                break;
            } else {
                trialGroup = deferGroup;
            }
        }
        $.each(cycleGroups, function(i, v) {
            var j = Math.floor(Math.random() * (i + 1));
            var temp = cycleGroups[i];
            cycleGroups[i] = cycleGroups[j];
            cycleGroups[j] = temp;
        });
        return cycleGroups;
    }
    ;
    this.getCycleGroups = function(resolution) {
        if (typeof resolution === 'undefined') {
            resolution = this.FAMap._olMap.getView().getResolution();
        }
        if (resolution in this._cycleGroups) {
            var cachedGroup = this._cycleGroups[resolution];
            var age = FAMap.Util.getNow() - cachedGroup.timestamp;
            if (age > this._cycleGroupLifetime) {
                delete this._cycleGroups[resolution];
            }
        }
        if (!(resolution in this._cycleGroups)) {
            this._cycleGroups[resolution] = {
                timestamp: FAMap.Util.getNow(),
                groups: this._generateCycleGroups(resolution)
            };
        }
        return this._cycleGroups[resolution].groups;
    }
    ;
    this.getCurrentCycleGroup = function(resolution) {
        if (typeof resolution === 'undefined') {
            resolution = this.FAMap._olMap.getView().getResolution();
        }
        var cycleGroups = this.getCycleGroups(resolution);
        if (cycleGroups.length == 0) {
            return [];
        }
        if (this._currentGroup === null || this._currentGroup.resolution !== resolution) {
            var trialIdx = Math.floor(Math.random() * cycleGroups.length) - 1;
            var trialGroup = cycleGroups[Math.max(trialIdx, 0)];
        } else {
            if (this._currentGroup.expiration <= FAMap.Util.getNow()) {
                var trialIdx = this._currentGroup.idx + 1;
                if (trialIdx > cycleGroups.length - 1) {
                    trialIdx -= cycleGroups.length;
                }
                var trialGroup = cycleGroups[trialIdx];
            } else {
                return this._currentGroup.group;
            }
        }
        var iterations = 0;
        while (true) {
            var mapExtent = this.FAMap._olMap.getView().calculateExtent(this.FAMap._olMap.getSize());
            var visibleCount = 0;
            try {
                $.each(trialGroup, $.proxy(function(k, feature) {
                    var geometry = feature.getGeometry();
                    if (typeof geometry === "undefined" || geometry === null) {
                        return true;
                    }
                    if (ol.extent.containsCoordinate(mapExtent, geometry.getCoordinates())) {
                        visibleCount++;
                    }
                }, this));
            } catch (e) {}
            if (visibleCount > 0) {
                break;
            } else {
                trialIdx++;
                if (trialIdx > cycleGroups.length - 1) {
                    trialIdx -= cycleGroups.length;
                }
            }
            iterations++;
            if (iterations > cycleGroups.length) {
                break;
            }
        }
        if (this._fixedCycleInterval !== null) {
            var interval = this._fixedCycleInterval;
        } else {
            var variableInterval = this._variableCycleOpts.factor * visibleCount;
            var minInterval = this._variableCycleOpts.min;
            var interval = Math.max(variableInterval, minInterval);
        }
        this._currentGroup = {
            group: trialGroup,
            idx: trialIdx,
            resolution: resolution,
            expiration: FAMap.Util.getNow() + interval
        };
        return trialGroup;
    }
    ;
    this.checkVisible = function(feature, hideOffscreen) {
        if (this.FAMap.activeState == 'active') {
            return false;
        }
        if (typeof hideOffscreen === 'undefined') {
            hideOffscreen = false;
        }
        if (hideOffscreen) {
            var cycleGroup = this.getCurrentCycleGroup();
            if (cycleGroup !== undefined && cycleGroup.indexOf(feature) !== -1) {
                var geometry = feature.getGeometry();
                if (typeof geometry !== "object" || geometry === null) {
                    return false;
                } else {
                    var mapExtent = this.FAMap._olMap.getView().calculateExtent(this.FAMap._olMap.getSize());
                    return ol.extent.containsCoordinate(mapExtent, geometry.getCoordinates())
                }
            } else {
                return false;
            }
        } else {
            return this.getCurrentCycleGroup().indexOf(feature) !== -1;
        }
    }
    ;
}
;
FAMap.Animation = {};
FAMap.Animation.Clock = function(options) {
    this.delay = 0;
    this.epoch = null;
    this.rate = 1;
    this.pendingDelta = 0;
    this.lastUpdateTime = null;
    this.interval = 0.042;
    this.updateInterval = null;
    this.onEpochUpdate = function() {}
    ;
    this.onRateChange = function() {}
    ;
    this.updateEpoch = function() {
        var currentTime = Date.now() / 1000;
        var elapsedClockTime = this.rate * (currentTime - this.lastUpdateTime);
        this.lastUpdateTime = currentTime;
        this.pendingDelta += elapsedClockTime;
        if (this.pendingDelta < 1) {
            return;
        }
        var epoch = this.epoch + Math.round(this.pendingDelta);
        this.pendingDelta = 0;
        var now = this.getNow();
        if (epoch > now) {
            epoch = now;
        }
        this.setTime(epoch);
    }
    ;
    this.setTime = function(timestamp) {
        if (timestamp == this.epoch) {
            return;
        }
        this.epoch = timestamp;
        this.onEpochUpdate(this.epoch);
    }
    ;
    this.setRate = function(rate) {
        this.rate = rate;
        this.onRateChange(this.rate);
    }
    ;
    this.getNow = function() {
        return FAMap.Util.getNow() - this.delay;
    }
    ;
    this.init = function(options) {
        if ('interval'in options) {
            this.interval = options.interval;
        }
        if ('onEpochUpdate'in options) {
            this.onEpochUpdate = options.onEpochUpdate;
        }
        if ('onRateChange'in options) {
            this.onRateChange = options.onRateChange;
        }
        if ('delay'in options) {
            this.delay = options.delay;
        }
        if ('initialEpoch'in options) {
            this.epoch = options.initialEpoch
        } else {
            this.epoch = this.getNow();
        }
        this.lastUpdateTime = Date.now() / 1000;
        this.updateInterval = setInterval($.proxy(this.updateEpoch, this), this.interval * 1000);
    }
    ;
    this.init(options || {});
}
;
FAMap.Animation.Controller = function(map, options) {
    this.FAMap = map;
    this._options = options;
    this._firstLoad = true;
    this._poller = null;
    this._clock = null;
    this.knownFlights = {};
    this.pendingFlights = {};
    this.activeFlights = {};
    this.registeredSources = [];
    this.onNewFlights = $.proxy(function(batch) {
        $.each(batch, $.proxy(function(k, v) {
            this.knownFlights[v.flight_id] = v.flightData;
            this.pendingFlights[v.flight_id] = {
                initialArgs: {
                    flight_id: v.flight_id,
                    flightData: v.flightData
                },
                subsequentData: []
            };
        }, this));
        $.each(batch, $.proxy(function(k, v) {
            $.each(this.registeredSources, $.proxy(function(k, source) {
                if (source.filter(v.flight_id, v.flightData)) {
                    this.addFeaturesToSource(source, v.flight_id);
                }
            }, this));
        }, this));
        this.FAMap.trigger('animationController.newFlights', [batch]);
        if (this._firstLoad) {
            this.FAMap.trigger('animation.firstload');
            this._firstLoad = false;
            if (this._options.singleFlight && batch.length > 0) {
                var fd = batch[0].flightData;
                var historical = fd.flightStatus != "" && fd.flightStatus != 'airborne';
                if (historical) {
                    if (fd.landingTimes.actual !== null) {
                        this.FAMap.setValidTimes(fd.takeoffTimes.actual, fd.landingTimes.actual);
                    } else if (fd.cancelled) {
                        this.FAMap.setValidTimes(fd.takeoffTimes.scheduled, fd.landingTimes.scheduled);
                    } else if (fd.landingTimes.estimated !== null) {
                        this.FAMap.setValidTimes(fd.takeoffTimes.estimated, fd.landingTimes.estimated);
                    }
                }
            }
        }
    }, this);
    this.onUpdatedFlights = $.proxy(function(batch) {
        $.each(batch, $.proxy(function(k, v) {
            if (v.flight_id in this.activeFlights) {
                this.activeFlights[v.flight_id].onDataReceived(v.flightData);
            } else {
                this.pendingFlights[v.flight_id].subsequentData.push(v.flightData);
            }
        }, this));
    }, this);
    this.getFlight = function(flight_id) {
        if (!(flight_id in this.activeFlights)) {
            if (!(flight_id in this.pendingFlights)) {
                return false;
            }
            var pending = this.pendingFlights[flight_id];
            var initialArgs = pending.initialArgs;
            this.activeFlights[flight_id] = new FAMap.Animation.Flight(initialArgs.flight_id,initialArgs.flightData,this.FAMap);
            $.each(pending.subsequentData, $.proxy(function(k, flightData) {
                this.activeFlights[flight_id].onDataReceived(flightData);
            }, this));
            delete this.pendingFlights[flight_id];
        }
        var flight = this.activeFlights[flight_id];
        if (this._clock === null) {
            var stalenesses = [];
            var maxStaleness = 15 * 60;
            $.each(this.knownFlights, function() {
                if (this.landingTimes.actual == null && this.takeoffTimes.actual !== null && this.staleness <= maxStaleness) {
                    stalenesses.push(this.staleness);
                }
            });
            if (stalenesses.length == 0) {
                var delay = 0;
            } else {
                stalenesses.sort(function(a, b) {
                    return a - b;
                });
                var targetPercentile = .9;
                var targetLength = Math.round(stalenesses.length * targetPercentile);
                var delay = stalenesses.slice(0, targetLength).pop();
            }
            delay += this._poller.interval / 1000;
            this._clock = new FAMap.Animation.Clock({
                delay: delay,
                onEpochUpdate: $.proxy(this.onClockUpdate, this),
                onRateChange: $.proxy(this.onClockRateChange, this)
            });
            this.FAMap.trigger('animationController.clockCreated');
        }
        flight.setAnimationTimestamp(FAMap.Util.getNow() - this._clock.delay);
        return flight;
    }
    ;
    this.getClockTime = function() {
        if (this._clock === null) {
            return null;
        }
        return this._clock.epoch;
    }
    ;
    this.setClockTime = function(timestamp) {
        if (this._clock === null) {
            return;
        }
        this._clock.setTime(timestamp);
    }
    ;
    this.getClockRate = function() {
        if (this._clock === null) {
            return null;
        }
        return this._clock.rate;
    }
    ;
    this.setClockRate = function(rate) {
        if (this._clock === null) {
            return;
        }
        this._clock.setRate(rate);
    }
    ;
    this.registerSource = function(source) {
        this.registeredSources.push(source);
        $.each(this.knownFlights, $.proxy(function(flight_id, flightData) {
            if (source.filter(flight_id, flightData)) {
                this.addFeaturesToSource(source, flight_id);
            }
        }, this));
    }
    ;
    this.addFeaturesToSource = function(source, flight_id) {
        if ('features'in source) {
            var flight = this.getFlight(flight_id);
            var features = [];
            $.each(source.features, function(k, featureType) {
                var newFeatures = flight.getAnimationFeatureSet(featureType).features;
                features = features.concat(newFeatures);
            });
            source.addFeatures(features);
        }
    }
    ;
    this.onClockUpdate = function(timestamp) {
        this.FAMap.trigger('animationController.clockTimeChange', timestamp);
        $.each(this.activeFlights, function() {
            if (typeof this.setAnimationTimestamp === 'function') {
                this.setAnimationTimestamp(timestamp);
            }
        });
    }
    ;
    this.onClockRateChange = function(rate) {
        this.FAMap.trigger('animationController.clockRateChange', rate);
    }
    ;
    this.init = function(map, options) {
        options.onNewFlights = this.onNewFlights;
        options.onUpdatedFlights = this.onUpdatedFlights;
        this._poller = new TrackPollClient(map,options);
    }
    ;
    this.init.apply(this, arguments);
}
;
FAMap.Animation.FeatureSet = function(flight) {
    this._flight = flight;
    this.features = [];
}
;
FAMap.Animation.FeatureSet.prototype.updateAnimationTimestamp = function(timestamp) {
    if (this.animationTimestamp === timestamp) {
        return;
    }
    this.animationTimestamp = timestamp;
    this.onAnimationTimestampChange();
}
;
FAMap.Animation.FeatureSet.prototype.onAnimationTimestampChange = function() {}
;
FAMap.Animation.FeatureSets = {};
FAMap.Animation.FeatureSets.Endpoints = function(flight, airborneOnly) {
    if (typeof airborneOnly == 'undefined') {
        airborneOnly = false;
    }
    this.airborneOnly = airborneOnly;
    this.animationTimestamp = null;
    this.originFeature = new ol.Feature();
    this.destinationFeature = new ol.Feature();
    this.headingRef = [{
        align: 'right',
        baseline: 'top'
    }, {
        align: 'right',
        baseline: 'bottom'
    }, {
        align: 'left',
        baseline: 'bottom'
    }, {
        align: 'left',
        baseline: 'top'
    }];
    FAMap.Animation.FeatureSet.apply(this, arguments);
    if (this.airborneOnly) {
        this.onAnimationTimestampChange = function() {
            this.setGeometries();
        }
        ;
    }
    this._geometriesAreEqual = function(g1, g2) {
        try {
            g1.getCoordinates();
        } catch (e) {
            g1 = null;
        }
        try {
            g2.getCoordinates();
        } catch (e) {
            g2 = null;
        }
        if (g1 === null && g2 === null) {
            return true;
        }
        if (g1 !== null && g2 !== null) {
            return g1.getCoordinates().join() == g2.getCoordinates().join();
        }
        return false;
    }
    ;
    this.setGeometries = function() {
        var position = this._flight.getPositionAt(this.animationTimestamp);
        if (this.airborneOnly && position.state != 'airborne') {
            var originGeometry = null;
            var destinationGeometry = null;
        } else {
            var flightData = this._flight.fullFlightData;
            if (flightData.origin && flightData.origin.coord !== null) {
                var originGeometry = new ol.geom.Point(flightData.origin.coord);
                originGeometry.transform('EPSG:4326', 'EPSG:3857');
            } else {
                var originGeometry = null;
            }
            if (flightData.destination && flightData.destination.coord !== null) {
                var destinationGeometry = new ol.geom.Point(flightData.destination.coord);
                destinationGeometry.transform('EPSG:4326', 'EPSG:3857');
            } else {
                var destinationGeometry = null;
            }
        }
        if (!this._geometriesAreEqual(originGeometry, this.originFeature.getGeometry())) {
            this.originFeature.setGeometry(originGeometry);
        }
        if (!this._geometriesAreEqual(destinationGeometry, this.destinationFeature.getGeometry())) {
            this.destinationFeature.setGeometry(destinationGeometry);
        }
    }
    ;
    this.init = function() {
        if (flight.animationTimestamp !== null) {
            this.animationTimestamp = flight.animationTimestamp;
        } else {
            this.animationTimestamp = FAMap.Util.getNow();
        }
        var flightData = this._flight.fullFlightData;
        if (flightData.origin && flightData.destination) {
            var oCoord = flightData.origin.coord;
            var dCoord = flightData.destination.coord;
            var outboundHeading = FAMap.Util.GreatCircle.bearing(oCoord, dCoord);
            var inboundHeading = FAMap.Util.GreatCircle.bearing(dCoord, oCoord);
        } else {
            var outboundHeading = FAMap.Util.toRadians(flightData.heading);
            var inboundHeading = FAMap.Util.toRadians((flightData.heading + 180) % 360);
        }
        var originQuad = Math.floor(((outboundHeading) / (Math.PI / 2)) % 4);
        var destinationQuad = Math.floor(((inboundHeading) / (Math.PI / 2)) % 4);
        if (typeof flightData.origin !== 'undefined') {
            var originIcao = null;
            if (flightData.origin.icao) {
                if (FAMap.Util.isAirportLatLon(flightData.origin.icao) && flightData.origin.friendlyName) {
                    if (typeof Rosetta === 'object') {
                        originIcao = Rosetta.getTranslation("FP_Near_City", "near %1", flightData.origin.friendlyName);
                    } else {
                        originIcao = flightData.origin.friendlyName;
                    }
                } else {
                    originIcao = flightData.origin.icao
                }
            }
            this.originFeature.set('icao', originIcao);
            this.originFeature.set('iata', flightData.origin.iata ? flightData.origin.iata : null);
            this.originFeature.set('altIdent', flightData.origin.altIdent);
            this.originFeature.set('labelAlign', this.headingRef[originQuad].align);
            this.originFeature.set('labelBaseline', this.headingRef[originQuad].baseline);
            this.originFeature.set('featureSet', 'Endpoints');
        }
        if (typeof flightData.destination !== 'undefined') {
            var destinationIcao = null;
            if (flightData.destination.icao) {
                if (FAMap.Util.isAirportLatLon(flightData.destination.icao) && flightData.destination.friendlyName) {
                    if (typeof Rosetta === 'object') {
                        destinationIcao = Rosetta.getTranslation("FP_Near_City", "near %1", flightData.destination.friendlyName);
                    } else {
                        destinationIcao = flightData.destination.friendlyName;
                    }
                } else {
                    destinationIcao = flightData.destination.icao
                }
            }
            this.destinationFeature.set('icao', destinationIcao);
            this.destinationFeature.set('iata', flightData.destination.iata ? flightData.destination.iata : null);
            this.destinationFeature.set('altIdent', flightData.destination.altIdent);
            this.destinationFeature.set('labelAlign', this.headingRef[destinationQuad].align);
            this.destinationFeature.set('labelBaseline', this.headingRef[destinationQuad].baseline);
            this.destinationFeature.set('featureSet', 'Endpoints');
        }
        this.originFeature.set('isGA', flightData.ga);
        this.destinationFeature.set('isGA', flightData.ga);
        this.setGeometries();
        this.features.push(this.originFeature, this.destinationFeature);
    }
    ;
    this.init();
}
;
FAMap.Animation.FeatureSets.Endpoints.prototype = Object.create(FAMap.Animation.FeatureSet.prototype);
FAMap.Animation.FeatureSets.FlexEndpoints = function(flight) {
    FAMap.Animation.FeatureSets.Endpoints.call(this, flight, true);
}
;
FAMap.Animation.FeatureSets.FlexEndpoints.prototype = Object.create(FAMap.Animation.FeatureSets.Endpoints.prototype);
FAMap.Animation.FeatureSets.Route = function(flight, showWhenNotAirborne) {
    if (typeof showWhenNotAirborne == 'undefined') {
        showWhenNotAirborne = false;
    }
    this.animationTimestamp = null;
    this.geometry = null;
    this.feature = new ol.Feature({
        geometry: null,
        featureSet: 'Route'
    });
    this.onAnimationTimestampChange = function(initial) {
        if (typeof initial == 'undefined') {
            initial = false;
        }
        var position = flight.getPositionAt(this.animationTimestamp);
        if (position == false && !initial) {
            return;
        }
        if ((position === false || position.state != 'airborne') && !showWhenNotAirborne) {
            var geometry = null;
        } else {
            var geometry = this.geometry;
        }
        this.feature.setGeometry(geometry);
    }
    ;
    FAMap.Animation.FeatureSet.apply(this, arguments);
    if (flight.fullFlightData.waypoints === null || flight.fullFlightData.waypoints.length < 2) {
        this.features = [];
    } else {
        var coords = FAMap.Util.GreatCircle.interpolate(flight.fullFlightData.waypoints);
        var linestring = new ol.geom.LineString(coords);
        this.geometry = FAMap.Util.IDL.lineStringSplit(linestring);
        this.geometry.transform('EPSG:4326', 'EPSG:3857');
        if (flight.animationTimestamp !== null) {
            this.animationTimestamp = flight.animationTimestamp;
        } else {
            this.animationTimestamp = FAMap.Util.getNow();
        }
        this.features = [this.feature];
        this.onAnimationTimestampChange(true);
    }
}
;
FAMap.Animation.FeatureSets.Route.prototype = Object.create(FAMap.Animation.FeatureSet.prototype);
FAMap.Animation.FeatureSets.FlightRoute = function(flight) {
    FAMap.Animation.FeatureSets.Route.call(this, flight, true);
}
;
FAMap.Animation.FeatureSets.FlightRoute.prototype = Object.create(FAMap.Animation.FeatureSets.Route.prototype);
FAMap.Animation.FeatureSets.Plane = function(flight) {
    this.animationTimestamp = null;
    this.planeFeature = new ol.Feature({
        featureSet: 'Plane'
    });
    this.lastCoord = null;
    this.lastData = null;
    this.lastState = null;
    FAMap.Animation.FeatureSet.apply(this, arguments);
    this.updateAttribs = function(flightData) {
        if (flightData === null || flightData === undefined) {
            return;
        }
        $.each(flightData, $.proxy(function(k, v) {
            this.planeFeature.set(k, v);
        }, this));
    }
    ;
    this.onAnimationTimestampChange = function() {
        var position = flight.getPositionAt(this.animationTimestamp);
        if (position == false) {
            return;
        }
        var redrawRequired = false;
        if (position.state == 'airborne' && this.lastCoord !== null) {
            var dist = FAMap.Util.refSphere.haversineDistance(this.lastCoord, position.coord);
            var pixelDist = dist / this._flight.FAMap._olMap.getView().getResolution();
            if (pixelDist > 1) {
                redrawRequired = true;
            }
        }
        if (this.lastData === null) {
            attribsChanged = true;
        } else {
            var attribsChanged = false;
            var attribKeys = ['altitude', 'groundspeed'];
            attribKeys.forEach($.proxy(function(k) {
                if (this.lastData[k] !== position.flightData[k]) {
                    attribsChanged = true;
                }
            }, this));
        }
        if (attribsChanged) {
            this.updateAttribs(position.flightData);
            redrawRequired = true;
        }
        this.lastData = position.flightData;
        var currentState = position.state;
        if (currentState !== this.lastState) {
            this.lastState = currentState;
            redrawRequired = true;
        }
        if (!redrawRequired) {
            return;
        }
        if (currentState != 'airborne') {
            var geometry = null;
            this.lastCoord = null;
            this.lastData = null;
        } else {
            var geometry = new ol.geom.Point(position.coord);
            geometry.transform('EPSG:4326', 'EPSG:3857');
            this.lastCoord = position.coord;
        }
        this.setGeometry(geometry);
        if (position.heading !== this.planeFeature.get('heading')) {
            if (position.heading !== undefined && position.heading !== null) {
                this.planeFeature.set('direction', position.heading);
            } else {
                this.planeFeature.set('direction', position.flightData.heading);
            }
        }
    }
    ;
    this.init = function(flight) {
        if (flight.animationTimestamp !== null) {
            this.animationTimestamp = flight.animationTimestamp;
        } else {
            this.animationTimestamp = FAMap.Util.getNow();
        }
        this.updateAttribs(flight.fullFlightData);
        this.features.push(this.planeFeature);
        this.onAnimationTimestampChange();
    }
    ;
    this.init(flight);
}
;
FAMap.Animation.FeatureSets.Plane.prototype = Object.create(FAMap.Animation.FeatureSet.prototype);
FAMap.Animation.FeatureSets.Plane.prototype.setGeometry = function(geometry) {
    this.planeFeature.setGeometry(geometry);
}
;
FAMap.Animation.FeatureSets.PlaneRoute = function(flight) {
    this.PlaneFeatureSet = null;
    this.RouteFeatureSet = null;
    this.updateAnimationTimestamp = function(timestamp) {
        if (this.animationTimestamp === timestamp) {
            return;
        }
        this.PlaneFeatureSet.animationTimestamp = timestamp;
        this.RouteFeatureSet.animationTimestamp = timestamp;
        this.PlaneFeatureSet.onAnimationTimestampChange();
        this.RouteFeatureSet.onAnimationTimestampChange();
    }
    ;
    this.init = function(flight) {
        this.PlaneFeatureSet = new FAMap.Animation.FeatureSets.Plane(flight);
        var planeFeature = this.PlaneFeatureSet.features[0];
        this.features = [planeFeature];
        this.RouteFeatureSet = new FAMap.Animation.FeatureSets.Route(flight);
        var routeFeature = this.RouteFeatureSet.features[0];
        if (typeof routeFeature !== 'undefined') {
            routeFeature.getCycleVisibility = function() {
                if ('getCycleVisibility'in planeFeature) {
                    return planeFeature.getCycleVisibility(true);
                } else {
                    return false;
                }
            }
            ;
            this.features.push(routeFeature);
            planeFeature.routeFeature = routeFeature;
        }
    }
    ;
    this.init(flight);
}
;
FAMap.Animation.FeatureSets.PlaneRoute.prototype = Object.create(FAMap.Animation.FeatureSet.prototype);
FAMap.Animation.FeatureSets.Shadow = function(flight) {
    this.scaleAltitude = null;
    this.getScaleAltitude = function(nocache) {
        if (typeof nocache === 'undefined') {
            nocache = false;
        }
        if (this.scaleAltitude === null || nocache) {
            this.scaleAltitude = this.planeFeature.get('altitude') / 60;
        }
        return this.scaleAltitude;
    }
    ;
    this.setGeometry = function(geometry) {
        if (geometry != null) {
            var res = this._flight.FAMap._olMap.getView().getResolution();
            var shift = this.getScaleAltitude() * res;
            var offsetCoord = geometry.getCoordinates();
            this.planeFeature.set('originalCoords', [offsetCoord[0], offsetCoord[1]]);
            ol.coordinate.add(offsetCoord, [shift, -shift]);
            geometry.setCoordinates(offsetCoord);
        } else {
            this.planeFeature.set('originalCoords', null);
        }
        this.planeFeature.setGeometry(geometry);
    }
    ;
    FAMap.Animation.FeatureSets.Plane.apply(this, arguments);
    this.planeFeature.set('featureSet', 'Shadow');
    this.planeFeature.on('propertychange', $.proxy(function(e) {
        if (e.key == 'altitude') {
            this.scaleAltitude = null;
        }
    }, this));
    this._flight.FAMap._olMap.getView().on('change:resolution', $.proxy(function() {
        var originalCoords = this.planeFeature.get('originalCoords');
        var geometry;
        if (originalCoords != null) {
            geometry = new ol.geom.Point(originalCoords);
        } else {
            geometry = null;
        }
        this.setGeometry(geometry);
    }, this));
}
;
FAMap.Animation.FeatureSets.Shadow.prototype = Object.create(FAMap.Animation.FeatureSets.Plane.prototype);
FAMap.Animation.FeatureSets.Track = function(flight) {
    this.animationTimestamp = null;
    this.segmentCache = {};
    this.projectedFeature = new ol.Feature({
        geometry: this.projectedGeometry,
        isProjected: true,
        featureSet: 'Track'
    });
    this.actualFeature = new ol.Feature({
        geometry: this.actualGeometry,
        isProjected: false,
        featureSet: 'Track'
    });
    this.isolatedPositionFeature = new ol.Feature({
        geometry: this.isolatedPositionGeometry,
        featureSet: 'IsolatedPosition'
    });
    FAMap.Animation.FeatureSet.apply(this, arguments);
    this.onAnimationTimestampChange = function() {
        var positions = flight.track.getTrackBetween(null, this.animationTimestamp);
        var pGeometry = new ol.geom.MultiLineString([]);
        var aGeometry = new ol.geom.MultiLineString([]);
        var iGeometry = new ol.geom.MultiPoint([])
        var prevPos = null;
        $.each(positions, $.proxy(function(ts, position) {
            if (position.flightData.isolated && ['P', 'TP'].indexOf(position.flightData.updateType) == -1) {
                var isoPoint = new ol.geom.Point(position.coord);
                isoPoint.transform('EPSG:4326', 'EPSG:3857');
                iGeometry.appendPoint(isoPoint);
            }
            if (prevPos === null) {
                prevPos = position;
                return true;
            }
            if (ts > this.animationTimestamp) {
                return false;
            }
            var segment;
            if (ts in this.segmentCache) {
                segment = this.segmentCache[ts];
            } else {
                segment = this.createSegment(prevPos, position);
                this.segmentCache[ts] = segment;
            }
            var geometry = (segment.projected) ? pGeometry : aGeometry;
            segment.linestrings.forEach(function(s) {
                geometry.appendLineString(s);
            });
            prevPos = position;
        }, this));
        if (prevPos !== null) {
            var position = flight.getPositionAt(this.animationTimestamp);
            var endpoints = [prevPos.coord, position.coord];
            var newGeometry = new ol.geom.LineString(endpoints);
            var multi = FAMap.Util.IDL.lineStringSplit(newGeometry);
            multi.transform('EPSG:4326', 'EPSG:3857');
            var geometry = (this.isProjected(prevPos, position)) ? pGeometry : aGeometry;
            multi.getLineStrings().forEach(function(s) {
                geometry.appendLineString(s);
            });
        }
        this.projectedFeature.setGeometry(pGeometry);
        this.actualFeature.setGeometry(aGeometry);
        this.isolatedPositionFeature.setGeometry(iGeometry);
    }
    ;
    this.createSegment = function(p1, p2) {
        var endpoints = [p1.coord, p2.coord];
        var newGeometry = new ol.geom.LineString(endpoints);
        var multi = FAMap.Util.IDL.lineStringSplit(newGeometry);
        multi.transform('EPSG:4326', 'EPSG:3857');
        return {
            linestrings: multi.getLineStrings(),
            projected: this.isProjected(p1, p2)
        };
    }
    ;
    this.isProjected = function(pos1, pos2) {
        var t1 = pos1.flightData.updateType;
        var t2 = pos2.flightData.updateType;
        return !(['P', 'TP'].indexOf(t1) == -1 && ['P', 'TP'].indexOf(t2) == -1);
    }
    ;
    this.init = function(flight) {
        if (flight.animationTimestamp !== null) {
            this.animationTimestamp = flight.animationTimestamp;
        } else {
            this.animationTimestamp = FAMap.Util.getNow();
        }
        this.onAnimationTimestampChange();
        this.features.push(this.projectedFeature, this.actualFeature, this.isolatedPositionFeature);
    }
    ;
    this.init(flight);
}
;
FAMap.Animation.FeatureSets.Track.prototype = Object.create(FAMap.Animation.FeatureSet.prototype);
FAMap.Animation.FeatureSets.Trail = function(flight) {
    this.animationTimestamp = null;
    this.trailFeature = new ol.Feature({
        featureSet: 'Trail'
    });
    this.trailLength = 5 * 60;
    FAMap.Animation.FeatureSet.apply(this, arguments);
    this.onAnimationTimestampChange = function() {
        var position = flight.getPositionAt(this.animationTimestamp);
        if (position.state != 'airborne') {
            var geometry = null;
        } else {
            var trail = this._flight.track.getTrail(this.animationTimestamp, this.trailLength);
            var coords = [];
            var timestamps = Object.keys(trail).sort();
            $.each(timestamps, function() {
                var pos = trail[this];
                coords.push(pos.coord);
            });
            if (coords.length > 1) {
                var geometry = FAMap.Util.IDL.lineStringSplit(new ol.geom.LineString(coords));
                geometry.transform('EPSG:4326', 'EPSG:3857');
            } else {
                var geometry = null;
            }
        }
        this.trailFeature.setGeometry(geometry);
    }
    ;
    this.init = function(flight) {
        if (flight.animationTimestamp !== null) {
            this.animationTimestamp = flight.animationTimestamp;
        } else {
            this.animationTimestamp = FAMap.Util.getNow();
        }
        this.onAnimationTimestampChange();
        this.features.push(this.trailFeature);
    }
    ;
    this.init(flight);
}
;
FAMap.Animation.FeatureSets.Trail.prototype = Object.create(FAMap.Animation.FeatureSet.prototype);
FAMap.Animation.Flight = function(id, flightData, map) {
    this.FAMap = map;
    this.id = null;
    this.fullFlightData = null;
    this.flightData = {};
    this.track = null;
    this._stalenessValue = null;
    this.animationFeatureSets = {};
    this.animationTimestamp = null;
    this.extent = null;
    this.getAnimationFeatureSet = function(type) {
        if (!(type in this.animationFeatureSets)) {
            this.animationFeatureSets[type] = new FAMap.Animation.FeatureSets[type](this);
        }
        return this.animationFeatureSets[type];
    }
    ;
    this.setAnimationTimestamp = function(timestamp) {
        if (this.animationTimestamp === timestamp) {
            return;
        }
        var oldState = this.getStateAt(this.animationTimestamp);
        var newState = this.getStateAt(timestamp);
        if (oldState !== newState) {
            this.FAMap.trigger('animationFlight.stateChange', [this, newState]);
        }
        this.animationTimestamp = timestamp;
        $.each(this.animationFeatureSets, function() {
            this.updateAnimationTimestamp(timestamp);
        });
    }
    ;
    this.getDepartureTime = function() {
        var timestamps = Object.keys(this.flightData).sort();
        if (timestamps.length > 1) {
            var ts = timestamps.pop();
            var flightData = this.flightData[ts];
        } else {
            var flightData = this.fullFlightData;
        }
        return flightData.takeoffTimes.actual;
    }
    ;
    this.getArrivalTime = function() {
        var ts;
        var timestamps = Object.keys(this.flightData).sort();
        if (timestamps.length > 0) {
            ts = timestamps.pop();
            var flightData = this.flightData[ts];
        } else {
            ts = null;
            var flightData = this.fullFlightData;
        }
        var arrivalTime;
        if (flightData.landingTimes.actual === flightData.takeoffTimes.actual) {
            arrivalTime = ts;
        } else {
            arrivalTime = flightData.landingTimes.actual;
        }
        if (arrivalTime !== null) {
            return arrivalTime;
        } else if (ts !== null && (FAMap.Util.getNow() - ts) > (30 * 60)) {
            return ts;
        } else {
            return null;
        }
    }
    ;
    this.getStateAt = function(timestamp) {
        var position = this.track.getPosition(timestamp);
        if (this.getArrivalTime() !== null && this.getArrivalTime() <= timestamp) {
            return 'historical';
        } else if (this.getDepartureTime() !== null && this.getDepartureTime() < timestamp) {
            return 'airborne';
        } else {
            return 'future';
        }
    }
    ;
    this.getState = function() {
        return this.getStateAt(this.animationTimestamp);
    }
    ;
    this.getLatestState = function() {
        if (this.getArrivalTime() !== null) {
            return 'historical';
        } else if (this.getDepartureTime() !== null) {
            return 'airborne';
        } else {
            return 'future';
        }
    }
    ;
    this.getPositionAt = function(timestamp) {
        var position = this.track.getPosition(timestamp);
        position.state = this.getStateAt(timestamp);
        return position;
    }
    ;
    this.getPosition = function() {
        return this.getPositionAt(this.animationTimestamp);
    }
    ;
    this.getStaleness = function() {
        if (this._stalenessValue === null) {
            if (this.getArrivalTime() > 0) {
                this._stalenessValue = 0;
            } else {
                var ts = this.getLatestTimestamp();
                if (ts == 0) {
                    return false;
                }
                this._stalenessValue = FAMap.Util.getNow() - ts;
            }
        }
        return this._stalenessValue;
    }
    ;
    this.getLatestTimestamp = function() {
        var timestamps = Object.keys(this.flightData).sort();
        if (timestamps.length == 0) {
            return 0;
        } else {
            return timestamps.pop();
        }
    }
    ;
    this.getLatestPosition = function() {
        var ts = this.getLatestTimestamp();
        if (ts === 0) {
            return false;
        }
        return this.flightData[ts];
    }
    ;
    this.onDataReceived = function(flightData, firstTime) {
        this.FAMap.trigger('animationFlight.flightDataChange', [flightData]);
        if (flightData.timestamp === null && !firstTime) {
            return;
        }
        var lastTs = this.getLatestTimestamp();
        if (lastTs > 0 && flightData.timestamp <= lastTs) {
            if (flightData.landingTimes.actual !== this.flightData[lastTs].landingTimes.actual) {
                this.flightData[lastTs].landingTimes.actual = flightData.landingTimes.actual;
            }
            return;
        }
        var latestPosition = this.getLatestPosition();
        if (latestPosition !== false) {
            try {
                var last = latestPosition.coord.join();
                var now = flightData.coord.join();
                if (last == now) {
                    return;
                }
            } catch (e) {}
        }
        var spliceLimit = FAMap.Util.getNow() - this.getStaleness();
        this.track.addPositions(flightData, spliceLimit);
        var ts = (flightData.timestamp !== null) ? flightData.timestamp : 0;
        this.flightData[ts] = flightData;
        this.extent = FAMap.Util.getBoundingExtent(this.FAMap, [{
            flightData: {
                track: this.track.getAllPositions(true),
                waypoints: null
            }
        }]);
    }
    ;
    this.init = function(id, flightData) {
        this.id = id;
        this.fullFlightData = flightData;
        this.track = new FAMap.Animation.Track(this.getArrivalTime() > 0);
        if (this.FAMap._animationController && this.FAMap._animationController._options.singleFlight && this.getArrivalTime() > 0) {
            this.FAMap.trigger('animationFlight.stateChange', [this, 'historical']);
        }
        this.onDataReceived(flightData, true);
    }
    ;
    this.init.apply(this, arguments);
}
;
FAMap.Animation.Track = function(historical) {
    this.positions = null;
    this.cachedTrackSegments = null;
    this.headingCache = {};
    this.cachedInterpolationTimestamps = null;
    this.cachedPositions = {};
    this.isHistorical = historical || false;
    this.generateTimedTrack = function(flightData) {
        if (!('track')in flightData) {
            return false;
        }
        var positions = flightData.track;
        if (positions === null || positions.length == 0) {
            return false;
        }
        if (flightData.coord !== null) {
            var lastPosition = positions.slice(-1)[0];
            var lonDiff = lastPosition.coord[0] - flightData.coord[0];
            var latDiff = lastPosition.coord[1] - flightData.coord[1];
            var diffScore = Math.abs(lonDiff) + Math.abs(latDiff);
            var sigScore = 0.5;
            if (diffScore > sigScore && flightData.timestamp > 0) {
                positions.push({
                    timestamp: flightData.timestamp,
                    alt: flightData.altitude,
                    gs: flightData.groundspeed,
                    coord: flightData.coord,
                    type: flightData.updateType
                });
            }
        }
        var timedTrack = {};
        flightData.track.forEach(function(position) {
            try {
                position.coord.join();
            } catch (e) {
                return true;
            }
            var curTimestamp = position.timestamp;
            timedTrack[curTimestamp] = {
                timestamp: position.timestamp,
                flightData: {
                    altitude: position.alt,
                    groundspeed: position.gs,
                    heading: flightData.heading,
                    updateType: position.type,
                    landingTimes: flightData.landingTimes,
                    timestamp: position.timestamp,
                    isolated: position.isolated
                },
                coord: position.coord
            };
            if (flightData.origin && flightData.origin.coord !== null) {
                timedTrack[curTimestamp].origin = {
                    coord: flightData.origin.coord
                }
            }
            if (flightData.landingTimes.actual !== null) {
                timedTrack[curTimestamp].arrivalTime = flightData.landingTimes.actual;
            }
            if (flightData.takeoffTimes.actual !== null) {
                timedTrack[curTimestamp].departureTime = flightData.takeoffTimes.actual;
            }
        });
        return timedTrack;
    }
    ;
    this.getTrackSegments = function() {
        if (this.cachedTrackSegments == null) {
            this.cachedTrackSegments = {};
            var timestamps = Object.keys(this.positions).sort();
            for (var i = 0; i < (timestamps.length - 1); i++) {
                var key = timestamps[i] + '_' + timestamps[i + 1];
                this.cachedTrackSegments[key] = [this.positions[timestamps[i]].coord, this.positions[timestamps[i + 1]].coord];
            }
        }
        return this.cachedTrackSegments;
    }
    ;
    this.trimTrackTo = function(timestamp) {
        var trackKeys = Object.keys(this.positions).sort();
        if (trackKeys.indexOf(timestamp) == -1) {
            return;
        }
        while (true) {
            var key = trackKeys.pop();
            if (key == timestamp) {
                break;
            } else {
                delete this.positions[key];
            }
        }
    }
    ;
    this.spliceTracks = function(positions, newPositions, spliceLimit) {
        if (typeof spliceLimit === 'undefined') {
            var spliceLimit = 0;
        }
        var newTimestamps = Object.keys(newPositions).sort();
        var oldTimestamps = Object.keys(positions).sort();
        var oldSegments = this.getTrackSegments();
        var oldSegmentKeys = Object.keys(oldSegments).sort();
        outer: for (var i = newTimestamps.length; i > 0; i--) {
            var idx = i - 1;
            if (idx > 0 && newTimestamps[idx] > spliceLimit) {
                var thisSegment = [newPositions[newTimestamps[idx]].coord, newPositions[newTimestamps[idx - 1]].coord];
                for (var j = oldSegmentKeys.length; j > 0; j--) {
                    var segIdx = j - 1;
                    var delta = 60;
                    var oldTs = Number(oldSegmentKeys[segIdx].split('_')[1]);
                    if (oldTs < spliceLimit || (Number(newTimestamps[idx - 1]) - oldTs) > delta) {
                        break;
                    }
                    var oldSegmentIdx = oldSegmentKeys[segIdx];
                    var oldSegment = oldSegments[oldSegmentIdx];
                    if (FAMap.Util.Segments.getIntersection(thisSegment, oldSegment)) {
                        var spliceTimestamps = {
                            old: oldSegmentIdx.split('_')[0],
                            new: newTimestamps[idx]
                        };
                        break outer;
                    }
                }
            }
        }
        ;if (typeof spliceTimestamps == 'undefined') {
            var spliceTimestamps = {
                old: null,
                new: null
            };
            var minDistOuter = null;
            var minDistInner = null;
            for (var i = oldSegmentKeys.length; i > 0; i--) {
                var idx = i - 1;
                var oldSegmentIdx = oldSegmentKeys[idx];
                var oldSegment = oldSegments[oldSegmentIdx];
                for (var j = newTimestamps.length; j > 0; j--) {
                    var pidx = j - 1;
                    var thisCoord = newPositions[newTimestamps[pidx]].coord;
                    var dist = FAMap.Util.Segments.getDistance(oldSegment, thisCoord);
                    if (minDistInner == null || dist < minDistInner) {
                        minDistInner = dist;
                        spliceTimestamps.old = oldSegmentIdx.split('_')[0];
                        spliceTimestamps.new = newTimestamps[pidx + 1];
                    } else {
                        break;
                    }
                }
                if (minDistOuter == null || minDistInner < minDistOuter) {
                    minDistOuter = minDistInner;
                } else {
                    break;
                }
            }
        }
        this.trimTrackTo(spliceTimestamps.old);
        var newTimestampsTrimmed = newTimestamps.slice(newTimestamps.indexOf(spliceTimestamps.new));
        if ((spliceTimestamps.new - spliceTimestamps.old) <= 0) {
            var maxNewTimestamp = Number(newTimestampsTrimmed.slice(-1)[0]);
            var maxOldTimestamp = Number(spliceTimestamps.old);
            var timestampCorrector = function(idx, timestamp) {
                var fraction = (idx + 1) / newTimestampsTrimmed.length;
                return Math.round(maxOldTimestamp + (fraction * (maxNewTimestamp - maxOldTimestamp)));
            }
        } else {
            var timestampCorrector = function(idx, timestamp) {
                return timestamp;
            }
        }
        for (var i = 0; i < newTimestampsTrimmed.length; i++) {
            var idx = newTimestampsTrimmed[i];
            var idxCorrected = timestampCorrector(i, idx);
            this.positions[idxCorrected] = newPositions[idx];
        }
        this.cachedTrackSegments = null;
        this.cachedInterpolationTimestamps = null;
        this.cachedPositions = {};
    }
    ;
    this.addPositions = function(flightData, spliceLimit) {
        var timedTrack = this.generateTimedTrack(flightData);
        if (timedTrack === false) {
            return;
        }
        if (this.positions == null) {
            this.positions = timedTrack;
        } else {
            this.spliceTracks(this.positions, timedTrack, spliceLimit);
        }
    }
    ;
    this.getInterpolationTimestamps = function(timestamp) {
        var cache = this.cachedInterpolationTimestamps;
        if (cache === null || !(timestamp > cache.min && timestamp < cache.max)) {
            var keys = Object.keys(this.positions).sort();
            var min = null;
            var max = null;
            for (var i = 0; i < keys.length; i++) {
                if (timestamp > keys[i]) {
                    min = keys[i];
                } else {
                    max = keys[i];
                    break;
                }
            }
            this.cachedInterpolationTimestamps = cache = {
                min: min,
                max: max
            }
        }
        return cache;
    }
    this.getHeadingBetweenTimes = function(min, max) {
        if (min == null || max == null) {
            return null;
        }
        var cacheKey = min + '_' + max;
        if (!(cacheKey in this.headingCache)) {
            var c1 = this.positions[min].coord;
            var c2 = this.positions[max].coord;
            var headingRadians = FAMap.Util.GreatCircle.bearing(c1, c2);
            if (headingRadians === false) {
                this.headingCache[cacheKey] = null;
            } else {
                this.headingCache[cacheKey] = FAMap.Util.toDegrees(headingRadians);
            }
        }
        return this.headingCache[cacheKey];
    }
    this.getHeadingFromPreviousPosition = function(timestamp) {
        var points = this.getInterpolationTimestamps(timestamp - 1);
        return this.getHeadingBetweenTimes(points.min, points.max);
    }
    this.getHeadingToNextPosition = function(timestamp) {
        var points = this.getInterpolationTimestamps(timestamp + 1);
        return this.getHeadingBetweenTimes(points.min, points.max);
    }
    this.getHeadingForPosition = function(timestamp) {
        var heading = this.getHeadingToNextPosition(timestamp);
        if (heading === null) {
            heading = this.getHeadingFromPreviousPosition(timestamp);
        }
        if (heading === null) {
            var position = this.positions[timestamp];
            var flightData = position.flightData;
            if (flightData.heading == 0 && flightData.origin && flightData.origin.coord !== null) {
                var cacheKey = '_' + timestamp;
                if (!(cacheKey in this.headingCache)) {
                    var c1 = flightData.origin.coord;
                    var c2 = position.coord;
                    var headingRadians = FAMap.Util.GreatCircle.bearing(c1, c2);
                    this.headingCache[cacheKey] = FAMap.Util.toDegrees(headingRadians);
                }
                heading = this.headingCache[cacheKey];
            }
        }
        return heading;
    }
    ;
    this.getPosition = function(timestamp) {
        if (!(timestamp in this.cachedPositions)) {
            var overrideUpdateType = null;
            if (this.positions === null) {
                var position = false;
            } else if (timestamp in this.positions) {
                var heading = this.getHeadingToNextPosition(timestamp);
                if (heading == null) {
                    var heading = this.getHeadingFromPreviousPosition(timestamp);
                }
                var position = {
                    actual: true,
                    heading: this.getHeadingForPosition(timestamp),
                    coord: this.positions[timestamp].coord,
                    flightData: this.positions[timestamp].flightData
                };
            } else {
                var points = this.getInterpolationTimestamps(timestamp);
                if (points.min == null && points.max == null) {
                    var position = false;
                }
                if (points.min == null) {
                    var position = {
                        actual: false,
                        extremity: 'start',
                        heading: this.getHeadingForPosition(points.max),
                        coord: this.positions[points.max].coord,
                        flightData: this.positions[points.max].flightData
                    };
                } else if (points.max == null) {
                    var position = {
                        actual: false,
                        extremity: 'end',
                        timestamp: Object.keys(this.positions).sort().pop(),
                        arrivalTime: this.positions[points.min].arrivalTime,
                        heading: this.getHeadingForPosition(points.min),
                        coord: this.positions[points.min].coord,
                        flightData: this.positions[points.min].flightData
                    };
                } else {
                    var c1 = this.positions[points.min].coord.slice(0);
                    var c2 = this.positions[points.max].coord.slice(0);
                    var crossing = FAMap.Util.IDL.checkCrossing(c1, c2);
                    var idlCorrection = (crossing !== false) ? crossing * 360 : 0;
                    c2[0] += idlCorrection;
                    var factor = (timestamp - points.min) / (points.max - points.min);
                    var lonDelta = c2[0] - c1[0];
                    var latDelta = c2[1] - c1[1];
                    var lon = (lonDelta * factor) + c1[0] - idlCorrection;
                    var lat = (latDelta * factor) + c1[1];
                    var minFlightData = this.positions[points.min].flightData
                    var maxFlightData = this.positions[points.max].flightData
                    var flightData = $.extend({}, minFlightData);
                    var altDelta = maxFlightData.altitude - minFlightData.altitude;
                    flightData.altitude = Math.round((altDelta * factor) + minFlightData.altitude);
                    var gsDelta = maxFlightData.groundspeed - minFlightData.groundspeed;
                    flightData.groundspeed = Math.round((gsDelta * factor) + minFlightData.groundspeed);
                    var t1 = this.positions[points.min].flightData.updateType;
                    var t2 = this.positions[points.max].flightData.updateType;
                    if (['P', 'TP'].indexOf(t1) != -1 || ['P', 'TP'].indexOf(t2) != -1) {
                        flightData.updateType = 'TP';
                    } else {
                        flightData.updateType = '';
                    }
                    var position = {
                        actual: false,
                        heading: this.getHeadingBetweenTimes(points.min, points.max),
                        coord: [lon, lat],
                        flightData: flightData
                    };
                }
            }
            this.cachedPositions[timestamp] = position
        }
        return this.cachedPositions[timestamp];
    }
    ;
    this.getTrackBetween = function(start, end) {
        start = start || null;
        end = end || null;
        var track = {};
        if (this.positions === null) {
            return track;
        }
        var timestamps = Object.keys(this.positions).sort().reverse();
        for (var i = 0; i < timestamps.length; i++) {
            if (end !== null && timestamps[i] > end) {
                continue;
            }
            if (start !== null && timestamps[i] < start) {
                break;
            }
            track[timestamps[i]] = this.positions[timestamps[i]];
        }
        return track;
    }
    ;
    this.getTrail = function(timestamp, trailLength) {
        var trailLimit = timestamp - trailLength;
        var trail = this.getTrackBetween(trailLimit, timestamp);
        if (!(timestamp in trail) && this.getPosition(timestamp) !== false) {
            trail[timestamp] = this.getPosition(timestamp);
        }
        if (!(trailLimit in trail) && this.getPosition(trailLimit) !== false) {
            trail[trailLimit] = this.getPosition(trailLimit);
        }
        return trail;
    }
    ;
    this.getPositionAfter = function(timestamp) {
        var points = this.getInterpolationTimestamps(timestamp);
        if (points.max === null) {
            return false;
        } else {
            return this.positions[points.max];
        }
    }
    ;
    this.getAllPositions = function(array) {
        if (!this.positions || !array) {
            return this.positions;
        }
        var track = [];
        $.each(this.positions, function(k, v) {
            track.push(v);
        });
        return track;
    }
    ;
}
;
(function(FA) {
    FA.Modules.Mixin = typeof (FA.Modules.Mixin) === "undefined" ? {} : FA.Modules.Mixin;
}
)(FA);
(function(FA) {
    var Eventer = function() {}
    Eventer.prototype = Object.create(null, {
        listeners: {
            value: []
        }
    });
    Eventer.prototype.on = function(eventKey, handler) {
        if (typeof (handler) != "function") {
            return;
        }
        if (typeof (eventKey) === "undefined") {
            return;
        }
        this.listeners = typeof (this.listeners) !== "undefined" ? this.listeners : {};
        if (typeof (this.listeners[eventKey]) == "undefined" || !this.listeners[eventKey]) {
            this.listeners[eventKey] = [];
        }
        this.listeners[eventKey].push(handler);
    }
    ;
    Eventer.prototype.off = function(eventKey, handler) {
        for (var i = 0; i < this.listeners[eventKey].length; i++) {
            if (this.listeners[eventKey][i] === handler) {
                this.listeners[eventKey].splice(i, 1);
            }
        }
    }
    ;
    Eventer.prototype.trigger = function(eventKey, eventData) {
        if (typeof (eventKey) === "undefined") {
            return;
        }
        this.listeners = typeof (this.listeners) !== "undefined" ? this.listeners : {};
        if (typeof (this.listeners[eventKey]) != "undefined") {
            for (var i = 0; i < this.listeners[eventKey].length; i++) {
                this.listeners[eventKey][i](eventData);
            }
        }
    }
    ;
    FA.Modules.Mixin.Eventer = Eventer;
}
)(FA);
if (typeof (module) !== "undefined" && typeof (module.exports) !== "undefined") {
    module.exports = FA.Modules.Mixin.Eventer;
}
(function(FA, $, ol) {
    var FrameBufferManager = function() {
        this._loopingTimeout = null
        this._liveTimeout = null;
        this._frameOffset = 0;
        this._timeSeriesLayers = [];
        this.setNFrames(1);
        this._minFrameResolution = 300;
        this.changeFramePeriod(1200);
        this._frameRate = 350;
        this._loopPause = 2000;
    };
    FrameBufferManager.prototype.getLoopingState = function() {
        var state = "paused";
        if (this._loopingTimeout) {
            state = "looping";
        }
        return state;
    }
    FrameBufferManager.prototype.setLoopingState = function(state) {
        switch (state) {
        case "looping":
            this.loop();
            break;
        case "paused":
            this.pause();
            break;
        }
        return this.getLoopingState();
    }
    FrameBufferManager.prototype.setNFrames = function(n) {
        this._nFrames = n;
        for (var i = 0; i < this._timeSeriesLayers.length; i++) {
            this._timeSeriesLayers[i].nFrames(n);
        }
        this._maxOffset = n - 1;
    }
    FrameBufferManager.prototype.changeFramePeriod = function(p) {
        this._framePeriod = p <= this._minFrameResolution ? this._minFrameResolution : Math.ceil(p / this._minFrameResolution) * this._minFrameResolution;
        for (var i = 0; i < this._timeSeriesLayers.length; i++) {
            this._timeSeriesLayers[i].framePeriod(this._framePeriod);
        }
    }
    FrameBufferManager.prototype.resetTimeSeriesClock = function(startTime, endTime) {
        if (typeof (endTime) === "undefined") {
            this._endTime = startTime;
            this._startTime = this._endTime - (this._maxOffset * this._framePeriod);
        } else {
            this._endTime = endTime;
            this._startTime = startTime;
        }
        var bufferStartTime = this._endTime - (this._maxOffset * this._framePeriod);
        if (bufferStartTime > this._startTime) {
            var newPeriod = Math.ceil((this._endTime - this._startTime) / this._nFrames);
            this.changeFramePeriod(newPeriod);
        }
        for (var i = 0; i < this._timeSeriesLayers.length; i++) {
            this._timeSeriesLayers[i].resetClock(this._endTime);
        }
    }
    FrameBufferManager.prototype.registerTimeSeriesLayer = function(target) {
        if (this._timeSeriesLayers.length > 0) {
            if (target.framePeriod() != this._framePeriod || target.nFrames() != this._nFrames) {
                target.nFrames(this._nFrames);
                target.framePeriod(this._framePeriod);
            }
        } else {
            this.setNFrames(target.nFrames());
            this.changeFramePeriod(target.framePeriod());
        }
        this._timeSeriesLayers.push(target);
        if (typeof (this._framesRequested) === "undefined") {
            this._framesRequested = [];
        }
        this._framesRequested[this._timeSeriesLayers.length - 1] = {};
    }
    ;
    FrameBufferManager.prototype.liveUpdate = function(active) {
        var now = FAMap.Util.getNow();
        var minIncrement = 300;
        if (this._liveTimeout) {
            clearTimeout(this._liveTimeout);
            this._liveTimeout = null;
        }
        if (!active) {
            return;
        }
        for (var t = 0; t < this._timeSeriesLayers.length; t++) {
            var pbTarget = this._timeSeriesLayers[t];
            pbTarget.endTimeSeriesAt(now, true);
            nextIncrement = pbTarget._framePeriod - (now - pbTarget._stopAt);
            minIncrement = nextIncrement < minIncrement ? nextIncrement : minIncrement;
        }
        this._frameOffset = 0;
        this.trigger('live-update');
        this._liveTimeout = setTimeout(this.liveUpdate.bind(this, true), minIncrement * 1000);
    }
    FrameBufferManager.prototype.preloadCounter = function(val) {
        this._preloadCounter = typeof (this._preloadCounter) === "undefined" ? this._maxOffset + 5 : this._preloadCounter;
        if (typeof (val) !== "undefined") {
            this._preloadCounter = val;
        }
        return (this._preloadCounter);
    }
    FrameBufferManager.prototype.preload = function(loadAdditionalFrames, requestInterval) {
        var loaded = true;
        this._preloadTimeout = typeof (this._preloadTimeout) === "undefined" ? null : this._preloadTimeout;
        var counter = this.preloadCounter();
        if (typeof (this._loaded) === "undefined") {
            this._loaded = [];
        }
        if (this._preloadTimeout) {
            clearTimeout(this._preloadTimeout);
            this._preloadTimeout = null;
        }
        var frameInRange = (function(tsLayer, fi) {
            var clock = tsLayer.getClock(fi);
            return (typeof (this._startTime) === "undefined" || (clock >= this._startTime && clock <= this._endTime));
        }
        ).bind(this);
        var clock = 0;
        for (var o = this._maxOffset; o >= 0; o--) {
            for (var t = 0; t < this._timeSeriesLayers.length; t++) {
                if (this._timeSeriesLayers[t].getVisible()) {
                    if (frameInRange(this._timeSeriesLayers[t], o)) {
                        this._loaded[t] = this._timeSeriesLayers[t].preloadFrames(o) && loaded;
                        if (!this._loaded[t]) {
                            if (!(o in this._framesRequested[t])) {
                                loaded = false;
                                clock = this._timeSeriesLayers[t].getClock(o);
                                this._framesRequested[t][o] = FAMap.Util.getNow();
                                break;
                            } else {
                                loaded = true;
                            }
                        } else {
                            this._framesRequested[t][o] = null;
                        }
                    }
                }
            }
            if (!loaded) {
                break;
            }
        }
        var totalInRange = 0;
        var requested = 0;
        for (t = 0; t < this._timeSeriesLayers.length; t++) {
            if (this._timeSeriesLayers[t].getVisible()) {
                for (o = this._maxOffset; o >= 0; o--) {
                    if (frameInRange(this._timeSeriesLayers[t], o)) {
                        totalInRange++;
                        if (o in this._framesRequested[t]) {
                            requested++;
                        }
                    }
                }
            }
        }
        if (loaded) {
            this.trigger('preload-complete');
            this.preloadCounter(0);
            return true;
        } else if (typeof (loadAdditionalFrames) !== "undefined" && loadAdditionalFrames() && counter > 0) {
            this.trigger('preloading', {
                percentRequested: (requested / totalInRange),
                clock: clock
            });
            this.preloadCounter(counter - 1);
            this._preloadTimeout = setTimeout(this.preload.bind(this, loadAdditionalFrames, requestInterval), requestInterval);
        }
        return false;
    }
    FrameBufferManager.prototype.loop = function() {
        var timeoutDelay = this._frameRate
          , startState = this.getLoopingState()
          , loaded = true;
        if (this._loopingTimeout) {
            clearTimeout(this._loopingTimeout);
            this._loopingTimeout = null;
        }
        loaded = this.preload((function() {
            return this._loopingTimeout !== null
        }
        ).bind(this), this._frameRate * 2);
        this.incrementFrame(1);
        this.trigger("loop-next-frame");
        this._loopingTimeout = setTimeout(this.loop.bind(this), this._frameOffset ? timeoutDelay : this._loopPause);
        if (startState !== this.getLoopingState() || this._loopingTimeout == null) {
            this.trigger("loop-start");
        }
        return (this._loopingTimeout != null);
    }
    FrameBufferManager.prototype.pause = function() {
        var startState = this.getLoopingState();
        if (this._loopingTimeout) {
            clearTimeout(this._loopingTimeout);
            this._loopingTimeout = null;
        }
        if (startState !== this.getLoopingState()) {
            this.trigger("loop-pause");
        }
        return (this._loopingTimeout == null);
    }
    FrameBufferManager.prototype.incrementFrame = function(n) {
        var verifyOffset = null
          , nextOffset = this._frameOffset - n;
        var maxOffset = this._maxOffset;
        if (typeof (this._preloadTimeout) === "undefined" || this._preloadTimeout === null) {} else if (this._preloadTimeout) {
            return;
        }
        if (nextOffset > maxOffset) {
            nextOffset = (nextOffset % (maxOffset + 1));
        } else if (nextOffset < 0) {
            nextOffset = (maxOffset + nextOffset) + 1;
        }
        for (var t = 0; t < this._timeSeriesLayers.length; t++) {
            try {
                this._frameOffset = this._timeSeriesLayers[t].skip(nextOffset);
                if (verifyOffset == null) {
                    verifyOffset = this._frameOffset;
                }
                if (this._frameOffset !== verifyOffset) {
                    throw (new Error("FrameBufferManager(incrementFrame): frames out of sequence."));
                }
            } catch (e) {
                console.error("FrameBufferManager: unable to advance timeSeries frame step=" + n);
                return false;
            }
        }
        return true;
    }
    FrameBufferManager.prototype.offsetFrame = function(offset) {
        for (var t = 0; t < this._timeSeriesLayers.length; t++) {
            try {
                this._frameOffset = this._timeSeriesLayers[t].skip(offset);
            } catch (e) {
                console.error("FrameBufferManager: unable to advance timeSeries frame skip:" + offset);
            }
        }
        return (this._frameOffset);
    }
    $.extend(FrameBufferManager.prototype, FA.Modules.Mixin.Eventer.prototype);
    FAMap.FrameBufferManager = FrameBufferManager;
}
)(FA, $, ol);
(function(FA, $, ol) {
    FA.Maps = typeof (FA.Maps) !== "undefined" ? FA.Maps : {};
    var OLPopupOverlay = function(overlayId, olMap, options) {
        var i, requiredClasses = ["ol-info-popup-closer", "ol-info-popup-content"], overlay = null;
        this.$popup = $("#" + overlayId);
        if (!this.$popup.length) {
            $("#" + olMap.getTarget()).after("<div id=\"" + overlayId + "\" class=\"ol-info-popup-overlay\"> <a href=\"#\" class=\"ol-info-popup-closer fa \"></a><div class=\"ol-info-popup-content\"></div></div>");
            this.$popup = $("#" + overlayId);
        }
        try {
            if (!this.$popup.length) {
                throw new FA.Modules.Error("DOM element: '" + overlayId + "' not found");
            }
            if (!this.$popup.hasClass("ol-info-popup-overlay")) {
                throw new FA.Modules.Error("expected class: ol-info-popup-overlay, not found");
            }
            for (i = 0; i < requiredClasses.length; i++) {
                if ($("." + requiredClasses[i], this.$popup).length != 1) {
                    throw new FA.Modules.Error("expected element with class:" + requiredClass);
                }
            }
            var oOptDefaults = {
                element: this.$popup[0],
                autoPan: true,
                autoPanAnimation: {
                    duration: 250
                }
            };
            var oOpts = oOptDefaults;
            $.extend(true, oOpts, typeof (options) !== "undefined" && typeof (options.overlayOptions) !== "undefined" ? options.overlayOptions : {});
            this.overlay = new ol.Overlay(oOpts);
            $(".ol-info-popup-closer", this.$popup).on('click', (function(infoPopupObj) {
                return function() {
                    infoPopupObj.hide();
                    return false;
                }
                ;
            }
            )(this));
            olMap.addOverlay(this.overlay);
        } catch (e) {
            console.error("OLPopupOverlay: " + e.message);
            console.error("OLPopupOverlay: popup overlay not created.");
            return null;
        }
    };
    OLPopupOverlay.prototype.setContent = function(content) {
        $(".ol-info-popup-content", this.$popup).html(content);
    }
    ;
    OLPopupOverlay.prototype.setPosition = function(lat, lon) {
        this._lat = lat;
        this._lon = lon;
    }
    ;
    OLPopupOverlay.prototype.show = function() {
        this.overlay.setPosition([this._lon, this._lat]);
    }
    ;
    OLPopupOverlay.prototype.hide = function() {
        this.overlay.setPosition(undefined);
        $(".ol-info-popup-closer", this.$popup).blur();
    }
    ;
    OLInfoPopup = function(popupId, olMap, options) {
        this._popupOverlay = new OLPopupOverlay(popupId,olMap,options);
        $("#" + popupId).addClass("ol-info-popup");
    }
    ;
    OLInfoPopup.prototype.showPopup = function(lat, lon, content) {
        if (!this._popupOverlay) {
            return;
        }
        if (typeof (content) !== "undefined") {
            this._popupOverlay.setContent(content);
        }
        if (typeof (lat) !== "undefined" && typeof (lon) !== "undefined") {
            this._popupOverlay.setPosition(lat, lon);
        }
        this._popupOverlay.show();
    }
    ;
    OLInfoPopup.prototype.setPosition = function(lat, lon) {
        this._popupOverlay.setPosition(lat, lon);
    }
    ;
    OLInfoPopup.prototype.setContent = function(content) {
        this._popupOverlay.setContent(content);
    }
    ;
    OLInfoPopup.prototype.hidePopup = function() {
        if (!this._popupOverlay) {
            return;
        }
        this._popupOverlay.hide();
    }
    ;
    FA.Maps.OLInfoPopup = OLInfoPopup;
}
)(FA, $, ol);
(function(FA) {
    var defaultConsoleEnabled = false;
    var snapAnalyticsEnabled = function() {
        return FA.faConfig.fa_config('snap_analytics_enabled', 0) != 0;
    };
    var logEventToConsole = function(category, action, label, value) {
        if (this.consoleEnabled) {
            console.log("Analytics Event (category=" + category + ") " + action + ":" + label + ":" + value);
        }
    }
    var logEventToSnapEndpoint = function(category, action, label, value) {
        if (snapAnalyticsEnabled()) {
            var snapEndpoint = "https://ko.flightaware.com/ajax/ignoreall/snap.rvt";
            var key = (category || '').replace(':', '\\:') + ":" + (action || '').replace(':', '\\:') + ":" + (label || '').replace(':', '\\:');
            var ajax = new Ajax.Post(snapEndpoint,{
                "params": {
                    "key": key
                }
            });
        }
    }
    var logEventToGoogleAnalytics = function(category, action, label, value) {
        if ((!category) || (!action)) {
            return;
        }
        if (typeof (ga) !== 'function') {
            return;
        }
        if (label) {
            ga('send', 'event', category, action, label, value);
        } else {
            ga('send', 'event', category, action);
        }
        console.log("Analytics Event (interface=Google) (category=" + category + ") " + action + ":" + label + ":" + value);
    }
    var Analytics = function(categoryName, interface) {
        this.categoryName = categoryName;
        this.consoleEnabled = defaultConsoleEnabled;
        if (!this.categoryName || this.categoryName === "") {
            console.error("Analytics: categoryName is null or empty string");
            return null;
        }
        this.setAnalyticsInterface(typeof (interface) !== "undefined" ? interface : "default");
        FA.analyticsCollectors = typeof (FA.analyticsCollectors) !== "undefined" ? FA.analyticsCollectors : {};
        FA.analyticsCollectors[categoryName] = this;
    }
    Analytics.prototype.setAnalyticsInterface = function(interface) {
        var workerFunction = logEventToConsole;
        switch (interface) {
        case "Google":
            workerFunction = typeof (ga) === "function" ? logEventToGoogleAnalytics : logEventToConsole;
            if (workerFunction == logEventToConsole) {
                console.error("Analytics: Google Analytics unavailable. (category=" + this.categoryName + ")");
            }
            break;
        case "FA_Snap":
            workerFunction = typeof (Ajax) !== "undefined" && snapAnalyticsEnabled() ? logEventToSnapEndpoint : logEventToConsole;
            if (workerFunction == logEventToConsole) {
                console.error("Analytics: FA Snap Analytics unavailable. (category=" + this.categoryName + ")");
            }
            break;
        case "Console":
            workerFunction = logEventToConsole;
            break;
        }
        this.logEvent = (function(worker) {
            return function(action, label, value) {
                worker(this.categoryName, action, label, value);
            }
        }
        )(workerFunction.bind(this));
        if (!this.consoleEnabled && workerFunction === logEventToConsole) {
            console.warn("Analytics: logEventToConsole is silenced.");
        }
    }
    FA.Modules.Analytics = Analytics;
}
)(FA);
(function(FA, $) {
    FA.Maps = typeof (FA.Maps) === "undefined" ? {} : FA.Maps;
    FA.Maps.OLMixins = typeof (FA.Maps.OLMixins) === "undefined" ? {} : FA.Maps.OLMixins;
    FA.Maps.OLMixins.manageInteractionsOnWindowScroll = function(olMap, initActive, options) {
        olMap._fa = typeof (olMap._fa) === "undefined" ? {} : ol._fa;
        olMap._fa.excludeList = typeof (options) !== "undefined" && typeof (options.exclude) !== "undefined" ? options.exclude : [];
        olMap._fa.setInteractionsActive = function(active) {
            if (typeof (olMap._fa.interactionsActive) !== "undefined" && active === olMap._fa.interactionsActive) {
                return;
            }
            olMap._fa.interactionsActive = active;
            var interactions = olMap.getInteractions();
            interactions.forEach(function(e, i, list) {
                var len = olMap._fa.excludeList.length;
                for (var i = 0; i < len; i++) {
                    if (e === olMap._fa.excludeList[i]) {
                        return;
                    }
                }
                e.setActive(active);
            }, null);
        }
        ;
        olMap._fa.getInteractionsActive = (function(olMap) {
            return function() {
                return olMap._fa.interactionsActive
            }
            ;
        }
        )(olMap);
        $(window).scroll(FA.Lib.Common.debounce(olMap._fa.setInteractionsActive.bind(olMap, false), 0));
        $(window).scroll(FA.Lib.Common.debounce(olMap._fa.setInteractionsActive.bind(olMap, true), 500));
        olMap._fa.setInteractionsActive(typeof (initActive) !== "undefined" ? initActive : true);
    }
    ;
}
)(FA, $);
FAMap.Map = function(target, options) {
    this.$_mapContainer = $('#' + target);
    this._olMap = null;
    this._baseLayers = {};
    this._overlays = {};
    this._currentBaseLayerIdx = null;
    this._textCycler = null;
    this._animationController = null;
    this._analytics = null;
    this.debugger = false;
    this._validTimes = null;
    this.setValidTimes = function(start, end) {
        this._validTimes = {
            start: start,
            end: end,
            midpoint: (end - start) / 2 + start
        };
        this.trigger('validTimesUpdate', [this._validTimes]);
    }
    this.activeState = 'inactive';
    this.inspectInfoPopup = null;
    this.setActiveState = function(state) {
        if (state !== this.activeState) {
            this.activeState = state;
            this.trigger('activeStateChange', [state]);
        }
    }
    ;
    this.getCorrectedCenter = function() {
        return FAMap.Util.getCorrectedCoordinate(this._olMap.getView().getCenter());
    }
    ;
    this.getAutoPanZoomController = function() {
        if (this.autoPanZoomController === undefined) {
            this.autoPanZoomController = new FAMap.Util.AutoPanZoomController(this);
        }
        return this.autoPanZoomController;
    }
    ;
    this.isAnimated = function() {
        return this._animationController !== null;
    }
    ;
    this.getAnimationTime = function() {
        if (!this.isAnimated()) {
            return null;
        }
        return this._animationController.getClockTime();
    }
    ;
    this.setAnimationTime = function(timestamp) {
        if (!this.isAnimated()) {
            return;
        }
        this._animationController.setClockTime(timestamp);
    }
    ;
    this.getAnimationRate = function() {
        if (!this.isAnimated()) {
            return null;
        }
        return this._animationController.getClockRate();
    }
    ;
    this.setAnimationRate = function(rate) {
        if (!this.isAnimated()) {
            return;
        }
        this._animationController.setClockRate(rate);
    }
    ;
    this.getAnimationClock = function() {
        if (!this.isAnimated()) {
            return null;
        }
        return this._animationController._clock;
    }
    ;
    this.addBaseLayer = function(layer) {
        window[layer.idx] = layer;
        layer._famap = this;
        this._olMap.addLayer(layer);
        this._baseLayers[layer.idx] = layer;
    }
    ;
    var baseLayerSet = 0;
    this.setBaseLayer = function(idx) {
        if (this.hasAnalytics()) {
            this._analytics.logEvent("setBaseLayer", idx, baseLayerSet);
            baseLayerSet = 1;
        }
        if (this._currentBaseLayerIdx !== null) {
            var prevIdx = this._currentBaseLayerIdx;
            var currentLayer = this._baseLayers[this._currentBaseLayerIdx];
            try {
                currentLayer.setVisible(false);
            } catch (e) {
                throw ('Error hiding current base layer: ' + e.msg);
            }
        } else {
            var prevIdx = null;
        }
        if (!(idx in this._baseLayers)) {
            throw ('Error: ' + idx + ' is not the index of any currently-configured base layer');
        }
        var newLayer = this._baseLayers[idx];
        try {
            newLayer.setVisible(true);
        } catch (e) {
            throw ('Error showing new base layer: ' + e.msg);
        }
        var constrainExtent = ol.proj.get('EPSG:3857').getExtent();
        constrainExtent = [constrainExtent[0] * 2, constrainExtent[1], constrainExtent[2] * 2, constrainExtent[3]];
        if (typeof currentLayer === 'undefined' || currentLayer.getSource().minZoom != newLayer.getSource().minZoom || currentLayer.getSource().maxZoom != newLayer.getSource().maxZoom) {
            this._olMap.setView(new ol.View({
                center: this._olMap.getView().getCenter(),
                zoom: this._olMap.getView().getZoom(),
                extent: constrainExtent,
                rotation: this._olMap.getView().getRotation(),
                minZoom: newLayer.getSource().minZoom,
                maxZoom: newLayer.getSource().maxZoom
            }));
        }
        this._currentBaseLayerIdx = idx;
        var self = this;
        $.each(this._overlays, function(overlayIdx) {
            var configOpts = FAMap.Util.ConfigPresets.getOverlayConfig([overlayIdx])[overlayIdx];
            if (typeof configOpts === 'undefined' || typeof configOpts.layerOpts === 'undefined' || typeof configOpts.layerOpts.style === 'undefined') {
                var autoStyle = self._getOverlayStyle(overlayIdx, idx);
                if (typeof autoStyle !== 'undefined') {
                    self._overlays[overlayIdx].setStyle(autoStyle);
                }
                ;
            }
        });
        if (typeof (FAMap.Styles.Control._instances[idx]) === "function") {
            FAMap.Styles.Control._instances[idx]();
        } else {
            FAMap.Styles.Control._instances.default();
        }
        var darkAttributionLayers = ['premium_terrain', 'premium_streets', 'skyvector_ifr_high', 'skyvector_ifr_low', 'skyvector_vfr'];
        var visibleTextColor = darkAttributionLayers.indexOf(idx) === -1 ? '#fff' : '#000';
        $('.ol-attribution').css('color', visibleTextColor);
        if ($('.ol-distance-bearing-control').length) {
            $('.ol-distance-bearing-control').css('color', visibleTextColor);
        }
        this.trigger('baseLayerChanged', [prevIdx, idx]);
    }
    ;
    this.addOverlay = function(layer, layerDef) {
        layer.isOverlay = true;
        layer._famap = this;
        this._olMap.addLayer(layer);
        this._overlays[layer.idx] = layer;
        var overlayState = this._configHandler.get('overlay_' + layer.idx);
        if (overlayState !== false) {
            if (overlayState.state === 'transient') {
                throw ('Error: I don\'t know how to handle transient values for overlayState yet!');
            } else {
                overlayState = overlayState.value;
            }
            if ('visibility'in overlayState) {
                layer.setVisible(overlayState.visibility);
            }
            if ('sourceKey'in overlayState) {
                layer.setSourceByKey(overlayState.sourceKey);
            }
        }
        if ('cycleText'in layer && layer.cycleText) {
            this.getTextCycler().addLayer(layer);
            this.on('activeStateChange', function(e, state) {
                layer.setStyle(layer.getStyle());
            });
        }
        if ('autoregion_enable'in layerDef && layerDef.autoregion_enable) {
            this.getAutoPanZoomController().addSource(layer.getSource());
            if (layerDef.autoregion_enable && typeof (this._frameBuffer) !== "undefined") {
                this._frameBuffer.setNFrames(1);
            }
        }
    }
    ;
    this.removeOverlay = function(layer) {
        if (layer.idx in this._overlays) {
            this._olMap.removeLayer(layer);
            delete this._overlays[layer.idx];
        }
    }
    ;
    this._getOverlayStyle = function(overlayIdx, baseIdx, prefix) {
        var style = FAMap.Styles.Feature._instances[overlayIdx];
        if (typeof style !== 'undefined') {
            var styleKeys = [];
            if (typeof prefix !== 'undefined') {
                styleKeys.push(prefix + '_' + baseIdx, prefix + '_default');
            }
            styleKeys.push(baseIdx, 'default');
            var rtnStyle = null;
            $.each(styleKeys, function() {
                var key = String(this);
                if (typeof style[key] !== 'undefined') {
                    rtnStyle = style[key];
                    return false;
                }
            });
            return rtnStyle;
        }
    }
    this._buildLayer = function(layerDef, idx) {
        if (typeof layerDef === 'function') {
            layerDef = layerDef.call();
        }
        if ('_buildLayer'in layerDef) {
            var layer = layerDef._buildLayer.call(layerDef);
            layer.setVisible(false);
            return layer;
        }
        var layerOpts = layerDef.layerOpts || {};
        layerOpts.visible = false;
        layerOpts.FAMap = this;
        if (typeof (layerDef.analytics) !== "undefined" && typeof (layerDef.analytics.interface) !== "undefined") {
            layerOpts.analytics = new FA.Modules.Analytics(layerDef.name,layerDef.analytics.interface);
        }
        var layer = new layerDef.layerClass(layerOpts);
        if ('MC'in FAMap.Globals) {
            var localizedName = FAMap.Globals.MC[layerDef.name.toLowerCase()];
        }
        if (typeof localizedName !== 'undefined') {
            layer.name = localizedName;
        } else {
            layer.name = layerDef.name;
        }
        layer._uiDef = layerOpts.ui || null;
        layer.idx = idx;
        if ('uiGroup'in layerDef) {
            layer.uiGroup = layerDef.uiGroup;
        }
        if ('excludeFromUi'in layerDef) {
            layer.excludeFromUi = layerDef.excludeFromUi;
        }
        if ('cycleText'in layerDef) {
            layer.cycleText = layerDef.cycleText;
        }
        if ('sourceClass'in layerDef) {
            var sourceOpts = layerDef.sourceOpts || {};
            if (typeof sourceOpts === 'function') {
                sourceOpts = sourceOpts();
            }
            sourceOpts.FAMap = this;
            var source = new layerDef.sourceClass(sourceOpts);
            var initialViewState = this._configHandler.get('initialViewState');
            if (initialViewState.state === "transient" && (Object.getPrototypeOf(source) === FAMap.olExtras.Source.FAWx.prototype || Object.getPrototypeOf(source) === FAMap.olExtras.Source.DTN.prototype)) {
                initialViewState.promise.done(function(initialViewState) {
                    layer.setSource(source);
                });
            } else {
                layer.setSource(source);
            }
        }
        if ('eventHandlers'in layerDef) {
            layer.eventHandlers = layerDef.eventHandlers;
        } else if (!('eventHandlers'in layer)) {
            layer.eventHandlers = {};
        }
        if ('onBuildLayerComplete'in layerDef) {
            var proceed = layerDef.onBuildLayerComplete.call(layer, layerDef, this);
            if (proceed === false) {
                return null;
            }
        }
        return layer;
    }
    ;
    this.getTextCycler = function() {
        if (this._textCycler === null) {
            if (!('textCycler'in this.options)) {
                this.options.textCycler = {};
            }
            this._textCycler = new FAMap.Util.TextCycler(this,this.options.textCycler);
        }
        return this._textCycler;
    }
    ;
    this.setViewState = function(viewState, animationCallback) {
        viewState.zoom = Math.floor(viewState.zoom);
        var view = this._olMap.getView();
        var canAnimate = view.getZoom() !== undefined && view.getCenter() !== null;
        var centerAnimation, zoomAnimation;
        switch (viewState.type) {
        case 'fitExtent':
            var padFactor = 1;
            if ('padding'in viewState) {
                padFactor += viewState.padding;
            }
            var mapPadding = {
                top: Number(this.$_mapContainer.data('mapPaddingTop')) || 0,
                right: Number(this.$_mapContainer.data('mapPaddingRight')) || 0,
                bottom: Number(this.$_mapContainer.data('mapPaddingBottom')) || 0,
                left: Number(this.$_mapContainer.data('mapPaddingLeft')) || 0,
            }
            var center = ol.extent.getCenter(viewState.extent);
            var zoom = 10;
            var extentWidth = ol.extent.getWidth(viewState.extent);
            var extentHeight = ol.extent.getHeight(viewState.extent);
            if (extentWidth + extentHeight > 0 && typeof this._olMap.getSize() !== 'undefined') {
                var size = this._olMap.getSize();
                var xRes = (extentWidth * padFactor) / (size[0] - mapPadding.left - mapPadding.right);
                var yRes = (extentHeight * padFactor) / (size[1] - mapPadding.top - mapPadding.bottom);
                var targetRes = Math.max(xRes, yRes);
                zoom = Math.min(FAMap.Util.getZoomForResolution(targetRes), 10);
                center[0] = center[0] + ((mapPadding.left - mapPadding.right) * 0.5 * xRes);
                center[1] = center[1] + ((mapPadding.top - mapPadding.bottom) * 0.5 * yRes);
            }
            if (canAnimate) {
                centerAnimation = {
                    center: center,
                    duration: 100,
                    easing: ol.easing.linear
                };
                zoomAnimation = {
                    zoom: zoom,
                    duration: 100,
                    easing: ol.easing.linear
                };
                if (typeof animationCallback === 'function') {
                    view.animate(centerAnimation, zoomAnimation, animationCallback);
                } else {
                    view.animate(centerAnimation, zoomAnimation);
                }
            } else {
                view.setCenter(center);
                view.setZoom(zoom);
            }
            break;
        case 'panZoom':
            if ('projection'in viewState) {
                var center = ol.proj.transform(viewState.center, viewState.projection, 'EPSG:3857');
            } else {
                var center = viewState.center;
            }
            if (canAnimate) {
                centerAnimation = {
                    center: center,
                    duration: 100,
                    easing: ol.easing.linear
                };
                zoomAnimation = {
                    zoom: viewState.zoom,
                    duration: 100,
                    easing: ol.easing.linear
                };
                if (typeof animationCallback === 'function') {
                    view.animate(centerAnimation, zoomAnimation, animationCallback);
                } else {
                    view.animate(centerAnimation, zoomAnimation);
                }
            } else {
                view.setCenter(center);
                view.setZoom(viewState.zoom);
            }
            break;
        default:
            throw ('Error: unknown viewState type: ' + viewState.type);
            break;
        }
    }
    ;
    this.addLoadingOverlay = function() {
        this.$_mapContainer.append($('<div>').addClass('mapLoading'));
        setInterval($.proxy(this.removeLoadingOverlay, this), 10000);
    }
    ;
    this.removeLoadingOverlay = function() {
        this.$_mapContainer.find('.mapLoading').remove();
    }
    ;
    this.on = function(event, handler) {
        this.$_mapContainer.on(event, handler);
    }
    ;
    this.trigger = function(event, extra) {
        this.$_mapContainer.trigger(event, extra);
    }
    ;
    var setupControlHiding = function() {
        var autohideControls = this.controls.filter((function(faMap) {
            return function(control) {
                return !(control instanceof FAMap.olExtras.Control.Attribution || control instanceof FAMap.olExtras.Control.ScaleLine || (control instanceof FAMap.olExtras.Control.LayerUI && faMap.options.layerUiTarget));
            }
            ;
        }
        )(this));
        var showControls = function() {
            autohideControls.forEach(function(control) {
                control.show();
            });
        };
        var hideControls = function() {
            autohideControls.forEach(function(control) {
                control.hide();
            });
        };
        this.on('activeStateChange', function(e, state) {
            if (state == 'active') {
                showControls();
            } else {
                hideControls();
            }
        });
        if (typeof this.options.showControlsInitially !== 'undefined' && !this.options.showControlsInitially) {
            hideControls();
        }
    };
    this._init = function(target, options) {
        if (typeof jQuery === 'undefined') {
            throw ('Error: FAMap requires jQuery, but it\'s not present.');
        }
        var self = this;
        if (typeof options === 'function') {
            options = options();
        }
        options = FAMap.Util.ConfigPresets.updateOptionsFromDOM(self.$_mapContainer, options);
        options.layerUiTarget = typeof (options.layerUiTarget) !== "undefined" ? options.layerUiTarget : null;
        if (typeof (options.analytics) != "undefined" && FA.Modules && FA.Modules.Analytics) {
            this._analytics = new FA.Modules.Analytics("FAMap",options.analytics);
        } else {
            console.error("FAMap: FA.Modules.Analytics: not available");
        }
        this.options = options;
        this.persistentStores = {};
        $.each(FAMap.Util.PersistentStores, $.proxy(function(k) {
            if ('persistent'in this.options && k in this.options.persistent) {
                var options = this.options.persistent[k];
            } else {
                var options = {};
            }
            var storeObj = new FAMap.Util.PersistentStores[k](options,self);
            self.persistentStores[storeObj.key] = storeObj;
        }, this));
        var baseLayerMap = {
            mapbox_sat_boundaries: 'premium_sat_boundaries',
            mapbox_sat: 'premium_sat',
            mapbox_terrain_light: 'premium_terrain',
            mapbox_terrain_dark: 'premium_terrain',
            mapbox_streets_light: 'premium_streets',
            mapbox_streets_dark: 'premium_streets'
        };
        var baseLayerPref = this.persistentStores.BaseLayer.get();
        if (baseLayerPref !== false && baseLayerPref in baseLayerMap) {
            this.persistentStores.BaseLayer.set(baseLayerMap[baseLayerPref]);
        }
        var configSources = {};
        $.extend(true, configSources, FAMap.Util.ConfigPresets.defaultSourcedItems());
        var layerUIOpt = null;
        if (options.layerUiTarget) {
            if (options.layerUiTarget in configSources) {
                throw ("FAMap map init: layer-ui-target (" + options.layerUiTarget + ") element id conflicts with other config source ");
            }
            configSources[options.layerUiTarget] = {
                "allowedSources": ["UIComponent"]
            };
            layerUIOpt = {
                target: options.layerUiTarget
            };
        }
        this._configHandler = new FA.Modules.ConfigHandler(this,configSources);
        if (layerUIOpt && layerUIOpt.target !== "undefined") {
            var layerUIConfig = this._configHandler.get(layerUIOpt.target);
            $.extend(layerUIOpt, layerUIConfig.value);
        }
        this.availableControls = {
            attributions: new FAMap.olExtras.Control.Attribution({
                collapsible: false,
                collapsed: false
            }),
            banner: new FAMap.olExtras.Control.Banner(this),
            scaleLine: new FAMap.olExtras.Control.ScaleLine(),
            distanceBearing: new FAMap.olExtras.Control.DistanceBearing(this),
            expand: new FAMap.olExtras.Control.Expand(this),
            layerUI: new FAMap.olExtras.Control.LayerUI(this,layerUIOpt),
            zoom: new FAMap.olExtras.Control.ZoomTo(this)
        };
        if (!FAMap.Globals.ANIMATED_WEATHER_ENABLED.match('disabled')) {
            this._frameBuffer = new FAMap.FrameBufferManager(this,{})
            this.availableControls.liveLoop = new FAMap.olExtras.Control.LiveLoop({
                'frameBuffer': this._frameBuffer
            });
            this._timeSeriesLiveLoop = this.availableControls.liveLoop;
        }
        var controlNames = [];
        if (typeof this.options.controls === 'undefined') {
            controlNames = ['liveLoop', 'layerUI', 'zoom', 'attributions', 'scaleLine'];
            if (typeof this.options.fullsizeMapUrl !== 'undefined') {
                controlNames = controlNames.concat(['expand']);
            }
        } else {
            controlNames = this.options.controls;
            if (controlNames.indexOf('expand') >= 0 && typeof this.options.fullsizeMapUrl === 'undefined') {
                controlNames.splice(controlNames.indexOf('expand'), 1);
            }
        }
        if (typeof this.options.bannerText !== 'undefined') {
            controlNames.push('banner');
        }
        if (FAMap.Globals.DEBUG_ENABLED) {
            this.debugger = new FAMap.Util.Debugger(this);
            this.availableControls['debugger'] = new FAMap.olExtras.Control.Debugger(this);
            controlNames.push('debugger');
        }
        this.controls = [];
        this._layerUI = null;
        var hasLiveLoop = null;
        controlNames.forEach(function(controlName) {
            if (FAMap.Globals.ANIMATED_WEATHER_ENABLED.match("disabled") && controlName == 'liveLoop') {
                return;
            }
            if (!(controlName in this.availableControls)) {
                throw ('Error: Unknown control "' + controlName + '" in config!');
            }
            this.controls.push(this.availableControls[controlName]);
            if (controlName === 'layerUI') {
                this._layerUI = this.availableControls.layerUI;
            }
            if (controlName === "liveLoop" && typeof (this.availableControls.liveLoop) !== "undefined") {
                hasLiveLoop = this.availableControls.liveLoop;
            }
        }, this);
        $('#' + target).html('');
        if (!hasLiveLoop && typeof (this.availableControls.liveLoop) !== "undefined") {
            this.availableControls.liveLoop.$liveLoop.html("");
        }
        this.on('validTimesUpdate', $.proxy(function() {
            this._olMap.removeControl(this._timeSeriesLiveLoop);
            if (typeof (this._frameBuffer) !== "undefined") {
                this._frameBuffer.setNFrames(1)
                this._frameBuffer.resetTimeSeriesClock(this._validTimes.midpoint);
            }
        }, this));
        this._olMap = new ol.Map({
            target: target,
            logo: false,
            layers: [],
            view: new ol.View(),
            interactions: [new ol.interaction.DoubleClickZoom(), new ol.interaction.DragPan(), new ol.interaction.PinchZoom(), new ol.interaction.MouseWheelZoom({
                constrainResolution: false,
                duration: 100
            }), new FAMap.olExtras.Interaction.FeatureMouseEvents(this)],
            controls: this.controls
        });
        this._olMap._famap = this;
        FA.Maps.OLMixins.manageInteractionsOnWindowScroll(this._olMap);
        this.inspectInfoPopup = new FA.Maps.OLInfoPopup('inspectPopup',this._olMap,{
            overlayOptions: {
                stopEvent: true,
                autoPan: false,
                offset: [1, 1]
            }
        });
        this.inspectInfoPopup.updateContent = function() {
            var i;
            var groupContent = "";
            this._contentList = typeof (this._contentList) === "undefined" ? [] : this._contentList;
            for (i = 0; i < this._contentList.length; i++) {
                groupContent += "<div>" + this._contentList[i].content + "</div>";
            }
            this.setContent(groupContent);
        }
        this.inspectInfoPopup.addContent = function(key, content) {
            this._contentList = typeof (this._contentList) === "undefined" ? [] : this._contentList;
            this._contentList.push({
                "key": key,
                "content": content
            });
            this.updateContent();
            if (this._contentList.length) {
                this.showPopup();
            }
        }
        this.inspectInfoPopup.removeContent = function(key) {
            this._contentList = typeof (this._contentList) === "undefined" ? [] : this._contentList;
            for (var i = 0; i < this._contentList.length; i++) {
                if (this._contentList[i].key === key) {
                    this._contentList.splice(i, 1);
                    break;
                }
            }
            this.updateContent();
            if (this._contentList.length === 0) {
                this.hidePopup();
            }
        }
        var playOnLoad = false;
        if (typeof (this._timeSeriesLiveLoop) !== "undefined") {
            var initialLiveLoop = this._configHandler.get('liveLoop');
            this._frameBuffer.on('loop-start', (function(faMap) {
                return function() {
                    faMap.persistentStores.LiveLoop.set({
                        'loopingState': faMap._frameBuffer.getLoopingState()
                    });
                    if (typeof (faMap.toggleWeatherLayers) === "function") {
                        faMap.toggleWeatherLayers(faMap.replayControl, faMap._frameBuffer);
                    }
                    if (typeof (faMap._tileLoader) !== "undefined") {
                        faMap._tileLoader.visibleWhenLoading(true);
                    }
                }
                ;
            }
            )(self));
            this._frameBuffer.on('loop-pause', (function(faMap) {
                return function() {
                    faMap.persistentStores.LiveLoop.set({
                        'loopingState': faMap._frameBuffer.getLoopingState()
                    });
                    if (typeof (faMap.toggleWeatherLayers) === "function") {
                        faMap.toggleWeatherLayers(faMap.replayControl, faMap._frameBuffer);
                    }
                    if (typeof (faMap._tileLoader) !== "undefined") {
                        faMap._tileLoader.visibleWhenLoading(false);
                    }
                }
                ;
            }
            )(self));
            if (initialLiveLoop && 'value'in initialLiveLoop) {
                this._frameBuffer.setLoopingState(initialLiveLoop.value.loopingState);
                playOnLoad = initialLiveLoop.value.loopingState === "looping";
            }
        }
        if ('animation'in options) {
            this.addLoadingOverlay();
            this.on('animation.firstload', $.proxy(this.removeLoadingOverlay, this));
            this._animationController = new FAMap.Animation.Controller(this,options.animation);
        }
        var initialViewState = this._configHandler.get('initialViewState');
        if ('value'in initialViewState) {
            this.setViewState(initialViewState.value);
        }
        if (initialViewState.state === 'transient') {
            initialViewState.promise.done($.proxy(function(initialViewState) {
                if (initialViewState !== false) {
                    this.setViewState(initialViewState.value);
                }
            }, this));
        }
        self._tileLoader = new FA.Maps.TileLoadingManager({
            "progressIndicator": true,
            "progressAnnotation": true
        });
        self._tileLoader.visibleWhenLoading(false);
        $.each(options.baseLayers, function(idx) {
            var layer = self._buildLayer(this, idx);
            if (layer !== null) {
                self.addBaseLayer(layer);
            }
        });
        var initialBaseLayer = this._configHandler.get('baseLayer');
        if (initialBaseLayer.state == 'final' && initialBaseLayer.value in this._baseLayers) {
            this.setBaseLayer(initialBaseLayer.value);
        } else {
            this.setBaseLayer('classic');
        }
        this._isHistorical = this._validTimes !== null;
        if (this._isHistorical) {
            playOnLoad = false;
            this._olMap.removeControl(this._timeSeriesLiveLoop);
            FAMap.Util.ConfigPresets._defs.overlays.basic_radar.layerOpts.timeSeriesNFrames = 1;
            FAMap.Util.ConfigPresets._defs.overlays.arinc_radar.layerOpts.timeSeriesNFrames = 1;
            FAMap.Util.ConfigPresets._defs.overlays.earthcast_world_wsr.layerOpts.timeSeriesNFrames = 1;
            FAMap.Util.ConfigPresets._defs.overlays.se_rad.layerOpts.timeSeriesNFrames = 1;
        }
        var hideDuringAnimation = function(idx) {
            if (FAMap.Globals.ANIMATED_WEATHER_ENABLED.match('disabled')) {
                return (FAMap.Util.ConfigPresets._defs.overlays[idx].uiGroup === "weather" || FAMap.Util.ConfigPresets._defs.overlays[idx].uiGroup === "premiumWeather");
            } else {
                return FAMap.Util.ConfigPresets._defs.overlays[idx].uiGroup === "premiumWeather";
            }
        };
        self._overlaysToHide = [];
        self.hideLayers = function(layerList) {
            for (var l = layerList.length - 1; l >= 0; l--) {
                if (layerList[l] && this._layerUI) {
                    if (layerList[l].getVisible()) {
                        var weatherType = "Premium ";
                        if (FAMap.Globals.ANIMATED_WEATHER_ENABLED.match('disabled')) {
                            weatherType = "";
                        }
                        if (typeof (this._timeSeriesLiveLoop) !== "undefined") {
                            this._timeSeriesLiveLoop.alertText(weatherType + "Weather not available for live weather loop");
                        }
                        this._layerUI.disableOverlay(layerList[l]);
                    }
                }
            }
        }
        ;
        self.showLayers = function(layerList) {
            for (var l = layerList.length - 1; l >= 0; l--) {
                if (layerList[l] && this._layerUI) {
                    this._layerUI.enableOverlay(layerList[l]);
                }
            }
            if (typeof (this._timeSeriesLiveLoop) !== "undefined") {
                this._timeSeriesLiveLoop.alertText("");
            }
            $(".flightReplayNotice").html("");
        }
        ;
        self.toggleWeatherLayers = function(replayControl, frameBuffer) {
            var isAnimating = (typeof (frameBuffer) !== "undefined" && frameBuffer.getLoopingState() === "looping") || (typeof (replayControl) !== "undefined" && replayControl.getState() === "playing");
            if (isAnimating) {
                this.hideLayers(this._overlaysToHide);
            } else {
                this.showLayers(this._overlaysToHide);
            }
        }
        ;
        var isTimeSeriesLayer = function(idx) {
            return FAMap.Util.ConfigPresets._defs.overlays[idx].layerClass === FAMap.olExtras.Layer.TimeSeries;
        }
        var enableTimeSeriesAnimation = function(idx) {
            return typeof (FAMap.Util.ConfigPresets._defs.overlays[idx].enableTimeSeriesAnimation) !== "undefined" ? FAMap.Util.ConfigPresets._defs.overlays[idx].enableTimeSeriesAnimation : false;
        }
        $.each(options.overlays, function(idx) {
            var overlay = self._buildLayer(this, idx);
            if (overlay === null) {
                return true;
            }
            if (hideDuringAnimation(idx)) {
                self._overlaysToHide.push(overlay);
            }
            self.addOverlay(overlay, this);
            if (isTimeSeriesLayer(overlay.idx)) {
                var supportAnimation = enableTimeSeriesAnimation(overlay.idx);
                if (supportAnimation && typeof (self._frameBuffer) !== "undefined") {
                    self._frameBuffer.registerTimeSeriesLayer(overlay);
                } else if (self._isHistorical) {
                    overlay.resetClock(self._validTimes.midpoint);
                }
            }
            if (typeof this.layerOpts === 'undefined' || typeof this.layerOpts.style === 'undefined') {
                var autoStyle = self._getOverlayStyle(idx, self._currentBaseLayerIdx);
                if (typeof autoStyle !== 'undefined') {
                    overlay.setStyle(autoStyle);
                }
            }
        });
        if (typeof (this._frameBuffer) !== "undefined") {
            if (!this._isHistorical) {
                this._frameBuffer.liveUpdate(true);
            } else {
                this._frameBuffer.liveUpdate(false);
                this._frameBuffer.pause();
                this._frameBuffer.resetTimeSeriesClock(this._validTimes.midpoint);
            }
        }
        FAMap.InteractionShims.register(this);
        if (self._overlaysToHide.length > 0 && playOnLoad) {
            self._frameBuffer.trigger("loop-start");
        }
        if (self._layerUI) {
            self._layerUI.on('baseLayerClick', function(e) {
                self.persistentStores.BaseLayer.set(e.idx);
            });
            self._layerUI.on('overlayLayerClick', function(e) {
                var layer = self._overlays[e.idx];
                self.persistentStores.Overlays.setItem(e.idx + '.visibility', layer.getVisible());
            });
            self._layerUI.render();
        }
        this.on('interaction.layerSourceChanged', function(e, idx, sourceKey) {
            self.persistentStores.Overlays.setItem(idx + '.sourceKey', sourceKey);
        });
        this.on('interaction.pan interaction.zoom', function() {
            self.persistentStores.ZoomTo.set();
        });
        var idlePeriod = 8000;
        var idleTimeout = setTimeout($.proxy(function() {
            this.trigger('idle');
        }, this), idlePeriod);
        var lastCoord = null;
        this.on('mousemove keydown', $.proxy(function(e) {
            if (e.type == 'mousemove') {
                var coord = [e.clientX, e.clientY].join();
                if (coord == lastCoord) {
                    return true;
                } else {
                    lastCoord = coord;
                }
            }
            this.setActiveState('active');
            clearTimeout(idleTimeout);
            idleTimeout = setTimeout($.proxy(function() {
                this.trigger('idle');
            }, this), idlePeriod);
        }, this));
        this.on('mouseleave', $.proxy(function() {
            this.setActiveState('off');
            clearTimeout(idleTimeout);
        }, this));
        this.on('idle', $.proxy(function() {
            this.setActiveState('inactive');
        }, this));
        setupControlHiding.call(this);
        if ('onMapReady'in options && typeof options.onMapReady == 'function') {
            options.onMapReady.call(null, this);
        }
        $(window).on('userPrefUpdate', $.proxy(function() {
            $.each(this._overlays, function() {
                if ('setStyle'in this) {
                    this.setStyle(this.getStyle());
                }
            });
        }, this));
        var prevWidth = this.$_mapContainer.width();
        var prevHeight = this.$_mapContainer.height();
        setInterval($.proxy(function() {
            var curWidth = this.$_mapContainer.width();
            var curHeight = this.$_mapContainer.height();
            if (prevWidth !== curWidth || prevHeight !== curHeight) {
                prevWidth = curWidth;
                prevHeight = curHeight;
                this._olMap.updateSize();
            }
        }, this), 1000);
    }
    ;
    this.hasAnalytics = function() {
        return this._analytics !== null;
    }
    ;
    this._init.apply(this, arguments);
}
;
(function(FAMap) {
    FAMap.Styles = typeof (FAMap.Styles) === "undefined" ? {} : FAMap.Styles;
}
)(FAMap);
(function(FAMap) {
    if (typeof (FAMap.Styles.Control) !== "undefined") {
        return;
    }
    var mapTypes = {
        default: {
            style: "light"
        },
        classic: {
            style: "light"
        },
        earthview: {
            style: "light"
        },
        mapbox_sat_boundaries: {
            style: "light"
        },
        mapbox_sat: {
            style: "light"
        },
        mapbox_terrain_dark: {
            style: "light"
        },
        mapbox_streets_dark: {
            style: "light"
        },
        mapbox_scope: {
            style: "light"
        },
        sectional: {
            style: "dark"
        },
        ifr_high: {
            style: "dark"
        },
        ifr_low: {
            style: "dark"
        },
        mapbox_terrain_light: {
            style: "dark"
        },
        mapbox_streets_light: {
            style: "dark"
        },
        skyvector_vfr: {
            style: "dark"
        },
        skyvector_ifr_low: {
            style: "dark"
        },
        skyvector_ifr_high: {
            style: "dark"
        }
    }
    FAMap.Styles.Control = {
        _getMapTypes: function() {
            return mapTypes;
        },
        _setMapControlStyle: function(opt) {
            if (opt.style in FAMap.Styles.Control._styleOptions) {
                $(".fa-loop-light,.fa-loop-dark").removeClass("fa-loop-light fa-loop-dark").addClass(FAMap.Styles.Control._styleOptions[opt.style].liveLoopStyleClass);
                $(".fa-zoom-light,.fa-zoom-dark").removeClass("fa-zoom-light fa-zoom-dark").addClass(FAMap.Styles.Control._styleOptions[opt.style].zoomStyleClass);
                $(".fa-layer-ui-light,.fa-layer-ui-dark").removeClass("fa-layer-ui-light fa-layer-ui-dark").addClass(FAMap.Styles.Control._styleOptions[opt.style].layerUIStyleClass);
            }
        },
        _styleOptions: {
            light: {
                liveLoopStyleClass: "fa-loop-light",
                zoomStyleClass: "fa-zoom-light",
                layerUIStyleClass: "fa-layer-ui-light"
            },
            dark: {
                liveLoopStyleClass: "fa-loop-dark",
                zoomStyleClass: "fa-zoom-dark",
                layerUIStyleClass: "fa-layer-ui-dark"
            }
        }
    }
    FAMap.Styles.Control._instances = {};
    $.each(mapTypes, function(idx, style) {
        FAMap.Styles.Control._instances[idx] = FAMap.Styles.Control._setMapControlStyle.bind(null, style);
    });
}
)(FAMap);
FAMap.Styles.Feature = {};
FAMap.Styles.Feature._instances = {};
FAMap.Styles.Feature._defaults = {
    FONT_SIZE: 11,
    FONT: 'Arial, sans-serif',
    LINE_WIDTH: 1.2,
    PLANE_ICON_MULTIPLIER: 1,
    DISABLE_DATABLOCKS: false
};
if (!('STYLE_OVERRIDES'in FAMap.Globals)) {
    FAMap.Styles.Feature._defs = FAMap.Styles.Feature._defaults;
} else {
    FAMap.Styles.Feature._defs = {};
    $.each(FAMap.Styles.Feature._defaults, function(k, v) {
        if (k in FAMap.Globals.STYLE_OVERRIDES) {
            FAMap.Styles.Feature._defs[k] = FAMap.Globals.STYLE_OVERRIDES[k];
        } else {
            FAMap.Styles.Feature._defs[k] = FAMap.Styles.Feature._defaults[k];
        }
    });
}
FAMap.Styles.Feature._util = {
    universalStyleFunction: function(styleFunction) {
        return function(maybeFeature, maybeResolution, ignoreCycling) {
            if (Object.getPrototypeOf(this) == ol.Feature.prototype) {
                var feature = this;
                var resolution = maybeFeature;
            } else {
                var feature = maybeFeature;
                var resolution = maybeResolution;
            }
            if (ignoreCycling || !('getCycleVisibility'in feature)) {
                cycleVisible = true;
            } else {
                cycleVisible = feature.getCycleVisibility(true);
            }
            return styleFunction(feature, resolution, cycleVisible);
        }
    },
    getIcon: function(feature, color, resolution, nofill) {
        if (typeof nofill === 'undefined') {
            nofill = false;
        }
        var iconName = feature.get('icon');
        if (typeof iconName == 'undefined') {
            iconName = 'unknown';
        }
        var direction = feature.get('direction');
        if (typeof direction == 'undefined') {
            direction = 0;
        }
        var iconParts = iconName.split(' ');
        var iconName = iconParts[0];
        var iconSize = iconParts[1] || 2;
        var scale = 1 * FAMap.Styles.Feature._defs.PLANE_ICON_MULTIPLIER;
        return new FAMap.olExtras.Style.Aircraft({
            shape: iconName,
            color: color,
            rotation: FAMap.Util.toRadians(direction),
            scale: scale,
            nofill: nofill
        });
    },
    getFlightDatablockData: function(feature) {
        var data = {}
        data.isProjected = (typeof feature.get('projected') !== 'undefined') ? feature.get('projected') : !(['P', 'TP'].indexOf(feature.get('updateType')) == -1);
        data.ident = (feature.get('displayIdent') || feature.get('ident') || feature.get('reg')) || (feature.get('hexid') ? '0x'.concat(feature.get('hexid')) : 'UNKNOWN');
        data.type;
        if (typeof feature.get('aircraft') === 'object' && 'type'in feature.get('aircraft')) {
            data.type = feature.get('aircraft').type;
        } else {
            data.type = feature.get('type') || '';
        }
        data.alt = FAUser.formatAltitude(feature.get('altitude'), false, false) || '';
        data.gs = FAUser.formatSpeed(feature.get('groundspeed'), false, false) || '';
        data.gs = String(data.gs).split('.')[0];
        data.origin = feature.get('origin');
        data.origLabel = '';
        if (data.origin) {
            data.origLabel = FAUser.formatAirportCode(data.origin.icao, data.origin.iata, data.origin.altIdent, false, true);
        }
        data.destination = feature.get('destination');
        data.destLabel = '';
        if (data.destination) {
            data.destLabel = FAUser.formatAirportCode(data.destination.icao, data.destination.iata, data.destination.altIdent, false, true);
        }
        try {
            var rawEta = feature.get('landingTimes').estimated;
            if (rawEta == 0 || rawEta === null) {
                data.eta = '';
            } else {
                try {
                    var tz = feature.get('destination').TZ;
                } catch (e) {
                    var tz = 'UTC';
                }
                if (typeof jet_blue_show_eta === 'undefined' || jet_blue_show_eta !== false) {
                    data.eta = FADate.displayFlightTime(moment.unix(rawEta), tz);
                }
            }
        } catch (e) {
            data.eta = '';
        }
        return data
    },
    getDatablock: function(feature, options) {
        if (FAMap.Styles.Feature._defs.DISABLE_DATABLOCKS) {
            return null;
        }
        var required = ['fillColor', 'strokeColor'];
        $.each(required, function() {
            if (!(this in options)) {
                throw ('Error: missing required option ' + this);
            }
        });
        datablockData = FAMap.Styles.Feature._util.getFlightDatablockData(feature);
        var datablockFormat = options.hasOwnProperty("datablockFormat") ? options.datablockFormat : null;
        switch (datablockFormat) {
        case "aireon":
            var lines = [datablockData.ident, ];
            if (datablockData.hasOwnProperty("reg")) {
                lines.push(datablockData.reg);
            }
            lines.push(datablockData.isProjected ? 'ESTIMATED' : [Math.round(datablockData.alt / 100), datablockData.gs].join(' '));
            break;
        case "noAirports":
            var lines = [datablockData.ident.trim(), datablockData.isProjected ? 'ESTIMATED' : [datablockData.alt, datablockData.gs].join(' '), ];
            break;
        default:
            var lines = [[datablockData.ident, datablockData.type].join(' ').trim(), datablockData.isProjected ? 'ESTIMATED' : [datablockData.alt, datablockData.gs].join(' '), ];
            if (!FAMap.Util.isAirportLatLon(datablockData.origin.icao)) {
                lines.push([datablockData.origLabel, datablockData.destLabel, datablockData.eta].join(' ').trim());
            }
        }
        var text = lines.join('\n');
        var heading = feature.get('direction') || feature.get('heading') || 0;
        var baseOffsetX = FAMap.Styles.Feature._defs.FONT_SIZE + 4;
        var baseOffsetY = FAMap.Styles.Feature._defs.FONT_SIZE * 2;
        if (datablockFormat === "aireon") {
            var align = 'left';
            var baseline = 'bottom';
            var offsetX = -(FAMap.Styles.Feature._defs.FONT_SIZE * 1.8);
            baseOffsetY = FAMap.Styles.Feature._defs.FONT_SIZE * (lines.length - 1);
            var offsetY = -(baseOffsetY + 3);
        } else {
            switch (Math.floor((heading % 360) / 90)) {
            case 0:
                var align = 'left';
                var baseline = 'top';
                var offsetX = baseOffsetX;
                var offsetY = -baseOffsetY;
                break;
            case 1:
                var align = 'left';
                var baseline = 'bottom';
                var offsetX = baseOffsetX;
                var offsetY = baseOffsetY;
                break;
            case 2:
                var align = 'right';
                var baseline = 'bottom';
                var offsetX = -baseOffsetX;
                var offsetY = baseOffsetY;
                break;
            case 3:
                var align = 'right';
                var baseline = 'top';
                var offsetX = -baseOffsetX;
                var offsetY = -baseOffsetY;
                break;
            }
        }
        return new ol.style.Text({
            font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
            offsetX: offsetX,
            offsetY: offsetY,
            text: text || '',
            textAlign: align,
            textBaseline: baseline,
            fill: new ol.style.Fill({
                color: options.fillColor
            }),
            stroke: new ol.style.Stroke({
                color: options.strokeColor,
                width: 2
            })
        });
    }
};
FAMap.Styles.Feature._instances.aircraft = {};
var flightColors = {
    dark: {
        fillColor: '#00FF00',
        strokeColor: '#008900',
        outline: '#000000',
        projectedColor: '#ffffff',
        projectedOutline: '#000000',
        shadowColor: '#000000',
        baseLayers: ['default', 'classic', 'earthview', 'premium_sat_boundaries', 'premium_sat']
    },
    light: {
        fillColor: '#00FF00',
        strokeColor: '#008900',
        outline: '#000000',
        projectedColor: '#000000',
        projectedOutline: '#ffffff',
        shadowColor: '#000000',
        baseLayers: ['sectional', 'ifr_high', 'ifr_low', 'premium_terrain', 'premium_streets', 'skyvector_vfr', 'skyvector_ifr_low', 'skyvector_ifr_high']
    }
};
$.each(flightColors, function(key, def) {
    def.baseLayers.forEach(function(layer) {
        FAMap.Styles.Feature._instances.aircraft[layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
            var isProjected = !(['P', 'TP'].indexOf(feature.get('updateType')) == -1);
            var isShadow = feature.get('featureSet') == 'Shadow';
            var iconFill = def.fillColor;
            var iconStroke = def.strokeColor;
            var textFill = def.fillColor;
            var textStroke = def.outline;
            var shadowColor = def.shadowColor;
            var projectedFill = def.projectedColor;
            var projectedStroke = def.projectedOutline;
            var projectedTextFill = def.projectedColor;
            var projectedOutline = def.projectedOutline;
            var imageStyle = null;
            var textStyle = null;
            if (isProjected) {
                if (!isShadow) {
                    var imageStyle = FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: projectedFill,
                        strokeColor: projectedStroke
                    }, resolution, true);
                    var textStyle = FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: projectedTextFill,
                        strokeColor: projectedOutline
                    });
                }
            } else {
                if (isShadow) {
                    var imageStyle = FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: shadowColor,
                        strokeColor: shadowColor
                    }, resolution);
                } else {
                    var imageStyle = FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: iconFill,
                        strokeColor: iconStroke
                    }, resolution);
                    var textStyle = FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: textFill,
                        strokeColor: textStroke
                    });
                }
            }
            var styleObj = {};
            if (imageStyle !== null) {
                styleObj.image = imageStyle;
            }
            if (textStyle !== null) {
                styleObj.text = textStyle;
            }
            return [new ol.style.Style(styleObj)]
        });
    });
});
delete flightColors;
FAMap.Styles.Feature._instances.aireon_flights = {};
(function(FAMap) {
    var svgTemplate = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 65" width="66px" height="66px" class="flightPageAircraftIcon Enroute progressBarAircraftIcon"><defs><style>.cls-1{fill:#FFFF00;}.cls-2{fill:#FFFF00;}</style></defs><title>aireon_smt_live</title><g id="Layer_2" data-name="Layer 2"><g id="ANSP-Flight-Icon"><rect x="28.5" y="28.5" width="8" height="8" stroke="#FFFF00" fill="none" stroke-width="2" /><path d="M32.5,32.5 LheadingX,headingY"  stroke="#FFFF00" stroke-width="1" /> </g></g></svg>';
    var aireonIcon = {};
    var aircraftColors = {
        default: {
            getHighlightText: FAMap.Styles.Feature._util.getDatablock,
            getIcon: FAMap.Styles.Feature._util.getIcon,
            outline: '#000000',
            fillColor: '#FFFFFF',
            strokeColor: '#4D4D4D',
            datablockFormat: "noAirports"
        },
        aireon_scope: {
            getHighlightText: FAMap.Styles.Feature._util.getDatablock,
            getText: FAMap.Styles.Feature._util.getDatablock,
            getIcon: function(feature, palette, resolution) {
                var direction = feature.get('direction');
                direction = Math.round(direction) - 90;
                var radians = FAMap.Util.toRadians(direction);
                var radius = 28.2843;
                if (!aireonIcon.hasOwnProperty(direction.toString())) {
                    var x = 32.5 + radius * Math.cos(radians);
                    var y = 32.5 + radius * Math.sin(radians);
                    var localSvg = svgTemplate.replace('headingX', x.toString()).replace('headingY', y.toString());
                    var src = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(localSvg);
                    aireonIcon[direction] = new ol.style.Icon({
                        anchor: [0.5, 0.5],
                        anchorXUnits: 'fraction',
                        anchorYUnits: 'fraction',
                        rotateWithView: false,
                        src: src,
                        imgSize: [66, 66]
                    });
                }
                return aireonIcon[direction];
            },
            strokeColor: '#FFFF00',
            fillColor: '#FFFF00',
            outline: "#0B0B53",
            datablockFormat: "aireon"
        }
    };
    var hiddenStyle = new ol.style.Style({
        visibility: "hidden"
    });
    $.each(aircraftColors, function(key, styleConfig) {
        FAMap.Styles.Feature._instances.aireon_flights[key] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
            var iconText = styleConfig.hasOwnProperty("getText") ? (typeof (styleConfig.getText) === "function" ? styleConfig.getText(feature, {
                fillColor: styleConfig.fillColor,
                strokeColor: styleConfig.outline,
                datablockFormat: styleConfig.hasOwnProperty("datablockFormat") ? styleConfig.datablockFormat : null
            }) : styleConfig.getText) : null;
            return [FA.aireonFilter.isPassing(feature) ? new ol.style.Style({
                image: styleConfig.getIcon(feature, {
                    fillColor: styleConfig.fillColor,
                    strokeColor: styleConfig.strokeColor
                }, resolution),
                text: iconText
            }) : hiddenStyle]
        });
        FAMap.Styles.Feature._instances.aireon_flights["highlight_" + key] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
            var iconText = styleConfig.hasOwnProperty("getHighlightText") ? (typeof (styleConfig.getHighlightText) === "function" ? styleConfig.getHighlightText(feature, {
                fillColor: styleConfig.fillColor,
                strokeColor: styleConfig.outline,
                datablockFormat: styleConfig.hasOwnProperty("datablockFormat") ? styleConfig.datablockFormat : null
            }) : styleConfig.getHighlightText) : null;
            return [new ol.style.Style({
                image: styleConfig.getIcon(feature, {
                    fillColor: styleConfig.fillColor,
                    strokeColor: styleConfig.strokeColor
                }, resolution),
                text: iconText,
            })]
        });
    });
}
)(FAMap);
FAMap.Styles.Feature._defaults.AirmetType = {
    "TURB": new ol.style.Style({
        stroke: new ol.style.Stroke({
            color: '#22f44c',
            width: 2
        }),
        fill: new ol.style.Fill({
            color: 'rgba(34,244,76,0.1)'
        })
    }),
    "IFR": new ol.style.Style({
        stroke: new ol.style.Stroke({
            color: '#ed0000',
            width: 2
        }),
        fill: new ol.style.Fill({
            color: 'rgba(237,0,0,0.1)'
        })
    }),
    "ICE": new ol.style.Style({
        stroke: new ol.style.Stroke({
            color: '#edaeef',
            width: 2
        }),
        fill: new ol.style.Fill({
            color: 'rgba(237,174,239,0.1)'
        })
    }),
    "MTN_OBSCN": new ol.style.Style({
        stroke: new ol.style.Stroke({
            color: '#f4dc22',
            width: 2
        }),
        fill: new ol.style.Fill({
            color: 'rgba(244,220,34,0.1)'
        })
    })
}
FAMap.Styles.Feature._instances.airmets = {
    default: FAMap.Styles.Feature._util.universalStyleFunction(function(feature) {
        var type = feature.get('type')
          , hazard = feature.get('hazard')
        style = null;
        hazard = hazard.replace(" ", "_");
        if (type !== "AIRMET") {
            return null;
        }
        if (typeof (FAMap.Styles.Feature._defaults.AirmetType[hazard]) !== "undefined") {
            style = FAMap.Styles.Feature._defaults.AirmetType[hazard];
        } else {
            console.error("Unknown airmet hazard:" + hazard);
            return null;
        }
        return [style];
    })
};
FAMap.Styles.Feature._instances.airport_delays = {
    _delayColors: {
        good: '#1FCA23',
        medium: '#FFFF00',
        bad: '#FC0D1B'
    }
};
var delayColors = {
    default: {
        text: '#FFFFFF',
        outline: '#000000'
    },
    classic: {
        text: '#FFFFFF',
        outline: '#000000'
    },
    earthview: {
        text: '#FFA033',
        outline: '#000000'
    },
    sectional: {
        text: '#0000CC',
        outline: '#BCBCBC'
    },
    ifr_high: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    ifr_low: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    skyvector_vfr: {
        text: '#0000CC',
        outline: '#BCBCBC'
    },
    skyvector_ifr_low: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    skyvector_ifr_high: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    mapbox_sat_boundaries: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_sat: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_terrain_light: {
        text: '#000000',
        outline: '#FFFFFF'
    },
    mapbox_terrain_dark: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_streets_light: {
        text: '#000000',
        outline: '#FFFFFF'
    },
    mapbox_streets_dark: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_scope: {
        text: '#66FF66',
        outline: '#000000'
    }
};
$.each(delayColors, function(idx, colors) {
    $.each([true, false], function(k, forceLabel) {
        var prefix = forceLabel ? 'highlight_' : ''
        FAMap.Styles.Feature._instances.airport_delays[prefix + idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
            var clusterFeatures = feature.get('features');
            if (clusterFeatures !== undefined) {
                if (clusterFeatures.length > 1) {
                    var byDelay = {};
                    $.each(clusterFeatures, function(k, clusterFeature) {
                        var delay = clusterFeature.get('delay');
                        if (!(delay in byDelay)) {
                            byDelay[delay] = {};
                        }
                        var score = clusterFeature.get('ops');
                        if (!(score in byDelay[delay])) {
                            byDelay[delay][score] = [];
                        }
                        byDelay[delay][score].push(clusterFeature);
                    });
                    var delayValues = Object.keys(byDelay).sort();
                    var worstDelayGroup = byDelay[delayValues.pop()];
                    var scoreValues = Object.keys(worstDelayGroup).sort();
                    var bestGroup = worstDelayGroup[scoreValues.shift()];
                    var displayFeature = bestGroup[0];
                    var displayLabel = displayFeature.get('label');
                    displayLabel += ' (+' + (clusterFeatures.length - 1) + ' more)';
                    feature.displayFeature = displayFeature;
                } else {
                    var displayFeature = clusterFeatures[0];
                    var displayLabel = displayFeature.get('label');
                }
            } else {
                var displayFeature = feature;
                var displayLabel = feature.get('label')
            }
            var zoomLevel = FAMap.Util.getZoomForResolution(resolution);
            var label = (forceLabel || zoomLevel >= 4) ? displayLabel : '';
            var delay = displayFeature.get('delay');
            var radius = 5;
            var delayFill;
            if (delay >= 3600 || delay < 0) {
                delayFill = FAMap.Styles.Feature._instances.airport_delays._delayColors.bad;
            } else if (delay >= 900) {
                delayFill = FAMap.Styles.Feature._instances.airport_delays._delayColors.medium;
            } else {
                delayFill = FAMap.Styles.Feature._instances.airport_delays._delayColors.good;
            }
            return [new ol.style.Style({
                image: new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: delayFill
                    }),
                    stroke: new ol.style.Stroke({
                        color: colors.outline
                    }),
                    radius: radius
                }),
                text: new ol.style.Text({
                    font: '11px ' + FAMap.Styles.Feature._defs.FONT,
                    offsetX: radius + 2,
                    offsetY: 0,
                    text: label || '',
                    textAlign: 'left',
                    textBaseline: 'top',
                    fill: new ol.style.Fill({
                        color: colors.text
                    }),
                    stroke: new ol.style.Stroke({
                        color: colors.outline,
                        width: 2
                    })
                })
            })];
        });
    });
});
delete delayColors;
FAMap.Styles.Feature._instances.arinc_lastpos = {};
var ADColors = {
    default: {
        altFill: '#00FFFF',
        altOutline: '#000000',
        defaultFill: '#FFFF00',
        defaultOutline: '#000000'
    },
    classic: {
        altFill: '#00FFFF',
        altOutline: '#000000',
        defaultFill: '#FFFF00',
        defaultOutline: '#000000'
    },
    earthview: {
        altFill: '#00FFFF',
        altOutline: '#000000',
        defaultFill: '#FFA033',
        defaultOutline: '#000000'
    },
    sectional: {
        altFill: '#002F5D',
        altOutline: '#BCBCBC',
        defaultFill: '#0000CC',
        defaultOutline: '#BCBCBC'
    },
    ifr_high: {
        altFill: '#002F5D',
        altOutline: '#FFFFFF',
        defaultFill: '#002F5D',
        defaultOutline: '#FFFFFF'
    },
    ifr_low: {
        altFill: '#002F5D',
        altOutline: '#FFFFFF',
        defaultFill: '#002F5D',
        defaultOutline: '#FFFFFF'
    },
    skyvector_vfr: {
        altFill: '#002F5D',
        altOutline: '#BCBCBC',
        defaultFill: '#0000CC',
        defaultOutline: '#BCBCBC'
    },
    skyvector_ifr_low: {
        altFill: '#002F5D',
        altOutline: '#FFFFFF',
        defaultFill: '#002F5D',
        defaultOutline: '#FFFFFF'
    },
    skyvector_ifr_high: {
        altFill: '#002F5D',
        altOutline: '#FFFFFF',
        defaultFill: '#002F5D',
        defaultOutline: '#FFFFFF'
    },
    mapbox_sat_boundaries: {
        altFill: '#00FFFF',
        altOutline: '#000000',
        defaultFill: '#FFFF00',
        defaultOutline: '#000000'
    },
    mapbox_sat: {
        altFill: '#00FFFF',
        altOutline: '#000000',
        defaultFill: '#FFA033',
        defaultOutline: '#000000'
    },
    mapbox_terrain_light: {
        altFill: '#002F5D',
        altOutline: '#FFFFFF',
        defaultFill: '#000000',
        defaultOutline: '#FFFFFF'
    },
    mapbox_terrain_dark: {
        altFill: '#00FFFF',
        altOutline: '#000000',
        defaultFill: '#FFFF00',
        defaultOutline: '#000000'
    },
    mapbox_streets_light: {
        altFill: '#002F5D',
        altOutline: '#FFFFFF',
        defaultFill: '#000000',
        defaultOutline: '#FFFFFF'
    },
    mapbox_streets_dark: {
        altFill: '#00FFFF',
        altOutline: '#000000',
        defaultFill: '#FFFF00',
        defaultOutline: '#000000'
    },
    mapbox_scope: {
        altFill: '#66FF66',
        altOutline: '#000000',
        defaultFill: '#66FF66',
        defaultOutline: '#000000'
    }
};
$.each(ADColors, function(idx, colors) {
    FAMap.Styles.Feature._instances.arinc_lastpos[idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution, cycleVisible) {
        var styleOpts = {};
        if (feature.get('featureSet') == 'Endpoints') {
            var airport = feature.get('label');
            var idents = [];
        } else {
            var airport = feature.get('airportIdent');
            var idents = feature.get('idents');
        }
        if (airport) {
            if (idents.length > 0) {
                styleOpts.image = new ol.style.RegularShape({
                    fill: new ol.style.Fill({
                        color: colors.altFill
                    }),
                    stroke: new ol.style.Stroke({
                        color: colors.altFill,
                        width: 2
                    }),
                    radius: 4,
                    radius2: 0,
                    points: 4,
                    angle: Math.PI
                });
                var labelText = airport + '(' + idents.length + ')\n';
                labelText += idents.join('\n');
            } else {
                styleOpts.image = new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: colors.altFill
                    }),
                    radius: 3
                });
                var labelText = airport;
            }
        } else {
            styleOpts.image = new ol.style.RegularShape({
                fill: new ol.style.Fill({
                    color: colors.altFill
                }),
                radius: 6,
                points: 3,
                angle: Math.PI
            });
            var labelText = idents[0];
        }
        if ((resolution === null || FAMap.Util.getZoomForResolution(resolution) >= 4) && cycleVisible) {
            styleOpts.text = new ol.style.Text({
                font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                offsetX: 5,
                offsetY: 0,
                text: labelText || '',
                textAlign: feature.get('labelAlign') || 'left',
                textBaseline: feature.get('labelBaseline'),
                fill: new ol.style.Fill({
                    color: colors.altFill
                }),
                stroke: new ol.style.Stroke({
                    color: colors.altOutline,
                    width: 2
                })
            });
        }
        return [new ol.style.Style(styleOpts)];
    });
    FAMap.Styles.Feature._instances.arinc_lastpos['highlight_' + idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var styleOpts = {};
        if (feature.get('featureSet') == 'Endpoints') {
            var airport = feature.get('label');
            var idents = [];
        } else {
            var airport = feature.get('airportIdent');
            var idents = feature.get('idents');
        }
        if (airport) {
            if (idents.length > 0) {
                styleOpts.image = new ol.style.RegularShape({
                    fill: new ol.style.Fill({
                        color: colors.altFill
                    }),
                    stroke: new ol.style.Stroke({
                        color: colors.altFill,
                        width: 2
                    }),
                    radius: 4,
                    radius2: 0,
                    points: 4,
                    angle: Math.PI
                });
                var labelText = airport + '(' + idents.length + ')\n';
            } else {
                styleOpts.image = new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: colors.altFill
                    }),
                    radius: 3
                });
                var labelText = airport;
            }
        } else {
            styleOpts.image = new ol.style.RegularShape({
                fill: new ol.style.Fill({
                    color: colors.altFill
                }),
                radius: 6,
                points: 3,
                angle: Math.PI
            });
            var labelText = '';
        }
        var offsetX = 5;
        var labelAlign = feature.get('labelAlign') || 'left';
        if (labelAlign == 'right') {
            offsetX = offsetX * -1;
        }
        if (FAMap.Util.getZoomForResolution(resolution) >= 4) {
            styleOpts.text = new ol.style.Text({
                font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                offsetX: offsetX,
                offsetY: 0,
                text: labelText || '',
                textAlign: labelAlign,
                textBaseline: feature.get('labelBaseline'),
                fill: new ol.style.Fill({
                    color: colors.defaultFill
                }),
                stroke: new ol.style.Stroke({
                    color: colors.defaultOutline,
                    width: 2
                })
            });
        }
        return [new ol.style.Style(styleOpts)];
    });
    FAMap.Styles.Feature._instances.arinc_lastpos['unhighlight_' + idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var styleOpts = {};
        if (feature.get('featureSet') == 'Endpoints') {
            var airport = feature.get('label');
            var idents = [];
        } else {
            var airport = feature.get('airportIdent');
            var idents = feature.get('idents');
        }
        if (airport) {
            if (idents.length > 0) {
                styleOpts.image = new ol.style.RegularShape({
                    fill: new ol.style.Fill({
                        color: colors.altFill
                    }),
                    stroke: new ol.style.Stroke({
                        color: colors.altFill,
                        width: 2
                    }),
                    radius: 4,
                    radius2: 0,
                    points: 4,
                    angle: Math.PI
                });
            } else {
                styleOpts.image = new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: colors.altFill
                    }),
                    radius: 3
                });
            }
        } else {
            styleOpts.image = new ol.style.RegularShape({
                fill: new ol.style.Fill({
                    color: colors.altFill
                }),
                radius: 6,
                points: 3,
                angle: Math.PI
            });
        }
        return [new ol.style.Style(styleOpts)];
    });
});
delete ADColors;
FAMap.Styles.Feature._instances.arinc_related_dedupe = FAMap.Styles.Feature._instances.arinc_lastpos;
FAMap.Styles.Feature._instances.arrivals = {};
FAMap.Styles.Feature._instances.departures = {};
var airportColors = {
    blueRoute: {
        arrivals: {
            fillColor: '#00FFFF',
            strokeColor: '#0075FF'
        },
        departures: {
            fillColor: '#00FF00',
            strokeColor: '#008900'
        },
        route: '#4499FF',
        baseLayers: ['default', 'classic', 'earthview', 'premium_sat_boundaries', 'premium_sat']
    },
    orangeRoute: {
        arrivals: {
            fillColor: '#00FFFF',
            strokeColor: '#0075FF'
        },
        departures: {
            fillColor: '#00FF00',
            strokeColor: '#008900'
        },
        route: '#ED8000',
        baseLayers: ['premium_terrain', 'premium_streets']
    },
    grayRoute: {
        arrivals: {
            fillColor: '#00FFFF',
            strokeColor: '#0075FF'
        },
        departures: {
            fillColor: '#00FF00',
            strokeColor: '#008900'
        },
        route: '#909090',
        baseLayers: ['ifr_high', 'ifr_low', 'skyvector_ifr_low', 'skyvector_ifr_high']
    },
    whiteRoute: {
        arrivals: {
            fillColor: '#00FFFF',
            strokeColor: '#0075FF'
        },
        departures: {
            fillColor: '#00FF00',
            strokeColor: '#008900'
        },
        route: '#F8F8F8',
        baseLayers: ['sectional', 'skyvector_vfr']
    }
};
$.each(airportColors, function(key, def) {
    def.baseLayers.forEach(function(layer) {
        FAMap.Styles.Feature._instances.arrivals[layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution, cycleVisible) {
            var arrivalIconFill = def.arrivals.fillColor;
            var arrivalIconStroke = def.arrivals.strokeColor;
            var arrivalTextFill = def.arrivals.fillColor;
            var arrivalTrailFill = def.arrivals.fillColor;
            var arrivalTrailStroke = def.arrivals.strokeColor;
            switch (feature.get('featureSet')) {
            case 'Plane':
                var styleOpts = {
                    image: FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: arrivalIconFill,
                        strokeColor: arrivalIconStroke
                    }, resolution)
                };
                if (cycleVisible) {
                    styleOpts.text = FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: arrivalTextFill,
                        strokeColor: '#000'
                    })
                }
                break;
            case 'Trail':
                var styleOpts = [{
                    stroke: new ol.style.Stroke({
                        color: arrivalTrailStroke,
                        width: FAMap.Styles.Feature._defs.LINE_WIDTH * 2
                    })
                }, {
                    stroke: new ol.style.Stroke({
                        color: arrivalTrailFill,
                        width: FAMap.Styles.Feature._defs.LINE_WIDTH
                    })
                }];
                break;
            case 'Route':
                var styleOpts = {};
                if (cycleVisible) {
                    styleOpts.stroke = new ol.style.Stroke({
                        color: def.route,
                        width: 1,
                        lineDash: [8, 4]
                    });
                }
                break;
            default:
                var styleOpts = {};
            }
            var styles = [];
            if (styleOpts.forEach === undefined) {
                styles.push(new ol.style.Style(styleOpts))
            } else {
                styleOpts.forEach(function(s) {
                    styles.push(new ol.style.Style(s))
                });
            }
            return styles;
        });
        FAMap.Styles.Feature._instances.arrivals['highlight_' + layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution, cycleVisible) {
            var arrivalIconFill = def.arrivals.fillColor;
            var arrivalIconStroke = def.arrivals.strokeColor;
            var arrivalTextFill = def.arrivals.fillColor;
            var arrivalTrailFill = def.arrivals.fillColor;
            var arrivalTrailStroke = def.arrivals.strokeColor;
            switch (feature.get('featureSet')) {
            case 'Plane':
                var styleOpts = {
                    image: FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: arrivalIconFill,
                        strokeColor: arrivalIconStroke
                    }, resolution),
                    text: FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: arrivalTextFill,
                        strokeColor: '#000'
                    })
                };
                break;
            case 'Route':
                var styleOpts = {
                    stroke: new ol.style.Stroke({
                        color: def.route,
                        width: 1,
                        lineDash: [8, 4]
                    })
                };
                break;
            default:
                var styleOpts = {};
            }
            return [new ol.style.Style(styleOpts)];
        });
        FAMap.Styles.Feature._instances.departures[layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution, cycleVisible) {
            var departureIconFill = def.departures.fillColor;
            var departureIconStroke = def.departures.strokeColor;
            var departureTextFill = def.departures.fillColor;
            var departureTrailFill = def.departures.fillColor;
            var departureTrailStroke = def.departures.strokeColor;
            switch (feature.get('featureSet')) {
            case 'Plane':
                var styleOpts = {
                    image: FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: departureIconFill,
                        strokeColor: departureIconStroke
                    }, resolution)
                };
                if (cycleVisible) {
                    styleOpts.text = FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: departureTextFill,
                        strokeColor: '#000'
                    })
                }
                break;
            case 'Trail':
                var styleOpts = [{
                    stroke: new ol.style.Stroke({
                        color: departureTrailStroke,
                        width: FAMap.Styles.Feature._defs.LINE_WIDTH * 2
                    })
                }, {
                    stroke: new ol.style.Stroke({
                        color: departureTrailFill,
                        width: FAMap.Styles.Feature._defs.LINE_WIDTH
                    })
                }];
                break;
            case 'Route':
                var styleOpts = {};
                if (cycleVisible) {
                    styleOpts.stroke = new ol.style.Stroke({
                        color: def.route,
                        width: 1,
                        lineDash: [8, 4]
                    });
                }
                break;
            default:
                var styleOpts = {};
            }
            var styles = [];
            if (styleOpts.forEach === undefined) {
                styles.push(new ol.style.Style(styleOpts))
            } else {
                styleOpts.forEach(function(s) {
                    styles.push(new ol.style.Style(s))
                });
            }
            return styles;
        });
        FAMap.Styles.Feature._instances.departures['highlight_' + layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
            var departureIconFill = def.departures.fillColor;
            var departureIconStroke = def.departures.strokeColor;
            var departureTextFill = def.departures.fillColor;
            var departureTrailFill = def.departures.fillColor;
            var departureTrailStroke = def.departures.strokeColor;
            switch (feature.get('featureSet')) {
            case 'Plane':
                var styleOpts = {
                    image: FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: departureIconFill,
                        strokeColor: departureIconStroke
                    }, resolution),
                    text: FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: departureTextFill,
                        strokeColor: '#000'
                    })
                };
                break;
            case 'Route':
                var styleOpts = {
                    stroke: new ol.style.Stroke({
                        color: def.route,
                        width: 1,
                        lineDash: [8, 4]
                    })
                };
                break;
            default:
                var styleOpts = {};
            }
            return [new ol.style.Style(styleOpts)];
        });
    });
});
delete airportColors;
var day_night_colors = {
    default: {
        night: 'rgba(0,0,0,0.04)'
    },
    classic: {
        night: 'rgba(0,0,0,0.04)'
    },
    earthview: {
        day: 'rgba(255,255,255,0.01)',
        night: 'rgba(0,0,0,0.04)'
    },
    sectional: {
        night: 'rgba(0,0,0,0.04)'
    },
    ifr_high: {
        night: 'rgba(0,0,0,0.04)'
    },
    ifr_low: {
        night: 'rgba(0,0,0,0.04)'
    },
    skyvector_vfr: {
        night: 'rgba(0,0,0,0.04)'
    },
    skyvector_ifr_low: {
        night: 'rgba(0,0,0,0.04)'
    },
    skyvector_ifr_high: {
        night: 'rgba(0,0,0,0.04)'
    },
    mapbox_sat_boundaries: {
        day: 'rgba(255,255,255,0.01)',
        night: 'rgba(0,0,0,0.04)'
    },
    mapbox_sat: {
        day: 'rgba(255,255,255,0.01)',
        night: 'rgba(0,0,0,0.04)'
    },
    mapbox_terrain_light: {
        night: 'rgba(0,0,0,0.04)'
    },
    mapbox_terrain_dark: {
        day: 'rgba(255,255,255,0.01)',
        night: 'rgba(0,0,0,0.04)'
    },
    mapbox_streets_light: {
        night: 'rgba(0,0,0,0.04)'
    },
    mapbox_streets_dark: {
        day: 'rgba(255,255,255,0.01)',
        night: 'rgba(0,0,0,0.04)'
    },
    mapbox_scope: {
        night: 'rgba(0,0,0,0.04)'
    },
};
FAMap.Styles.Feature._instances.day_night = {};
$.each(day_night_colors, function(layer, styleData) {
    FAMap.Styles.Feature._instances.day_night[layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var styles = [];
        var type = feature.get('type');
        if (type in styleData) {
            styles.push(new ol.style.Style({
                fill: new ol.style.Fill({
                    color: styleData[type]
                })
            }));
        }
        return styles;
    });
});
FAMap.Styles.Feature._defaults.fir_polygons = {
    FIR: {
        "Point": new ol.style.Style({
            image: new ol.style.Circle({
                stroke: new ol.style.Stroke({
                    color: '#FFFFFF',
                    width: 1
                }),
                fill: new ol.style.Fill({
                    color: 'rgba(255,255,255,0.15)'
                }),
                radius: 3
            })
        }),
        "Polygon": new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#FFFFFF',
                width: 1
            }),
            fill: new ol.style.Fill({
                color: 'rgba(255,255,255,0.15)'
            })
        })
    },
}
FAMap.Styles.Feature._instances.fir_polygons = {
    default: FAMap.Styles.Feature._util.universalStyleFunction(function(feature) {
        var type = feature.get('type')
          , hazard = feature.get('hazard')
          , style = null
          , geomType = feature.getGeometry().getType();
        style = FAMap.Styles.Feature._defaults.fir_polygons.FIR[geomType];
        return [style];
    })
};
FAMap.Styles.Feature._instances.flights = {};
var flightColors = {
    blueRoute: {
        fillColor: '#00FFFF',
        strokeColor: '#008900',
        route: '#4499FF',
        baseLayers: ['default', 'classic', 'earthview', 'premium_sat_boundaries', 'premium_sat']
    },
    orangeRoute: {
        fillColor: '#00FFFF',
        strokeColor: '#008900',
        route: '#ED8000',
        baseLayers: ['premium_terrain', 'premium_streets']
    },
    grayRoute: {
        fillColor: '#00FFFF',
        strokeColor: '#008900',
        route: '#909090',
        baseLayers: ['ifr_high', 'ifr_low', 'skyvector_ifr_low', 'skyvector_ifr_high']
    },
    whiteRoute: {
        fillColor: '#00FFFF',
        strokeColor: '#008900',
        route: '#F8F8F8',
        baseLayers: ['sectional', 'skyvector_vfr']
    }
};
$.each(flightColors, function(key, def) {
    def.baseLayers.forEach(function(layer) {
        FAMap.Styles.Feature._instances.flights[layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution, cycleVisible) {
            var iconFill = def.fillColor;
            var iconStroke = def.strokeColor;
            var textFill = def.fillColor;
            var trailFill = def.fillColor;
            var trailStroke = def.strokeColor;
            switch (feature.get('featureSet')) {
            case 'Plane':
                var styleOpts = {
                    image: FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: iconFill,
                        strokeColor: iconStroke
                    }, resolution)
                };
                if (cycleVisible) {
                    styleOpts.text = FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: textFill,
                        strokeColor: '#000'
                    })
                }
                break;
            case 'Trail':
                var styleOpts = [{
                    stroke: new ol.style.Stroke({
                        color: trailStroke,
                        width: FAMap.Styles.Feature._defs.LINE_WIDTH * 2
                    })
                }, {
                    stroke: new ol.style.Stroke({
                        color: trailFill,
                        width: FAMap.Styles.Feature._defs.LINE_WIDTH
                    })
                }];
                break;
            case 'Route':
                var styleOpts = {};
                if (cycleVisible) {
                    styleOpts.stroke = new ol.style.Stroke({
                        color: def.route,
                        width: 1,
                        lineDash: [8, 4]
                    });
                }
                break;
            default:
                var styleOpts = {};
            }
            var styles = [];
            if (styleOpts.forEach === undefined) {
                styles.push(new ol.style.Style(styleOpts))
            } else {
                styleOpts.forEach(function(s) {
                    styles.push(new ol.style.Style(s))
                });
            }
            return styles;
        });
        FAMap.Styles.Feature._instances.flights['highlight_' + layer] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution, cycleVisible) {
            var iconFill = def.fillColor;
            var iconStroke = def.strokeColor;
            var textFill = def.fillColor;
            switch (feature.get('featureSet')) {
            case 'Plane':
                var styleOpts = {
                    image: FAMap.Styles.Feature._util.getIcon(feature, {
                        fillColor: iconFill,
                        strokeColor: iconStroke
                    }, resolution),
                    text: FAMap.Styles.Feature._util.getDatablock(feature, {
                        fillColor: textFill,
                        strokeColor: '#000'
                    })
                };
                break;
            case 'Route':
                var styleOpts = {
                    stroke: new ol.style.Stroke({
                        color: def.route,
                        width: 1,
                        lineDash: [8, 4]
                    })
                };
                break;
            default:
                var styleOpts = {};
            }
            return [new ol.style.Style(styleOpts)];
        });
    });
});
delete flightColors;
FAMap.Styles.Feature._instances.flown_route = {};
var routeColors = {
    default: {
        airportDot: '#00FF00',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    classic: {
        airportDot: '#00FF00',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    earthview: {
        airportDot: '#00FF00',
        airportTextFill: '#FFA033',
        airportTextOutline: '#000000'
    },
    sectional: {
        airportDot: '#00FF00',
        airportTextFill: '#0000CC',
        airportTextOutline: '#BCBCBC'
    },
    ifr_high: {
        airportDot: '#00FF00',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    ifr_low: {
        airportDot: '#00FF00',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    skyvector_vfr: {
        airportDot: '#00FF00',
        airportTextFill: '#0000CC',
        airportTextOutline: '#BCBCBC'
    },
    skyvector_ifr_low: {
        airportDot: '#00FF00',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    skyvector_ifr_high: {
        airportDot: '#00FF00',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    premium_sat_boundaries: {
        airportDot: '#00FF00',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    premium_sat: {
        airportDot: '#00FF00',
        airportTextFill: '#FFA033',
        airportTextOutline: '#000000'
    },
    premium_terrain: {
        airportDot: '#00FF00',
        airportTextFill: '#000000',
        airportTextOutline: '#FFFFFF'
    },
    premium_streets: {
        airportDot: '#00FF00',
        airportTextFill: '#000000',
        airportTextOutline: '#FFFFFF'
    }
};
var trackColors = {
    dark: {
        fillColor: '#00FF00',
        strokeColor: '#008900',
        projectedColor: '#ffffff',
        projectedOutline: '#000000',
        baseLayers: ['default', 'classic', 'earthview', 'premium_sat_boundaries', 'premium_sat']
    },
    light: {
        fillColor: '#00FF00',
        strokeColor: '#008900',
        projectedColor: '#000000',
        projectedOutline: '#ffffff',
        baseLayers: ['sectional', 'ifr_high', 'ifr_low', 'premium_terrain', 'premium_streets', 'skyvector_vfr', 'skyvector_ifr_low', 'skyvector_ifr_high']
    }
};
$.each(trackColors, function(key, def) {
    def.baseLayers.forEach(function(layer) {
        routeColors[layer].fillColor = def.fillColor;
        routeColors[layer].strokeColor = def.strokeColor;
        routeColors[layer].projectedColor = def.projectedColor;
        routeColors[layer].projectedOutline = def.projectedOutline;
    });
});
$.each(routeColors, function(idx, colors) {
    FAMap.Styles.Feature._instances.flown_route[idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var style;
        switch (feature.get('featureSet')) {
        case 'Endpoints':
            var label = FAUser.formatAirportCode(feature.get('icao'), feature.get('iata'), feature.get('altIdent'), false, true);
            var baseOffset = 5;
            switch (feature.get('labelAlign')) {
            case 'right':
                offsetX = baseOffset * -1;
                break;
            case 'left':
                offsetX = baseOffset;
                break;
            default:
                offsetX = 0;
                break;
            }
            return [new ol.style.Style({
                image: new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: colors.airportDot
                    }),
                    radius: 2
                }),
                text: new ol.style.Text({
                    font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                    offsetX: offsetX,
                    offsetY: 0,
                    text: label || '',
                    textAlign: feature.get('labelAlign'),
                    textBaseline: feature.get('labelBaseline'),
                    fill: new ol.style.Fill({
                        color: colors.airportTextFill
                    }),
                    stroke: new ol.style.Stroke({
                        color: colors.airportTextOutline,
                        width: 2
                    })
                })
            })];
            break;
        case 'Track':
            if (feature.get('isProjected')) {
                var trackFill = colors.projectedColor;
                var trackStroke = colors.projectedOutline;
            } else {
                var trackFill = colors.fillColor;
                var trackStroke = colors.strokeColor;
            }
            return [new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: trackStroke,
                    width: FAMap.Styles.Feature._defs.LINE_WIDTH * 2
                })
            }), new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: trackFill,
                    width: FAMap.Styles.Feature._defs.LINE_WIDTH
                })
            })];
            break;
        case 'IsolatedPosition':
            var posColor = colors.realTrackFill;
            return [new ol.style.Style({
                image: new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: posColor
                    }),
                    radius: 1.5
                })
            })];
            break;
        default:
            return null;
            break;
        }
    });
});
delete routeColors;
FAMap.Styles.Feature._instances.live_flights = {};
var liveColors = {
    default: {
        outline: '#000000',
        fillColor: '#F6C081',
        strokeColor: '#4D4D4D'
    }
};
$.each(liveColors, function(idx, colors) {
    FAMap.Styles.Feature._instances.live_flights[idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var iconFill = colors.fillColor;
        var iconStroke = colors.strokeColor;
        var textFill = colors.fillColor;
        var textStroke = colors.outline;
        return [new ol.style.Style({
            image: FAMap.Styles.Feature._util.getIcon(feature, {
                fillColor: iconFill,
                strokeColor: iconStroke
            }, resolution)
        })]
    });
    FAMap.Styles.Feature._instances.live_flights['highlight_' + idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var iconFill = colors.fillColor;
        var iconStroke = colors.strokeColor;
        var textFill = colors.fillColor;
        var textStroke = colors.outline;
        return [new ol.style.Style({
            image: FAMap.Styles.Feature._util.getIcon(feature, {
                fillColor: iconFill,
                strokeColor: iconStroke
            }, resolution),
            text: FAMap.Styles.Feature._util.getDatablock(feature, {
                fillColor: textFill,
                strokeColor: textStroke
            })
        })]
    });
});
delete liveColors;
var natEastStyle = {
    default: FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        return [new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#00FF00',
                width: FAMap.Styles.Feature._defs.LINE_WIDTH
            }),
            text: new ol.style.Text({
                font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                offsetX: 30,
                offsetY: 10,
                text: feature.get('TRACK_NAME') || '',
                textAlign: 'left',
                textBaseline: 'bottom',
                fill: new ol.style.Fill({
                    color: '#00FF00'
                })
            })
        })];
    })
};
var natWestStyle = {
    default: FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        return [new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#FF0000',
                width: FAMap.Styles.Feature._defs.LINE_WIDTH
            }),
            text: new ol.style.Text({
                font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                offsetX: -30,
                offsetY: -10,
                text: feature.get('TRACK_NAME') || '',
                textAlign: 'right',
                textBaseline: 'top',
                fill: new ol.style.Fill({
                    color: '#FF0000'
                })
            })
        })];
    })
};
FAMap.Styles.Feature._instances.nat_east = natEastStyle;
FAMap.Styles.Feature._instances.nat_west = natWestStyle;
FAMap.Styles.Feature._instances.nat_east_pub = natEastStyle;
FAMap.Styles.Feature._instances.nat_west_pub = natWestStyle;
FAMap.Styles.Feature._instances.nearby_airports = {
    _wxColors: {
        VFR: '#1FCA23',
        MVFR: '#1921FA',
        IFR: '#FD8825',
        LIFR: '#FC0D1B',
        BCAT1: '#CA41FB',
        default: '#AAAAAA'
    },
    _getRadiusByOps: function(feature) {
        var maxRadius = 7;
        var minRadius = 3;
        var ops = feature.get('ops');
        if (typeof ops == 'undefined') {
            return minRadius;
        }
        return Math.round(ops * (maxRadius - minRadius) + minRadius);
    }
};
var nearbyColors = {
    default: {
        text: '#FFFF00',
        outline: '#000000'
    },
    classic: {
        text: '#FFFF00',
        outline: '#000000'
    },
    earthview: {
        text: '#FFA033',
        outline: '#000000'
    },
    sectional: {
        text: '#0000CC',
        outline: '#BCBCBC'
    },
    ifr_high: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    ifr_low: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    skyvector_vfr: {
        text: '#0000CC',
        outline: '#BCBCBC'
    },
    skyvector_ifr_low: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    skyvector_ifr_high: {
        text: '#002F5D',
        outline: '#FFFFFF'
    },
    mapbox_sat_boundaries: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_sat: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_terrain_light: {
        text: '#000000',
        outline: '#FFFFFF'
    },
    mapbox_terrain_dark: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_streets_light: {
        text: '#000000',
        outline: '#FFFFFF'
    },
    mapbox_streets_dark: {
        text: '#FFFF00',
        outline: '#000000'
    },
    mapbox_scope: {
        text: '#66FF66',
        outline: '#000000'
    }
};
$.each(nearbyColors, function(idx, colors) {
    FAMap.Styles.Feature._instances.nearby_airports[idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var text = FAUser.formatAirportCode(feature.get('icao'), feature.get('iata'), feature.get('altIdent'), false);
        var radius = FAMap.Styles.Feature._instances.nearby_airports._getRadiusByOps(feature);
        var wx = feature.get('wx');
        if (wx in FAMap.Styles.Feature._instances.nearby_airports._wxColors) {
            var wxFill = FAMap.Styles.Feature._instances.nearby_airports._wxColors[wx];
        } else {
            var wxFill = FAMap.Styles.Feature._instances.nearby_airports._wxColors.default;
        }
        return [new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({
                    color: wxFill
                }),
                stroke: new ol.style.Stroke({
                    color: colors.outline
                }),
                radius: radius
            }),
            text: new ol.style.Text({
                font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                offsetX: radius + 2,
                offsetY: 0,
                text: text || '',
                textAlign: 'left',
                textBaseline: 'top',
                fill: new ol.style.Fill({
                    color: colors.text
                }),
                stroke: new ol.style.Stroke({
                    color: colors.outline,
                    width: 2
                })
            })
        })]
    });
    FAMap.Styles.Feature._instances.nearby_airports['highlight_' + idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var wx = feature.get('wx');
        if (wx in FAMap.Styles.Feature._instances.nearby_airports._wxColors) {
            var wxFill = FAMap.Styles.Feature._instances.nearby_airports._wxColors[wx];
        } else {
            var wxFill = FAMap.Styles.Feature._instances.nearby_airports._wxColors.default;
        }
        if (wx == '') {
            var wxText = '';
        } else {
            var wxText = ' (' + wx + ')';
        }
        var text = feature.get('label') + wxText;
        var radius = FAMap.Styles.Feature._instances.nearby_airports._getRadiusByOps(feature);
        return [new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({
                    color: wxFill
                }),
                stroke: new ol.style.Stroke({
                    color: colors.outline
                }),
                radius: radius + 1
            }),
            text: new ol.style.Text({
                font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                offsetX: radius + 2,
                offsetY: 0,
                text: text || '',
                textAlign: 'left',
                textBaseline: 'top',
                fill: new ol.style.Fill({
                    color: colors.text
                }),
                stroke: new ol.style.Stroke({
                    color: colors.outline,
                    width: 2
                })
            })
        })]
    });
});
delete nearbyColors;
FAMap.Styles.Feature._instances.nearby_flights = {};
var nearbyColors = {
    default: {
        outline: '#000000',
        fillColor: '#D9D9D9',
        strokeColor: '#5A5A5A'
    }
};
$.each(nearbyColors, function(idx, colors) {
    FAMap.Styles.Feature._instances.nearby_flights[idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var iconFill = colors.fillColor;
        var iconStroke = colors.strokeColor;
        var textFill = colors.fillColor;
        var textStroke = colors.outline;
        return [new ol.style.Style({
            image: FAMap.Styles.Feature._util.getIcon(feature, {
                fillColor: iconFill,
                strokeColor: iconStroke
            }, resolution)
        })]
    });
    FAMap.Styles.Feature._instances.nearby_flights['highlight_' + idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var iconFill = colors.fillColor;
        var iconStroke = colors.strokeColor;
        var textFill = colors.fillColor;
        var textStroke = colors.outline;
        return [new ol.style.Style({
            image: FAMap.Styles.Feature._util.getIcon(feature, {
                fillColor: iconFill,
                strokeColor: iconStroke
            }, resolution),
            text: FAMap.Styles.Feature._util.getDatablock(feature, {
                fillColor: textFill,
                strokeColor: textStroke
            })
        })]
    });
});
delete nearbyColors;
FAMap.Styles.Feature._instances.planned_route = {};
var routeColors = {
    default: "#4499FF",
    classic: "#4499FF",
    earthview: "#4499FF",
    sectional: "#F8F8F8",
    ifr_high: "#909090",
    ifr_low: "#909090",
    skyvector_vfr: "#F8F8F8",
    skyvector_ifr_low: "#909090",
    skyvector_ifr_high: "#909090",
    mapbox_sat_boundaries: "#4499FF",
    mapbox_sat: "#4499FF",
    mapbox_terrain_light: "#ED8000",
    mapbox_terrain_dark: "#4499FF",
    mapbox_streets_light: "#ED8000",
    mapbox_streets_dark: "#4499FF",
    mapbox_scope: "#00B400"
};
$.each(routeColors, function(idx, color) {
    FAMap.Styles.Feature._instances.planned_route[idx] = new ol.style.Style({
        stroke: new ol.style.Stroke({
            color: color,
            width: 1.2,
            lineDash: [8, 4]
        })
    });
});
FAMap.Styles.Feature._instances.range_rings = {
    default: new ol.style.Style({
        stroke: new ol.style.Stroke({
            color: '#66FF66',
            width: 1
        })
    })
};
FAMap.Styles.Feature._instances.related_airports = {};
var endpointColors = {
    default: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    classic: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    earthview: {
        airportDot: '#66FF66',
        airportTextFill: '#FFA033',
        airportTextOutline: '#000000'
    },
    sectional: {
        airportDot: '#00FFFF',
        airportTextFill: '#0000CC',
        airportTextOutline: '#BCBCBC'
    },
    ifr_high: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    ifr_low: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    skyvector_vfr: {
        airportDot: '#00FFFF',
        airportTextFill: '#0000CC',
        airportTextOutline: '#BCBCBC'
    },
    skyvector_ifr_low: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    skyvector_ifr_high: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    mapbox_sat_boundaries: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    mapbox_sat: {
        airportDot: '#66FF66',
        airportTextFill: '#FFA033',
        airportTextOutline: '#000000'
    },
    mapbox_terrain_light: {
        airportDot: '#000000',
        airportTextFill: '#000000',
        airportTextOutline: '#FFFFFF'
    },
    mapbox_terrain_dark: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    mapbox_streets_light: {
        airportDot: '#000000',
        airportTextFill: '#000000',
        airportTextOutline: '#FFFFFF'
    },
    mapbox_streets_dark: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    mapbox_scope: {
        airportDot: '#66FF66',
        airportTextFill: '#66FF66',
        airportTextOutline: '#000000'
    }
};
$.each(endpointColors, function(idx, colors) {
    $.each([false, true], function(k, isHighlightStyle) {
        var airportRadius = isHighlightStyle ? 5 : 3;
        var prefix = isHighlightStyle ? 'highlight_' : '';
        FAMap.Styles.Feature._instances.related_airports[prefix + idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution, cycleVisible) {
            var styleOpts = {};
            if (feature.get('onground')) {
                styleOpts.image = new ol.style.RegularShape({
                    fill: new ol.style.Fill({
                        color: colors.airportDot
                    }),
                    radius: 4,
                    points: 3
                });
            } else {
                styleOpts.image = new ol.style.Circle({
                    fill: new ol.style.Fill({
                        color: colors.airportDot
                    }),
                    radius: airportRadius
                });
            }
            if ((FAMap.Util.getZoomForResolution(resolution) >= 4 || feature.get('onground')) && cycleVisible) {
                if (feature.get('onground')) {
                    var label = feature.get('label') || '';
                } else {
                    var label = FAUser.formatAirportCode(feature.get('icao'), feature.get('iata'), feature.get('altIdent'), false);
                    var baseOffset = 5;
                    var offsetX;
                    switch (feature.get('labelAlign')) {
                    case 'right':
                        offsetX = baseOffset * -1;
                        break;
                    case 'left':
                    default:
                        offsetX = baseOffset;
                        break;
                    }
                }
                styleOpts.text = new ol.style.Text({
                    font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                    offsetX: offsetX,
                    offsetY: 0,
                    text: label || '',
                    textAlign: feature.get('labelAlign') || 'left',
                    textBaseline: feature.get('labelBaseline') || 'middle',
                    fill: new ol.style.Fill({
                        color: colors.airportTextFill
                    }),
                    stroke: new ol.style.Stroke({
                        color: colors.airportTextOutline,
                        width: 2
                    })
                });
            }
            return [new ol.style.Style(styleOpts)];
        });
    });
});
delete endpointColors;
FAMap.Styles.Feature._instances.onground_related_dedupe = FAMap.Styles.Feature._instances.related_airports;
FAMap.Styles.Feature._defaults.SigmetType = {
    SIGMET: {
        "Point": new ol.style.Style({
            image: new ol.style.Circle({
                stroke: new ol.style.Stroke({
                    color: '#22dcf4',
                    width: 2
                }),
                fill: new ol.style.Fill({
                    color: 'rgba(34,220,244,0.1)'
                }),
                radius: 3
            })
        }),
        "Polygon": new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#22dcf4',
                width: 2
            }),
            fill: new ol.style.Fill({
                color: 'rgba(34,220,244,0.1)'
            })
        })
    },
    OUTLOOK: {
        "Point": new ol.style.Style({
            image: new ol.style.Circle({
                stroke: new ol.style.Stroke({
                    color: '#22dcf4',
                    width: 2
                }),
                fill: new ol.style.Fill({
                    color: 'rgba(34,220,244,0.1)'
                }),
                radius: 3
            })
        }),
        "Polygon": new ol.style.Style({
            stroke: new ol.style.Stroke({
                color: '#f4b222',
                width: 2
            }),
            fill: new ol.style.Fill({
                color: 'rgba(244,178,34,0.1)'
            })
        })
    }
}
FAMap.Styles.Feature._instances.sigmets = {
    default: FAMap.Styles.Feature._util.universalStyleFunction(function(feature) {
        var type = feature.get('type')
          , hazard = feature.get('hazard')
          , style = null
          , geomType = feature.getGeometry().getType();
        if (type !== "SIGMET" && type !== "OUTLOOK") {
            return null;
        }
        if (typeof (FAMap.Styles.Feature._defaults.SigmetType[type]) !== "undefined") {
            if (typeof (FAMap.Styles.Feature._defaults.SigmetType[type][geomType]) !== "undefined") {
                style = FAMap.Styles.Feature._defaults.SigmetType[type][geomType];
            } else {
                console.error("Unknown sigmet type.geomType:" + type + "." + geomType);
                return null;
            }
        } else {
            console.error("Unknown sigmet type:" + type);
            return null;
        }
        return [style];
    })
};
FAMap.Styles.Feature._instances.static_airport = {};
var airportColors = {
    default: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    classic: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    earthview: {
        airportDot: '#66FF66',
        airportTextFill: '#FFA033',
        airportTextOutline: '#000000'
    },
    sectional: {
        airportDot: '#00FFFF',
        airportTextFill: '#0000CC',
        airportTextOutline: '#BCBCBC'
    },
    ifr_high: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    ifr_low: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    skyvector_vfr: {
        airportDot: '#00FFFF',
        airportTextFill: '#0000CC',
        airportTextOutline: '#BCBCBC'
    },
    skyvector_ifr_low: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    skyvector_ifr_high: {
        airportDot: '#66FF66',
        airportTextFill: '#002F5D',
        airportTextOutline: '#FFFFFF'
    },
    mapbox_sat_boundaries: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    mapbox_sat: {
        airportDot: '#66FF66',
        airportTextFill: '#FFA033',
        airportTextOutline: '#000000'
    },
    mapbox_terrain_light: {
        airportDot: '#000000',
        airportTextFill: '#000000',
        airportTextOutline: '#FFFFFF'
    },
    mapbox_terrain_dark: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    mapbox_streets_light: {
        airportDot: '#000000',
        airportTextFill: '#000000',
        airportTextOutline: '#FFFFFF'
    },
    mapbox_streets_dark: {
        airportDot: '#66FF66',
        airportTextFill: '#FFFF00',
        airportTextOutline: '#000000'
    },
    mapbox_scope: {
        airportDot: '#66FF66',
        airportTextFill: '#66FF66',
        airportTextOutline: '#000000'
    }
};
$.each(airportColors, function(idx, colors) {
    FAMap.Styles.Feature._instances.static_airport[idx] = FAMap.Styles.Feature._util.universalStyleFunction(function(feature, resolution) {
        var text = FAUser.formatAirportCode(feature.get('icao'), feature.get('iata'), feature.get('altIdent'), false);
        var baseOffset = 5;
        switch (feature.get('labelAlign')) {
        case 'right':
            offsetX = baseOffset * -1;
            break;
        case 'left':
            offsetX = baseOffset;
            break;
        default:
            offsetX = 0;
            break;
        }
        return [new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({
                    color: colors.airportDot
                }),
                radius: 2
            }),
            text: new ol.style.Text({
                font: String(FAMap.Styles.Feature._defs.FONT_SIZE) + 'px ' + FAMap.Styles.Feature._defs.FONT,
                offsetX: 2,
                offsetY: 0,
                text: text || '',
                textAlign: 'left',
                textBaseline: 'top',
                fill: new ol.style.Fill({
                    color: colors.airportTextFill
                }),
                stroke: new ol.style.Stroke({
                    color: colors.airportTextOutline,
                    width: 2
                })
            })
        })];
    });
});
FAMap.Styles.Feature._instances.ifr_endpoints = FAMap.Styles.Feature._instances.static_airport;
delete airportColors;
FAMap.Styles.Feature._instances.tfrs = {
    default: new ol.style.Style({
        fill: new ol.style.Fill({
            color: 'rgba(255,0,0,0.2)'
        }),
        stroke: new ol.style.Stroke({
            color: '#FF0000',
            width: 3
        })
    })
};
